window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.infobarnotifications.js'] = (new Date()).getTime();
Type.registerNamespace("_inot");_inot.g=function(n){_inot.g.initializeBase(this,[n])};_inot.c=function(n,t){_inot.c.initializeBase(this,[n]);this.__type=_inot.c._dataContractName;this.Body=t};_inot.h=function(){_inot.h.initializeBase(this);this.__type=_inot.h._dataContractName;this.Body=new _inot.i};_inot.d=function(n,t){_inot.d.initializeBase(this);this.__type=_inot.d._dataContractName;this.ItemId=n;this.Id=t;this.Notifications=new Array(0)};_inot.i=function(){_inot.i.initializeBase(this);this.__type=_inot.i._dataContractName};_inot.b=function(n){this.c=n};_inot.b.prototype={c:null,a:function(){return this.c},b:function(n,t){if(n&&t){for(var f=this.f(t,12e3),r=0;r<n.cm.b();r++){var i=n.cm.a(r);var u=i.a;var o=this;var e=new _inot.e(i,function(t,i){o.c.b(n,t,i,function(){},function(n){})});this.e(t,e,u,i.Key,this.g(i));Array.remove(f,String.format(_inot.b.a,u,i.Key))}this.h(t,f)}},e:function(n,t,i,r,u){this.d(n,i,r);var f=String.format(_inot.b.a,i,r);return n.j(12e3,t,f,u)},d:function(n,t,i){var r=String.format(_inot.b.a,t,i);n.n(12e3,r)},h:function(n,t){for(var u=t,o=u.length,i=0;i<o;++i){var s=u[i];var r=s.split(_inot.b.b,2);var e=r[0];var f=r[1];this.d(n,e,f)}},g:function(n){var t=n.Type===undefined?0:n.Type;switch(t){case 2:return 0;case 0:return 1;case 1:return 2}return 0},f:function(n,t){for(var u=[],i=0;i<n.e().x.length;i++){var r=n.e().x[i];r.d===t&&r.f&&u.push(r.f)}return u}};function InfoBarNotificationsComponent(){}InfoBarNotificationsComponent.$$cctor=function(){_a.t.a().a(InfoBarNotificationsComponent)};InfoBarNotificationsComponent.prototype={b:function(n,t,i){var f=this;n.b(_mco.H,function(){return new _inot.f}).a().b(_mco.H);var u=this;n.b(_mco.v,function(){return new _inot.j(n.a(_mco.H))}).a().b(_mco.v);var r=this;n.b(_mco.m,function(){return new _inot.b(n.a(_mco.v))}).a().b(_mco.m)},a:function(){return null}};_inot.j=function(n){this.e=n};_inot.j.prototype={e:null,a:function(){return this.e},b:function(n,t,i,r,u){for(var f=0;f<n.cm.b();f++)if(n.cm.a(f).a===t&&n.cm.a(f).Key===i){var e=n.cm.a(f).b;n.cm.o(f);if(e){var s=this,o=this;this.e.b(t,n,function(){r()},function(n){u(n)})}else r();return}u(9024)},c:function(n,t,i,r){for(var e=5,u=0;u<t.cm.b();u++){var f=t.cm.a(u);if(f.a===n.a){if(f.Key===n.Key){r(9023);return}e--;if(!e){r(9025);return}}}t.cm.c(n);if(n.b){var s=this,o=this;this.e.b(n.a,t,function(){i()},function(n){r(n)})}else i()},d:function(n,t,i,r){for(var u=0;u<t.cm.b();u++){var f=t.cm.a(u);if(f.a===n.a&&f.Key===n.Key){var e=n.b||f.b;t.cm.C(u,n);if(e){var s=this,o=this;this.e.b(n.a,t,function(){i()},function(n){r(n)})}else i();return}}this.c(n,t,i,r)}};_inot.f=function(){};_inot.f.a=function(n,t,i){var u=n.Type===undefined?0:n.Type;var r;return r=new _g.df,r.a=t.toLowerCase(),r.b=i,r.Key=n.Key,r.Icon=n.Icon,r.Type=u,r.Message=n.Message,r};_inot.f.b=function(n,t){for(var u=[],r=0;r<n.cm.b();r++){var i=n.cm.a(r);i&&i.a===t&&i.b&&u.push(i)}return u};_inot.f.prototype={d:function(n,t){if(!n.gm){n.gm=!0;if(n.dK())for(var u=0;u<n.dK().b();u++){for(var f=!1,i=n.dK().a(u),r=0;r<i.Notifications.length;r++){t&&i.Notifications[r].Type===2&&(f=!0);n.cm.c(_inot.f.a(i.Notifications[r],i.Id,!t||i.Notifications[r].Type!==2))}if(f){var o=this,e=this;this.b(i.Id,n,function(){},function(n){})}}}},b:function(n,t,i,r){var f=_inot.f.b(t,n);if(!t.bD.ItemId||!t.bD.ItemId.Id){r(9028);return}var u=new _inot.k(t.bD.ItemId,n.toLowerCase(),f);var o=this;u.b(function(n){i()});var e=this;u.c(function(n){r(9027)});_a.g.a.a(u)},c:function(n,t,i){var f=!!n.bD.PropertyExistence&&!!n.bD.PropertyExistence.WebExtNotifications;var e=f&&(!n.dK()||!n.dK().b());n.dK()||n.bD.ItemId&&n.bD.ItemId.Id||n.hb(new _a.k);if(e){var r=new _h.K(1300,[new _g.e(n.bD.ItemId.Id)],_h.b.a(),"ItemNormalizedBody",0,!1,null,null);var u=this;r.b(function(i){var r=_h.d.a().a(n.bD.ItemId.Id);n.hb(r.dK()?r.dK():new _a.k);u.d(n,!0);t()});var o=this;r.c(function(n){i(9026)});_a.g.a.a(r);return}this.d(n,!0);t()},a:function(n){var i=this,t=this;this.c(n,function(){},function(n){})}};_inot.k=function(n,t,i){_inot.k.initializeBase(this);this.f=n;this.e=t;this.h=i};_inot.k.prototype={f:null,e:null,h:null,j:null,K:function(n){var i=new _inot.g(this.L);i.actionName="UpdateClientExtensionNotificationsAction";i.owsVersion="V2_75";var t;var r=new _inot.c(this.X("V2_75"),(t=new _inot.d,t.Id=this.e,t.ItemId=this.f,t.Notifications=this.h,t));n.dq(r,i,this.J,this.H)},cI:function(n){this.j=n}};_inot.e=function(n,t){this.d=Function.createDelegate(this,this.e);_inot.e.initializeBase(this,["ExtensibilityInfoBarView"]);this.a=n;this.c=t;this.b=new _j.g(this.d,_a.a.i)};_inot.e.prototype={a:null,c:null,b:null,e:function(){this.c(this.a.a,this.a.Key)}};_inot.a=function(){};_inot.a.$$cctor=function(){_inot.a._I()};_inot.a.d=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_inot_2'></span> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_inot_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div>";_j.i.a().appendChild(n);return n};_inot.a.g=function(n){return n.a.Message};_inot.a.f=function(n){return n.b};_inot.a.c=function(n,t){n.a(t)};_inot.a.e=function(n,t){n.T(t)};_inot.a._I=function(){var t="ExtensibilityInfoBarView._tid1";new _j.d(t,function(){_inot.a.a[t]===undefined&&(_inot.a.a[t]=[[[-1,4,null,null,null,"Text",null,_inot.a.c,0,null,null,null,_u.S.A]]]);var n=_inot.a.b.childNodes[0].cloneNode(!0);var i=new _fc.a(n.children[0]);return new _j.a(n,[i])},"",_inot.e,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_inot.a.a);var n="ExtensibilityInfoBarView";new _j.d(n,function(){_inot.a.a[n]===undefined&&(_inot.a.a[n]=[[[-1,0,["InfoBarText"],[_inot.a.g],null,"Text",null,_inot.a.c,1,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_inot.a.f],null,"ClickCommand",null,_inot.a.e,0,null,null,null]]]);var t=_inot.a.b.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(t,[0,2]));r.y("ExtensibilityInfoBarView._tid1");var i=new _fc.a(_j.a.a(t,[0,1]));i.a("|");var u=new _fc.a(_j.a.a(t,[0,0]));return new _j.a(t,[u,i,r])},"",_inot.e,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_inot.a.a)};_inot.g.registerClass("_inot.g",_g.hD,0,0);_inot.c.registerClass("_inot.c",_g.hQ,0,0);_inot.h.registerClass("_inot.h",_g.ke);_inot.d.registerClass("_inot.d",_g.kh);_inot.i.registerClass("_inot.i",_g.gt);InfoBarNotificationsComponent.registerClass("InfoBarNotificationsComponent",null,_a.jw,_j.ce);_inot.k.registerClass("_inot.k",_h.dr.$$(_inot.h,_inot.i));_inot.e.registerClass("_inot.e",_y.le);_inot.c._dataContractName="UpdateClientExtensionNotificationsJsonRequest:#Exchange";_inot.h._dataContractName="UpdateClientExtensionNotificationsJsonResponse:#Exchange";_inot.d._dataContractName="UpdateClientExtensionNotificationsRequest:#Exchange";_inot.i._dataContractName="UpdateClientExtensionNotificationsResponseMessage:#Exchange";_inot.b.b=":";_inot.b.a="{0}"+_inot.b.b+"{1}";InfoBarNotificationsComponent.$$cctor();_inot.a.b=_inot.a.d();_inot.a.a={};_inot.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.infobarnotifications.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.infobarnotifications.js'] = (new Date()).getTime();
