var Footprint=function(){function n(n,r,u){if(void 0===u&&(u=""),n&&0!==n.trim().length&&Number(r)===r&&r%1===0&&!(r<0)){var f=200,c=u.trim().length>0;c&&u.trim().length>f&&(u=u.trim().substr(0,f));var l=window.location.protocol+"//";if(JSON&&XMLHttpRequest){var m="trans.gif",g=2e3,s="4",h=i(),d=o(),w="&MonitorID="+n+"&rid="+d+"&w3c="+h+"&prot="+window.location.protocol+"&v="+s+(c?"&tag="+u:"")+"&DATA=";if("undefined"!=typeof fpconfig){var v=e(fpconfig,l);if(0!==v.length){var p=t(v,l,m),y=[l+fpconfig.r[0]+"?"+w];a(p,g,r,y,null)}}}}}function e(n,e){var t=1,r=2,o=12,i="http://"===e.toLowerCase()?r:t,a=[],u=0;for(var f in n.e){var c=n.e[f];c.w>0&&c.m&i&&(u+=c.w,a.push({endpoint:c.e,cumWeight:u,weight:c.w,measurementType:c.m}))}for(var l=[],m=Math.min(n.n,a.length);l.length<m;){var g=Math.floor(Math.random()*u),s=null;for(var h in a)null==s?g<=a[h].cumWeight&&(s=a[h],delete a[h]):a[h].cumWeight-=s.weight;u-=s.weight;var d=s.measurementType&o?"17k.gif":"trans.gif";l.push({id:s.endpoint,testImage:d})}return l}function t(n,e,t){var r=[];for(var i in n){var a=n[i].id,u=n[i].testImage,f=e+a;a.indexOf(".")===-1&&(f+=".clo.footprintdns.com"),f+="/apc/";var c=f+t+"?"+o();r.push({url:c,requestID:a,object:t,conn:"cold"});var l=f+u+"?"+o();r.push({url:l,requestID:a,object:u,conn:"warm"})}return r}function r(n,e){for(var t=[],r=0;r<e.length;r++)for(var r=0;r<e.length;r++)t.push({RequestID:e[r].requestID,Object:e[r].object,Conn:e[r].conn,Result:Math.round(n[r])});return JSON.stringify(t)}function o(){function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return n()+n()+n()+n()+n()+n()+n()+n()}function i(){return!(!window.performance||!window.performance.getEntriesByName)}function a(n,e,t,o,a){function u(t){if(null!=c&&clearTimeout(c),null!=f?m[t]=(new Date).getTime()-f:m[t]=-1,t=(g+s)%n.length,l=new Image,g++<n.length){f=(new Date).getTime(),l.onload=function(){u(t)};var h=function(){l.onload=null,l.onerror=null,f=null,u(t)};c=setTimeout(function(){h()},e),l.onerror=function(){null!=c&&clearTimeout(c),c=null,h()},l.src=n[t].url}else{if(null!=o&&0!==o.length){if(i())for(var d=0;d<n.length;d++){var w=n[d].url,v=window.performance.getEntriesByName(w);m[d]!==-1&&v&&v[0]&&(m[d]=v[0].duration)}for(var p=r(m,n),d=0;d<o.length;d++){var y=o[d],I=new Image;I.src=y+p}}null!=a&&a()}}var f,c,l,m=[],g=0,s=0;setTimeout(function(){u(0)},t)}return fpconfig={n:3,e:[{e:"msedge-anycast-a-ring",w:20,m:1},{e:"msedge-anycast-b-ring",w:20,m:1},{e:"acdc-direct.office.com",w:20,m:1},{e:"gtm-dyn-direct.office365.com",w:20,m:1},{e:"atm",w:20,m:1},{e:"outlook.office365.com",w:20,m:1},{e:"outlook.office.com",w:20,m:1}],r:["fpc.msedge.net/r.gif"]},{start:n}}();