window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.triageshared.js'] = (new Date()).getTime();
function TriageSharedComponent(){}TriageSharedComponent.$$cctor=function(){_a.t.a().a(TriageSharedComponent)};TriageSharedComponent.prototype={b:function(n,t,i){var f=this;n.b(_y.eS,function(){return new _trs.b(n.a(_a.f),n.a(_g.h),n.a(_j.j))}).b(_y.eS);var u=this;n.b(_y.gw,function(){return new _trs.e(n.a(_a.T),n.a(_a.f),n.a(_a.ee),n.a(_a.Y),n.a(_g.bG),n.a(_a.cX))}).b(_y.gw).a();var r=this;n.b(_y.gr,function(){var i=n.a(_a.f);if(i&&i.a().cA().Enabled){var u=n.a(_a.H);var t=u.a.mcuPercentage;var r=_j.h.b(t)?null:parseInt(t);return new _trs.j(n.a(_y.cN),n.a(_y.H),r)}return null}).a()},a:function(){return[]}};Type.registerNamespace("_trs");_trs.c=function(n){this.a=n};_trs.c.a=function(n,t,i,r,u){var o=n>=1073741824?1073741824:n>=1048576?1048576:1024;var e=(n/o).toFixed(u);var f=n>=1073741824?t:n>=1048576?i:r;return _j.h.c(f,e)};_trs.c.prototype={a:null,b:function(){var n=this.a.b();var i=this.a.c();var t=i.bD.UseDatabaseQuotaDefaults?n.e():i.c();return t.bD.IsUnlimited?n.b().bD.IsUnlimited?100:n.b().bD.Value>0?3:0:Math.round(n.b().bD.Value/t.bD.Value*100)},f:function(){var i=this.a.b();var t=this.a.c();var n=t.bD.UseDatabaseQuotaDefaults?i.c():t.b();var r=i.b().bD.Value;return n.bD.IsUnlimited?_ops.b.bq:this.d()?_trs.c.a(n.bD.Value,_ops.b.aq,_ops.b.Xg,_ops.b.Ui,2):_trs.c.a(n.bD.Value,_ops.b.Xp,_ops.b.bf,_ops.b.Fp,2)},e:function(){var i=this.a.b();var t=this.a.c();var n=t.bD.UseDatabaseQuotaDefaults?i.e():t.c();return n.bD.IsUnlimited?_ops.b.Rs:_trs.c.a(n.bD.Value,_ops.b.Dx,_ops.b.N,_ops.b.dX,2)},c:function(n,t,i){var u=this.a.b();var r=u.b().bD.Value;return _trs.c.a(r,n,t,i,2)},g:function(){if(!this.d())return null;var t=this.a.b();var n=this.a.c();var r=n.bD.UseDatabaseQuotaDefaults?t.c():n.b();var i=t.b().bD.Value-r.bD.Value;return _trs.c.a(i,_ops.b.PT,_ops.b.gL,_ops.b.bQ,2)},d:function(){var i=this.a.b();var t=this.a.c();var n=t.bD.UseDatabaseQuotaDefaults?i.c():t.b();var r=i.b().bD.Value;return!n.bD.IsUnlimited&&r>=n.bD.Value}};_trs.j=function(n,t,i){this.k=Function.createDelegate(this,this.a);this.f=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.r);this.e=n;this.i=t;this.h=new _j.g(this.l,_a.a.s);this.j=i!=null?i:95};_trs.j.prototype={e:null,i:null,j:0,b:0,d:null,h:null,c:null,g:!1,p:function(){var n=this.b>=98?_ops.b.RZ:_ops.b.FG;return _j.h.c(_ops.b.EX,this.b,n)},q:function(){return this.b>=98?1:0},a:function(){var n=new _trs.i;n.b(this.m);_a.g.a.a(n)},s:function(n){var i=n;var t=new _trs.c(i.e);this.b=t.b();!this.g&&this.b>=this.j?this.v():this.o()},v:function(){this.e.b(this.n,this.f,this.q(),this.p(),null,_ops.b.Wh,this.h,null,null,null,null,_fm.a.u,this.d,!1,null,!1,null)},u:function(n){this.d=n;this.c||(this.c=_j.m.a().e(_a.a.s,"MailboxUsageNotificationViewModel",this.k,5e3));_a.c.c(_a.a.s,"VM.MailboxCleanup.ShowMailboxUsage",this.b.toString(),0)},o:function(){this.e.a(this.d,this.f)},t:function(){this.d=null;if(this.c){this.c=_j.m.a().b(this.c);this.g=!0}_a.c.c(_a.a.s,"VM.MailboxCleanup.HideMailboxUsage")},r:function(){this.i.a(1450,1);this.o();_a.c.c(_a.a.s,"VM.MailboxCleanup.CleanupMailboxButtonClicked")}};_trs.b=function(n,t,i){this.g=i;if(n){var u=t.b().h();this.h=u.b()===_trs.b.a.b();if(!_trs.b.c&&this.h){_trs.b.c=!0;for(var r=0;r<_trs.b.a.b();r++)if(u.a(r)!==_trs.b.a.a(r)){_h.j.a(_a.a.R,"CustomHoverActions",-1,0,null);break}}}};_trs.b.prototype={g:null,h:!1,j:null,b:function(n){var i=_g.a.a().b().h();var r=new _a.k;if(this.h)for(var t=0;t<i.b();t++)i.a(t)&&r.c(i.a(t));else r=_trs.b.a;return this.i(r,n)},f:function(n,t){var u=_g.a.a().b().h();var i=new _a.k;if(this.h)if(_g.x.isInstanceOfType(n))for(var r=0;r<u.b();r++)u.a(r)&&i.c(u.a(r));else u.j(1)&&i.c(1);else _g.x.isInstanceOfType(n)?i=_trs.b.a:i.c(1);return this.i(i,t)},e:function(n){var u=_g.a.a().b().h();var t=new _a.k;if(this.h)for(var r=0;r<u.b();r++){var i=u.a(r);(i===4||i===1||i===5)&&t.c(i)}else{t.c(5);t.c(4);t.c(1)}return this.i(t,n)},d:function(n,t){for(var u=this.h?_g.a.a().b().h():_trs.b.b,f=new _a.k,i=0;i<u.b();i++){var r=u.a(i);(_g.x.isInstanceOfType(n)&&r===4||r===1)&&f.c(r)}return this.i(f,t)},c:function(n,t){for(var u=this.h?_g.a.a().b().h():_trs.b.b,f=new _a.k,i=0;i<u.b();i++){var r=u.a(i);(_g.x.isInstanceOfType(n)&&r===4||r===1)&&f.c(r)}return this.i(f,t)},a:function(n){var t=_trs.b.d;return this.i(t,n)},i:function(n,t){var r=new _j.l;if(t&&_a.gb.isInstanceOfType(t)&&t.fk)r.a(this.k(t));else for(var i=0;i<n.b();i++)r.a(this.l(n.a(i),t));return r},l:function(n,t){var i;switch(n){case 1:i=new _trs.g(this.g,t,1,t.T(),_n.b.U(),_n.b.bk(),_u.R.Mq,null,null);break;case 2:i=new _trs.g(this.g,t,2,t.b(),_n.b.ck(),_n.b.dK(),_u.R.Ez,null,null);break;case 5:var f=new _fce.g(new _b.a(_a.o.a(),_j.m.a()),this.g,_y.c.a,_g.a.a());f.c(t.q());f.j(!!t.q()&&t.q().q());var e=_y.hC.isInstanceOfType(t)?t.e():null;i=new _trs.g(this.g,t,5,t.Z(),t.V(),t.U(),t.W(),f,e);break;case 3:var r=t;i=new _trs.g(this.g,t,3,r.f(),r.d(),r.c(),r.a(),null,null);break;case 6:var o=t;var u=new _fce.g(new _b.a(_a.o.a(),_j.m.a()),this.g,_y.c.a,_g.a.a());u.e=!0;u.b=1;i=new _trs.g(this.g,t,6,o.e(),_n.b.cB(),_n.b.eG(),_u.R.Pg,u,null);break;case 4:i=new _trs.g(this.g,t,4,t.ba(),_n.b.eZ(),_n.b.fa(),t.z(),null,null);break;default:i=this.k(t);break}return i},k:function(n){this.j&&(this.j=new _trs.g(this.g,n,0,_j.g.a,null,null,"",null,null));return this.j}};_trs.d=function(n,t,i,r){this.q=Function.createDelegate(this,this.G);_trs.d.initializeBase(this,[t,n,null,!1,null,null,"ModuleSwitcherView.ContextMenuSwitch"]);this.i=i;this.m=r;this.y(new _j.g(this.q,_trs.e.a))};_trs.d.prototype={m:null,A:function(){return this.m.b===this.i},C:function(){return String.format(_u.R.Rj,this.j)},i:null,e:function(){return new _trs.d(this.p,this.j,this.i,this.m)},bx:function(){this.m=null;_j.R.prototype.bx.call(this)},G:function(){this.m.x(this.i)}};_trs.e=function(n,t,i,r,u,f){this.s=Function.createDelegate(this,this.w);this.f=Function.createDelegate(this,this.v);_trs.e.initializeBase(this);_a.c.c(_trs.e.a,"ModSwitchInit");this.q=n;this.m=t;this.c=i;this.d=r;this.e=u;this.l=f;this.u();this.t(this.c.a());this.c.b(this.f);this.h=!t.a().fA().Enabled;this.g=new _j.g(this.s,_trs.e.a)};_trs.e.prototype={q:null,m:null,c:null,d:null,e:null,l:null,b:0,g:null,n:null,j:null,o:null,r:null,p:null,h:!1,a:null,i:null,t:function(n){if(this.b!==n){this.b=n;this.eG("CurrentModuleType")}return n},x:function(n){var i=new _a.l;i.b("F",_a.M.toString(this.b));i.b("T",_a.M.toString(n));var t;var u,r;(r=this.y(n,u={val:t}),t=u.val,r)?this.d.c(t):this.q.a(_a.bb.a(n),null);_h.j.a(_trs.e.a,"ModSwitch",19,1,i)},eI:function(){this.c.c(this.f);_a.gb.prototype.eI.call(this)},y:function(n,t){t.val=null;if(n===5){t.val=this.d.b().replace(this.d.k(),"/mail/photohub.aspx");return!0}return!1},u:function(){this.a=new Array(0);this.n=new _trs.d(_fm.b.a(_fm.a.e),_u.R.DJ,0,this);this.a.push(this.n);if(this.e.bD.Calendar){this.j=new _trs.d(_fm.b.a(_fm.a.w),_u.R.Ie,1,this);this.a.push(this.j)}if(this.e.bD.Contacts){this.o=new _trs.d(_fm.b.a(_fm.a.ba),_u.R.FU,2,this);this.a.push(this.o)}if(this.m.a().jb().Enabled){this.p=new _trs.d(_fm.b.a(_fm.a.bY),_u.R.IT,5,this);this.a.push(this.p)}if(this.e.bD.Tasks){this.r=new _trs.d(_fm.b.a(_fm.a.bv),_u.R.Eu,3,this);this.a.push(this.r)}this.i=new _trs.d(_fm.b.a(_fm.a.h),_u.R.Pd,null,this)},v:function(){this.t(this.c.a())},w:function(){_db.x.d(this.l)}};_trs.i=function(){_trs.i.initializeBase(this)};_trs.i.prototype={e:null,K:function(n){var i=new _dg.cG(this.L);var t=new _dg.bY(this.M());n.bz(t,i,this.J,this.H)},cS:function(n,t,i){if(n&&n.AccountInfo){this.e=new _dg.W(n.AccountInfo);t()}}};_trs.f=function(n){this.c=-1;this.a=new _fm.e(null);this.e=new _j.l;_trs.f.initializeBase(this,[n]);this.y("ModuleSwitcherView")};_trs.f.prototype={b:!1,g:function(){if(this.c===-1){this.c=205;this.f()}return this.c},j:function(n){if(this.c!==n){this.c=n;this.b||this.f()}return n},k:function(n){if(this.b!==n){this.b=n;this.b&&this.f();this.bw("IsVertical")}return n},h:function(){return!this.a.p.x.length},d:!1,f:function(){this.d=!1;var u=this.V();var i=u.a.length;var n;if(this.b)n=Math.min(5,i);else{var f=Math.floor((this.g()-5)/40);n=Math.min(f,i);n<i&&(n-=1)}this.e.g();this.i();for(var t=0;t<i;t++){var r=u.a[t];if(t<n)this.e.a(r);else{this.a.p.a(r.e());r.i===u.b&&(this.d=!0)}}this.bz("HideMoreModulesButton","IsActiveModuleInOverflowMenu")},i:function(){this.a.q()&&this.a.r.a();for(var t=this.a.p.x.length-1,n=t;n>=0;n--){this.a.p.x[n].dispose();this.a.p.n(n)}}};_trs.a=function(){};_trs.a.$$cctor=function(){};_trs.a.v=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_3'></button> </div><div>  <div></div> </div><div><div class='__Microsoft_Owa_TriageShared_templates_cs_2'></div></div><div> <div></div> </div><div> <div class='__Microsoft_Owa_TriageShared_templates_cs_6 flex flexwrap'></div>  <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_c __Microsoft_Owa_TriageShared_templates_cs_7 ms-fcl-tp'></button> </div><div>  <div class='__Microsoft_Owa_TriageShared_templates_cs_4 flex flexwrap ms-bgc-nl'></div> </div><div>  <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_7 __Microsoft_Owa_TriageShared_templates_cs_d ms-fcl-tp'></button> <div></div> </div><div> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_8 __Microsoft_Owa_TriageShared_templates_cs_d ms-font-m ms-fcl-tp ms-bgc-tl-h'></button> </div><div> <a class='__Microsoft_Owa_TriageShared_templates_cs_e ms-bgc-tp ms-fcl-w'></a> <div></div>   </div>";_j.i.a().appendChild(n);return n};_trs.a.N=function(n){return n.e()};_trs.a.K=function(n){return n.c()};_trs.a.M=function(n){return n.d()};_trs.a.L=function(n){return n.h()};_trs.a.P=function(n){return n.g()};_trs.a.J=function(n){return n.bJ()};_trs.a.O=function(n){return n.f()};_trs.a.n=function(n){return n.i};_trs.a.g=function(n){return n.j};_trs.a.l=function(n){return n.p};_trs.a.c=function(n){return n.X};_trs.a.Y=function(n){return _trs.f.isInstanceOfType(n)?n.h():null};_trs.a.ba=function(n){return _trs.f.isInstanceOfType(n)?n.d:null};_trs.a.u=function(n){return _trs.f.isInstanceOfType(n)?n.a:null};_trs.a.H=function(n){return n.q()};_trs.a.z=function(n){return n.k()};_trs.a.Z=function(n){return n.e};_trs.a.bb=function(n){return n.b};_trs.a.V=function(n){return n.C()};_trs.a.j=function(n){return n.A()};_trs.a.s=function(n){return n.k};_trs.a.U=function(n){return n.i===1};_trs.a.t=function(n){return n.c()};_trs.a.F=function(n){return n.r};_trs.a.G=function(n){return n.u};_trs.a.X=function(n){return n.h};_trs.a.W=function(n){return n.g};_trs.a.R=function(n){return _n.I.isInstanceOfType(n)?n.a:null};_trs.a.Q=function(n){return n.b};_trs.a.f=function(n,t){n.l(t)};_trs.a.x=function(n,t){n.m(t)};_trs.a.e=function(n,t){n.T(t)};_trs.a.y=function(n,t){n.dO(t)};_trs.a.w=function(n,t){n.bN(t)};_trs.a.m=function(n,t){n.bj(t)};_trs.a.r=function(n,t){n.bk(t)};_trs.a.h=function(n,t){n.K(t)};_trs.a.o=function(n,t){n.Q(t)};_trs.a.B=function(n,t){n.b=t};_trs.a.C=function(n,t){n.c(t)};_trs.a.I=function(n,t){n.m(t)};_trs.a.A=function(n,t){n.j(t)};_trs.a.p=function(n,t){n.o(t)};_trs.a.T=function(n,t){n.b=t};_trs.a.S=function(n,t){n.b=t};_trs.a.q=function(n,t){n.j(t)};_trs.a.D=function(n,t){n.w(t)};_trs.a.E=function(n,t){n.b=t};_trs.a.bd=function(n,t){n.k(t)};_trs.a.bc=function(n,t){n.j(t)};_trs.a.k=function(){_trs.a.d||(_trs.a.d=new _fc.k);return _trs.a.d};_trs.a.i=function(){};TriageSharedComponent.registerClass("TriageSharedComponent",null,_a.jw,_j.ce);_trs.d.registerClass("_trs.d",_fm.c);_trs.e.registerClass("_trs.e",_a.bu,_y.gw,_a.ki,_j.bs,Sys.IDisposable);_trs.i.registerClass("_trs.i",_h.fG);_trs.f.registerClass("_trs.f",_j.c);TriageSharedComponent.$$cctor();_trs.b.c=!1;_trs.b.a=new _a.k([3,5,4,1]);_trs.b.b=new _a.k([4,1]);_trs.b.d=new _a.k([3,4,1]);_trs.e.a=_a.a.fb;_trs.a.b=_trs.a.v();_trs.a.d=null;_trs.a.a={};_trs.a.$$cctor();
window.scriptsLoaded['microsoft.owa.triageshared.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.triageshared.js'] = (new Date()).getTime();
