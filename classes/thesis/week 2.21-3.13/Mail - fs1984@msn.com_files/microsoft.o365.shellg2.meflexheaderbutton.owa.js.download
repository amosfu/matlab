window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = (new Date()).getTime();
function MeFlexHeaderButtonComponent(){}MeFlexHeaderButtonComponent.$$cctor=function(){_a.t.a().a(MeFlexHeaderButtonComponent)};MeFlexHeaderButtonComponent.prototype={b:function(n,t,i){var r=this;n.b(_o365sg2c.d,function(){return new _o365sg2pflex.b}).b(_o365sg2c.d).a()},a:function(){return null}};Type.registerNamespace("_o365sg2pflex");_o365sg2pflex.b=function(){_o365sg2pflex.b.resolveInheritance();this.k=this.X;this.a=this.co;_o365sg2pflex.b.initializeBase(this)};_o365sg2pflex.b.prototype={Q:null,bh:null,bg:null,br:null,bd:!1,bi:0,be:null,Y:null,bE:null,bq:0,bf:null,bc:null,l:function(){return this.Q},w:function(n){this.Q!==n&&(this.Q=n);return n},d:function(){return this.bh},bF:function(n){if(this.bh!==n){this.bh=n;this.bw("UserDisplayName")}return n},i:function(){return this.bg},bG:function(n){this.bg!==n&&(this.bg=n);return n},r:function(){return!1},s:function(){return this.br},bP:function(n){if(this.br!==n){this.br=n;this.bw("UserEmail")}return n},o:function(){return this.bd},ca:function(n){if(this.bd!==n){this.bd=n;this.bw("IsSkypeDisabled")}return n},m:function(){return this.bi},f:function(n){if(this.bi!==n){this.bi=n;this.bw("UserPresence")}return n},V:null,b:function(){return this.V},B:null,c:function(){return this.B},v:function(n){this.bE!==n&&(this.bE=n);return n},q:function(){return this.A},j:function(n){this.A!==n&&this.E(n);return n},p:function(){return this.bq},e:function(n){if(this.bq!==n){this.bq=n;this.bw("MenuState")}return n},h:function(){return this.bf},x:function(n){if(this.bf!==n){this.bf=n;this.bw("TextBoyDataType")}return n},g:function(){return!_j.z.a(this.C().a().ShowLighterWeightMeControl)&&this.C().a().ShowLighterWeightMeControl},bS:function(){return this.g()?this.bg:this.R()},n:function(){return this.bc},t:function(n,t){var r;try{r=n}catch(f){throw _o365cl.a.a(415006,"userPhotoViewModels",6,1);}var i;try{i=t}catch(u){throw _o365cl.a.a(415007,"rightMenusViewModel",6,1);}this.bX(r,i)},bX:function(n,t){this.Y=n;this.be=t;if(!this.C()||!this.C().b())throw _o365cl.a.b(409845,1,6);this.C().a()&&(this.C().a().IsConsumerShell&&this.C().a().NotManagedEmailAddress?this.bP(this.C().a().NotManagedEmailAddress):this.bP(this.C().a().UPN));this.K("O365_MeFlexPane_ButtonID");try{this.bT(this.C().b())}catch(i){O365.Log.WriteShellLog(411324,6,1,0,i);throw i;}},bT:function(n){this.bY(n.UserDisplayName,n.TruncatedUserDisplayName);this.u(_s1.ShellG2Strings.l_ShellCore_MeTile_Aria_Text);this.ca(this.C().a().LyncIntegrationDisabled);this.f(0);this.bZ();this.bV(n)},bZ:function(){if(this.Y.length>0){this.V=this.Y[0];if(this.V){var n=this;this.V.j=function(){n.B&&n.B.d()};try{this.V.i()}catch(i){O365.Log.WriteShellLog(409847,6,1,0,i);throw i;}}if(this.Y.length>1){this.B=this.Y[1];if(this.B)try{this.B.i()}catch(t){O365.Log.WriteShellLog(409848,6,1,0,t);throw t;}}}this.bc=this.g()?_o365sg2c.b.c:_o365sg2c.b.d},bY:function(n,t){if(n||t){this.bF(t||n);this.bG(n)}else if(this.C().a()&&this.C().a().UPN)if(this.C().a().IsConsumerShell&&this.C().a().NotManagedEmailAddress){this.bF(this.C().a().NotManagedEmailAddress);this.bG(this.C().a().NotManagedEmailAddress)}else{this.bF(this.C().a().UPN);this.bG(this.C().a().UPN)}else O365.Log.WriteShellLog(175144,1,1,0)},bV:function(n){this.w(new Array(0));if(n){var t=new Array(0);if(n.AboutMeLink){var h=this;this.be.a(t,n.AboutMeLink,function(){O365.Log.WriteShellLog(300934,1,1,0);O365.Log.a("AboutMe","MeControlPane","NavLink",null,1,1);return!0})}if(this.C().a().MyAccountEnabled){var s=this;var u=new _fm.o(_s1.ShellG2Strings.l_ShellCore_MyAccount_Title_Text,null,new _ff.q(function(n){O365.Log.WriteShellLog(406639,1,1,0);O365.Log.a("MyAccount","MeControlPane","NavLink",null,1,1)},_ff.c.a),this.C().a().PortalUrl+this.C().a().MyAccountUrl,"_self");u.V("O365_SubLink_ViewAccount");u.v(_s1.ShellG2Strings.l_ShellCore_MyAccount_Title_Text);t.push(u)}if(n.CurrentWorkloadUserSubLinks&&n.CurrentWorkloadUserSubLinks.length>0)for(var e=n.CurrentWorkloadUserSubLinks,o=e.length,r=0;r<o;++r){var f=e[r];f&&this.be.a(t,f,null)}if(n.SignOutLink){var i=this;this.be.a(t,n.SignOutLink,function(){O365.Log.a("SignOut","MeControlPane","NavLink",null,1,1);if(i.Q){for(var n=0;n<i.Q.length;n++)if(i.Q[n])try{i.Q[n]()}catch(t){t.message=_o365su.d.a(t.message);O365.Log.WriteShellLog(300442,6,1,0,n,t)}return!1}return!0})}this.bn(new _fm.e(t));_o365sg2c.k.b(this);_o365sg2c.k.a(this.z)}}};_o365sg2pflex.c=function(n){_o365sg2pflex.c.initializeBase(this,[n]);this.y("MeFlexPaneHeaderButtonView")};_o365sg2pflex.a=function(){};_o365sg2pflex.a.$$cctor=function(){_o365sg2pflex.a._I()};_o365sg2pflex.a.C=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <img/> </div><div> <div class='o365cs-mfp-header-img-container o365cs-mfp-circular-small'></div> </div><div>  <div class='o365cs-mfp-header'> <div class='o365cs-mfp-header-displayname o365cs-rsp-tn-hide o365cs-mfp-header-displayname-wrap'> <span class='o365cs-topnavText'> </span> </div> <div class='o365cs-nav-button o365cs-mfp-header-img'>  <div class='o365cs-mfp-doughboy-container'> <span class='ms-bgc-nt ms-fcl-w o365cs-mfp-doughboy o365cs-mfp-circular-small'></span> </div>  <div class='o365cs-mfp-textboy o365cs-mfp-circular-small'></div>  <div></div>  <div class='o365cs-mfp-header-img-container o365cs-mfp-circular-small'></div> <div autoid=\"__Microsoft_O365_ShellG2_MeFlexHeaderButton_Owa_templates_cs_0\" class='o365cs-mfp-presenceButton'></div> </div> </div> <div class='o365cs-flexPane-unseenitems'> <span class='o365cs-flexPane-unseenCount'></span> <span class='o365cs-flexPane-unseenCount'></span> </div> </div><div> <button type='button' class='o365cs-nav-item o365cs-nav-button ms-bgc-tdr-h'></button> </div><div> <div></div> </div>";_j.i.a().appendChild(n);return n};_o365sg2pflex.a.g=function(n){return n.B};_o365sg2pflex.a.q=function(n){return n.f};_o365sg2pflex.a.r=function(n){return n.g};_o365sg2pflex.a.p=function(n){return n.a};_o365sg2pflex.a.o=function(n){return n.b};_o365sg2pflex.a.k=function(n){return n.V};_o365sg2pflex.a.w=function(n){return n.g()};_o365sg2pflex.a.P=function(n){return n.bh};_o365sg2pflex.a.y=function(n){return n.N};_o365sg2pflex.a.A=function(n){return n.H()};_o365sg2pflex.a.L=function(n){return n.bc};_o365sg2pflex.a.N=function(n){return n.bf};_o365sg2pflex.a.M=function(n){return n.bd};_o365sg2pflex.a.c=function(n){return n.bi};_o365sg2pflex.a.B=function(n){return n.U};_o365sg2pflex.a.z=function(n){return n.bo};_o365sg2pflex.a.T=function(n){return n.bQ()};_o365sg2pflex.a.U=function(n){return n.bb};_o365sg2pflex.a.R=function(n){return n.P};_o365sg2pflex.a.x=function(n){return n.A};_o365sg2pflex.a.O=function(n){return n.bS()};_o365sg2pflex.a.Q=function(n){return n.bs()};_o365sg2pflex.a.K=function(n){return n.k()};_o365sg2pflex.a.S=function(n){return n.Z};_o365sg2pflex.a.s=function(n,t){n.g(t)};_o365sg2pflex.a.t=function(n,t){n.i(t)};_o365sg2pflex.a.v=function(n,t){n.a(t)};_o365sg2pflex.a.u=function(n,t){n.b=t};_o365sg2pflex.a.e=function(n,t){n.K(t)};_o365sg2pflex.a.n=function(n,t){n.a(t)};_o365sg2pflex.a.m=function(n,t){n.a(t)};_o365sg2pflex.a.G=function(n,t){n.ba(t)};_o365sg2pflex.a.E=function(n,t){n.T(t)};_o365sg2pflex.a.J=function(n,t){n.bj(t)};_o365sg2pflex.a.I=function(n,t){n.O(t)};_o365sg2pflex.a.H=function(n,t){n.fe(t)};_o365sg2pflex.a.D=function(n,t){n.Q(t)};_o365sg2pflex.a.F=function(n,t){n.l=t};_o365sg2pflex.a.f=function(){_o365sg2pflex.a.h||(_o365sg2pflex.a.h=new _fc.k);return _o365sg2pflex.a.h};_o365sg2pflex.a.l=function(){_o365sg2pflex.a.i||(_o365sg2pflex.a.i=new _fc.l);return _o365sg2pflex.a.i};_o365sg2pflex.a.b=function(){_o365sg2pflex.a.j||(_o365sg2pflex.a.j=new _o365sg2c.w);return _o365sg2pflex.a.j};_o365sg2pflex.a._I=function(){var r="MeFlexPaneHeaderButtonView._tid1._tid2._tid3._tid4";new _j.d(r,function(){_o365sg2pflex.a.a[r]===undefined&&(_o365sg2pflex.a.a[r]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pflex.a.u,0,null,null,0,4],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pflex.a.g,_o365sg2pflex.a.q],null,"LoadCommand",null,_o365sg2pflex.a.s,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pflex.a.g,_o365sg2pflex.a.r],null,"LoadErrorCommand",null,_o365sg2pflex.a.t,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pflex.a.g,_o365sg2pflex.a.p],null,"Source",null,_o365sg2pflex.a.v,1,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[0].cloneNode(!0);var n=new _o365sg2c.h(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var u="MeFlexPaneHeaderButtonView._tid1._tid2._tid3";new _j.d(u,function(){_o365sg2pflex.a.a[u]===undefined&&(_o365sg2pflex.a.a[u]=[[[-1,0,["SecondaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pflex.a.g,_o365sg2pflex.a.o],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.f(),null,!0]]]);var t=_o365sg2pflex.a.d.childNodes[1].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid3._tid4");return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var f="MeFlexPaneHeaderButtonView._tid1._tid2._tid5";new _j.d(f,function(){_o365sg2pflex.a.a[f]===undefined&&(_o365sg2pflex.a.a[f]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pflex.a.u,0,null,null,0,4],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pflex.a.k,_o365sg2pflex.a.q],null,"LoadCommand",null,_o365sg2pflex.a.s,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pflex.a.k,_o365sg2pflex.a.r],null,"LoadErrorCommand",null,_o365sg2pflex.a.t,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pflex.a.k,_o365sg2pflex.a.p],null,"Source",null,_o365sg2pflex.a.v,1,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[0].cloneNode(!0);var n=new _o365sg2c.h(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var n="MeFlexPaneHeaderButtonView._tid1._tid2";new _j.d(n,function(){_o365sg2pflex.a.a[n]===undefined&&(_o365sg2pflex.a.a[n]=[[[-1,5,["IsLighterWeightMeControlEnabled"],[_o365sg2pflex.a.w],null,"o365cs-display-none",null,null,0,null,null,null]],[[-1,0,["UserDisplayName"],[_o365sg2pflex.a.P],null,"Text",null,_o365sg2pflex.a.n,1,null,null,null],[-1,5,["IsDisabled"],[_o365sg2pflex.a.y],null,"o365cs-nav-itemDisabled",null,null,0,null,null,null],[-1,5,["IsSelected"],[_o365sg2pflex.a.A],null,"o365cs-topnavText",null,null,0,_o365sg2pflex.a.f(),null,null]],[[-1,0,["DoughboyIconId"],[_o365sg2pflex.a.L],null,"Id",null,_o365sg2pflex.a.m,0,null,null,null]],[[-1,0,["TextBoyDataType"],[_o365sg2pflex.a.N],null,"DataContext",null,_o365sg2pflex.a.G,1,null,null,null]],[[-1,0,["SecondaryUserPhotoViewModel"],[_o365sg2pflex.a.g],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.l(),null,!0]],[[-1,0,["PrimaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pflex.a.k,_o365sg2pflex.a.o],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.f(),null,!0]],[[-1,0,["IsSkypeDisabled"],[_o365sg2pflex.a.M],null,"IsHidden",null,_o365sg2pflex.a.e,1,null,null,!0],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--question",null,null,0,_o365sg2pflex.a.b(),0,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeUnkown",null,null,0,_o365sg2pflex.a.b(),0,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeOffline",null,null,0,_o365sg2pflex.a.b(),1,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeCheck",null,null,0,_o365sg2pflex.a.b(),2,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeAvailable",null,null,0,_o365sg2pflex.a.b(),2,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeClock",null,null,0,_o365sg2pflex.a.b(),3,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeAway",null,null,0,_o365sg2pflex.a.b(),3,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeBusy",null,null,0,_o365sg2pflex.a.b(),4,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeMinus",null,null,0,_o365sg2pflex.a.b(),6,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeDND",null,null,0,_o365sg2pflex.a.b(),6,null]],null,[[-1,0,["UnseenCount"],[_o365sg2pflex.a.B],null,"Text",null,_o365sg2pflex.a.n,1,null,null,null],[-1,0,["UnseenCount"],[_o365sg2pflex.a.B],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.l(),null,!0],[-1,5,["IsReverseColor"],[_o365sg2pflex.a.z],null,"ms-fcl-tdr ms-bgc-w o365cs-flexPane-unseenCountBorder:ms-fcl-w ms-bgc-tdr",null,null,0,null,null,null],[-1,5,["IsOval"],[_o365sg2pflex.a.T],null,"o365cs-flexPane-unseenCountOval",null,null,0,null,null,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pflex.a.m,0,null,null,null,_o365sg2c.b.g],[-1,0,["ShowUnseenIndicator"],[_o365sg2pflex.a.U],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.f(),null,!0],[-1,5,["IsReverseColor"],[_o365sg2pflex.a.z],null,"ms-fcl-tdr ms-bgc-w o365cs-flexPane-unseenCountBorder:ms-fcl-w ms-bgc-tdr",null,null,0,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[2].cloneNode(!0);var o=new _fc.d(_j.a.a(t,[1,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var h=new _fc.a(_j.a.a(t,[1,0]));var l=new _j.i(t.children[1]);var c=new _j.c(_j.a.a(t,[0,1,4]));var e=new _j.c(_j.a.a(t,[0,1,3]));e.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid5");var r=new _j.c(_j.a.a(t,[0,1,2]));r.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid3");var i=new _j.c(_j.a.a(t,[0,1,1]));i.y("MeFlexPanePanelView.TextBoy");i.L(!0);var f=new _fc.d(_j.a.a(t,[0,1,0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));f.N(!0);var u=new _fc.a(_j.a.a(t,[0,0,0]));u.E(47);var s=new _j.i(_j.a.a(t,[0,0]));return new _j.a(t,[s,u,f,i,r,e,c,l,h,o])},"",_o365sg2pflex.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var t="MeFlexPaneHeaderButtonView._tid1";new _j.d(t,function(){_o365sg2pflex.a.a[t]===undefined&&(_o365sg2pflex.a.a[t]=[[[-1,0,["IsHidden"],[_o365sg2pflex.a.R],null,"IsHidden",null,_o365sg2pflex.a.e,1,null,null,!0],[-1,0,["Command"],[_o365sg2pflex.a.x],null,"ClickCommand",null,_o365sg2pflex.a.E,1,null,null,null],[-1,0,["TextBoyToolTip"],[_o365sg2pflex.a.O],null,"Title",null,_o365sg2pflex.a.J,1,null,null,null],[-1,0,["AriaId"],[_o365sg2pflex.a.Q],null,"AriaId",null,_o365sg2pflex.a.I,1,null,null,null],[-1,0,["IsDisabled"],[_o365sg2pflex.a.y],null,"AriaDisabledState",null,_o365sg2pflex.a.H,1,null,null,!1],[-1,0,["AriaLabel"],[_o365sg2pflex.a.K],null,"AriaLabel",null,_o365sg2pflex.a.D,1,null,null,null],[-1,5,["IsSelected"],[_o365sg2pflex.a.A],null,"o365cs-spo-topbarMenuOpen ms-fcl-b ms-bgc-nlr:o365cs-topnavText ms-bgc-tdr-h",null,null,0,null,null,null],[-1,5,["AppButtonHighlighted"],[_o365sg2pflex.a.S],null,"ms-bgc-tdr",null,null,0,null,null,null],[-1,5,["IsLighterWeightMeControlEnabled"],[_o365sg2pflex.a.w],null,"o365cs-mfp-headerbutton",null,null,0,_o365sg2pflex.a.f(),null,null]]]);var r=_o365sg2pflex.a.d.childNodes[3].cloneNode(!0);var n=new _fc.b(r.children[0]);n.E(10);var u=new _fc.g;var i=new _fc.c;i.U(_j.f.a(["Command"],[_o365sg2pflex.a.x],null,"Command",null,_o365sg2pflex.a.F,1));i.j("DOWNARROW");u.a([i]);n.C([u]);n.y("MeFlexPaneHeaderButtonView._tid1._tid2");return new _j.a(r,[n])},"",_o365sg2pflex.b,_o365sg2pflex.c,function(n){return new _o365sg2pflex.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var i="MeFlexPaneHeaderButtonView";new _j.d(i,function(){_o365sg2pflex.a.a[i]===undefined&&(_o365sg2pflex.a.a[i]=[null]);var t=_o365sg2pflex.a.d.childNodes[4].cloneNode(!0);var n=new _o365sg2pflex.c(t.children[0]);n.y("MeFlexPaneHeaderButtonView._tid1");return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pflex.a.a)};MeFlexHeaderButtonComponent.registerClass("MeFlexHeaderButtonComponent",null,_a.jw,_j.ce);_o365sg2pflex.b.registerClass("_o365sg2pflex.b",_o365sg2c.m,_o365sg2c.d);_o365sg2pflex.c.registerClass("_o365sg2pflex.c",_j.c);MeFlexHeaderButtonComponent.$$cctor();_o365sg2pflex.a.d=_o365sg2pflex.a.C();_o365sg2pflex.a.h=null;_o365sg2pflex.a.i=null;_o365sg2pflex.a.j=null;_o365sg2pflex.a.a={};_o365sg2pflex.a.$$cctor();
window.scriptsLoaded['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = (new Date()).getTime();
