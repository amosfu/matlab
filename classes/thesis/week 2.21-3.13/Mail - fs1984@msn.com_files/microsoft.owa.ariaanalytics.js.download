window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.ariaanalytics.js'] = (new Date()).getTime();
Type.registerNamespace("_ar");function AriaAnalyticsComponent(){}AriaAnalyticsComponent.$$cctor=function(){_a.t.a().a(AriaAnalyticsComponent)};AriaAnalyticsComponent.prototype={b:function(n,t,i){var r=this;n.b(_a.eT,function(){return new _ar.a(i,n.a(_g.h),n.a(_a.f),n.a(_j.j))}).a()},a:function(){return[]}};_ar.a=function(n,t,i,r){this.g=Function.createDelegate(this,this.l);this.c=[];this.d=n;this.f=t.c();this.e=i;r.b(_a.ej,this.g);microsoft.applications.telemetry.LogManager.initialize(_ar.d.a);this.m();this.j()};_ar.a.b=function(n,t){try{t.a().logEvent(n);return!0}catch(i){_j.e.b(_a.a.cQ,"Aria SDK rejected event '{1}' with exception: {1}",n.name,i.message);return!1}};_ar.a.prototype={d:null,e:null,f:null,a:function(n){for(var r=null,u=this.c,f=u.length,t=0;t<f;++t){var i=u[t];if(n.d&i.e&&i.d(this.e,n,null)){if(!r){n.n(this.d.p());r=this.h(n.c(),n.b)}if(!_ar.a.b(r,i))break}}},b:function(n){for(var c=n,h=c,l=h.length,o=0;o<l;++o){var t=h[o];if(t.Id==="PerfTraceCTQ"){for(var s=null,u={},i=0;i<t.Keys.length;i++){var f=t.Keys[i];switch(f){case"S":s=t.Values[i];break;case"T":case"set":case"E":u[f]=t.Values[i];break;case"cd":for(var e=f.split(new RegExp("_|\\|")),r=0;r<e.length;r=r+2)u[e[r]]=e[r+1];break;default:break}}this.n(s,u)}}},n:function(n,t){for(var r=null,f=this.c,e=f.length,i=0;i<e;++i){var u=f[i];if(u.b(n)){r||(r=this.h(n,t));if(!_ar.a.b(r,u))return}}},h:function(n,t){for(var f=this.i(n),u=Object.keys(t),o=u.length,i=0;i<o;i++){var r=u[i];var e=this.k(r);try{f.setProperty(e,t[r],!1)}catch(s){_j.e.b(_a.a.cQ,"Aria SDK rejected event property name '{0}' (sanitized to {1}) for event '{2}'",r,e,n)}}return f},j:function(){this.c.push(new _ar.d);this.c.push(new _ar.f);this.c.push(new _ar.b);this.c.push(new _ar.c);this.c.push(new _ar.e);for(var i=this.c,r=i.length,n=0;n<r;++n){var t=i[n];t.g(this.e)&&t.c.logSession(0,null)}},m:function(){var t=microsoft.applications.telemetry.LogManager.getSemanticContext();t.setAppVersion(this.d.h());t.setAppLanguage(this.d.x());var i=new RegExp(";[^;]*UC[^;]*=([^;]*)");var n=i.exec(document.cookie);n&&n.length>=2&&t.setUserId(n[1])},l:function(n){for(var r=this.c,u=r.length,t=0;t<u;++t){var i=r[t];i.g(this.e)&&i.c.logSession(1,null)}microsoft.applications.telemetry.LogManager.flush()},k:function(n){return"owa_"+n.replace(_ar.a.a,"_")},i:function(n){var t=new microsoft.applications.telemetry.EventProperties;t.name=n.replace(_ar.a.a,"_");t.setProperty("owadef_ut",_g.a.a().B?"1":"0",!1);t.setProperty("owadef_layout",_y.c.a.a(),!1);t.setProperty("owadef_tenantg",this.f.bD.TenantGuid,!1);t.setProperty("owadef_mbxg",this.f.bD.MailboxGuid,!1);t.setProperty("owadef_mbxp",this.f.bD.UserPuid,!1);t.setProperty("owadef_be",window.navBackEndServer,!1);return t}};_ar.g=function(n,t,i){this.f={};_j.s.h(n,0,"tenantType");_j.s.a(t,"tenantToken");if(i)for(var f=i,e=f.length,r=0;r<e;++r){var u=f[r];this.f[u]=u}this.c=new microsoft.applications.telemetry.Logger(t);this.e=n};_ar.g.prototype={c:null,a:function(){return this.c},e:0,b:function(n){return!_j.h.b(n)&&n in this.f},d:function(n,t,i){var r=!1;var u=t?t.c():i;switch(u){case"Usage":r=n.a().dt().Enabled||_a.bs.c(n,null,_y.c.a.a(),!1);break;case"CorePerf":r=n.a().dq().Enabled;break;case"SamplePerf":r=n.a().ds().Enabled;break;case"owaclienterror":r=n.a().dr().Enabled;break;case"session":r=n.a().dq().Enabled||n.a().dr().Enabled||n.a().ds().Enabled||n.a().dt().Enabled;break;default:break}return r},g:function(n){return this.d(n,null,"session")}};_ar.b=function(){_ar.b.initializeBase(this,[4,_ar.b.a,_ar.b.b])};_ar.c=function(){_ar.c.initializeBase(this,[8,_ar.c.a,_ar.c.b])};_ar.f=function(){_ar.f.initializeBase(this,[2,_ar.f.a,null])};_ar.f.prototype={d:function(n,t,i){var r=!1;var u=t?t.c():i;switch(u){case"Usage":case"CorePerf":case"SamplePerf":r=n.a().iu().Enabled;break;default:break}return r}};_ar.e=function(){_ar.e.initializeBase(this,[16,_ar.e.a,null])};_ar.e.prototype={d:function(n,t,i){var r=t?t.c():i;return r==="CorePerf"?!0:!1}};_ar.d=function(){_ar.d.initializeBase(this,[1,_ar.d.a,null])};AriaAnalyticsComponent.registerClass("AriaAnalyticsComponent",null,_a.jw,_j.ce);_ar.g.registerClass("_ar.g",null,_y.jZ);_ar.b.registerClass("_ar.b",_ar.g);_ar.c.registerClass("_ar.c",_ar.g);_ar.f.registerClass("_ar.f",_ar.g);_ar.e.registerClass("_ar.e",_ar.g);_ar.d.registerClass("_ar.d",_ar.g);AriaAnalyticsComponent.$$cctor();_ar.a.a=new RegExp("[^a-zA-Z0-9_]+","g");_ar.b.a="db385f8607b44b3d8fb92311805212e0-9d5bc416-9d45-4f5a-8890-7f539d2149b7-7198";_ar.b.b=["ReadAppSelection","ReadExtContextualSelection","ReadExtCommandSelection","ComposeAppSelection","ComposeExtCommandSelection"];_ar.c.a="978f0a4574614d73b316043d2ee6ec94-888f068a-4993-4ad7-8ecb-50ad875cfed8-7307";_ar.c.b=["FL.GN","FL.GUCL","ClickGroupsDiscoveryEndToEnd","NavigateFromMeToWeSpaceMail","GroupHeaderModuleSwitch","SwitchGroup","SwitchGroupConversation","Group_Conversation_E2E_Post"];_ar.f.a="23bf92431eeb425b85357b276ea236fb-f1061998-013f-4307-94b0-a711da4fe80e-7012";_ar.e.a=" cc1920a404f34459bfd3df750aaebf97-033ebeb1-ebd8-4e8f-9ee1-f620a30cd05e-7162";_ar.d.a="10f398a784604301b583d289d31ac608-e6197a1d-8df3-48b2-bc01-25057dd8e015-7020";
window.scriptsLoaded['microsoft.owa.ariaanalytics.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.ariaanalytics.js'] = (new Date()).getTime();
