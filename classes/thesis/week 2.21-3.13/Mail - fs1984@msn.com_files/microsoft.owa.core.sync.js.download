window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.sync.js'] = (new Date()).getTime();
Type.registerNamespace("_w");_w.ca=function(){};_w.ca.registerInterface("_w.ca");_w.bZ=function(){};_w.bY=function(){};_w.bY.registerInterface("_w.bY");_w.r=function(n,t){_w.r.initializeBase(this,[n,t])};_w.r.prototype={k:7,i:null,h:function(){this.i||(this.i=_a.bm.b(Array,this.g,"SyncFolders.Mail.AutoSelected"));this.i||(this.i=new Array(0));return this.i},l:function(n){this.g.a("SyncFolders.Mail.AutoSelected",JsonParser.serialize(n));this.i=n;return n},p:function(){var i;var t,n;return(n=this.a(null,-1,t={val:i}),i=t.val,n).length},e:function(){_j.e.a(_w.h.a,"Remove AutoSelectedMailSyncFolders settings");for(var t=this.h(),r=t.length,n=0;n<r;++n){var i=t[n];this.m(new _g.l(i.FolderId))}this.g.c("SyncFolders.Mail.AutoSelected")},a:function(n,t,i){return this.q(this.h(),n,t,!0,i)},v:function(n,t,i){_a.b.a(n,"folderId");_a.b.a(t,"successCallback");this.z(n)?t():i(Error.create("Failed to add folder into the sync list"))},c:function(n){var r;var i,t;return t=this.q(this.h(),null,n,!1,i={val:r}),r=i.val,t},A:function(n,t){_a.b.a(n,"folder");for(var r=this.h(),f=0;f<r.length;f++){var e=r[f];if(e.FolderId===n.bD.FolderId.Id){var u=_a.d.b(e.LastAccessTime);var i=_a.d.a();var o=_a.bX.a(u.d(),i.d());if(o.a/864e5>this.k&&this.p()>=_h.k.a+_h.k.f().length){_j.e.a(_w.h.a,"Already syncing {0} non-default email folders for this client. This is the max allowed limit.",_h.k.a);Array.removeAt(r,f);this.l(r);this.m(n.bD.FolderId);t(!1)}else if(i.g()!==u.g()||i.f()!==u.f()||i.j()!==u.j()){r[f]=new SyncFolderListItem(n.bD.FolderId.Id,_a.d.d(i));this.l(r);this.w(u,i,_a.z.a,t)}else t(!1);break}}},b:function(n,t,i){_a.b.a(i,"completeCallback");var f;var u,r;var e=(r=this.a(t,n,u={val:f}),f=u.val,r);i(e)},d:function(n,t,i){this.j(n,t,i)},f:function(n,t,i){_a.b.a(n,"allFolderIds");_a.b.a(t,"successCallback");_a.b.a(i,"errorCallback");for(var f=!1,u=this.h(),e=[],r=0;r<u.length;r++)u[r].FolderId in n?Array.add(e,u[r]):f=!0;if(f){_j.e.b(_w.h.a,"SyncFolderSetting needs to be updated based on folder hierarchy sync results.");this.l(e)}t()},y:function(n){_a.b.a(n,"folderTable");for(var e=_h.k.f(),r=e,o=r.length,i=0;i<o;++i){var f=r[i];this.r(n,new _g.l(f),2)}for(var t=0;t<this.h().length;t++){var u=this.i[t];this.r(n,new _g.l(u.FolderId),1)}},j:function(n,t,i,r){var u=new _w.I;var f;var o,e;var s=(e=this.a(null,-1,o={val:f}),f=o.val,e);u.f(f);u.b(s.length);u.e(n);u.c(_h.k.a);u.a.ICU=!!i!==i?!1:i;u.d(!!r!==r?!1:r);u.g(!1);t.a(u)},z:function(n){_a.b.a(n,"folderId");for(var i=!0,u=this.h(),r=this.h(),e=r.length,t=0;t<e;++t){var f=r[t];if(f.FolderId===n){_j.e.b(_w.h.a,"Trying to add an already existing folder to the SyncFolderSetting, folderId = {0}",n);return i}}if(this.p()<_h.k.a+_h.k.f().length){Array.add(u,new SyncFolderListItem(n,_a.d.d(_a.d.a())));this.l(u)}else{i=!1;this.m(new _g.l(n));_j.e.b(_w.h.a,"Not adding folder to the sync list because syncing max ({0}) number of non-default email folders for this client.",_h.k.a);this.j("",_a.z.a,!1,!0)}return i},r:function(n,t,i){var r=n.f(t);r&&r.T(i)},q:function(n,t,i,r,u){u.val=0;var s=0;var o=this.u(i,t);if(this.t()&&n){for(var f=0;f<n.length;f++){var e=n[f];if((this.x(e)||!r)&&(i===-1||this.o(e.FolderId,i))){this.s(t,e.FolderId,o);s++}}u.val=n.length-s}_a.b.d(!!o,"activelySyncingFolderListForModule can never be null. At the least it should have default list of folders.");return o},x:function(n){var r=_a.d.b(n.LastAccessTime);var i=_a.d.a();var t=_a.bX.a(r,i);return Math.floor(t.a/864e5)<=this.k},w:function(n,t,i,r){var f=_a.bX.a(n.d(),t.d());if(f.a/864e5>this.k){r(!0);var u=new _w.N;u.b(f.a/864e5);i.a(u);return}r(!1)}};_w.s=function(n,t,i,r,u,f){_w.s.initializeBase(this,[8,13,n,!0,t]);this.p=i;this.l=r;this.n=u;this.o=String.format("{0}:{1}","BackgroundSyncContextId",this.g);this.q=f};_w.s.prototype={p:null,l:!1,o:null,n:0,q:0,k:function(){return!0},e:function(){return this.o},i:function(){return!1},t:function(){return this.l},w:function(){return this.l},j:function(){return this.p},u:function(){return!0},v:function(){return this.q},s:function(){return this.n},f:function(n){return n.j(this.g)}};_w.h=function(n,t){_a.b.a(n,"localStorageAdapter");_a.b.a(t,"eventAggregator");this.g=n;this.n=t};_w.h.prototype={g:null,n:null,t:function(){var n=this.g.b("MaxSyncModuleType");return _j.h.a(n)?!0:parseInt(n)>=11},u:function(n,t){for(var u=new Array(0),f=_h.k.f(),e=f.length,r=0;r<e;++r){var i=f[r];(n===-1||this.o(i,n))&&(t&&i===t.Id?Array.insert(u,0,i):Array.add(u,i))}return u},B:function(n){if(n){for(var i={},t=0;t<n.length;t++)i[n[t]]=!0;return Object.keys(i)}return n},o:function(n,t){var i=_g.a.a().b().g(new _g.l(n),!1,!1);if(i.a()===1&&(t===11||t===4))return!0;else if((i.a()===2||i.a()===3)&&(t===12||t===5))return!0;return!1},s:function(n,t,i){n&&t===n.Id?Array.insert(i,0,t):Array.add(i,t)},m:function(n){var i=_g.a.a().b().g(n,!1,!1);var t=-1;i.a()===1?t=4:(i.a()===2||i.a()===3)&&(t=5);this.n.a(_h.cy,new _h.cy(t,new _bc.i(n)))}};_w.P=function(n){_w.P.initializeBase(this,[3,6,!0,n])};_w.P.prototype={e:function(){return"PeopleModule"},f:function(n){return n.x()}};_w.U=function(n,t){_w.U.initializeBase(this,[n,t,"BackgroundSyncNotification"])};_w.U.prototype={f:function(n,t,i){var r=n;var u=new _w.s(r.FolderId,this.e,r.c,r.e,r.d,r.b);if(this.d.f(u,!0))this.g(r,u);else{_j.e.a(_a.a.C,String.format("Rejecting BackgroundSyncNotification with FolderId : {0}.",r.FolderId));i(n)}}};_w.A=function(n,t){_w.A.initializeBase(this,[n,t])};_w.A.prototype={h:null,i:function(){if(!this.h){this.h=_a.bm.b(Array,this.g,"SyncFolders.Mail.UserSelected");this.h=this.B(this.h)}this.h||(this.h=new Array(0));return this.h},j:function(n){if(n){this.g.a("SyncFolders.Mail.UserSelected",JsonParser.serialize(n));this.h=n}return n},e:function(){_j.e.a(_w.h.a,"Remove UserSelectedSyncFolders settings");for(var t=this.i(),r=t.length,n=0;n<r;++n){var i=t[n];this.m(new _g.l(i))}this.g.c("SyncFolders.Mail.UserSelected")},a:function(n,t,i){var f=this.u(t,n);if(this.t())for(var e=this.i(),o=e.length,r=0;r<o;++r){var u=e[r];(t===-1||this.o(u,t))&&this.s(n,u,f)}i.val=0;return f},c:function(n){var r;var i,t;return t=this.a(null,n,i={val:r}),r=i.val,t},d:function(n,t,i){var r=new _w.I;r.f(this.i().length);r.b(this.i().length);r.e(n);r.c(_h.k.a);r.a.ICU=!!i!==i?!1:i;r.d(!1);r.g(!0);t.a(r)},b:function(n,t,i){_a.b.a(i,"completeCallback");var f;var u,r;var e=(r=this.a(t,n,u={val:f}),f=u.val,r);i(e)},f:function(n,t,i){_a.b.a(n,"allFolderIds");_a.b.a(t,"successCallback");_a.b.a(i,"errorCallback");for(var e=!1,o=[],f=this.i(),s=f.length,r=0;r<s;++r){var u=f[r];u in n?Array.add(o,u):e=!0}if(e){_j.e.b(_w.h.a,"SyncFolderSetting needs to be updated based on folder hierarchy sync results.");this.j(o)}t()}};_w.t=function(n){_w.t.initializeBase(this,[5,0,!0,n])};_w.t.prototype={e:function(){return"Refresh"},i:function(){return!1},f:function(n){return n.A()}};_w.bX=function(n,t,i,r,u){_w.bX.initializeBase(this,[n,t,r,u]);this.g=i};_w.bX.prototype={g:null,e:function(){return this.g}};_w.i=function(n){_w.i.initializeBase(this,[6,0,!0,n])};_w.i.prototype={i:function(){return!1},k:function(){return!0},f:function(n){return n.p()}};_w.C=function(n){this.d=Function.createDelegate(this,this.k);this.j=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.h);this.g=n;var i=this;n.b(_no.e,function(){i.h(new _a.dF(!0))});n.b(_a.dF,this.i);var t=this;n.b(_no.f,function(){t.h(new _a.dF(!0))});n.b(_a.cv,this.j);n.b(_a.cj,this.d);n.b(_a.eJ,this.d);n.b(_a.eL,this.d)};_w.C.prototype={g:null,c:null,e:!1,f:!1,b:function(n){this.c=n},a:function(n){if(this.c){this.c.l();if(this.e){_w.a.a("Pending get request is alive, starting full sync");this.c.d(n)}else{if(this.c.b())_w.a.a("Pending get request is not alive and in ALT1, will start full sync when it comes alive");else{_w.a.a("Pending get request is not alive, starting quick sync now and full sync when it comes alive");_a.j.bm(_a.cS.toString(n));this.c.A()}this.f=!0}}},h:function(n){_w.a.a("Pending get request alive changed to {0}",n.a);this.e=n.a;if(this.f&&this.e){_w.a.a("Pending get just came alive -> starting sync");this.f=!1;this.c.d(4)}},k:function(n){if(this.c)if(this.c.j()){var r=n.a.c("SyncInProgress","SYNC");var t=null;var i=this;t=function(){i.c.g(20,t);r()};this.c.c(20,t)}else _w.a.a(n.a.h+" - No sync in progress.")},l:function(n){if(this.c){_j.e.a(_a.a.j,"Resume sync, IsBackground: {0}",n.a);if(!n.a){this.g.a(_h.bK,new _h.bK);_g.k.a&&_g.k.a.n&&_g.k.a.n.m();this.c.b()&&(_a.j.b="ALT1");this.a(10)}}}};_w.ce=function(n,t){_w.ce.initializeBase(this,[n,t])};_w.ce.prototype={m:function(n,t){var r=null;var i=this.o(n,t);i&&(r=i.LastSuccessfulSyncTime);return r},g:function(n,t){_a.b.d(_bc.i.isInstanceOfType(n),"The context type should match the module.");var r=n;_a.b.a(r.FolderId,"Invalid call to IsSynced with no folder ID specified.");if(t){var i=this.o(n,t);return!!i}return!1},d:function(){return"ConversationSyncStateId"},n:function(n,t){if(t.ModuleSpecificContext){for(var r=t.ModuleSpecificContext,i=0;i<r.length;i++){var u=r[i];if(u.FolderId.Id===n)break}if(i!==r.length){_j.e.a(_w.b.a,"Removing Folder {0} Conversation SyncState",n);Array.removeAt(r,i)}}},o:function(n,t){var u=n;if(t.ModuleSpecificContext)for(var f=t.ModuleSpecificContext,e=f.length,i=0;i<e;++i){var r=f[i];if(r.FolderId.Id===u.FolderId.Id)return r}_j.e.a(_w.b.a,"We can't find the folderEntry inside Conversation SyncState for folder:{0}",u.FolderId.Id);return null}};_w.cg=function(n,t){_w.cg.initializeBase(this,[n,t])};_w.cg.prototype={f:function(){return 0},D:function(n){_a.b.d(_bc.i.isInstanceOfType(n),"The context type should match the module.");var t=n;_a.b.a(t.FolderId,"Invalid call to IsSynced with no folder ID specified.");var i=this,r=this;this.a.c().e(function(n){i.n(t.FolderId.Id,n)},function(){})},C:function(n,t){_a.b.d(_bc.i.isInstanceOfType(n),"The context type should match the module.");var u=n;_a.b.a(u.FolderId,"Invalid call to IsSynced with no folder ID specified.");var i=null;var r=this,f=this;this.a.d(function(u){u?i=r.m(n,u):_j.e.a(_w.b.a,"Getting null SyncState for {0}",r.d());t(i)},function(){t(i)})}};_w.Q=function(n){this.h={};this.j={};_a.b.e(n,1,50,"maxNotifications");this.m=n;this.k=0};_w.Q.prototype={m:0,i:null,k:0,b:function(n,t){_a.b.c(n,"id");_a.b.a(t,"notification");if(this.k<this.m){this.k++;var i=this.h[n];if(!i){i=[];this.h[n]=i}Array.enqueue(i,t);return!0}_j.e.b(_a.a.cS,"Max Notification Queue limit reached.");return!1},a:function(){_j.e.b(_a.a.cS,"Clear Sync Notification Queue");var t=this.h;for(var r in t){var i={key:r,value:t[r]};var n=this.h[i.key];if(n){this.l(n,2);delete this.h[i.key];n=null}}this.k=0},f:function(n){_a.b.a(n,"postSyncCallback");this.i=n},g:function(){this.i=null},d:function(){var n=_ff.i.b(this.h);return this.n(n)},c:function(){var n=_ff.i.b(this.j);return this.n(n)},e:function(n){_a.b.a(n,"e");if(!_j.h.a(n.f)){_j.e.a(_a.a.cS,"Processing sync event type: {0} for notification sync context id: {1}",n.a,n.f);this.o(n.a,n.f)}},o:function(n,t){if(n===1){var f=this.h[t];if(f){this.k-=f.length;this.j[t]=f;delete this.h[t]}}else if(n===3){var u=this.j[t];if(u){for(var e;e=Array.dequeue(u);)this.i&&this.i(e,0);delete this.j[t];u=null}}else if(n===6){var r=this.j[t];if(r){_j.e.b(_a.a.cS,"Discarding notifications due to abort event Notification id : {0}, Total Count: {1}",t,r.length);this.l(r,4);r=null;delete this.j[t]}}else if(n===4){var i=this.h[t];if(i){_j.e.b(_a.a.cS,"Discarding notifications due to canceled event Notification id : {0}, Total Count: {1}",t,i.length);this.k-=i.length;this.l(i,5);i=null;delete this.h[t]}}},l:function(n,t){if(this.i)for(var i;i=Array.dequeue(n);)this.i(i,t);else Array.clear(n)},n:function(n){var r=new _j.q;var u=n;for(var i in u){var o={key:i,value:u[i]};var t=o.value;if(t)while(t.length>0){var e=Array.dequeue(t);var f=new _a.fQ(e);r.c(f)}}return r}};_w.ba=function(n,t){_w.ba.initializeBase(this,[n,t,"CalendarItemNotification"])};_w.ba.prototype={f:function(n,t,i){var r=n;if(!r.FolderId){_j.e.a(_a.a.C,String.format("Rejecting CalendarItem notification with null FolderId : {0}",r.id));i(n);return}var u=new _w.f(r.FolderId,this.d.b(),this.e);if(this.d.f(u,r.EventType==="Reload")){if(this.j(n,t.e())){_j.e.a(_a.a.C,String.format("CalendarItemNotification throttled id : {0}",r.FolderId));return}this.g(r,u);return}i(r);this.d.e(u)}};_w.bk=function(n,t,i,r,u){this.e=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.v);this.i=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.r);this.l=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.s);this.h=Function.createDelegate(this,this.p);_w.bk.initializeBase(this);_a.b.a(n,"syncManager");_a.b.a(r,"dataPointTracker");this.c=n;this.b=t;this.n=i;this.o=r;this.g=new _bs.bE(_a.bm.a());this.d=u};_w.bk.prototype={c:null,b:null,n:null,o:null,d:null,g:null,f:!1,a:function(){if(!this.f){this.b.b(_h.bl,this.h);this.b.b(_h.bs,this.k);this.b.b(_a.ea,this.l);this.b.b(_h.bS,this.j);this.b.b(_h.cy,this.i);_w.e.c(this.m);this.d.a()||this.b.b(_h.bk,this.e);this.f=!0}},D:function(){if(this.f){this.b.c(_h.bl,this.h);this.b.c(_h.bs,this.k);this.b.c(_a.ea,this.l);this.b.c(_h.bS,this.j);this.b.c(_h.cy,this.i);_w.e.f(this.m);this.d.a()||this.b.c(_h.bk,this.e);this.f=!1}},v:function(){this.d.a()?this.b.c(_h.bk,this.e):this.b.b(_h.bk,this.e)},t:function(n){_w.a.c("Receiving ViewFolderEvent");var t=n.a;if(t&&t.bD.FolderId){var i=this;this.d.i(t,function(n){n&&i.c.m(t.bD.FolderId.Id)})}},p:function(n){n.b?this.g.c(n.a,this.c.t()):this.g.c(n.a,"")},s:function(n){var t=new _h.eO;t.a.C=this.n.a;this.o.a(t);this.c.B()},u:function(n){_w.a.a("OnPauseResumeSyncEvent, PauseEvent: {0}",n.a);if(n.a){if(_h.z.a){_w.a.b("Stopping sync manager on version mismatch error");var t=this;this.c.n(function(){_w.a.a("Successfully stopped sync manager on version mismatch error")})}}else{_w.a.a("Enable sync and start full sync");this.c.o()}},r:function(n){_w.a.a("Receiving StartFullSyncEvent");this.c.d(n.a)},q:function(n){_w.a.c("Receiving StartFullSyncEvent");this.c.w(n.b,n.a)}};_w.M=function(n,t){_w.M.initializeBase(this,[3,0,n,t])};_w.M.prototype={e:function(){return"CalendarFoldersModule"},f:function(n){return n.v()}};_w.d=function(n,t,i){_w.d.initializeBase(this,[4,0,!1,t]);_a.b.a(i,"postCleanup");this.g=n;this.l=i};_w.d.prototype={g:0,l:null,e:function(){return"CleanupSyncContextId"},f:function(n){return n.G(this.g)},n:function(n){this.l(n)}};_w.R=function(n){_w.R.initializeBase(this,[3,0,!0,n])};_w.R.prototype={f:function(n){return n.y()}};_w.N=function(){_w.N.initializeBase(this,[1,"Core.Models.Sync.FolderActiveSyncingAgain"])};_w.N.prototype={b:function(n){this.a.NDBLACA=n;return n}};_w.O=function(n,t){_a.b.e(n,0,Number.MAX_VALUE,"Interval");_a.b.e(t,2,Number.MAX_VALUE,"maxTimes");this.d=n;this.c=t;this.a=[]};_w.O.prototype={d:0,c:0,a:null,b:0,f:function(n){_a.b.e(n,1,Number.MAX_VALUE,"actionTimeInUtcMinutes");if(this.b)if(this.a.length<this.c-1)Array.enqueue(this.a,n);else{this.b=Array.dequeue(this.a);Array.enqueue(this.a,n)}else this.b=n},e:function(n){return this.a.length<this.c-1?!0:n-this.b>=this.d}};_w.o=function(n,t){_w.o.initializeBase(this,[1,t,!0,n])};_w.o.prototype={i:function(){return!1},k:function(){return!0},f:function(n){return n.w(this.m)}};_w.f=function(n,t,i){_w.f.initializeBase(this,[3,14,n,t,i])};_w.f.prototype={f:function(n){return n.e(this.g)}};_w.S=function(n,t){_w.S.initializeBase(this,[3,0,n,t])};_w.S.prototype={e:function(){return"RemindersModule"},f:function(n){return n.B()}};_w.T=function(n,t,i){this.v=Function.createDelegate(this,this.F);_w.T.initializeBase(this,[n,t,i]);this.K(this.v,"ConfirmSyncCompleted")};_w.T.prototype={g:function(){return 14},J:function(){return this.w.d.e()},u:function(n,t){var r=this,i=this;this.y.b(this.w.g,this.G(),function(){r.E(n,t)},function(n){i.D("Module cleanup failed with error: "+n.a());var r=Error.create(n.a());t(r)})},F:function(){this.R()},G:function(){return new _bs.bK(this.y.a().j(),this.y.a().n())},E:function(n,t){if(this.w.d.h.b(this.w.d.h.i())&&this.w.d.h.q().a(this.J())&&!this.w.d.p.b()){var i=this;this.w.d.p.a(this.w.d.h,n,function(n){t&&t(n)})}else n()}};_w.u=function(n,t){_w.u.initializeBase(this,[n,t])};_w.u.prototype={f:function(){return 0},c:function(n,t,i){_a.b.a(i,"completeCallback");if(!_w.d.isInstanceOfType(n))throw Error.argumentType("only CleanupSyncContext is supported by the SyncAttachmentModule");var r=new _w.T(n,t,this.a);i([r])},e:function(n){return!1},w:function(n){return!1},A:function(){return!1},q:function(n){return!1},g:function(n,t){return!0},d:function(){return"AttachmentsStateId"}};_w.W=function(){this.e=Function.createDelegate(this,this.j);_w.W.initializeBase(this,[null])};_w.W.prototype={K:function(n){n.x(null,this.e,this.H)},j:function(n,t){t.WasSuccessful?this.bg(n,t):this.bb(Error.create(_db.bV.a(t.ErrorCode)))}};_w.X=function(n,t,i){this.E=Function.createDelegate(this,this.G);this.F=Function.createDelegate(this,this.S);_w.X.initializeBase(this,[n,t,i])};_w.X.prototype={g:function(){return 9},cI:function(n){return!0},cL:function(){return new SyncState("CalendarFoldersSyncStateId","")},cM:function(n){n(new _w.W)},cQ:function(){return new(_bs.cv.$$(_g.fM))(this.v,this.F)},cK:function(){return new _bs.bS(this.E)},S:function(n,t){var i=new _bs.E(this.y.a());var r=this;i.p(t,n,function(){})},G:function(n){_bs.E.b(n);this.y.a().i().b(n,_bs.d.a("CalendarFoldersSyncStateId"))}};_w.Y=function(n,t){_w.Y.initializeBase(this,[n,t])};_w.Y.prototype={f:function(){return 2},c:function(n,t,i){i([new _w.X(n,t,this.a)])},e:function(n){return!1},h:function(){return!0},v:function(){return!0},d:function(){return"CalendarFoldersSyncStateId"}};_w.Z=function(n,t){this.h=Function.createDelegate(this,this.k);_w.Z.initializeBase(this,[n,t,"CalendarFoldersNotification"]);t.c.b(_h.cf,this.h)};_w.Z.prototype={f:function(n,t,i){_j.e.c(_a.a.C,String.format("Receiving unexpected CalendarFolders offline notification. Id: {0}",n.id||""));i(n)},k:function(n){var i=new _bs.bh(this.e.e(),_bs.f.b);var r=new _bs.bC(i.i(),"CalendarFoldersSyncStateId");_j.e.a(_a.a.C,"Processing (client-only) CalendarFolders notification.");var t=this;r.l(!1,function(){_j.e.a(_a.a.C,"Successfully set isSynced to false for CalendarFolders table. Starting notification based sync.");var n=new _w.M(t.d.b(),t.e);t.d.e(n)})}};_w.bb=function(n){_w.bb.initializeBase(this,[n])};_w.bb.prototype={g:function(n){this.a.rmwi=n;return n},h:function(n){this.a.ttiw=n;return n}};_w.be=function(n,t,i,r){_w.be.initializeBase(this,[n,t,i,r])};_w.be.prototype={g:function(){return 16},cU:function(){return this.bd().length>0}};_w.bf=function(n,t,i,r){_w.bf.initializeBase(this,[n,t,i,r])};_w.bf.prototype={g:function(){return 15},O:function(n){return this.w.c!==3&&!n},cU:function(){return this.bd().length>0&&this.E<_h.k.g}};_w.bg=function(n){_w.bg.initializeBase(this,[n])};_w.bg.prototype={g:function(n){this.a.ciips=n;return n}};_w.E=function(n,t,i){this.v=Function.createDelegate(this,this.E);_w.E.initializeBase(this,[n,t,i]);this.K(this.v,"UpdateReadFlagDirtyConversations");this.K(this.ct,"SyncCompleted")};_w.E.prototype={g:function(){return 19},cy:function(){return!1},bS:function(){return""},h:function(){return!0},u:function(n,t){n()},E:function(){this.x("Updating conversation items read flags");var t=this.y.a().d();var u=this.y.a().a();var r=this.y.a().k();var f=this,i=this,n=this;t.a(new _e.a("SyncConversationItemsReadFlagModule.UpdateReadFlagDirtyConversations"),function(n){t.updateReadFlagDirtyConversations(n,r,u)},function(){i.H()},function(t){n.Q("Failed to update read flags",t.a);n.n(Error.create(t.a))})}};function ExternalSyncDependencies(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_a.b.a(n,"offlineMailboxDataContext");_a.b.a(t,"localStorageAdapter");_a.b.a(i,"offlineUserSettings");_a.b.a(r,"syncFolderSettingProcessor");_a.b.a(u,"nativeBridge");_a.b.a(f,"attachmentsCleanupManager");_a.b.a(e,"datapointTracker");_a.b.a(o,"offlineNotificationHandler");_a.b.a(s,"userAgent");_a.b.c(h,"userCulture");_a.b.a(l,"taskRunner");_a.b.a(a,"eventAggregator");_a.b.a(v,"syncController");_a.b.a(y,"uiModuleService");_a.b.a(p,"featureManager");_a.b.a(w,"pageDataPayloadManager");_a.b.a(b,"owaDateTimeFactory");this.j=n;this.g=t;this.a=i;this.b=r;this.h=u;this.p=f;this.d=e;this.f=o;this.k=s;this.o=h;this.q=c;this.x=l;this.c=a;this.r=v;this.n=y;this.s=p;this.w=w;this.v=b;var k=this;this.c.b(_h.bk,function(n){var t=n.a;t&&(k.m=t.bD.FolderId)})}ExternalSyncDependencies.prototype={r:null,v:null,g:null,a:null,b:null,h:null,p:null,d:null,f:null,k:null,o:null,m:null,x:null,c:null,j:null,n:null,q:0,s:null,w:null,t:function(){return this.j.m()},l:function(){return this.j.e()},e:function(){return this.j.h()},u:function(){return this.j.g()},i:function(){if(!this.m)if(_g.b.a)this.m=_g.b.a.nameToId("inbox");else throw Error.invalidOperation("Trying access ExternalSyncDependencies.InViewFolderId before FolderMappings is initialized. That should not happen.");return this.m},y:function(n,t,i){this.j.k(n,t,i)}};_w.bl=function(){_w.bl.initializeBase(this,[null])};_w.bl.prototype={K:function(n){var t=new _g.he(this.L);n.A(t,this.J,this.H)}};_w.bm=function(n,t,i){this.E=Function.createDelegate(this,this.G);this.F=Function.createDelegate(this,this.S);_w.bm.initializeBase(this,[n,t,i])};_w.bm.prototype={g:function(){return 6},cI:function(n){return!0},cL:function(){return new SyncState("FavoriteFoldersSyncStateId","")},cM:function(n){n(new _w.bl)},cQ:function(){return new(_bs.cv.$$(_g.fS))(this.v,this.F)},cK:function(){return new _bs.bS(this.E)},S:function(n,t){var i=new _bs.E(this.y.a());var r=this;i.r(t,n,function(){})},G:function(n){_bs.E.c(n)}};_w.bn=function(n,t){_w.bn.initializeBase(this,[n,t])};_w.bn.prototype={f:function(){return 2},c:function(n,t,i){i([new _w.bm(n,t,this.a)])},e:function(n){return!1},d:function(){return"FavoriteFoldersSyncStateId"}};_w.e=function(n,t){_a.b.a(n,"localStorageAdapter");_a.b.a(t,"eventAggregator");this.n=n;this.o=t;this.p()};_w.e.c=function(n){_w.e.d(n)};_w.e.f=function(n){_w.e.g(n)};_w.e.e=function(){var n=_w.e.a.getHandler("UserSelected");n&&n()};_w.e.d=function(n){_w.e.a.addHandler("UserSelected",n)};_w.e.g=function(n){_w.e.a.removeHandler("UserSelected",n)};_w.e.prototype={n:null,o:null,m:null,a:function(){return this.n.b("SyncFolders.UserSelected")==="true".toLowerCase()},j:function(n){var t=this.n.b("SyncFolders.UserSelected")==="true".toLowerCase();this.n.a("SyncFolders.UserSelected",n.toString().toLowerCase());if(n!==t){this.q();_w.e.e()}return n},e:function(){return this.m},g:function(n){_a.b.a(n,"folder");if(n.b||!_g.t.isInstanceOfType(n)||_h.n.a(n.bD.FolderId)||n.c()||_g.bT.isInstanceOfType(n)){_j.e.a(_w.e.b,"{0} is not syncable because it is not mail folder or is an archive/public/shared/search folder",n.bD.FolderId.Id);return!1}else return _h.k.o(n)},i:function(n,t){_a.b.a(n,"folder");_a.b.a(t,"onCompletedCallback");if(_w.A.isInstanceOfType(this.m)){t(!1);return}if(n.y===2){t(!1);return}var i=this.m;if(n.y)i.A(n,t);else{if(!this.g(n)){t(!1);return}var u=this,r=this;i.v(n.bD.FolderId.Id,function(){n.T(1);t(!0);i.j("",_a.z.a)},function(i){_j.e.b(_w.e.b,"We failed to add {0} into sync list",n.bD.FolderId.Id);t(!1)})}},b:function(n,t){_a.b.c(t,"folderId");var u=!1;switch(n){case 11:case 4:case 12:case 5:var f;var i,r;var e=(r=this.m.a(null,n,i={val:f}),f=i.val,r);u=Array.contains(e,t);break;default:break}return u},f:function(n,t){_a.b.c(t,"folderId");var i=this.m.c(n);return Array.contains(i,t)},d:function(n){_a.b.a(n,"folderId");return this.b(12,n)},h:function(n,t,i){this.m.d(n,t,i)},k:function(n){if(_w.r.isInstanceOfType(this.m)){var t=this.m;t.y(n)}},c:function(n,t,i){this.m.b(n,t,i)},l:function(n,t,i){this.m.f(n,t,i)},q:function(){this.m.e();this.p()},p:function(){this.m=this.a()?new _w.A(this.n,this.o):new _w.r(this.n,this.o)}};_w.F=function(n,t,i){this.F=[];this.bi=[];_w.F.$$(this.$$gta["_w.F"].TSyncAction,this.$$gta["_w.F"].TSyncResponse,this.$$gta["_w.F"].TSyncResponseType).initializeBase(this,[n,t,i]);this.be=-1};_w.F.$$=function(n,t,i){var e=_w.__tc=_w.__tc||{};var r="F"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!e[r]){var f=e[r]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_w.F.apply(this,t)};var h=_w.k;f.registerClass("_w.__tc."+r,h);var l={"_w.F":{TSyncAction:n,TSyncResponse:t,TSyncResponseType:i},ctor:_w.F};var a=h.prototype.$$gta;for(var v in a){var c={key:v,value:a[v]};l[c.key]=c.value}f.prototype.$$gta=l;var o=_w.F.prototype;for(var s in o){var u={key:s,value:o[s]};"constructor"!==u.key&&(f.prototype[u.key]=u.value)}}return e[r]};_w.F.prototype={E:0,bu:null,be:0,G:function(){return this.A().a},bR:function(){return this.w.k()},cH:function(){if(this.be===-1){var n=this.z.g.b("MaxSyncModuleType");this.be=_j.h.a(n)?14:parseInt(n)}return this.be},h:function(){return!0},cI:function(n){return!1},I:function(){this.F=[];this.bi=[];_w.k.prototype.I.call(this)},cb:function(n,t){for(var r=[],i=0;i<n.length;i++)t[n[i].Id]||Array.add(r,n[i].Id);r.length>0&&_j.e.b(_w.b.a,"Following items were not synced due to servers errors. This warning message is there to help troubleshoot such errors. ItemIds = '{0}'",r.join(", "))},cc:function(n){if(n&&n.length>0&&14<=this.cH())for(var o=n,l=o.length,e=0;e<l;++e){var t=o[e];if(t.Attachments)for(var f=0,u=0,s=t.Attachments,c=s.length,r=0;r<c;++r){var i=s[r];if(this.cG(i)){if(f+i.Size>1048576||u+1>10){this.x(String.format("Threshold to sync attachments for item : {0} has reached. Size: {1}, Total attachments: {2}",t.ItemId.Id,f,u));break}f+=i.Size;++u;var h=_bs.x.g(i,t.ItemId.Id,t.DateTimeReceived,!1,!0);Array.add(this.bi,h)}}}}};_w.cf=function(n,t,i,r){this.T=new Array(0);_w.cf.initializeBase(this,[n,i,r]);_a.b.a(t,"foldersToSync");this.G=t};_w.cf.prototype={G:null,be:0,bi:0,E:null,bt:!1,bZ:function(){return this.cl()},bR:function(){return this.w.k()},cz:function(){return!1},cP:function(){return 11},V:function(n){if(!n&&this.E.a.length>0&&(!this.bt||this.bZ())&&(this.w.h||!this.bc)){this.x("Raising Hierarchy notification for mail synced folders");this.z.w.e(!0);if(_a.j.g()){_a.j.bl(_a.j.a());_a.j.bf=this.bW;_a.j.bd=this.bI;_a.j.be=this.bJ;_a.j.V=this.bD;this.bD=0;if(this.z.n.a()){_a.j.u=2;_a.j.J()}else _a.j.u=1}var i=_j.n.b(_a.a.bB,2,"GenerateSyncNotificationForChanges_"+this.a());this.J().a(this.E.a);_j.n.a(i);this.bt=!0;_a.j.r=_a.j.r+1}else{this.x("No changes received hence not raising Hierarchy notification for mail synced folders");var t=_j.n.b(_a.a.bB,2,"NoSyncNotificationForChanges_"+this.a()+"_"+_a.gg.toString(n));_a.n.a("ALT3.1");if(!_a.j.r&&n!==1&&_a.j.g()){_a.j.bl(_a.j.a());_a.j.u=3;_a.j.J()}_j.n.a(t)}_w.k.prototype.V.call(this,n)},U:function(n){if(n===2||n===1){this.x("Raising Hierarchy notification for mail all folders");this.J().a(this.G)}_w.k.prototype.U.call(this,n)},cu:function(n,t){return _a.dP.a(n,this.g(),this.br,this.b(),this.bS(),this.bm,this.G,this.T,t,this.w.j())},bb:function(){var n=this.C();n.g(this.T);n.a.is=this.be;_w.a.a(this.a()+" module data point: Synced "+this.be+" messages, ")},bg:function(){return new _w.bj(this.g())},I:function(){this.E=null;_w.k.prototype.I.call(this)},N:function(n){_w.k.prototype.N.call(this,n)},Z:function(n){_w.k.prototype.Z.call(this,n)},bM:function(){if(this.A().IsSynced&&this.ca()){this.D("Reaching max sync limit PostALT1, will revert to ALT1 sync");var n=new _h.et;n.a.MN=this.a();this.z.d.a(n);this.z.c.a(_h.bl,new _h.bl(11,!1));this.z.c.a(_h.bS,new _h.bS(11));this.n(Error.create("Sync aborts since reaching the max sync limit PostALT1"))}else _w.k.prototype.bM.call(this)},ca:function(){return this.bi+this.be>=_h.k.a*_h.k.b*2}};_w.ch=function(){this.a=[];this.c=[];this.b=[]};_w.ch.prototype={j:function(){return null},e:function(n){Array.contains(this.a,n)||Array.add(this.a,n)}};_w.br=function(n,t,i){_w.br.initializeBase(this,[t,i,"HierarchyNotification"]);_a.b.a(n,"clientStore");this.h=n};_w.br.prototype={h:null,f:function(n,t,i){var r=n;if(r.folderId){if(r.folderId!==_g.b.a.nameToId("outbox").Id){this.k(r);if(t.l()[r.folderId]&&r.EventType!=="Reload"){i(r);return}var u=new _w.f(r.folderId,this.d.b(),this.e);if(this.d.f(u,r.EventType==="Reload"||this.e.f.m())){this.g(r,u);return}i(r);this.d.e(u)}}else{if(r.EventType==="Reload"){_j.e.a(_a.a.C,"Received reload hierarchy notificaiton, start full sync");t.x(this.m());this.d.d(5)}r.pendingGetGenerated||i(r)}},k:function(n){var t=new _bs.bm(this.h,this.e.u());var u=this,r=this,i=this;t.a(new _e.a("SyncHierarchyNotificationStrategy.UpdateClientStoreFolderCounts",!1),function(i){t.q(i,new _g.l(n.folderId),n.itemCount,n.unreadCount)},function(){},function(t){_j.e.b(_a.a.C,"Failed to update counts for folder id={0}, Error={1}",n.folderId,t.a)})}};_w.bs=function(n,t,i,r){_w.bs.initializeBase(this,[t]);_a.b.c(n,"folderToSync");_a.b.a(t,"syncState");_a.b.e(i,1,100,"maxChangesReturned");this.j=new _g.F(new _g.l(n));this.k=i;this.f=r};_w.bs.prototype={j:null,k:0,f:!1,K:function(n){var t=new _gg.kC(null,this.j,this.k);t.ShapeName="MailListItem";t.SyncState=this.e.State;t.NumberOfDays=_h.k.e;t.MinimumCount=_h.k.c;t.MaximumCount=_h.k.b;t.DoQuickSync=this.f;t.ItemShape=new _g.X("IdOnly");var r=new _gg.kB(this.M(),t);var i=new _gg.CB(this.L);n.iI(r,i,this.J,this.H)}};_w.x=function(n,t,i){_w.x.initializeBase(this,[n,t]);this.l=i};_w.x.prototype={l:null,e:function(n){return this.b.b.b(12,n)},j:function(n){return this.b.b.b(12,n)},c:function(n,t,i){var r=this;this.b.b.c(12,this.b.i(),function(u){var f=null;if(_w.d.isInstanceOfType(n)||u.length){_w.f.isInstanceOfType(n)&&(u=[n.g]);f=[new _w.bt(n,u,t,r.a),new _w.bu(n,t,new _bs.cq(r.i(),_h.k.d),r.l)]}i(f)})}};_w.bu=function(n,t,i,r){_w.bu.initializeBase(this,[n,t,i,r])};_w.bu.prototype={g:function(){return 18},cU:function(){return this.G().length>0}};_w.bv=function(n,t,i,r){_w.bv.initializeBase(this,[n,t,i,r])};_w.bv.prototype={g:function(){return 17},O:function(n){return this.w.c!==3&&!n},cU:function(){return this.G().length>0&&this.E<_h.k.g}};_w.m=function(n,t,i,r){_w.m.initializeBase(this,[n,t,i]);var f=this;_w.m.a=new _j.J(function(){return _h.b.R(r.b())});var u=this;_w.m.b=new _j.J(function(){return _h.b.K()})};_w.m.prototype={cM:function(n){var t=this.S();_w.a.a("Creating SyncItems action for {0} items",t.length);n(new _w.q(this.g(),t,this.A().b?_w.m.a.e():_w.m.b.e(),this.A().b?"EditableItems":"ItemNormalizedBody"))},cK:function(){return null},cQ:function(){return new _bs.di(this.y.a().a(),this.y.a().j(),this.F,this.bi,[])},L:function(n){this.x("Process current SyncItems response");var f={};this.bu=[];for(var u=!1,r=0;r<this.v.length;r++){var t=this.v[r];if(t.ResponseClass!=="Success"){var e=this.G()[r];_j.e.b(_w.b.a,"Error [{0}:{1}:{2}] while syncing item id {3}, SyncContext = {4}",t.ResponseClass,t.ResponseCode,t.MessageText||"",e.Id,this.w.e());t.ResponseCode!=="ErrorItemNotFound"&&(u=!0);Array.add(this.bu,e);continue}var i=this.v[r].Items;if(i&&i.length>0){_j.e.a(_w.b.a,"Setting item IsDataSynced flag to true");_bs.U.a(i[0],"",2);Array.add(this.F,i[0]);f[i[0].ItemId.Id]=!0;this.E++}else u=!0}u&&this.cb(this.G(),f);this.cc(this.F);_w.k.prototype.L.call(this,n)},cL:function(){return new MessageItemSyncState(this.bu,null,!1)},bg:function(){return new _w.bw(this.g())},bb:function(){var n=this.C();n.g(this.E);_w.a.a(this.a()+" module data point: Synced "+this.E+" items")},cG:function(n){return n?n.IsInlineToNormalBody:!1},S:function(){for(var i=Math.min(_h.k.d,this.G().length),t=new Array(i),n=0;n<i;n++){var r=new _g.e(this.G()[n].Id);t[n]=r}return t}};_w.bt=function(n,t,i,r){_w.bt.initializeBase(this,[n,t,i,r])};_w.bt.prototype={g:function(){return 12}};_w.bw=function(n){_w.bw.initializeBase(this,[n])};_w.bw.prototype={g:function(n){this.a.miis=n;return n}};_w.bx=function(n,t,i,r){_w.bx.initializeBase(this,[n,[t],i,r])};_w.bx.prototype={g:function(){return 5},O:function(n){return this.w.c!==3&&!n},cI:function(n){return!0}};_w.y=function(n,t,i){_w.y.initializeBase(this,[n||new _bs.cs(t.e(),"MessageSyncStateId"),t]);this.l=i};_w.y.prototype={l:null,c:function(n,t,i){var r=this;this.b.b.c(5,this.b.i(),function(u){_a.b.d(!_w.f.isInstanceOfType(n),"sync message minimum module factory should not be invoked on notification based sync");var f=null;(_w.d.isInstanceOfType(n)||u.length)&&(f=[new _w.bx(n,u[0],t,r.a),new _w.bv(n,t,new _bs.cq(r.i(),_h.k.d),r.l)]);i(f)})},e:function(n){return!1},p:function(){var n=this.b.i().Id;return this.b.b.d(n)}};_w.ci=function(n,t,i,r){_w.ci.initializeBase(this,[n,t,i,r])};_w.ci.prototype={S:0,bZ:function(){return this.S>=this.G.length-1&&this.v.IncludesLastItemInRange},F:function(){return this.G[this.S]},bT:function(n){var t=this.bd(n,this.F());return!t||t.State===""},cI:function(n){if(this.bZ())return!0;else{n.IncludesLastItemInRange&&this.S++;return!1}},cM:function(n){var i=this.A();var t=new _w.bs(this.F(),this.bd(i,this.F())||this.Y().a(this.F()),_h.k.g,_w.i.isInstanceOfType(this.w));n(t)},cQ:function(){var n=this.E;return new _bs.bU(this.y.a().a(),n.c,n.b,n.f,new _bs.bK(this.y.a().j(),this.y.a().n()))},L:function(n){this.E=new _w.by(this.v,this.F());this.E.h();var r=this.E.c.length;this.bi+=this.E.b.length;if(r>0){this.be+=r;for(var i=this.E.a,t=0;t<i.length;t++)Array.contains(this.T,i[t])||Array.add(this.T,i[t])}_w.k.prototype.L.call(this,n)},cL:function(){var n=this.A()||this.Y().b();this.bh(this.F(),n,this.E);return n},cK:function(){return null},bh:function(n,t,i){var r=t.PerFolderSyncStateContainer[n];r||(r=this.Y().a(n));r.State=i.k();r.IsSynced=t.IsSynced;r.LastSuccessfulSyncTime=_a.d.d(_a.d.a());r.LastAttemptedSyncTime=r.LastSuccessfulSyncTime;r.ModuleSpecificContext=new MessageSyncStateContext(i.d.MoreItemsOnServer,i.d.OldestReceivedTime,_h.k.c,_h.k.b,i.d.TotalCount);t.PerFolderSyncStateContainer[n]=r},bd:function(n,t){return t in n.PerFolderSyncStateContainer?n.PerFolderSyncStateContainer[t]:null}};_w.cj=function(n,t){_w.cj.initializeBase(this,[n||new _bs.cs(t.e(),"MessageSyncStateId"),t])};_w.cj.prototype={m:function(n,t){var i=this.o(t,n);return i?i.LastSuccessfulSyncTime:null},g:function(n,t){_a.b.d(_bc.i.isInstanceOfType(n),"The context type should match the module.");if(t){var i=this.o(t,n);if(i)return i.IsSynced}return!1},s:function(n,t){_a.b.d(_bc.i.isInstanceOfType(n),"The context type should match the module.");if(t){var i=this.o(t,n);if(i)return i.ModuleSpecificContext}return null},d:function(){return"MessageSyncStateId"},n:function(n,t){var i=t.PerFolderSyncStateContainer;if(n in i){_j.e.a(_w.b.a,"Removing Folder {0} Message SyncState",n);delete i[n]}},o:function(n,t){var i=t;_a.b.a(i.FolderId,"FolderId should be present");var r=n.PerFolderSyncStateContainer[i.FolderId.Id];r||_j.e.a(_w.b.a,"We didn't find the syncState for folder:{0}",i.FolderId.Id);return r}};_w.by=function(n,t){this.f=[];_w.by.initializeBase(this);this.d=n;this.g=t};_w.by.prototype={g:null,d:null,k:function(){return this.d.SyncState},h:function(){for(var r=this.d.Changes.Changes,e=r.length,t=0;t<e;++t){var n=r[t];switch(n.ChangeType){case"Create":case"Update":var i=n;Array.add(this.c,i.Item);var f=i.Item.ParentFolderId.Id;this.e(f);break;case"Delete":Array.add(this.b,_bs.d.a(n.ItemId.Id));this.e(this.g);break;case"ReadFlagChange":var u=n;Array.add(this.f,u);break;default:throw Error.invalidOperation("Invalid value of change type "+n.ChangeType+" change JSON = '"+JsonParser.serialize(n)+"'");}}}};_w.H=function(n,t){_a.b.a(n,"offlineSettings");this.e=n;this.h=t};_w.H.a=function(n,t){return new _w.H(n,t)};_w.H.prototype={e:null,h:null,g:null,f:null,a:function(){return this.e.b()},j:function(){if(!this.g){var t=15;this.g=new Array(t);for(var n=0;n<t;n++)this.g[n]=n}return this.g},b:function(n,t,i,r){var u;_w.a.a("GetModuleList - isInViewFolderSyncingInDateView: {0}, currentUIModule: {1}",i,r);if((_w.o.isInstanceOfType(n)||_w.t.isInstanceOfType(n))&&this.e.b()){_w.a.a("Getting post-ALT1 module list, syncType: {0}",n.c);u=this.k(i,t);u=this.l(u,r)}else{_w.a.a("Getting ALT1 module list, syncType: {0}",n.c);u=this.j()}return u},d:function(){if(!this.e.b()){this.e.r(!0);_w.a.a("UsePostALT1SyncOrder changed to true");this.h.a(_ob.c,new _ob.c)}},c:function(){if(this.e.b()){this.e.r(!1);_w.a.a("UsePostALT1SyncOrder changed to false");this.h.a(_ob.c,new _ob.c)}},k:function(n,t){var r=t<11?4:11;var i=t<12?5:12;this.f||(this.f=[n?5:4,10,3,r,i,0,2,6,9,7,8,1,13,14]);this.f[0]=n?5:4;this.f[3]=r;this.f[4]=i;return this.f},l:function(n,t){var i=null;if(t===1){i=[10,3];i=this.i(i,n)}else if(t===2){i=[7,8];i=this.i(i,n)}else i=n;return i},i:function(n,t){var r=_a.I.a();var u=new _j.q;n=n.concat.apply(n,t);for(var i=0;i<n.length;++i)if(!r.b[_a.bw.toString(n[i])]){u.c(n[i]);r.a(_a.bw.toString(n[i]),!0)}return u.i()}};_w.cl=function(n,t,i){_a.b.a(n,"syncManager");_a.b.a(t,"externalSyncDependencies");_a.b.a(i,"notificationType");this.d=n;this.e=t;this.i=i};_w.cl.prototype={d:null,i:"HierarchyNotification",e:null,b:function(){return this.i},l:function(){return this.e.f.f()},m:function(){return _a.d.get_utcNow().h()},c:function(n,t,i){_a.b.b(n,"notification");_a.b.b(t,"offlineNotificationHandler");_a.b.b(i,"callback");_a.b.g(n.clientGenerated,!0,"notification.ClientGenerated");this.f(n,t,i)},g:function(n,t){_a.b.b(n,"notification");_a.b.b(t,"syncContext");if(this.l().b(t.e(),n))this.d.e(t);else{_j.e.b(_a.a.C,"NQM rejected enqueue notification, clear notification queue and start full sync");this.l().a();this.d.l();this.d.d(7)}},j:function(n,t){return n.EventType==="Reload"&&n.pendingGetGenerated&&this.m()-t<=5e3}};_w.bA=function(){_w.bA.initializeBase(this,[null])};_w.bA.prototype={K:function(n){n.cg(null,this.J,this.H)}};_w.bB=function(n,t,i){this.E=Function.createDelegate(this,this.G);this.F=Function.createDelegate(this,this.S);_w.bB.initializeBase(this,[n,t,i])};_w.bB.prototype={g:function(){return 13},cI:function(n){return!0},cL:function(){return new SyncState("OtherMailboxConfigurationSyncStateId","")},cM:function(n){n(new _w.bA)},cQ:function(){return new(_bs.cv.$$(_g.gk))(this.v,this.F)},cK:function(){return new _bs.bS(this.E)},S:function(n,t){var i=new _bs.E(this.y.a());var r=this;i.v(t,n,function(){})},G:function(n){_bs.E.d(n)}};_w.bC=function(n,t){_w.bC.initializeBase(this,[n,t])};_w.bC.prototype={f:function(){return 2},c:function(n,t,i){i([new _w.bB(n,t,this.a)])},e:function(n){return!1},d:function(){return"OtherMailboxConfigurationSyncStateId"}};_w.bL=function(n){_w.bL.initializeBase(this,[n])};_w.bM=function(n,t){this.a=new _j.q;this.d=_a.I.a();this.b=n;this.c=t;this.e=!1};_w.bM.prototype={g:0,b:null,c:0,e:!1,f:function(n,t){_a.b.a(n,"module");var r=!1;if(n.g()>this.b.r()&&!n.h()){_w.a.b("Currently sync module type {0} is not supported",n.a());return}if(t){_w.a.c("Enquing module '{0} at the front of the sync internalQueue",n);if(this.d.b[n.b()])for(var i=0;i<this.a.d.length;i++)if(this.a.d[i].b()===n.b()){r=!0;n=this.a.d[i];this.a.j(i);break}this.a.k(0,n)}else{if(this.d.b[n.b()]){r=!0;_w.a.c("Module '{0}' is already present in the sync internalQueue.",n);return}else{_w.a.c("Module '{0}' is not already present in the sync internalQueue. Enquing at the back of the internalQueue",n);this.a.c(n)}this.c!==this.b.h()&&(this.e=!0)}if(!r){this.d.a(n.b(),!0);n.r(++this.g);_w.a.c("Completed enqueuing module : {0}",n);n.p()}},i:function(){var n=null;if(this.a.d.length>0){this.j();n=this.a.d[0];if(n){this.a.j(0);this.d.e(n.b());n.o()}}return n},h:function(){for(var i=this.a.i(),r=i.length,n=0;n<r;++n){var t=i[n];_w.a.c("Module {0} sync cancelled, TrackingId {1} during sync internalQueue cleanup before FullSync",t.a(),t.c());t.d()}this.a=new _j.q;this.d=_a.I.a()},j:function(){if((this.c!==this.b.h()||this.e)&&!this.b.b()){_w.a.a("CurrentUIModue: {0}, NewUIModule: {1}, readjusting sync queue",this.c,this.b.h());this.c=this.b.h();this.e=!1;for(var t=new _j.q,i=new _j.q;this.a.d.length>0;){var n=this.a.d[0];this.a.j(0);n.s(this.c)?t.c(n):i.c(n)}t.h(i.i());this.a=t}}};_w.bN=function(n,t){_w.bN.initializeBase(this,[n,t,"ReminderNotification"])};_w.bN.prototype={f:function(n,t,i){_a.b.f(n.id,"ReminderNotification","reminderNotification.id");var r=new _w.S(this.d.b(),this.e);if(this.d.f(r,!1)){if(this.j(n,t.e())){_j.e.a(_a.a.C,"ReminderNotification throttled.");return}this.g(n,r);return}i(n);this.d.e(r)}};_w.bR=function(n,t){_w.bR.initializeBase(this,[n,t,"RowNotification"]);_j.e.a(_a.a.C,"[SyncRowNotificationStrategy::Ctor]");var r=this;this.h=new _j.J(function(){return new _bs.bN(r.e.e(),r.e.u())});var i=this;this.k=new _j.J(function(){return new _bs.bR(i.e.e(),i.e.u())})};_w.bR.prototype={h:null,k:null,f:function(n,t,i){var r=n;if(!r.FolderId){i(n);return}this.o(r);if(r.FolderId!==_g.b.a.nameToId("outbox").Id)if(t.l()[r.FolderId]){var f=r.FolderId===_g.b.a.nameToId("drafts").Id;var u=new _w.f(r.FolderId,this.d.b()||f,this.e);if(this.d.f(u,r.EventType==="Reload"||this.e.f.m())){if(this.j(n,t.e())){_j.e.a(_a.a.C,"Reload RowNotification throttled folderid: {0}.",n.FolderId);return}this.g(r,u);return}if(!f){(r.EventType==="RowAdded"||r.EventType==="RowModified")&&this.n(r);i(r)}this.d.e(u)}else{i(r);return}},n:function(n){var t=_ff.i.b(n);if(t.Item)if(t.Conversation)_j.e.c(_a.a.C,"NOT saving the row notification to the client store. Both the Item and the Converation properties are non null. That should never happen. Folder Id={0}",t.FolderId);else if(this.e.b.b(12,t.FolderId)){var u=t.Item;u.ParentFolderId=new _g.l(t.FolderId);var f=new _bs.bU(this.k.e(),[u],[],[],null);f.f=10;f.l(null)}else return;else if(t.Conversation){if(this.e.b.b(11,t.FolderId)){var i=t.Conversation;i.FolderId=new _g.l(t.FolderId);var r=new _bs.bT(this.h.e(),[i],[]);r.f=10;r.l(null)}}else _j.e.c(_a.a.C,"NOT saving the row notification to the client store. Both the Item and the Converation properties are null. That should never happen. Folder Id={0}",t.FolderId)},o:function(n){if(n.Conversation){var i=n.Conversation;_j.e.a(_a.a.C,"Handling RowNotification id: {0}, EventType: {1}, ConversationType: true, convId: {2}, topic: {3}, lastDeliveryTime: {4}",n.FolderId||"",n.EventType,i.ConversationId?i.ConversationId.Id:"",i.ConversationTopic||"",i.LastDeliveryTime||"")}else{var t=n.Item;t&&_j.e.a(_a.a.C,"Handling RowNotification id: {0}, EventType: {1}, ConversationType: false, itemId: {2}, subject: {3}, lastReceivedTime: {4}",n.FolderId||"",n.EventType,t.ItemId?t.ItemId.Id:"",t.Subject||"",t.DateTimeReceived||"")}}};_w.I=function(){_w.I.initializeBase(this,[1,"Core.Models.Sync.Setting"])};_w.I.prototype={g:function(n){this.a.USSF=n;return n},b:function(n){this.a.ASMFC=n;return n},f:function(n){this.a.OSMFC=n;return n},e:function(n){this.a.MSMT=n;return n},c:function(n){this.a.MSFC=n;return n},d:function(n){this.a.MCEE=n;return n}};_w.bS=function(){_w.bS.initializeBase(this,[null])};_w.bS.prototype={K:function(n){var r=new _gg.hV(_a.d.a().x(-2).i(),_a.d.a().x(3).i());var i=new _gg.hU(this.M(),r);var t=new _gg.uv(this.L);n.gu(i,t,this.J,this.H)}};_w.bT=function(n,t,i){_w.bT.initializeBase(this,[n,t,i])};_w.bT.prototype={g:function(){return 1},cU:function(){var n=_a.d.g;_j.h.a(this.A().LastSuccessfulSyncTime)||(n=_a.d.b(this.A().LastSuccessfulSyncTime));return n.b(_a.d.a().c(-7))<0},cI:function(n){return!0},cL:function(){return new SyncState("TimeZoneOffsetsSyncStateId","")},cM:function(n){n(new _w.bS)},cQ:function(){this.x(String.format("Number of time zones = {0}",this.v.Body.TimeZones.length));return new(_bs.bM.$$(_bc.I,_g.hq))(this.y.a().p(),this.v.Body.TimeZones)},cK:function(){return null},bM:function(){var i=this.y.a().p();var r=this,n=this,t=this;i.a(new _e.a("SyncTimeZoneOffsetsModule.OnBatchCompleted"),function(n){r.z.e().F(i,n,null,null)},function(){n.x("The time zone offsets table has been loaded");n.z.y(!0,function(){_w.k.prototype.bM.call(n)},function(t){n.Q("Failed to set the offline component as ready to use after synchronizing the time zone data.",t.a());n.n(Error.create(t.a()))})},function(n){t.Q("Failed to load the time zone offsets table",n.a);t.n(Error.create(n.a))})}};_w.bU=function(n,t){_w.bU.initializeBase(this,[n,t])};_w.bU.prototype={f:function(){return 2},c:function(n,t,i){i([new _w.bT(n,t,this.a)])},e:function(n){return!1},d:function(){return"TimeZoneOffsetsSyncStateId"}};_w.bd=function(n,t,i,r,u){_w.bd.initializeBase(this,[1102,n,t,i,r,u])};_w.bd.prototype={get_syncResponse:function(){return this.h},Y:function(){return"UTC"},cK:function(n){return n!=="ErrorItemNotFound"}};_w.J=function(n){this.f=this.$$gta["_w.J"].TSyncResponse===Number||Type.isEnum(this.$$gta["_w.J"].TSyncResponse)?0:this.$$gta["_w.J"].TSyncResponse===Boolean?!1:null;_w.J.$$(this.$$gta["_w.J"].TSyncResponse).initializeBase(this);this.h=n};_w.J.$$=function(n){var u=_w.__tc=_w.__tc||{};var t="J"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_w.J.apply(this,t)};var h=_h.fG;r.registerClass("_w.__tc."+t,h,_a.fK,_a.fE);var o={"_w.J":{TSyncResponse:n},ctor:_w.J};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}r.prototype.$$gta=o;var f=_w.J.prototype;for(var e in f){var i={key:e,value:f[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};_w.J.prototype={h:null,get_syncResponse:function(){return this.f},cS:function(n,t,i){this.f=n;t()}};_w.B=function(n){_w.B.$$(this.$$gta["_w.B"].TResult,this.$$gta["_w.B"].TResponseMessage).initializeBase(this);this.e=n};_w.B.$$=function(n,t){var f=_w.__tc=_w.__tc||{};var i="B"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!f[i]){var u=f[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_w.B.apply(this,t)};var c=_h.dr.$$(n,t);u.registerClass("_w.__tc."+i,c,_a.fK,_a.fE);var s={"_w.B":{TResult:n,TResponseMessage:t},ctor:_w.B};var l=c.prototype.$$gta;for(var a in l){var h={key:a,value:l[a]};s[h.key]=h.value}u.prototype.$$gta=s;var e=_w.B.prototype;for(var o in e){var r={key:o,value:e[o]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return f[i]};_w.B.prototype={e:null,h:null,get_syncResponse:function(){return this.h},Y:function(){return"UTC"},cI:function(n){_a.b.b(n,"responseMessage");this.h=n}};_w.cb=function(n,t,i,r){_a.b.b(r,"ExternalSyncDependencies");this.c=n;this.m=t;this.d=r;this.h=i;this.r=_a.d.a().h().toString()};_w.cb.prototype={c:0,m:0,d:null,r:null,h:!1,e:function(){return""},b:function(){return this.c},a:function(){return this.h},t:function(){return!1},w:function(){return!1},j:function(){return""},i:function(){return!0},k:function(){return!1},u:function(){return!1},s:function(){return _a.d.z.h()},v:function(){return 36e5}};_w.v=function(n,t,i){_w.v.initializeBase(this,[n,t]);this.l=i};_w.v.prototype={l:null,e:function(n){return this.b.b.b(11,n)},j:function(n){return this.b.b.b(11,n)},u:function(){return this.b.a.n()-this.t()<=0},h:function(){return!0},c:function(n,t,i){if(_w.d.isInstanceOfType(n))i([new _w.D(n,[],t,this.a)]);else{var r=this;this.b.b.c(11,this.b.i(),function(u){var f=null;u.length&&(f=[new _w.D(n,u,t,r.a),new _w.E(n,t,r.a),new _w.be(n,t,new _bs.ci(r.i(),_h.k.d),r.l)]);i(f)})}}};_w.w=function(n,t,i){_w.w.initializeBase(this,[n,t]);this.l=i};_w.w.prototype={l:null,e:function(n){return!1},p:function(){var n=this.b.i().Id;return!this.b.b.d(n)},c:function(n,t,i){var r=this;this.b.b.c(4,this.b.i(),function(u){_a.b.d(!_w.f.isInstanceOfType(n),"sync conversation minimum module factory should not be invoked on notification based sync");var f=null;(_w.d.isInstanceOfType(n)||u.length)&&(f=[new _w.bh(n,u[0],t,r.a),new _w.E(n,t,r.a),new _w.bf(n,t,new _bs.ci(r.i(),_h.k.d),r.l)]);i(f)})}};_w.bq=function(n,t){_w.bq.initializeBase(this,[n,t])};_w.bq.prototype={f:function(){return 0},c:function(n,t,i){i([new _w.bp(n,t,this.a)])},e:function(n){return!1},d:function(){return"FolderHierarchySyncStateId"}};_w.bD=function(){_w.bD.initializeBase(this,[null])};_w.bD.prototype={K:function(n){var t=new _g.hf(this.L);n.h(t,this.J,this.H)}};_w.bE=function(n,t,i){this.G=Function.createDelegate(this,this.bi);_w.bE.initializeBase(this,[n,t,i]);this.E=null;this.F=new _h.ez};_w.bE.prototype={E:null,F:null,g:function(){return 0},cI:function(n){return!0},cL:function(){return new SyncState("OwaUserConfigurationSyncStateId","")},cM:function(n){n(new _w.bD)},cS:function(){this.bh(this.bO,this.W)},cQ:function(){return new(_bs.cv.$$(_g.ct))(this.v,this.G)},cK:function(){return null},V:function(n){this.S(n);_w.k.prototype.V.call(this,n)},U:function(n){this.S(n);_w.k.prototype.U.call(this,n)},bi:function(n,t){var i=new _bs.E(this.y.a());var r=this;i.e(t,n,function(){})},bh:function(n,t){var r=new _bs.E(this.y.a());var i=this;r.d(function(t){i.E=t;n()},t)},T:function(n,t){if(n.UserOptions.HideDeletedItems!==t.UserOptions.HideDeletedItems||n.UserOptions.ConversationSortOrder!==t.UserOptions.ConversationSortOrder||n.SegmentationSettings.PredictedActions!==t.SegmentationSettings.PredictedActions){this.x(String.format("UserOption changed. Marking Email data for cleanup."));this.z.c.a(_h.bl,new _h.bl(11,!0))}return this.bd(n,t)},S:function(n){if(n===1&&this.v&&this.E){var t=this.T(this.E,this.v);t=t||!this.F.a(this.E,this.v);this.x(String.format("SyncType={0}, ShouldReload={1}",_a.cF.toString(this.w.c),t));this.J().e(t);_a.C.b(this.v.SessionSettings.UserCulture)!==_a.C.b(this.E.SessionSettings.UserCulture)&&this.z.c.a(_a.fm,new _a.fm)}},bd:function(n,t){var e=!1;if(!n.SessionSettings||!t.SessionSettings||!n.SessionSettings.DefaultFolderIds||!n.SessionSettings.DefaultFolderNames||!t.SessionSettings.DefaultFolderIds||!t.SessionSettings.DefaultFolderNames)return e;var v=new _g.a(n);var l=new _g.a(t);var d=v;var g=l;v.O();l.O();for(var b=["inbox","drafts","outbox","sentitems","calendar","contacts","recipientcache","quickcontacts"],i=new Array(0),u,a=b,k=a.length,f=0;f<k;++f){var r=a[f];u=!1;var c=d.nameToId(r);var s=g.nameToId(r);if(c)if(s){if(c.Id!==s.Id){this.D(String.format("FolderId for distinguishedFolderIdName:{0} has changed",r));u=!0}}else{this.Q(String.format("Couldn't find FolderId for {0} in newUserConfiguraiton",r),"");u=!0}else{this.Q(String.format("Couldn't find FolderId for {0} in oldUserConfiguraiton",r),"");u=!0}if(u){var w=this.be(r);i=i.concat.apply(i,w)}}if(i.length>0){this.x(String.format("We need to clean up modules {0} due to FolderId changes",i.join()));e=!0;this.z.a.j();for(var h=i,p=h.length,o=0;o<p;++o){var y=h[o];this.z.c.a(_h.bl,new _h.bl(y,!0))}}return e},be:function(n){var t;switch(n){case"inbox":case"drafts":case"outbox":case"sentitems":t=[11];break;case"calendar":t=[9,10];break;case"contacts":case"recipientcache":case"quickcontacts":t=[7,8];break;default:this.D(String.format("We dont' cleanup module for distinguishedFolderIdName:{0}",n));t=new Array(0);break}return t}};_w.bF=function(n,t){_w.bF.initializeBase(this,[n,t])};_w.bF.prototype={f:function(){return 1},c:function(n,t,i){i([new _w.bE(n,t,this.a)])},e:function(n){return!1},q:function(n){return!1},y:function(){return!0},d:function(){return"OwaUserConfigurationSyncStateId"}};_w.V=function(n,t,i,r){_w.V.initializeBase(this,[n]);this.e=new _gg.kw;this.e.FolderId=t;this.e.WindowStart=i.i();this.e.WindowEnd=r.i();this.e.SyncState=n.State;this.e.MaxChangesReturned=50};_w.V.prototype={e:null,K:function(n){var t=new _gg.Cr(this.L);n.iF(this.e,t,this.J,this.H)}};_w.q=function(n,t,i,r){_w.q.initializeBase(this,[_w.q.a(n),t,i,r,0,!1,null,null])};_w.q.a=function(n){switch(n){case 15:case 16:return 1102;case 17:case 18:return 1103;case 10:return 1101;default:return 1100}};_w.q.prototype={e:null,get_syncResponse:function(){return this.e},Y:function(){return"UTC"},cK:function(n){return this.L===1101?!1:n!=="ErrorItemNotFound"},cJ:function(n){this.e=n},cI:function(n){}};_w.bz=function(n,t,i){this.bN=Function.createDelegate(this,this.X);this.cp=Function.createDelegate(this,this.bQ);this.cr=Function.createDelegate(this,this.de);this.cs=Function.createDelegate(this,this.df);this.cq=Function.createDelegate(this,this.cw);this.W=Function.createDelegate(this,this.cA);this.bO=Function.createDelegate(this,this.H);this.ct=Function.createDelegate(this,this.R);this.bp=[];this.M=-1;_a.b.a(n,"syncContext");_a.b.a(n.d,"syncContext.ExternalSyncDependencies");_a.b.a(n.d.l(),"syncContext.ExternalSyncDependencies.ActionQueue");_a.b.a(n.d.t(),"syncContext.ExternalSyncDependencies.ConnectionManager");_a.b.a(n.d.d,"syncContext.ExternalSyncDependencies.DatapointTracker");_a.b.a(i,"itemSynchronizer");_a.b.a(i.c(),"itemSynchronizer.SyncStateProvider");this.bV=t;this.w=n;this.z=n.d;this.y=i;this.bH=0;this.bF=0;this.bc=!1;this.bX()};_w.bz.a=function(n,t){_a.b.c(n,"moduleName");_a.b.a(t,"syncContext");return n+":"+t.e()};_w.bz.prototype={bV:null,w:null,z:null,y:null,bn:null,bw:null,B:null,bm:!1,bx:!1,bB:!1,bj:!1,bH:0,br:0,bq:null,bc:!1,bl:null,bF:0,P:!1,bY:null,bU:0,bW:0,bC:null,bE:0,bI:0,bJ:0,bD:0,k:function(){return this.bB},f:function(){var n=_a.bX.a(this.bl,_a.d.a());return n.a/6e4<5},c:function(){return this.br},r:function(n){this.br=n;return n},m:function(){return this.bq},Y:function(){return this.y.c()},e:function(){return this.bl},j:function(){return this.bx},q:function(n){this.bx=n;return n},A:function(){return this.bw},a:function(){return _a.bw.toString(this.g())},cx:function(){return this.z.t()},bz:function(){return this.z.l()},bk:function(){return _a.cF.toString(this.w.c)},b:function(){return _w.bz.a(this.a(),this.w)},l:function(){return this.bj},C:function(){this.bn||(this.bn=this.bg());return this.bn},cy:function(){return this.cx().a||_w.i.isInstanceOfType(this.w)},bS:function(){return this.w.c===3||this.cz()?this.w.e():""},cz:function(){return this.w.c===8},bR:function(){return!1},dc:function(){return this.z.a.b()&&this.bR()},dd:function(){return!_w.d.isInstanceOfType(this.w)||this.w.g===2},bX:function(){this.bl=_a.d.a()},h:function(){return!1},s:function(n){return this.w.c!==4&&this.w.c!==7&&this.O(n)},t:function(){this.dk();this.P=!1;if(_w.d.isInstanceOfType(this.w)){_j.e.a(_w.b.a,"{0}: Starting cleanup for module {1}",_a.d.a(),this.a());_a.b.d(this.w.g!==1,"Quota exceeded error is not processed through this code path at present");var n=this,t=this;this.u(function(){var t=n.w;t.n(n.g());n.R()},function(n){_j.e.c(_a.a.co,"Cleanup failed, but continuing with the rest of the sync. Error = "+n.message);n.message&&t.C().f(n.message);t.R()})}else{_j.e.a(_w.b.a,"{0}: Starting sync for module {1}",_a.d.a(),this.a());this.dj()}},dj:function(){this.x(String.format("Starting Sync with SyncContext Id '{0}', Time: {1}",this.w.e(),this.bq));this.ba(1);this.dm(this.cq)},i:function(){this.x("Continue sync");if(this.bj){_j.n.a(this.bY);this.bW+=+new Date-_a.j.bw(this.bU);this.bj=!1;_j.e.a(_w.b.a,"{0}: Syncing module {1} step {2} continues its execution",_a.d.a(),this.a(),this.M);this.by()}},p:function(){this.ba(0)},o:function(){this.bX()},d:function(){this.ba(4)},n:function(n){if(this.B){this.B.e=1;this.B.a=n;this.B.b=!1;this.H()}else this.bG(n)},O:function(n){return!1},cw:function(){this.B&&this.B.g();if(this.M>=this.bp.length)throw Error.invalidOperation("All the steps in this module have already been executed");this.B=this.bp[++this.M];this.by()},de:function(){this.x("Getting a currentSyncState");this.Y().c(this.cs,this.W)},df:function(n){var t=n?n.get_data():this.Y().b();this.bo(t)},bo:function(n){if(this.bT(n)){this.x("This module is being synced for the first time i.e. the SyncState is <empty>");this.bm=!0}else this.x("The module is NOT being synced for the first time. SyncState is "+n.State);this.x("Got a currentSyncState");this.bw=n;this.bc=_j.h.b(n.Diagnostics.SyncError);this.H()},cA:function(n){var t=null;t=Error.create(n.a());this.B.b=n.c();this.bx=n.d();this.bQ(t)},bT:function(n){return n.State===""},R:function(){if(this.P){this.D(String.format("{0} has been aborted when invoking SyncCompleted",this.b()));return}this.x("Completed syncing");this.bP();var n=this;this.dp(function(){n.N(function(){n.ba(3)})})},N:function(n){this.x("Post sync completed");n()},bg:function(){return new _w.c(this.g())},dh:function(){this.x("Restart syncing current module");this.M=-1;this.H()},K:function(n,t){Array.add(this.bp,new _w.G(n,t))},cY:function(n,t){Array.insert(this.bp,0,new _w.G(n,t))},H:function(){if(this.P){this.x("Ignoring StepCompleted as the module has been aborted");return}this.bP();if(this.B.e)this.B.i()?this.dg():this.bG(this.B.a);else{if(this.B.a)throw Error.invalidOperation("previous StepError should be null at this point");this.cw()}},bA:function(){return _a.d.get_utcNow().h()},dp:function(n){if(this.dd()){var t=this;this.cB(function(n){n.IsSynced=!0;n.Diagnostics.SyncType=t.bk();n.Diagnostics.SyncInProgress=!1;n.Diagnostics.SyncError="";var i=_a.d.a();n.LastSuccessfulSyncTime=_a.d.d(i);n.LastAttemptedSyncTime=n.LastSuccessfulSyncTime;t.z.a.I(n.Id,i.h())},n)}else n()},di:function(){this.bB=!0;this.bz().b(!1)},bP:function(){this.bB=!1;this.cx().f();this.bz().b(!0)},by:function(){if(this.P){this.D(String.format("{0} has been aborted when invoking ExecuteCurrentStep",this.b()));return}this.bX();if(!_h.z.a){this.B.a=Error.create("Abort syncing because Sync is disabled");this.bG(this.B.a);return}if(this.w.u()){var n=this.w.d.v.a().h();if(this.w.s()<=n){this.B.a=Error.create(String.format("Abort syncing because it reachs the time limit at {0}",n));this.bG(this.B.a);return}}if(!this.cZ()){this.bY=_j.n.b(_a.a.N,517,"WaitForActionQueueToDrain");this.bU=+new Date;this.x("Cannot execute current sync step number "+this.M+" is triggering action queue process and waiting until it finishes.");this.bj=!0;this.bP();return}this.dc()?this.da():this.db()},da:function(){var t=String.format("SyncModule_{0}.{1}",this.a(),this.B.d);var n=_j.n.b(_a.a.co,2,t);this.cv();_j.n.a(n)},db:function(){this.bF=this.bA();var t=this.a()+":"+this.B.d;this.x(String.format("Enqueing sync task: {0} on idle queue.",t));var n=this;this.z.x.d(_w.b.a,t,function(){var i=n.bA()-n.bF;i>=1e3&&n.x(String.format("Sync task {0} was delayed for {1} milliseconds",t,i));n.cv()})},cv:function(){this.x(String.format("Executing step #{0}: {1}",this.M,this.B.d));this.di();this.B.h();var n;(n=this.B).c=n.c+1;this.B.f()},cZ:function(){return!this.bz().a()},dg:function(){this.x(String.format("Re-executing step number {0}. Step execution count = {1}",this.M,this.B.c));if(_h.z.c>0){var n=this;_j.m.a().a(_w.b.a,"SyncExecuteCurrentStep",function(){n.by()},_h.z.c)}else this.by()},ba:function(n,t){if(n===6||n===3){this.dl();var r=this.z.d;if(r.b()){this.bb();this.C().q(this.bm);this.C().u(_a.cs.toString(n));this.C().v(this.bk());this.C().t(_a.cS.toString(this.w.m));this.bn.s(this.w.r);this.C().w(this.bH);this.C().p(this.w.j());this.C().r(this.w.v());t&&t.message&&this.C().f(t.message);r.a(this.C())}}var i=this;_j.m.a().c(_w.b.a,"SyncInvokeProgressEventHandler_"+this.a()+"_"+_a.cs.toString(n),function(){i.bV(i.cu(n,t))})},cu:function(n,t){return _a.dP.a(n,this.g(),this.br,this.b(),this.bS(),this.bm,null,null,t,this.w.j())},bG:function(n){if(this.P){this.D(String.format("{0} has been aborted when invoking SyncAborted",this.b()));return}this.P=!0;this.D("Aborting syncing module Id "+this.b());n&&this.D("Error: "+n.message);var t=this;this.dn(!1,n,function(){t.Z(function(){t.ba(6,n)})})},Z:function(n){this.x("Processing sync aborted");n()},bb:function(){return},X:function(n){_j.n.a(this.bC);this.bI+=+new Date-this.bE;var t=n;t.d()&&(this.bJ+=t.d().backEndTime);_a.b.a(n,"action");_a.b.a(n.G,"action.Error");if(this.P){this.x("Ignoring ActionErrorCallback as the module has been aborted");return}this.D(String.format("Action failed, action name: {0}, error: {1}",n.be,n.G));this.cy()||(this.B.b=!1);this.bQ(n.G)},bQ:function(n){this.D(String.format("Error in current step number {0}. Error = {1}",this.M,n?n.toString():""));this.B.e=1;this.B.a=n;this.H()},dm:function(n){var t=this;this.cB(function(n){n.Diagnostics.SyncType=t.bk();n.Diagnostics.SyncInProgress=!0;n.LastAttemptedSyncTime=_a.d.d(_a.d.a())},n)},dn:function(n,t,i){this.x(String.format("Updating the sync diagnostics for module '{0}', SyncType: {1}, SyncInProgress: {2}, Error: {3}",this.a(),this.bk(),n,t));this.Y().h(this.bk(),n,t,i)},I:function(){this.x("Resetting currentSyncState to null");this.bw=null},x:function(n){_j.e.a(_w.b.a,"{0}: {1}",this.a(),n)},D:function(n){_j.e.b(_w.b.a,"{0}: {1}",this.a(),n)},Q:function(n,t){_j.e.c(_w.b.a,this.a()+": "+n+" [Data] "+t)},dk:function(){this.bq=_a.d.a()},dl:function(){this.bH=_a.d.a().h()-this.bq.h()},cB:function(n,t){this.Y().e(n,t)}};_w.k=function(n,t,i){this.cj=Function.createDelegate(this,this.cW);this.cg=Function.createDelegate(this,this.co);this.cd=Function.createDelegate(this,this.cJ);this.ch=Function.createDelegate(this,this.cT);this.ce=Function.createDelegate(this,this.bM);this.ck=Function.createDelegate(this,this.cX);this.cf=Function.createDelegate(this,this.cS);this.ci=Function.createDelegate(this,this.cV);_w.k.initializeBase(this,[n,t,i]);this.K(this.cr,"GetSyncState");this.K(this.ci,"SyncChangesFromServer");this.K(this.cf,"PerformModuleSpecificAction");this.K(this.ck,"SynchronizeChangesToClientStore");this.K(this.ce,"OnBatchCompleted");switch(this.w.c){case 7:this.K(this.ch,"ReconcileClientData");break;default:break}this.K(this.cd,"ConfirmSyncCompleted")};_w.k.prototype={v:null,bv:null,bf:null,cO:function(){return 100},cl:function(){return!!this.v&&this.cI(this.v)},J:function(){this.bv||(this.bv=this.cR());return this.bv},cP:function(){return this.g()},cT:function(){if(_bs.cu.isInstanceOfType(this.bf)){this.cn();var t=this.bf;var n=this,i=this;this.y.e(t,this.cO(),this.cg,function(){n.C().d(t.a());n.C().e(t.b());_j.e.a(_a.a.co,"Finished sync reconciliation (Reconciled/Detected: {0}/{1}).",n.C().m(),n.C().i());n.bz().d(function(t){n.C().n(t.length);for(var r=t,f=r.length,i=0;i<f;++i){var u=r[i];_j.e.b(_a.a.co,"Existing action in the queue after sync reconciliation was done: {0}",_g.H.a(u))}n.H()},n.cp)},function(n){_j.e.c(_a.a.co,"Failed to reconcile client data. Error: {0}",n.a());i.cA(n)})}else{this.C().d(-1);this.C().e(-1);this.H()}},u:function(n,t){_a.b.a(n,"onCleanupComplete");_a.b.a(t,"errorCallback");_j.e.a(_w.b.a,"Starting cleanup for module '{0}'",this.b());this.cm();var i=this.cK();if(i){var r=this;this.y.b(this.w.g,i,n,function(n){r.D("Module cleanup failed with error: "+n.a());var i=Error.create(n.a());t(i)})}else n()},cX:function(){this.x("Persisting changes to client store");this.bf=this.cN();var n=this.cL();n.IsSynced=this.A().IsSynced;n.LastSuccessfulSyncTime=this.A().LastSuccessfulSyncTime;n.Diagnostics.SyncInProgress=!0;this.y.f(n,this.w.t(),this.w.j(),this.w.w(),this.bf,this.bO,this.W)},L:function(n){n()},co:function(n){n()},cR:function(){return new _bs.du},I:function(){_w.bz.prototype.I.call(this);this.v=null},X:function(n){var t=n;var r=!1;var i=!1;if(t.d()){r=t.d().responseCode==="ErrorInvalidSyncStateData";i=t.d().responseCode==="ErrorInvalidPropertyForSortBy"}if(r||i){var u=i?15:12;this.D(String.format("Receiving {0} response",t.d().responseCode));this.z.c.a(_h.bl,new _h.bl(this.cP(),!1));this.z.a.j();this.z.c.a(_h.bS,new _h.bS(u));this.n(Error.create(String.format("Abort syncing current module because receiving {0} response",t.d().responseCode)))}else _w.bz.prototype.X.call(this,n)},cN:function(){if(!this.v)throw Error.invalidOperation("CurrentSyncResponse should not be null at this point");return this.cQ()},cV:function(){if(!this.A())throw Error.invalidOperation("CurrentSyncState cannot be null before starting this step");if(this.cU()){var n=this;this.cM(function(t){if(t){t.b(n.cj);t.c(n.bN);n.bC=_j.n.b(_a.a.N,517,"SyncModule.SubmitSyncAction");n.bE=+new Date;n.bD++;_a.g.a.a(t)}else{n.D("Sync action is null");n.n(Error.invalidOperation("Sync action is null"))}})}else this.R()},cU:function(){return!0},cS:function(){this.H()},bM:function(){this.bL(0);this.H()},cJ:function(){this.x("Confirming sync is complete");if(this.cl())this.R();else{this.ba(2,null);this.I();this.dh()}},N:function(n){this.bL(1);_w.bz.prototype.N.call(this,n)},Z:function(n){this.bL(2);_w.bz.prototype.Z.call(this,n)},bL:function(n){this.w.c===5?this.U(n):n!==2&&this.V(n)},U:function(n){},V:function(n){},cm:function(){},cn:function(){},cW:function(n){_j.n.a(this.bC);this.bI+=+new Date-this.bE;var t=n;t.d()&&(this.bJ+=t.d().backEndTime);var r=n;this.v=r.get_syncResponse();var i=this;this.L(function(){i.H()})}};_w.c=function(n){_w.c.initializeBase(this,[1,"Core.Models.Sync.ModuleStats"]);this.a[_w.c.h]=_a.bw.toString(n)};_w.c.prototype={p:function(n){this.a[_w.c.e]=n;return n},q:function(n){this.a[_w.c.f]=n;return n},v:function(n){this.a[_w.c.m]=n;return n},t:function(n){this.a[_w.c.k]=n;return n},u:function(n){this.a[_w.c.l]=n;return n},f:function(n){this.a[_w.c.i]=n;return n},w:function(n){this.a[_w.c.n]=n;return n},b:function(n){this.a[_w.c.o]=n;return n},r:function(n){this.a[_w.c.g]=n;return n},c:function(n){this.a[_w.c.d]=n;return n},s:function(n){this.a[_w.c.j]=n;return n},i:function(){return this.a[_w.c.a]},d:function(n){this.a[_w.c.a]=n;return n},m:function(){return this.a[_w.c.b]},e:function(n){this.a[_w.c.b]=n;return n},n:function(n){this.a[_w.c.c]=n;return n}};_w.bc=function(n,t,i,r,u){this.o=Function.createDelegate(this,this.q);_w.bc.initializeBase(this,[t]);_a.b.a(n,"foldersToSync");_a.b.a(t,"syncState");_a.b.e(i,1,100,"maxChangesReturned");this.f=new Array(n.length);for(var f=0;f<n.length;f++)this.f[f]=new _g.l(n[f]);this.l=i;this.k=r;this.j=u};_w.bc.prototype={f:null,l:0,k:!1,j:!1,p:function(n){var t=new _gg.ky(this.l);t.NumberOfDays=_h.k.e;t.MinimumCount=_h.k.c;t.MaximumCount=_h.k.b;t.FolderIds=this.f;t.SyncState=this.e.State;t.IsPartialFolderList=this.k;t.DoQuickSync=this.j;t.ConversationShape=_h.b.P();t.SortOrder=_h.v.e(_h.b.b,"Descending");t.ShapeName=_h.b.Q(this.f[0],null);return new _gg.kx(n,t)},K:function(n){var i=this.p(this.M());var t=new _gg.Ct(this.L);n.iG(i,t,this.o,this.H)},q:function(n,t){this.bg(n,t)}};_w.bi=function(n){this.f=[];_w.bi.initializeBase(this);this.d=n};_w.bi.prototype={d:null,k:function(){return this.d.SyncState},j:function(){return this.d.ConversationViewDataList},h:function(){var t=this.d.DeletedConversations;var n=this.d.Conversations;t&&this.i(t);n&&this.g(n)},i:function(n){for(var u=[],r=n,f=r.length,i=0;i<f;++i){var t=r[i];Array.add(this.b,_bs.Y.a(t.FolderId,t.ConversationId));Array.add(u,t.ConversationId.Id);this.e(t.FolderId.Id)}_w.a.a("SyncConversation received {0} deletes. List of conversations deleted = [{1}]",n.length,u.join(","))},g:function(n){for(var u={},e=[],f=n,s=f.length,i=0;i<s;++i){var t=f[i];Array.add(this.c,t);var r=t.ConversationId.Id;if(!u[r]){u[r]=!0;Array.add(this.f,new _g.cB(t.ConversationId))}var o=t.FolderId.Id;this.e(o);Array.add(e,r+"::"+t.LastDeliveryTime+"::"+t.ConversationTopic)}_w.a.a("SyncConversation received {0} AddsAndChanges. List of conversations added = [{1}]",n.length,e.join(","))}};_w.j=function(n,t,i,r){_w.j.initializeBase(this,[n,t,i]);this.bu=r;this.T=_a.I.a();this.F=_a.I.a();this.bt=!1;this.bi=0;this.bd=0;this.be=0;this.bh=0};_w.j.b=function(n,t,i,r){var f=n.d();var u=f.c(1-f.j());var e=u.s(t);i.val=u.c(-7);r.val=e.c(14)};_w.j.prototype={bu:null,G:null,S:null,E:null,T:null,F:null,bt:!1,bi:0,bd:0,be:0,bh:0,bs:!1,g:function(){return 10},cb:function(){return _g.a.a().a().bD.TimeZone},cc:function(){return 50},O:function(n){return n===1},cC:function(){if(!_w.j.a){var n=this.bu.b()?_h.b.I():_h.b.X();_w.j.a=_ff.e.a(n);_w.j.a.MaximumBodySize=this.z.q==="Mouse"?51200:25600}return _w.j.a},cI:function(n){this.bs=n.IncludesLastItemInRange;return this.bs&&!this.A().TryToIncrementWindowSizeOnNextSync},cL:function(){return new CalendarSyncState(this.v.SyncState,this.E.Id,this.G,this.S,this.cb(),this.A().ApproximateWindowSize,this.A().TryToIncrementWindowSizeOnNextSync)},bo:function(n){var t=n;if(this.bT(n)){t.ApproximateWindowSize=3;t.TryToIncrementWindowSizeOnNextSync=6>t.ApproximateWindowSize}else if(_j.C.a(t.ApproximateWindowSize)){t.ApproximateWindowSize=6;t.TryToIncrementWindowSizeOnNextSync=!1}else if(t.TryToIncrementWindowSizeOnNextSync&&this.bs){var u=t.ApproximateWindowSize+3;if(u>=6){t.ApproximateWindowSize=6;t.TryToIncrementWindowSizeOnNextSync=!1}else t.ApproximateWindowSize=u}var r,i;_w.j.b(_a.d.a(),t.ApproximateWindowSize,r={val:this.G},i={val:this.S}),this.G=r.val,this.S=i.val;_w.bz.prototype.bo.call(this,n)},cQ:function(){var r=this.y;var t=this.w;var n=this.v;return new _bs.bB(r.a(),_w.z.isInstanceOfType(t)||_w.o.isInstanceOfType(t),this.G.i(),n.UpdatedItems,n.RecurrenceMastersWithInstances,n.RecurrenceMastersWithoutInstances,n.DeletedItems,this.T,this.F)},cK:function(){return new _bs.cX(this.y.a().f(),this.y.a().b(),this.y.a().i())},L:function(n){var t=this.v;this.bi+=t.UpdatedItems.length;this.bd+=t.DeletedItems.length;this.be+=t.RecurrenceMastersWithInstances.length;this.bh+=t.RecurrenceMastersWithoutInstances.length;(this.bi>0||this.bd>0||this.be>0||this.bh>0)&&(this.bt=!0);for(var r=[],e=0;e<t.RecurrenceMastersWithInstances.length;e++){var o=t.RecurrenceMastersWithInstances[e];this.F.a(o.UID,o.ItemId.Id);Array.add(r,o.ItemId)}for(var s=0;s<t.UnchangedRecurrenceMastersWithInstances.length;s++){var i=t.UnchangedRecurrenceMastersWithInstances[s];if(!this.F.c(i.UID)){this.F.a(i.UID,i.ItemId.Id);Array.add(r,i.ItemId)}}for(var f=0;f<t.UpdatedItems.length;f++){var u=t.UpdatedItems[f];u.CalendarItemType==="Occurrence"&&this.F.c(u.UID)||Array.add(r,u.ItemId)}this.bZ(r,!0,!0,this.T,n)},co:function(n){var t=this.bf;var i=new Array(t.a());var u=0;var f=this;t.v(function(n){var t=new _g.e(n);i[u++]=t});var r=this;this.bZ(i,!1,!1,t.h,function(){_w.k.prototype.co.call(r,n)})},cM:function(n){var t=this;_w.g.c(this.z.e(),function(i){if(i){t.x(String.format("Syncing calendar folder ('{0}').",i.Id));t.E=i;var r=t.cD();n(r)}else{t.D("Could not find the primary calendar folder.");n(null)}})},bb:function(){var n=this.C();n.b(this.bi);n.c(this.bd);n.a.rmi=this.be;n.g(this.bh);n.a.sws=this.G?this.G.i():"";n.a.swe=this.S?this.S.i():"";n.a.sf=this.E?this.E.Id:"";if(this.A()){var t=this.A();n.a.aws=t.ApproximateWindowSize;n.h(t.TryToIncrementWindowSizeOnNextSync)}},bg:function(){return new _w.bb(this.g())},cD:function(){var n=new _g.F(new _g.l(this.E.Id));return new _w.V(this.A(),n,this.G,this.S)},V:function(n){if(n===1&&this.bt&&(this.w.h||!this.bc)){this.x("Raising Hierarchy notification for calendar synced folders");this.J().a([this.E.Id])}_w.k.prototype.V.call(this,n)},U:function(n){if(n===2||n===1){this.x("Raising Hierarchy notification for calendar all folders");this.J().a([this.E.Id])}_w.k.prototype.U.call(this,n)},I:function(){this.T=_a.I.a();this.F=_a.I.a();_w.k.prototype.I.call(this)},cn:function(){if(this.w.c===7){var n=this.bA()+288e5;this.z.a.p(n);this.x(String.format("Next calendar reconcile time: {0} utc ms",n))}_w.k.prototype.cn.call(this)},bZ:function(n,t,i,r,u){var f=[];this.x(String.format("Items to sync: {0}",n.length));var e=this;this.bK(n,0,this.cc(),t,i,r,f,function(){e.x(String.format("Failed items to sync: {0}",f.length));e.ca(f,r,u)})},ca:function(n,t,i){var r=this;this.bK(n,0,1,!1,!1,t,[],function(){i()})},bK:function(n,t,i,r,u,f,e,o){var l=n.length-t;var s=Math.min(l,i);this.x(String.format("SyncItems with offset = {0}, remaining = {1}, count = {2}",t,l,s));if(s){for(var c=new Array(s),h=0;h<s;h++)c[h]=n[t+h];t+=s;var a=this;this.cE(c,f,r,u,e,function(){a.bK(n,t,i,r,u,f,e,o)})}else{this.x("Done syncing items");o()}},cE:function(n,t,i,r,u,f){var s=new _w.q(this.g(),n,this.cC(),"FullCalendarItem");var e=this;s.b(function(r){e.bl=_a.d.a();for(var h=r,l=h.e.length,o=0;o<l;o++){var s=h.e[o];if(!e.cF(t,s))if(i&&s.ResponseCode!=="ErrorItemNotFound")Array.add(u,n[o]);else{var c=String.format("Failed to sync item: {0}, ResponseCode: {1}",n[o].Id,s.ResponseCode);s.ResponseCode==="ErrorItemNotFound"?e.D(c):e.Q(c,"");Array.add(e.v.DeletedItems,n[o])}}f()});var o=this;s.c(function(i){if(r){o.D("Retry sync items action");o.ca(n,t,f)}else{o.D("Sync items action failed");o.X(i)}});_a.g.a.a(s)},cF:function(n,t){switch(t.ResponseCode){case"NoError":var r=t.Items;if(r&&r.length>0){_a.b.f(r.length,1,String.format("There are unexpected number of items ({0}) in the response.",r.length));var i=r[0];_a.b.g(i,null,String.format("The item should not be null with the response code '{0}'.",t.ResponseCode));i.Body&&i.Body.IsTruncated&&(i.Body.Value="");i.TextBody&&i.TextBody.IsTruncated&&(i.TextBody.Value="");n.a(i.ItemId.Id,i)}return!0;default:this.D(String.format("SyncItems encountered error (ResponseCode: {0}; MessageText: '{1}').",t.ResponseCode,t.MessageText));return!1}}};_w.g=function(n,t,i){_w.g.initializeBase(this,[n||new _bs.dr(t.e()),t]);this.l=i};_w.g.c=function(n,t){_w.g.b(n,function(){t(_w.g.a)})};_w.g.b=function(n,t){_w.g.a?t():_bs.I.a(new _bs.bm(n,"UTC"),"calendar",function(n){n?_w.g.a=n.get_data().FolderId:_w.a.b("The primary calendar folder is not present in the folder hierarchy.");t()},function(n){_w.a.d("Failed to find the calendar folder. Error: {0}",n);t()})};_w.g.prototype={l:null,f:function(){return 0},c:function(n,t,i){i([new _w.j(n,t,this.a,this.l)])},e:function(n){return this.m(n)},z:function(){return this.b.a.m()-this.t()<=0},j:function(n){return this.m(n)},h:function(){return!0},d:function(){return"CalendarSyncState"},g:function(n,t){if(_bs.bo.isInstanceOfType(n)){var r=t;var i=n;if(_w.ck.prototype.g.call(this,n,t))if(i.b===r.FolderId){var u=_g.a.a().a().bD.TimeZone;if(r.TimeZone===u){var e=i.d.localeCompare(r.WindowStart);if(e>=0){var f=i.c.localeCompare(r.WindowEnd);if(f>0)i.a=313;else return!0}else i.a=314}else{_j.e.b(_w.b.a,"Calendar module is synced to a different time zone ('{0}') than expected ('{1}').",r.TimeZone,u);i.a=315}}else i.a=316;else i.a=301;return!1}else throw Error.argumentType("context",Object.getType(n),_bs.bo,"The context type should match the module.");},m:function(n){return!!_w.g.a&&n===_w.g.a.Id}};_w.bo=function(n){_w.bo.initializeBase(this,[n])};_w.bo.prototype={K:function(n){var t=new _gg.kz(this.M(),new _gg.kA(_h.b.J()));t.Body.ShapeName="Folder";t.Body.ReturnRootFolder=!0;t.Body.SyncState=this.e.State||"";t.Body.ReturnPeopleIKnowFolder=!0;t.Body.FolderToMoveToTop=_h.bD.a(_h.a.r);var i=new _gg.Cw(this.L);n.iH(t,i,this.J,this.H)}};_w.bp=function(n,t,i){_w.bp.initializeBase(this,[n,t,i]);this.E=[];this.F=[]};_w.bp.prototype={E:null,F:null,S:0,G:null,g:function(){return 2},cI:function(n){return n.IncludesLastFolderInRange},cM:function(n){n(new _w.bo(this.A()))},cQ:function(){return new _bs.dt(this.y.a().c(),this.E,this.G,this.S)},cK:function(){return null},cL:function(){return new SyncState("FolderHierarchySyncStateId","")},L:function(n){if(!this.v.RootFolder)throw Error.invalidOperation("Server returned null value for RootFolder in the SyncFolderHierarchy response. That should never happen");_bs.I.c(this.v.RootFolder,0);Array.add(this.E,this.v.RootFolder);for(var r={},f=this.v.Changes.Changes,t=0;t<f.length;t++){var e=f[t];switch(e.ChangeType){case"Create":case"Update":var i=e.Folder;if(i.DistinguishedFolderId==="outbox"){this.G=i.FolderId.Id;this.S=t+1}_bs.I.c(i,t+1);Array.add(this.E,i);r[i.FolderId.Id]=!0;break;case"Delete":break}}this.x(String.format("Number of created/updated folders = {0} and number of deleted folders = {1}",this.E.length,this.F.length));var o=this,u=this;this.z.b.l(r,function(){_w.k.prototype.L.call(o,n)},function(t){u.Q("An error occured during updating the sync folder settings: {0}",t.toString());_w.k.prototype.L.call(u,n)})},V:function(n){!n&&this.v&&this.w.c===1&&this.J().c(this.v);_w.k.prototype.V.call(this,n)},U:function(n){this.v&&!n&&this.J().c(this.v);_w.k.prototype.U.call(this,n)},I:function(){this.E=[];this.F=[];_w.k.prototype.I.call(this)}};_w.G=function(n,t){_a.b.a(n,"stepDelegate");this.f=n;this.d=t;this.g()};_w.G.prototype={f:null,d:null,e:0,a:null,c:0,b:!1,i:function(){return this.b&&this.c<_h.z.d},h:function(){this.e=0;this.a=null},g:function(){this.c=0;this.b=!0;this.h()}};_w.ck=function(n,t){_a.b.a(t,"ExternalSyncDependencies");this.b=t;this.a=n||new _bs.bQ(this.i(),this.d())};_w.ck.prototype={a:null,b:null,k:!0,i:function(){return this.b.e()},w:function(n){return this.I(n)},A:function(){return!0},q:function(n){var t=_a.g.k;return t.bp===n},B:function(){return!1},z:function(){return!1},v:function(){return!1},y:function(){return!1},p:function(){return!1},j:function(n){return!1},x:function(){return!1},G:function(n){var t=!1;switch(n){case 1:t=!0;break;case 2:t=this.u();break;case 4:t=this.h();break;case 3:t=this.H();break;default:break}return t},u:function(){return!1},h:function(){return!1},H:function(){return!1},r:function(n,t,i){n.f(this)?this.c(n,t,i):i(null)},E:function(n,t){var i=this,r=this;this.a.d(function(r){var u=i.g(n,r);t(u)},function(){t(!1)})},F:function(n,t){var i=this,r=this;this.a.d(function(r){var f=i.g(n,r);var u=i.s(n,r);t(f,u)},function(){t(!1,null)})},t:function(){return _a.d.get_utcNow().h()},g:function(n,t){return t.IsSynced},s:function(n,t){return t.ModuleSpecificContext},I:function(n){var i=this.b.a.F(this.d());if(n!==100){var t=_h.z.b[this.f()];t||n!==5||this.k||(t=_h.z.e);return this.f()===1&&(this.k||n===2||n===7||n===8||n===9||n===11)||_a.d.a().h()-i>t}else return!0}};_w.bG=function(n,t){_w.bG.initializeBase(this,[n]);this.f=t};_w.bG.prototype={f:null,K:function(n){var t=new _gg.kF(50);t.SyncState=this.e.State||"";t.JumpHeaderValues=this.f;t.MaxPersonas=5e3;var r=new _gg.kE(this.M(),t);var i=new _gg.CJ(this.L);n.iJ(r,i,this.J,this.H)}};_w.bH=function(){_w.bH.initializeBase(this,[null])};_w.bH.prototype={K:function(n){var t=new _gg.lQ(this.L);n.D(t,this.J,this.H)}};_w.bI=function(n,t,i){_w.bI.initializeBase(this,[n,t,i])};_w.bI.prototype={g:function(){return 7},cI:function(n){return!0},cL:function(){return new SyncState("PeopleFiltersSyncStateId","")},cM:function(n){n(new _w.bH)},O:function(n){return n===2},cQ:function(){this.x(String.format("Number of created/updated people filters = {0}",this.v.length));return new(_bs.bM.$$(_bc.H,_g.hi))(this.y.a().o(),this.v)},cK:function(){return new _bs.ch(this.y.a().o())},N:function(n){var t=this;_w.n.b(this.z.e(),function(){_w.k.prototype.N.call(t,n)})}};_w.bJ=function(n,t){_w.bJ.initializeBase(this,[n,t])};_w.bJ.prototype={f:function(){return 1},c:function(n,t,i){i([new _w.bI(n,t,this.a)])},e:function(n){return!1},h:function(){return!0},d:function(){return"PeopleFiltersSyncStateId"}};_w.bK=function(n,t,i,r,u){this.be=Function.createDelegate(this,this.bu);_w.bK.initializeBase(this,[n,t,i]);this.E=u;this.F={};this.S=0;this.T=0;this.bd=r;this.E.h(_a.ev,1)&&this.cY(this.be,"CheckWhetherToSyncNABContactsStep")};_w.bK.prototype={F:null,T:0,S:0,G:0,bd:null,E:null,g:function(){return 8},O:function(n){return n===2},cI:function(n){return n.IncludesLastItemInRange},bo:function(n){if(n.UserCultureAtLastSync&&n.UserCultureAtLastSync!==this.z.o){this.D(String.format("User culture has changed from '{0}' to '{1}', existing personas will be wiped",n.UserCultureAtLastSync,this.z.o));this.G=1;var t=this;this.y.b(3,this.cK(),function(){n.State="";t.bs(n)},this.W)}else this.bs(n)},cM:function(n){var t=this.bK()?null:this.bi();n(new _w.bG(this.A(),t))},bb:function(){var n=this.C();n.b(this.T);n.c(this.S);n.a.wr=this.G},bg:function(){return new _w.bL(this.g())},cQ:function(){return new _bs.dq(_bs.A.a(this.y.a()),new _bs.E(this.y.a()),this.y.a().m(),this.y.a().s(),this.v.People,this.v.DeletedPeople,this.bt(this.v.JumpHeaderSortKeys))},L:function(n){if(this.A().SortKeyVersionAtLastSync!==SyncState.a&&this.v.SortKeyVersion!==this.A().SortKeyVersionAtLastSync){this.D(String.format("Sort key version has changed from '{0}' to '{1}', existing personas will be wiped",this.A().SortKeyVersionAtLastSync,this.v.SortKeyVersion));this.G=4;var r=this;this.y.b(3,this.cK(),function(){r.v.SyncState="";r.v.IncludesLastItemInRange=!1;_w.k.prototype.L.call(r,n)},this.W);return}this.T+=this.v.People.length;this.S+=this.v.DeletedPeople.length;for(var t=0;t<this.v.People.length;++t)for(var i=0;i<this.v.People[t].FolderIds.length;++i)this.F[this.v.People[t].FolderIds[i].Id]=!0;this.x(String.format("Number of created/updated persona = {0} and number of deleted persona = {1}",this.v.People.length,this.v.DeletedPeople.length));_w.k.prototype.L.call(this,n)},X:function(n){var t=n;if(t.n()==="ErrorFullSyncRequiredException"||t.n()==="ErrorTooManyContactsException"){_w.a.a("Sync action failed with {0}, wiping the persona store",t.n());this.G=t.n()==="ErrorFullSyncRequiredException"?2:3;var i=this;this.y.b(3,this.cK(),function(){i.A().State="";_w.k.prototype.X.call(i,n)},this.W)}else _w.k.prototype.X.call(this,n)},V:function(n){if(n===1&&_ff.i.a(this.F)>0&&(this.w.h||!this.bc)){var r=[];var i=this.F;for(var t in i){var u={key:t,value:i[t]};Array.add(r,u.key)}this.x("Raising Persona notification for people synced folders");this.bh(r)}_w.k.prototype.V.call(this,n)},U:function(n){if(n===2||n===1){this.x("Raising Persona notification for people all folders");this.bh(this.bd)}_w.k.prototype.U.call(this,n)},cL:function(){var n=new SyncState("PeopleSyncStateId",this.v.SyncState);n.UserCultureAtLastSync=this.z.o;n.SortKeyVersionAtLastSync=this.v.SortKeyVersion;return n},cK:function(){return new _bs.dn(_bs.A.a(this.y.a()))},R:function(){this.E.b(this.E.g())&&this.E.g().a().a()===1&&this.E.g().h();_w.bz.prototype.R.call(this)},bu:function(){var n=this;var t=function(t){t?n.H():n.n(Error.create("SyncPeople module stopped to wait for NAB contact sync to complete."))};this.x("Raising SyncPeopleModuleStartingEvent");this.z.c.a(_h.dh,new _h.dh(t))},bs:function(n){_w.bz.prototype.bo.call(this,n)},bh:function(n){n.length?this.J().d(n):this.Q("Contacts folder list should not be empty","")},bt:function(n){var i=null;if(n){var r=this.bi();i={};for(var t=0;t<n.length;++t)i[r[t]]=n[t]}return i},bi:function(){return _a.v.a().culture().people.headerSeekToValues},bK:function(){return!_j.h.a(this.A().State)}};_w.n=function(n,t){_w.n.initializeBase(this,[n,t]);_a.b.a(t.h,"NativeBridge should not be null.")};_w.n.b=function(n,t){_bs.bA.a(new(_bs.bO.$$(_bc.H,_bs.bA))(n,_bs.f.b),function(i){for(var u=[],r=0;r<i.length;++r)if(_j.h.a(i[r].getFolderId()))_w.a.b("PeopleFilterItem entry folderId is empty");else{_w.a.a("Caching contacts folder '{0}' ",i[r].getFolderId());Array.add(u,i[r].getFolderId())}_bs.I.a(new _bs.bm(n,_bs.f.b),"recipientcache",function(n){if(n){var i=n.a().toString();if(_j.h.a(i))_w.a.b("RecipientCacheFolderItem folderId is empty");else{_w.a.a("Cacheing recipient cache folder '{0}'.",i);Array.add(u,i)}}else _w.a.b("RecipientCacheFolderItem is null");_w.n.a=u;t()},function(n){_w.a.d("Failed to fetch the recipient cache folder. Error: {0}",n);t()})},function(n){_w.a.d("Failed to get all folders. Error: {0}",n);t()})};_w.n.prototype={f:function(){return 1},c:function(n,t,i){i([new _w.bK(n,t,this.a,_w.n.a,this.b.h)])},e:function(n){_w.a.a("Checking if sync people should occur for folder '{0}'",n);return Array.contains(_w.n.a,n)},h:function(){return!0},x:function(){return!0},d:function(){return"PeopleSyncStateId"}};_w.bP=function(n,t,i){_w.bP.initializeBase(this,[n,t,i])};_w.bP.prototype={g:function(){return 3},cI:function(n){return!0},cM:function(n){var t=!this.z.k.c()||this.z.s.a().w().Enabled;n(new _w.bO(this.A(),t))},O:function(n){return n===1},bb:function(){this.v&&this.C().b(this.v.Reminders.length)},cQ:function(){this.x(String.format("Number of created reminders = {0}",this.v.Reminders.length));return new(_bs.bM.$$(_bc.Y,_g.dF))(this.y.a().g(),this.v.Reminders)},cK:function(){return new _bs.ch(this.y.a().g())},V:function(n){n===1&&this.v&&this.v.Reminders.length>0&&(this.w.h||!this.bc)&&this.J().b();_w.k.prototype.V.call(this,n)},U:function(n){(n===2||n===1)&&this.J().b();_w.k.prototype.U.call(this,n)},Z:function(n){if(this.w.c===1){this.x("Generating reminder notification on sync aborted");this.J().b()}_w.k.prototype.Z.call(this,n)},cL:function(){return new SyncState("RemindersSyncStateId","")}};_w.bO=function(n,t){_w.bO.initializeBase(this,[n]);this.f=t};_w.bO.prototype={f:!1,K:function(n){var i=this.j();var t=new _g.hg(this.L);n.F(i,t,this.J,this.H)},j:function(){var n=new _g.ey(this.M());var t=_a.d.a().c(14);n.Body.EndTime=_a.d.d(t);n.Body.ReminderType=0;n.Body.MaxItems=_bs.J.a;this.f||(n.Body.ReminderGroupType=0);return n}};_w.bQ=function(n,t){_w.bQ.initializeBase(this,[n,t])};_w.bQ.prototype={f:function(){return 0},c:function(n,t,i){i([new _w.bP(n,t,this.a)])},e:function(n){return!1},B:function(){return!0},j:function(n){return n==="Reminders"},d:function(){return"RemindersSyncStateId"}};_w.a=function(){};_w.a.c=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t]};_w.a.a=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_j.e.a(_w.b.a,n,i)};_w.a.b=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_j.e.b(_w.b.a,n,i)};_w.a.d=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];_j.e.c(_w.b.a,n,i)};_w.z=function(n,t){_w.z.initializeBase(this,[2,0,!0,t]);this.g=n};_w.z.prototype={g:0,e:function(){return"TimeBasedSyncContextId"},f:function(n){return n.q(this.g)}};_w.b=function(n,t,i,r){this.U=Function.createDelegate(this,this.cd);this.br=Function.createDelegate(this,this.bT);this.bi=Function.createDelegate(this,this.bR);this.bj=Function.createDelegate(this,this.bS);this.bf=new Sys.EventHandlerList;this.bl=new _w.O(_w.b.c,_w.b.b);_w.b.initializeBase(this);_a.b.a(n,"ExternalSyncDependencies");_a.b.a(i,"taskRunner");this.C=n;this.K=-1;this.H=i;this.J=r;_h.z.a=t;_w.a.a("SyncSettings IsEnabled :"+_h.z.a);_bs.b.g(this.bj);n.l().g(this.bi);n.a.z(this.br);n.f.w(this);this.bk=new _w.l(n.f,n.c,this,this.C.d);this.S=new Array(0);this.bc=new _w.bk(this,n.c,n.t(),_a.z.a,n.b);this.M=new _w.bM(this,this.h());this.Q=new _bs.bE(n.g);_h.k.k(n.q);n.r.b(this);this.bG()};_w.b.prototype={C:null,H:null,J:null,W:null,bp:288e5,bt:144e5,bB:6048e5,E:null,M:null,bh:null,Z:!1,Y:!1,be:!1,K:0,O:null,bq:null,bo:null,P:null,bd:null,N:!1,G:0,bb:null,bc:null,bg:!1,S:null,Q:null,L:null,bz:!1,bk:null,V:null,q:function(){return!!this.E&&this.E.k()},p:function(){return this.E.a()},j:function(){return!!this.bh},b:function(){return!this.X().a()},h:function(){return this.C.n.a()},F:function(){this.W||(this.W=this.bH());return this.W},k:function(){return this.C.e()},r:function(){if(this.K===-1){var n=this.C.g.b("MaxSyncModuleType");this.K=_j.h.a(n)?14:parseInt(n)}return this.K},bF:function(n){_a.b.e(n,0,14,"MaxSyncModuleType");this.K=n;this.C.g.a("MaxSyncModuleType",n.toString());_w.a.a("Set local storage maxSyncModuleType = {0}",n);return n},bm:function(){_j.h.a(this.O)&&(this.O=this.C.g.b("FirstQuotaExceededErrorTime"));return this.O},bE:function(n){if(_j.h.a(n)){this.C.g.c("FirstQuotaExceededErrorTime");this.O=n}else{_a.d.b(n);this.O=n;this.C.g.a("FirstQuotaExceededErrorTime",n);_w.a.a("Set local storage FirstQuotaExceededErrorTime = {0}",n)}return n},X:function(){this.bd||(this.bd=this.bI());return this.bd},t:function(){return this.bb},s:function(){return this.C.f},u:function(){return this.C.n},bx:function(){return _a.d.get_utcNow().h()},by:function(){this.P||(this.P=this.bJ());return this.P},bw:function(){return this.C.l()},c:function(n,t){_a.b.b(n,"type");_a.b.b(t,"handler");this.bf.addHandler(_a.bw.toString(n).toLowerCase(),t)},g:function(n,t){_a.b.b(n,"type");_a.b.b(t,"handler");this.bf.removeHandler(_a.bw.toString(n).toLowerCase(),t)},x:function(){_j.e.a(_w.b.a,"Starting the sync manager, PALEnabled: {0}, BackgroundBoot: {1}",this.C.k.c(),this.C.h.p());this.bb=_a.d.o(_a.d.a());if(!_h.z.a){_j.e.a(_w.b.a,"Sync is disabled");return}this.bz=!0;this.C.k.c()&&this.C.h.p()||this.C.r.a(1);this.cc();this.C.k.c()||this.bX();this.bc.a()},n:function(n){_a.b.a(n,"onSyncStopped");_w.a.a("Stopping");_h.z.a=!1;this.l();if(this.j()){_w.a.a("Wait for sync complete");if(this.E)_w.a.a("The current sync module : {0}, StartTime {1}",this.E.a(),this.E.m());else{var t=new Sys.StringBuilder;t.appendLine("SyncSession is on while currentSyncModule is null.");t.appendLine(String.format("SyncTimerCallbackInvoked:{0}",this.bg));t.appendLine(String.format("SyncModuleLogForCurrentSyncSession:{0}",this.S));_w.a.b(t.toString())}var i=this;this.c(20,function(t){t.a===5&&n()})}else n()},a:function(n,t,i){_a.b.a(t,"context");_a.b.a(i,"syncStatusCallback");this.F()[n].E(t,i)},i:function(n,t,i){_a.b.a(t,"context");_a.b.a(i,"syncStatusCallback");this.F()[n].F(t,i)},v:function(n,t,i){this.bC(n);var r=null;r=this.F()[n];r.C(t,i)},w:function(n,t){_a.b.d(_bc.i.isInstanceOfType(t),"The context type should match the module.");var r=t;_a.b.a(r.FolderId,"Invalid call to IsSynced with no folder ID specified.");this.bC(n);_j.e.a(_w.b.a,"Removing Folder {0} SyncState for module {1}",r.FolderId.Id,_a.bw.toString(n));var i=null;i=this.F()[n];i.D(t)},bS:function(){_w.a.a("OnQuotaExceeded");_j.h.a(this.bm())&&this.bE(_a.d.a().i());this.Z=!0;this.E&&this.E.f()||this.bs()},f:function(n,t){_a.b.a(n,"syncContext");if(!_h.z.a||n.a()&&!_w.s.isInstanceOfType(n))return!1;for(var i=0;i<this.r();i++){this.F()[i]||_w.a.d("One of the factories is null @ {0} index, there are total {1} factories",i,this.F().length);if(n.f(this.F()[i])&&!_w.u.isInstanceOfType(this.F()[i])){var r=_w.y.isInstanceOfType(this.F()[i])||_w.w.isInstanceOfType(this.F()[i])||_w.x.isInstanceOfType(this.F()[i])||_w.v.isInstanceOfType(this.F()[i]);return r&&!t?!1:!0}}return!1},e:function(n){_a.b.a(n,"syncContext");_w.a.a("Starting {0} sync",_a.cF.toString(n.b()));this.ce(n)},B:function(){_w.a.a("Handling user refresh event");this.e(new _w.t(this.C))},y:function(){this.e(new _w.R(this.C))},z:function(){this.e(new _w.P(this.C))},d:function(n){if(!_h.z.a){_j.e.a(_w.b.a,"Sync is disabled");return}this.L=this.L||_j.n.b(_a.a.cZ,517,"Sync",1);_a.j.bm(_a.cS.toString(n));_a.j.bn(_a.cF.toString(1));_a.j.bk(_a.j.a());_w.a.a("Starting full sync {0}",_a.cS.toString(n));this.N=!1;var t=this;this.bU(function(){t.R(new _w.o(t.C,n),function(){t.bD(function(){t.ba(0,1)})})})},bX:function(){_w.a.a("Schedule periodic sync, cleanup and reconcilation...");this.bq=this.bZ(this.bp);this.bo=this.bY(this.bt)},m:function(n){this.e(new _w.f(n,!0,this.C))},A:function(){this.L=_j.n.b(_a.a.cZ,517,"Sync",1);_a.j.bn(_a.cF.toString(6));_a.j.bk(_a.j.a());this.e(new _w.i(this.C))},o:function(){if(!_h.z.a){_w.a.a("Enable sync manager");_h.z.a=!0;this.l();this.d(2)}},l:function(){_j.e.a(_w.b.a,"Resetting sync state");this.bW();this.M.h()},D:function(){_w.a.c("SyncManager is disposing");this.bk.dispose();this.bc.dispose();_bs.b.i(this.bj);this.bw().q(this.bi);this.H.b(this.bq);this.H.b(this.bo);this.cf();this.C.f.A(this);this.P=null},bH:function(){var n=new Array(15);n[0]=new _w.bF(null,this.C);n[1]=new _w.bU(null,this.C);n[2]=new _w.bq(null,this.C);n[3]=new _w.bQ(null,this.C);n[4]=new _w.w(null,this.C,this.J);n[5]=new _w.y(null,this.C,this.J);n[6]=new _w.bn(null,this.C);n[7]=new _w.bJ(null,this.C);n[8]=new _w.n(null,this.C);n[9]=new _w.Y(null,this.C);n[10]=new _w.g(null,this.C,this.J);n[11]=new _w.v(null,this.C,this.J);n[12]=new _w.x(null,this.C,this.J);n[13]=new _w.bC(null,this.C);n[14]=new _w.u(null,this.C);return n},bJ:function(){var n=new Array(6);n[0]=new _w.br(this.k(),this,this.C);n[1]=new _w.bN(this,this.C);n[2]=new _w.bR(this,this.C);n[3]=new _w.ba(this,this.C);n[4]=new _w.Z(this,this.C);n[5]=new _w.U(this,this.C);return n},bI:function(){return _w.H.a(this.C.a,this.C.c)},bY:function(n){var t=this;return this.H.e(_w.b.a,"CleanupAndReconcilation",function(){_h.z.a&&t.bD(function(){t.ba(0,4)})},n)},bD:function(n){var t=this;this.bK(function(){t.bL(function(){n()})})},cd:function(n){_a.b.a(n,"e");this.bA(n);if(n.a===1||n.a===2||n.a===6||n.a===3)if(this.E){if(n.e!==this.E.b()){_w.a.b("Ignore event {0} from moduleId {1}  since it is different from currentSyncModuleId:{2}",_a.cs.toString(n.a),n.e,this.E.b());return}}else{_w.a.b("Ignore event {0} from moduleId {1}  since CurrentSyncModule is null",_a.cs.toString(n.a),n.e);return}if(n.a===6)this.bV(n);else if(n.a===3){var t=this.F()[n.c];t&&(t.k=!1);this.T()}},cc:function(){for(var i=this.by(),u=i.length,t=0;t<u;++t){var r=i[t];var n=r;this.C.f.v(r.b(),n.a||(n.a=Function.createDelegate(n,n.c)))}},cf:function(){if(this.P)for(var t=this.by(),r=t.length,n=0;n<r;++n){var i=t[n];this.C.f.z(i.b())}},ce:function(n){if(!_h.z.a){_j.e.a(_w.b.a,"Sync is disabled");return}var t=this;this.R(n,function(){t.ba(n.i()?500:0,n.c)})},R:function(n,t){_a.b.b(n,"context");_j.e.a(_w.b.a,"Populating sync modules with MaxSyncModule = {0}",this.r());var i=this.C.b.d(this.C.i().Id);this.bv(0,this.X().b(n,this.r(),i,this.h()),n,t)},bU:function(n){var i=this.Q.g(this.bb);if(!i||!i.length){n();return}for(var e=0,s=this,h=function(n){_j.e.a(_w.b.a,"Removing {0} from ConfigCleanup list",_a.bw.toString(n));s.Q.d(n)},o=new _w.d(4,this.C,h),u=i,c=u.length,r=0;r<c;++r){var t=u[r];var f=this;this.F()[t].r(o,this.U,function(r){if(r&&r.length&&r[0])for(var o=r,h=o.length,u=0;u<h;++u){var s=o[u];_j.e.a(_w.b.a,"Enqueuing {0} for ConfigChangeCleanup",_a.bw.toString(t));f.M.f(s)}else{_j.e.b(_w.b.a,"We can't get the CleanupModule base on SyncModuleType {0}",_a.bw.toString(t));f.Q.d(t)}++e===i.length&&n()})}},bC:function(n){switch(n){case 5:case 12:case 4:case 11:break;default:throw Error.invalidOperation("We don't support VerifyEmailModuleFactory for "+_a.bw.toString(n));}},bR:function(n,t){_w.a.a(Object.getType(n).getName()+"."+t+" changed");this.bw().c()&&this.E&&this.E.i()},bs:function(){if(this.Y){_w.a.a("Quota cleanup already in progress");return}if(this.r()<=5){_w.a.a("Reached minimum module limit for cleanup");if(this.C.d.b()){var t=new _a.br(1,"FatalQuotaError",_a.d.a());this.C.d.a(t)}this.C.c.a(_h.cQ,new _h.cQ);this.bn()}else{_w.a.a("Start cleanup");this.Y=!0;var n=this;this.bO(this.r(),function(t){t.u(function(){_w.a.a("Quota Cleanup Succeeded, Module: {0}",t.a());n.bF(n.r()-1);n.bn();if(n.C.d.b()){var i=new _a.br(1,"QuotaExceededError",_a.d.a());n.C.d.a(i)}n.C.b.h(_a.bw.toString(n.r()),_a.z.a,!0)},function(i){_w.a.d("Quota Cleanup Failed, Module: {0}, Exception:{1}",t.a(),i.message);n.bn()})})}},bV:function(n){this.C.a.c()&&_w.a.b("Aborted syncing the module Id {0} due to error: {1} ",n.e,n.d?n.d.message:"");if(!this.C.a.b()&&!this.N){var t=n.d;if(t)t.responseCode!=="ErrorTooManyContactsException"&&(this.N=!0);else{_w.a.b("Can't cast error to ActionRecord for module {0}",n.c);this.N=!0}}if(this.E.j()){this.E.q(!1);this.M.f(this.E)}this.T()},ba:function(n,t){if(this.j()){if(this.E&&!this.E.f()){_w.a.b("Module {0} is not active, lastHeartBeatTime = {1}. SyncManager continues to sync the next module.",this.E.a(),this.E.e());this.E.n(Error.create(String.format("Aborted by sync manager due to inactive,lastHeartBeatTime={0}, IsWaitingForActionQueue={1},IsHighPriorityActionEnqueued={2}",this.E.e(),this.E.l(),this.C.l().a())))}}else{var i=this;this.bh=this.H.a(_w.b.a,"SyncNextModule",function(){i.bg=!0;_w.a.a("Start a new sync session");i.G=t;(1===i.G||2===i.G||4===i.G)&&(i.V=_a.c.b(_w.b.a,i.bN(),!1,null));i.T()},n)}},T:function(){if(this.Z){this.E=null;this.be=!0;this.bs()}else{_w.a.a("Syncing next module");this.E=this.M.i();if(!this.E){this.bu(5,null);return}Array.add(this.S,this.E.a());this.cb()}},cb:function(){var n=this.E.a();if(this.E.g()<=this.r()||this.E.h()){var t=Math.floor(_a.d.a().h()/6e4);if(this.bl.e(t)){this.bl.f(t);var r=this;this.H.c(_w.b.a,"SyncStartCurrentModule_"+n,function(){_j.e.a(_w.b.a,"{0}: Starting module {1}",_a.d.a(),n);_a.j.br(_a.j.a());r.E.t()})}else{_w.a.b("Aborted module {0}, TrackingId {1} due to sync frequency throttling",n,this.E.c());if(this.C.d.b()){var i=new _a.br(1,"FrequencyThrottlingModuleAborted",_a.d.a());this.C.d.a(i)}this.E.d();this.bu(6,null)}}else{_w.a.b("Aborted module {0}, TrackingId {1} because it is higher than the MaxSyncModuleType {2}",n,this.E.c(),this.r());this.E.d();this.T()}},bu:function(n,t){_w.a.a("Sync session completed");this.ca();this.bQ();if(1===this.G||2===this.G||4===this.G){_a.c.a(this.V);this.V=null}1!==this.G||n!==5||this.N||this.X().d();this.bP(n,t)},bQ:function(){if(this.L&&(this.G===6||this.G===1)){_j.n.a(this.L);this.L=null}},ca:function(){this.bh=null;this.bg=!1;Array.clear(this.S)},bv:function(n,t,i,r){var u=this;this.F()[t[n]].r(i,this.U,function(f){if(f)for(var o=f,h=o.length,e=0;e<h;++e){var s=o[e];u.M.f(s)}++n<t.length?u.bv(n,t,i,r):r()})},bA:function(n){_a.b.b(n,"e");_a.b.b(n.c,"e");_a.b.b(n.a,"e.ModuleType");_w.a.c("Module {0}, TrackingId {1}, Event {2}",n.c,n.i,_a.cs.toString(n.a));var t=this.bf.getHandler(_a.bw.toString(n.c).toLowerCase());if(t){_w.a.a("Invoke sync progress event handler for moduleType: {0}, eventType: {1}, InitiatorId: {2}",_a.bw.toString(n.c),_a.cs.toString(n.a),n.g);t(n)}},bP:function(n,t){_w.a.c("Receiving sync completed event");var i=_a.dP.b(n,t);this.bA(i)},bn:function(){this.Z=!1;this.Y=!1;if(this.be){_w.a.a("Resuming sync after quota cleanup");this.be=!1;this.T()}},bO:function(n,t){if(n===15||n===16||n===17||n===18||n===19)throw Error.argumentOutOfRange("ItemsMinimum and ItemsFull do not have factories and hence should never be provided to this method");var r=this.F()[n];var f=this;var i=new _w.d(1,this.C,function(n){});var u=this;r.r(i,this.U,function(n){t(n[0])})},bZ:function(n){var t=this;return this.H.e(_w.b.a,"SyncTimeBased",function(){_h.z.a&&t.bM(n,function(){t.ba(0,2)})},n)},bM:function(n,t){_w.a.a("Populate time based sync with period {0}",n);var i=this;this.R(new _w.z(n,this.C),function(){t()})},bK:function(n){_w.a.a("Populate periodic cleanup modules");var i=this,t=this;this.R(new _w.d(2,this.C,function(n){}),function(){n()})},bL:function(n){_w.a.a("Populate periodic reconcile modules");var t=this;this.R(new _w.bW(this.C),function(){n()})},bT:function(n){n||this.X().c()},bW:function(){if(!_j.h.a(this.bm())&&_a.d.a().h()>_a.d.b(this.bm()).l(this.bB).h()){_j.e.a(_w.b.a,"Reseting MaxSyncModule to its default value");this.bF(14);this.bE(null);if(this.C.d.b()){var n=new _a.br(1,"MaxSyncModuleReset",_a.d.a());this.C.d.a(n)}}},bN:function(){return 1===this.G?"Core.Models.Sync.Full":3===this.G?"Core.Models.Sync.NotificationBased":2===this.G?"Core.Models.Sync.TimeBased":"Core.Models.Sync.Cleanup"},bG:function(){this.C.a.n()||this.C.a.q(this.bx()+144e5);this.C.a.m()||this.C.a.p(this.bx()+288e5)}};_w.D=function(n,t,i,r){_w.D.initializeBase(this,[n,t,i,r]);for(var u=null,f=new Array(0),s=t,h=s.length,e=0;e<h;++e){var o=s[e];o===_g.b.a.nameToId("sentitems").Id?u=o:Array.add(f,o)}if(u)if(f.length)if(this.z.i().Id===u){this.G=[u];this.S=f;this.bd=!0}else{this.G=f;this.S=[u];this.bd=!0}else{this.G=[u];this.bd=!1}else{this.G=f;this.bd=!1}};_w.D.prototype={bd:!1,F:null,S:null,g:function(){return 11},bh:function(){return this.bd},bZ:function(){return!this.S&&this.v.IncludesLastItemInRange},cI:function(n){if(n.IncludesLastItemInRange)if(this.S){this.G=this.S;this.S=null;return!1}else return!0;else return!1},cK:function(){this.F=new _bs.dc(this.w.g,this.y.a(),"ConversationSyncStateId","MessageSyncStateId",_g.b.a,this.z.d,_h.k.c,_h.k.e,this.z.g);return new _bs.T(this.F)},N:function(n){this.bu();_w.cf.prototype.N.call(this,n)},cm:function(){if(this.w.c===4&&this.w.g===2){var n=this.bA()+144e5;this.z.a.q(n);this.x(String.format("Next email cleanup time {0} utc ms",n))}_w.k.prototype.cm.call(this)},bu:function(){if(this.F){var n=_a.d.a();this.F.a.q(n.h()-this.F.c);var t=String.format("{0}, TT:{1}(ms), TTBT={2}, C={3}, CNC={4}, CN={5}, M={6}, TS={7}, I={8}",_a.d.d(n),this.F.a.m(),this.F.a.s(),this.F.a.c(),this.F.a.f(),this.F.a.e(),this.F.a.b(),this.F.a.g(),this.F.a.r());this.F.l.a("LastSuccessfullEmailCleanup",t);_j.e.a(_a.a.Q,"Completed full email cleanup, time taken {0} ms",this.F.a.m());this.F.o()}}};_w.cc=function(n,t,i,r){this.bZ=Function.createDelegate(this,this.cF);this.S=[];this.bs=_a.I.a();this.T=[];this.bt={};_w.cc.initializeBase(this,[n,t,i]);this.bK=r};_w.cc.prototype={bK:null,bh:0,bd:function(){return this.G()},cM:function(n){var t=this.cD();_w.a.a("Creating SyncConversationItems action for {0} items",t.length);var u=_h.b.r();var r=_h.k.j?"ItemPartNormalizedBody":"ItemPart";var i=new _w.bd(t,20,u,r,0);n(i)},cK:function(){return null},cQ:function(){return new _bs.ds(this.y.a(),this.F,this.S,this.bs,this.bi)},L:function(n){this.x("Process current SyncConversationItems response");for(var h={},s=!1,o=0;o<this.v.length;o++){var c=this.v[o];if(c.ResponseClass!=="Success"){s=!0;continue}var i=c.Conversation;h[i.ConversationId.Id]=!0;if(i.ConversationNodes){this.cC(i);Array.add(this.F,i);for(var l=i.ConversationNodes,y=l.length,f=0;f<y;++f){for(var u=l[f],r=0;r<u.Items.length;r++){var t=u.Items[r];if(_g.b.a.doesIdEqualName(t.ParentFolderId,"drafts")){var e=t.ItemId.Id;if(!this.bt[e]){this.bt[e]=!0;var v=new _g.e(e);Array.add(this.T,v)}}_j.e.a(_w.b.a,"Setting item IsDataSynced flag to true for conversation item parts");_bs.U.a(t,"",1);var a=_bs.bl.a(t);Array.add(this.S,t);this.bs.a(t.ItemId.Id,!0);u.Items[r]=a}this.bh+=u.Items.length}}this.E++}s&&this.cb(this.bd(),h);this.cc(this.S);_w.k.prototype.L.call(this,n)},cL:function(){return new ConversationItemSyncState(this.bd(),null,null)},bg:function(){return new _w.bg(this.g())},bb:function(){var n=this.C();n.a.cis=this.E;n.g(this.bh);_w.a.a(this.a()+" module data point: Synced "+this.E+" conversations and "+this.bh+" item parts")},I:function(){this.S=[];this.bs=_a.I.a();this.T=[];this.bt={};_w.F.prototype.I.call(this)},cG:function(n){return n?_h.k.j?n.IsInlineToNormalBody:n.IsInlineToUniqueBody:!1},cS:function(){this.cE()},cE:function(){if(!this.T||!this.T.length){this.H();return}var n=new _w.q(this.g(),this.T,_h.b.R(this.bK.b()),"EditableItems");n.b(this.bZ);n.c(this.bN);_a.g.a.a(n)},cF:function(n){for(var i=n.e,r=0;r<i.length;r++){var t=i[r].Items;if(t&&t.length>0){_j.e.a(_w.b.a,"Setting item IsDataSynced flag to true for editable items");_bs.U.a(t[0],"",2);Array.add(this.S,t[0])}}this.bh+=i.length;this.H()},cD:function(){for(var u=Math.min(_h.k.d,this.bd().length),r=new Array(u),n=0;n<u;n++){var t=this.bd()[n];var i=new _g.cB(t);i.SyncState=this.ca().b[t.Id]||"";r[n]=i}return r},cC:function(n){var t=n.ConversationId.Id;var i=this.ca().c;if(!i[t])throw Error.invalidOperation("Last modified time for conversation not available. This should never happen. Conversation Id = "+t);n.LastModifiedTime=i[t]},ca:function(){return this.A()}};_w.bh=function(n,t,i,r){_w.bh.initializeBase(this,[n,[t],i,r])};_w.bh.prototype={g:function(){return 4},bh:function(){return!0},O:function(n){return this.w.c!==3&&!n},cI:function(n){return!0}};_w.cd=function(n,t,i,r){_w.cd.initializeBase(this,[n,t,i,r]);this.bs=t};_w.cd.prototype={bs:null,cM:function(n){this.G.length||_a.b.k("FoldersToSync",String.format("isPartialList:{0}, actualList:{1}",this.bh(),this.bs.toString()));var t=new _w.bc(this.G,this.A(),_h.k.g,this.bh(),_w.i.isInstanceOfType(this.w));n(t)},cQ:function(){return new _bs.bT(this.y.a().d(),this.E.c,this.E.b)},L:function(n){this.E=new _w.bi(this.v);this.E.h();var r=this.E.c.length;this.bi+=this.E.b.length;if(r>0){this.be+=r;for(var i=this.E.a,t=0;t<i.length;t++)Array.contains(this.T,i[t])||Array.add(this.T,i[t])}_w.k.prototype.L.call(this,n)},cL:function(){var n=new SyncState("ConversationSyncStateId",this.E.k());this.bK(n,this.E.j(),this.A()?this.A().ModuleSpecificContext:null,this.G);return n},cK:function(){return null},bK:function(n,t,i,r){if(t)if(i){for(var s=t,l=t,b=l.length,o=0;o<b;++o){var u=l[o];u.LastSuccessfulSyncTime=_a.d.d(_a.d.a());u.SyncMinimum=_h.k.c;u.SyncMaximum=_h.k.b}for(var v=i,w=v.length,f=0;f<w;++f){for(var a=v[f],h=!1,c=t,p=c.length,e=0;e<p;++e){var y=c[e];if(y.FolderId.Id===a.FolderId.Id){h=!0;break}}h||Array.add(s,a)}n.ModuleSpecificContext=s}else n.ModuleSpecificContext=t;else n.ModuleSpecificContext=i}};_w.bj=function(n){_w.bj.initializeBase(this,[n])};_w.bj.prototype={g:function(n){n&&(this.a.fs=n.join())}};_w.bV=function(n,t,i,r,u,f){_w.bV.initializeBase(this,[1,"Core.Models.Sync.BackgroundCompleted"]);this.a.TAC=n;this.a.TCC=t;this.a.SI=i;this.a.TIS=r;this.a.RES=u;this.b(f/1e3)};_w.bV.prototype={b:function(n){this.a.MPTIS=n;return n}};_w.l=function(n,t,i,r){this.g=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_w.l.initializeBase(this);_a.b.a(n,"notificationHandler");_a.b.a(t,"eventAggregator");_a.b.a(i,"syncManager");_a.b.a(r,"dataPointTracker");this.b=t;this.c=n;this.d=i;this.h=r;this.a=_a.I.a();this.b.b(_e.g,this.f);this.c.u("BackgroundSyncNotification",_w.l.a,"BackgroundSyncNotification",this.e,2);this.d.c(20,this.g)};_w.l.prototype={c:null,b:null,d:null,h:null,a:null,D:function(){this.b.c(_e.g,this.f);this.c.y("BackgroundSyncNotification",this.e);this.d.g(20,this.g)},i:function(n){this.l(n)},l:function(n){var i=n;var t=i.c;var v=new Array(0);var y=new Array(0);var r=0,u=0;if(this.a.c(t)){var d=this.a.b[t];this.a.e(t);for(var w=_a.I.a(),p=d,g=p.length,f=0;f<g;++f){for(var a=p[f],l=a.b,nt=l.length,o=0;o<nt;++o){var h=l[o];++u<=5&&Array.add(y,h);w.a(h.c.toString(),!0)}for(var c=a.c,k=c.length,s=0;s<k;++s){var e=c[s];w.c(e.c.toString())?_j.e.a(_w.l.a,"Skip the later change with newly added Id: {0}",e.c.toString()):++r<=5&&Array.add(v,e)}}}_j.e.a(_w.l.a,"Raising BackgroundSyncCompleteEvent senderId:{0}, totalAddCount:{1}, totalChangeCount:{2}, Result:{3}",t,u,r,i.a);this.b.a(_a.ey,new _a.ey(t,i.a,y,v,r+u));var b=new _w.bV(u,r,t,_a.d.get_utcNow().h()/1e3,i.a,i.b);this.h.a(b)},j:function(n){_j.e.a(_w.l.a,"Receiving DbTransactionItemInfoEvent SyncInitiatorId:{0}, Add Count:{1}, Changes Count:{2}",n.a,n.b.length,n.c.length);var t;if(this.a.c(n.a)){t=this.a.b[n.a];Array.add(t,n)}else t=[n];this.a.a(n.a,t)},k:function(n){if(n.a===5&&this.a.f()>0){_j.e.b(_w.l.a,"ItemInfoCount= {0} when sync session completes",this.a.f().toString());this.a=_a.I.a()}}};function CoreSyncComponent(){}CoreSyncComponent.$$cctor=function(){_a.t.a().a(CoreSyncComponent)};CoreSyncComponent.prototype={b:function(n,t,i){var f=this;n.b(_w.e,function(){return new _w.e(n.a(_a.cw),n.a(_j.j))}).b(_h.cE).a();var u=this;n.b(_w.C,function(){return new _w.C(n.a(_j.j))}).b(_a.gf);n.e(_w.K).b(_a.fH);var r=this;n.b(_w.L,function(){return new _w.L(n.a(_h.cE),n.a(_a.gf),n.a(_a.cw),n.a(_h.bi),n.a(_a.D),n.a(_bc.S),_a.z.a,n.a(_j.o),n.a(_j.v),n.a(_j.j),n.a(_a.f),n.a(_a.y),n.a(_a.dr))}).b(_h.dH).b(_a.er).a()},a:function(){return[]}};_w.p=function(n,t,i,r,u,f){this.L=Function.createDelegate(this,this.W);this.P=Function.createDelegate(this,this.V);_w.p.resolveInheritance();this.u=this.a;this.y=this.b;_w.p.initializeBase(this,[n,t,i,r,u]);this.G={};this.F={};this.M=f;this.O=this.U();this.f().f(this.P);this.X()};_w.p.prototype={G:null,F:null,M:!1,O:null,N:0,m:function(){return this.M},e:function(){return this.N},x:function(n){this.N=n;return n},f:function(){return this.O},l:function(){return this.G},d:function(n){_a.b.a(n,"notification");_j.e.a(_a.a.C,"Handling notification: {0}, ClientGenerated: {1}",n.id,n.clientGenerated);if(!n.clientGenerated){var r=this.B[n.id];var t=null;r?t=this.F[r.d().toLowerCase()]:n.id==="BackgroundSyncNotification"&&(t=this.F[n.id.toLowerCase()]);if(t){var i=this;t(n,this,function(n){i.R(n,1);_no.g.prototype.d.call(i,n)});return}_j.e.a(_a.a.C,"No Sync callback registered for notification: {0}",n.id)}_no.g.prototype.d.call(this,n)},r:function(n){_j.e.a(_a.a.C,"[NotificationHandlerProxy::RegisterSubscription] Adding subscription id : {0}",n.a());this.S(n);_no.g.prototype.r.call(this,n)},V:function(n,t){_a.b.a(n,"notification");_a.b.g(n.clientGenerated,!0,"notification.ClientGenerated");(this.R(n,t)||!t)&&_no.g.prototype.d.call(this,n)},v:function(n,t){_a.b.c(n,"notificationType");_a.b.a(t,"callback");_j.e.a(_a.a.C,"Registering sync notification handler for notification type {0}",n);this.F[n.toLowerCase()]=t},z:function(n){_a.b.c(n,"notificationType");_j.e.a(_a.a.C,"Unregistering sync notification handler for notification type {0}",n);this.F[n.toLowerCase()]&&delete this.F[n.toLowerCase()]},w:function(n){_a.b.b(n,"syncManager");_j.e.a(_a.a.C,"Registering sync progress event handlers for all modules");for(var t=0;t<20;t++)n.c(t,this.L)},A:function(n){_a.b.b(n,"syncManager");_j.e.a(_a.a.C,"Unregistering sync progress event handlers for all modules");for(var t=0;t<20;t++)n.g(t,this.L)},J:function(n){var i=this.B[n];if(i&&this.Q(i)){var t=i.b();if(t&&this.G[t]){_j.e.a(_a.a.C,"Removing granular notification entry for folder id : {0}",t);delete this.G[t]}}_no.g.prototype.J.call(this,n)},D:function(){this.f().g();_no.g.prototype.D.call(this)},U:function(){return new _w.Q(50)},R:function(n,t){if(n.id==="BackgroundSyncNotification"){var i=n;i.a=t;return!0}return!1},W:function(n){_a.b.b(n,"e");this.f().e(n)},X:function(){var t=this.B;for(var n in t){var r={key:n,value:t[n]};var i=this.B[r.key];this.S(i)}},S:function(n){if(this.Q(n)){var t=n.b();if(t){_j.e.a(_a.a.C,"Granular notification is subscribed for folder id : {0}",t);this.G[t]=!0}}},Q:function(n){var i=n.d().toLowerCase();if(i===_w.p.b){var t=n.k;return!_j.u.a(t)&&!_j.u.a(t.Filter)?t.Filter==="All":!0}else return i===_w.p.a}};_w.K=function(){};_w.K.a=function(n){var i=!1;var t="emailProxy";if(n&&n.b(t)){var r=n.a[t];i="true"===r}return i};_w.K.prototype={b:null,a:function(n,t,i,r){this.b||(this.b=new _w.p(n,t,i.g(),i.i(),i.h(),_w.K.a(r)));return this.b}};_w.bW=function(n){_w.bW.initializeBase(this,[7,0,!0,n])};_w.bW.prototype={e:function(){return"ReconcileSyncContextId"},f:function(n){return n.z()}};_w.L=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.n=n;this.m=t;this.i=i;this.k=r;this.j=u;this.f=f;this.o=e;this.p=o;this.d=s;this.e=h;this.h=c;this.g=l;this.l=a};_w.L.prototype={n:null,m:null,i:null,k:null,j:null,f:null,o:null,p:null,d:null,e:null,h:null,g:null,l:null,c:null,b:function(n,t,i,r,u,f,e){if(this.c){_j.e.b(_a.a.co,"Sync manager create called, but a sync manager already exists");this.c.dispose()}var o=new ExternalSyncDependencies(n,this.i,this.k,this.n,this.j,this.f,this.o,t,this.p,i,r,this.d,this.e,this.m,f,this.h,e,this.l);this.c=new _w.b(o,u,this.d,this.g);_a.g.L(this.c);return this.c},a:function(){return this.c}};_w.h.registerClass("_w.h");_w.r.registerClass("_w.r",_w.h);_w.cb.registerClass("_w.cb",null,_a.kL);_w.bX.registerClass("_w.bX",_w.cb);_w.s.registerClass("_w.s",_w.bX);_w.P.registerClass("_w.P",_w.cb);_w.cl.registerClass("_w.cl",null,_w.ca);_w.U.registerClass("_w.U",_w.cl);_w.A.registerClass("_w.A",_w.h);_w.t.registerClass("_w.t",_w.cb);_w.i.registerClass("_w.i",_w.cb);_w.C.registerClass("_w.C",null,_a.gf);_w.ck.registerClass("_w.ck");_w.cg.registerClass("_w.cg",_w.ck);_w.ce.registerClass("_w.ce",_w.cg);_w.ba.registerClass("_w.ba",_w.cl);_w.bk.registerClass("_w.bk",_j.bZ,Sys.IDisposable);_w.M.registerClass("_w.M",_w.cb);_w.d.registerClass("_w.d",_w.cb);_w.R.registerClass("_w.R",_w.cb);_w.N.registerClass("_w.N",_a.br);_w.o.registerClass("_w.o",_w.cb);_w.f.registerClass("_w.f",_w.bX);_w.S.registerClass("_w.S",_w.cb);_w.bz.registerClass("_w.bz",null,_w.bY);_w.T.registerClass("_w.T",_w.bz);_w.u.registerClass("_w.u",_w.ck);_w.W.registerClass("_w.W",_w.J.$$(_g.fM));_w.k.registerClass("_w.k",_w.bz);_w.X.registerClass("_w.X",_w.k);_w.Y.registerClass("_w.Y",_w.ck);_w.Z.registerClass("_w.Z",_w.cl);_w.c.registerClass("_w.c",_a.br);_w.bb.registerClass("_w.bb",_w.c);_w.cc.registerClass("_w.cc",_w.F.$$(_w.bd,Array,_g.hb));_w.be.registerClass("_w.be",_w.cc);_w.bf.registerClass("_w.bf",_w.cc);_w.bg.registerClass("_w.bg",_w.c);_w.E.registerClass("_w.E",_w.bz);ExternalSyncDependencies.registerClass("ExternalSyncDependencies");_w.bl.registerClass("_w.bl",_w.J.$$(_g.fS));_w.bm.registerClass("_w.bm",_w.k);_w.bn.registerClass("_w.bn",_w.ck);_w.e.registerClass("_w.e",null,_h.cE);_w.cf.registerClass("_w.cf",_w.k);_w.ch.registerClass("_w.ch");_w.br.registerClass("_w.br",_w.cl);_w.bs.registerClass("_w.bs",_w.B.$$(_gg.CD,_gg.CG));_w.cj.registerClass("_w.cj",_w.cg);_w.x.registerClass("_w.x",_w.cj);_w.m.registerClass("_w.m",_w.F.$$(_w.q,Array,_g.L));_w.bu.registerClass("_w.bu",_w.m);_w.bv.registerClass("_w.bv",_w.m);_w.ci.registerClass("_w.ci",_w.cf);_w.bt.registerClass("_w.bt",_w.ci);_w.bw.registerClass("_w.bw",_w.c);_w.bx.registerClass("_w.bx",_w.ci);_w.y.registerClass("_w.y",_w.cj);_w.by.registerClass("_w.by",_w.ch);_w.bA.registerClass("_w.bA",_w.J.$$(_g.gk));_w.bB.registerClass("_w.bB",_w.k);_w.bC.registerClass("_w.bC",_w.ck);_w.bL.registerClass("_w.bL",_w.c);_w.bN.registerClass("_w.bN",_w.cl);_w.bR.registerClass("_w.bR",_w.cl);_w.I.registerClass("_w.I",_a.br);_w.bS.registerClass("_w.bS",_w.J.$$(_gg.uw));_w.bT.registerClass("_w.bT",_w.k);_w.bU.registerClass("_w.bU",_w.ck);_w.bd.registerClass("_w.bd",_h.Z,_a.fK,_a.fE);_w.v.registerClass("_w.v",_w.ce);_w.w.registerClass("_w.w",_w.ce);_w.bq.registerClass("_w.bq",_w.ck);_w.bD.registerClass("_w.bD",_w.J.$$(_g.ct));_w.bE.registerClass("_w.bE",_w.k);_w.bF.registerClass("_w.bF",_w.ck);_w.V.registerClass("_w.V",_w.J.$$(_gg.Cs));_w.q.registerClass("_w.q",_h.bX,_a.kf,_a.fK,_a.fE);_w.bc.registerClass("_w.bc",_w.B.$$(_gg.Cu,_gg.Cv));_w.bi.registerClass("_w.bi",_w.ch);_w.j.registerClass("_w.j",_w.k);_w.g.registerClass("_w.g",_w.ck);_w.bo.registerClass("_w.bo",_w.B.$$(_gg.Cy,_g.jE));_w.bp.registerClass("_w.bp",_w.k);_w.G.registerClass("_w.G");_w.bG.registerClass("_w.bG",_w.B.$$(_gg.CK,_gg.CL));_w.bH.registerClass("_w.bH",_w.J.$$(Array));_w.bI.registerClass("_w.bI",_w.k);_w.bJ.registerClass("_w.bJ",_w.ck);_w.bK.registerClass("_w.bK",_w.k);_w.n.registerClass("_w.n",_w.ck);_w.bP.registerClass("_w.bP",_w.k);_w.bO.registerClass("_w.bO",_w.B.$$(_g.fX,_g.fZ));_w.bQ.registerClass("_w.bQ",_w.ck);_w.z.registerClass("_w.z",_w.cb);_w.b.registerClass("_w.b",_j.bZ,_a.kN,Sys.IDisposable);_w.cd.registerClass("_w.cd",_w.cf);_w.D.registerClass("_w.D",_w.cd);_w.bh.registerClass("_w.bh",_w.cd);_w.bj.registerClass("_w.bj",_w.c);_w.bV.registerClass("_w.bV",_a.br);_w.l.registerClass("_w.l",_j.bZ);CoreSyncComponent.registerClass("CoreSyncComponent",null,_a.jw,_j.ce);_w.p.registerClass("_w.p",_no.g,_no.c,Sys.IDisposable,_a.ko);_w.K.registerClass("_w.K",null,_a.fH);_w.bW.registerClass("_w.bW",_w.cb);_w.L.registerClass("_w.L",null,_h.dH,_a.er);_w.h.a=_a.a.dg;_w.e.a=new Sys.EventHandlerList;_w.e.b=_a.a.dg;_w.m.a=null;_w.m.b=null;_w.c.h="m";_w.c.f="fts";_w.c.m="st";_w.c.k="ss";_w.c.l="sse";_w.c.i="se";_w.c.o="u";_w.c.d="d";_w.c.n="syt";_w.c.j="sid";_w.c.a="dic";_w.c.b="ric";_w.c.g="mpti";_w.c.c="aqcar";_w.c.e="iid";_w.j.a=null;_w.g.a=null;_w.n.a=[];_w.b.a=_a.a.co;_w.b.c=10;_w.b.b=500;_w.l.a=_a.a.en;CoreSyncComponent.$$cctor();_w.p.b="RowNotification".toLowerCase();_w.p.a="CalendarItemNotification".toLowerCase();
window.scriptsLoaded['microsoft.owa.core.sync.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.sync.js'] = (new Date()).getTime();
