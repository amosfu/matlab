window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.offline.boot.js'] = (new Date()).getTime();
Type.registerNamespace("_ob");_ob.h=function(n){this.i=Function.createDelegate(this,this.l);_ob.h.initializeBase(this);this.d=n;this.h=new _j.g(this.i,_a.a.di);this.g(!0);this.j(this.d.a);var t=this;this.d.apcl("AppStatus",function(){t.j(t.d.a)})};_ob.h.prototype={d:null,e:null,h:null,f:!1,c:function(){return this.e},j:function(n){if(n!==this.e){this.e=n;this.eG("Status");_j.h.a(this.e)?this.g(!0):this.g(!1)}return n},a:function(){return this.f},g:function(n){if(n!==this.f){this.f=n;this.eG("IsHidden")}return n},b:function(){return this.h},l:function(){this.g(!0)}};_ob.g=function(){};_ob.g.prototype={initialize:1,reachShowLimit:2,appCacheStatusChanges:3,removeALT1doneText:4,removeUpdatingPausedText:5,removeDisconnectedText:6,removeConnectingText:7,removeUpToDateText:8,connectionStatusChange:9,detectingConnectivityChange:10,syncingStatusEvent:11,postALT1SyncOrderChange:12};_ob.g.registerEnum("_ob.g",!1);_ob.c=function(){};_ob.d=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.D);this.o=Function.createDelegate(this,this.B);this.n=Function.createDelegate(this,this.A);this.m=Function.createDelegate(this,this.z);this.r=_a.a.di;this.l=new Sys.EventHandlerList;this.b=t;this.e=n;this.i=i;this.c=r;this.d=!1;this.f=!1;this.g=!1;this.h=this.c.a();this.j=_a.d.g.h();this.a=null;u&&(this.q(u.status)?this.b.e(!0):u.status!==5&&u.status||this.b.e(!1));this.E();this.s()};_ob.d.prototype={e:null,b:null,i:null,c:null,h:null,a:null,g:!1,d:!1,j:0,f:!1,w:function(n){this.x(n)},v:function(n){if(this.d!==n){this.d=n;this.k()}return n},t:function(n){if(this.f!==n){this.f=n;this.k()}return n},u:function(n){if(this.g!==n){this.g=n;this.k()}return n},y:function(){var n=this.c.a().h();return this.b.t()>this.j&&n<this.b.u()+5e3+3e3},E:function(){this.e.b(_h.cO,this.m);this.e.b(_h.ck,this.n);this.e.b(_a.cy,this.o);this.e.b(_h.bK,this.p)},k:function(){var n=this.l.getHandler("StatusChanged");n&&n()},x:function(n){this.l.addHandler("StatusChanged",n)},C:function(){if(this.c.a().h()-this.h.h()>3e5){if(this.a){this.i.b(this.a);this.a=null}this.u(!0)}},z:function(n){this.h=this.c.a();if(this.q(n.a)){this.b.e(!0);this.f=!0;this.d=!1;if(this.a){this.i.b(this.a);this.a=null}this.k()}else n.a!==5&&n.a||this.b.e(!1);this.s()},q:function(n){return n===1||n===4},s:function(){if(!this.b.k()&&!this.a){this.u(!1);var n=this;this.a=this.i.e(this.r,"installerStoppedDuringALT1Check",function(){n.C()},3e5)}},A:function(n){this.v(!1);this.t(!0)},B:function(n){if(!n.a&&!this.d){this.j=this.c.a().h();this.v(!0);this.t(!1)}},D:function(n){this.h=this.c.a()}};_ob.e=function(n,t,i,r,u,f,e,o){this.w=Function.createDelegate(this,this.D);this.v=Function.createDelegate(this,this.C);this.y=Function.createDelegate(this,this.H);this.x=Function.createDelegate(this,this.G);this.r=_a.a.di;_ob.e.initializeBase(this);this.c=e;this.f=i;this.l=n;this.u=t;this.h=u;this.j=r;this.d=f;var s=this;this.d.apcl("DetectingConnectivity",function(){s.B()});this.p=_a.d.g.h();this.q=_a.d.g.h();this.o=null;this.i=null;this.k=null;this.n=!1;o&&(this.e=o);this.E();this.K()};_ob.e.prototype={f:null,l:null,j:null,h:null,u:null,d:null,a:null,p:0,q:0,n:!1,o:null,i:null,k:null,c:null,e:null,t:0,b:function(n){if(n!==this.a){var t;t=this.a===""?0:this.p+3e3-this.h.a().h();if(t<=0){this.a=n;this.p=this.h.a().h();this.J();this.bw("AppStatus")}else if(!this.o){var i=this;this.o=this.j.a(this.r,"UpdateAppStatus",function(){i.o=null;i.g(2)},t)}}return n},s:function(){return this.u.u()},K:function(){this.l.b(_h.bK,this.x);this.l.b(_a.cN,this.y);this.l.b(_h.by,this.v);this.l.b(_ob.c,this.w);var n=this;this.c.w(function(){n.g(3)})},J:function(){this.z();if(this.a===_u.n.Ba){this.f.H(!0);this.m(null,1e4,4)}else if(this.a===_u.n.Qp)this.m(null,5e3,5);else if(this.a===_u.n.LH)this.m(null,1e4,6);else if(this.a===_u.n.Dg)this.m(null,3e3,7);else if(this.a===_u.n.Gp){this.t=this.e.A();this.m(null,3e3,8)}},m:function(n,t,i){this.z();var r=this;this.i=this.j.a(this.r,_ob.g.toString(i),function(){r.i=null;n&&n();r.g(i)},t)},z:function(){if(this.i){this.j.b(this.i);this.i=null}},E:function(){if(this.f.B())this.b(_u.n.Dg);else{this.f.G(!0);this.g(1)}},g:function(n){if(!this.d.b)if(this.d.a)this.f.k()&&this.f.b()||this.c.d?this.c.d?this.c.y()?this.b(_u.n.Qp):this.b(_u.n.Hz):this.f.C()||!this.s()?this.e&&this.e.n?this.e.p?this.b(_u.n.Rv):this.h.a().h()-this.e.A()<3e3?this.a===_u.n.Gp?this.t!==this.e.A()&&this.m(null,3e3,8):this.b(_u.n.Gp):this.b(""):this.b(""):this.b(_u.n.Ba):this.s()&&(this.c.g?this.b(_u.n.NS):this.b(_u.n.MZ));else{var t=this.h.a().h();t-this.q<1e4||this.a===_u.n.Dg?this.b(_u.n.LH):this.s()&&this.c.g&&!this.c.f?this.b(_u.n.NS):this.b("")}},H:function(n){this.k&&this.j.b(this.k);var t=this;this.k=this.j.a(this.r,"ConnectionStatusDelayer",function(){t.k=null;if(t.d.b)t.n=!0;else{t.d.a||t.A(9);t.g(9)}},3e3)},B:function(){if(!this.d.b){if(this.n){this.d.a||this.A(10);this.n=!1}this.g(10)}},G:function(n){this.b(_u.n.Dg)},C:function(n){if(_ob.b.isInstanceOfType(n.a)){this.e=n.a;this.g(11)}},D:function(n){this.g(12)},A:function(n){this.a!==_u.n.LH&&(this.q=this.h.a().h())}};_ob.f=function(n,t,i){_ob.f.initializeBase(this,[n,t,i,[10]])};_ob.f.prototype={a:!1,H:function(n){this.a=!0;this.c()},G:function(n){this.a=!1;this.c()},J:function(n){if(this.a){this.a=!1;this.c()}},F:function(){this.c()},c:function(){this.K(this.e.a&&this.a)}};_ob.b=function(n,t,i,r,u,f,e,o){this.w=Function.createDelegate(this,this.U);this.z=Function.createDelegate(this,this.Y);this.x=Function.createDelegate(this,this.V);this.y=Function.createDelegate(this,this.W);_ob.b.initializeBase(this,[i,u,e,[4,11,5,12]]);_a.b.a(n,"userConfiguration");_a.b.a(t,"folderMappings");_a.b.a(r,"clientStore");_a.b.a(f,"syncFolderSettingProcessor");this.v=n;this.s=t;this.k=r;this.C=f;this.h=o;this.a=_a.I.a();this.t=_a.I.a();this.X();this.bb();this.N(!this.h.a());this.i()};_ob.b.prototype={k:null,v:null,s:null,C:null,a:null,t:null,l:!1,d:0,u:null,c:null,q:!1,h:null,n:!1,g:null,r:!1,N:function(n){if(this.n!==n){this.n=n;this.i()}return n},B:function(n){if(n!==this.u){this.u=n;this.b.a(_h.dc,new _h.dc(this,this.u))}return n},ba:function(n){if(this.d!==n){this.d=n;this.i()}return n},Z:function(n){if(n!==this.q){this.q=n;this.b.a(_h.co,new _h.co(this.q))}return n},M:function(n){if(this.c!==n){this.c=n;this.m(this.a.c(this.c.Id));this.i()}return n},m:function(n){if(this.l!==n){this.l=n;this.i()}return n},A:function(){return this.t.b[this.c.Id]},D:function(){this.b.c(_h.bk,this.y);this.b.c(_h.cl,this.x);this.b.c(_a.dE,this.z);this.h.c(this.w);_h.dI.prototype.D.call(this)},S:function(n,t){_a.b.a(n,"unsentInfo");_a.b.a(t,"updateInfo");var i;i=n.length>0?t.length>0?String.format("{0}{1}{2}",n,_u.n.Nf,t):n:t;return i},H:function(n){if(n.b&&n.b.length){Array.contains(n.b,this.c.Id)&&this.m(!0);for(var f=n.b,e=f.length,i=0;i<e;++i){var t=f[i];if(this.a.c(t)){var r,u;this.a.a(t,(r=this.a).a(u=t,r.b[u]+1))}else this.a.a(t,1)}}},G:function(n){if(n.b&&n.b.length){if(Array.contains(n.b,this.c.Id)&&this.l)if(n.a===3){this.g=this.c.Id;this.r||this.O()}else this.m(!1);for(var r=n.b,f=r.length,i=0;i<f;++i){var t=r[i];if(this.a.c(t)){var u=this.a.b[t];u>1?this.a.a(t,--u):this.a.e(t)}}}},J:function(n){if(this.a.f()>0){var t=new Sys.StringBuilder;var i=this;this.a.d(function(n,i){t.append(String.format("Key:{0},Value:{1};",n,i))});this.m(!1);this.a=_a.I.a()}},F:function(){this.i()},O:function(){this.t.a(this.g,_a.d.get_utcNow().h());this.c.Id===this.g&&this.m(!1);this.g=""},X:function(){var n=this.s.nameToId("inbox");this.M(n)},bb:function(){this.P();this.b.b(_h.bk,this.y);this.b.b(_h.cl,this.x);this.b.b(_a.dE,this.z);this.h.b(this.w)},V:function(n){this.r=n.a;this.r||_j.h.a(this.g)||this.O()},U:function(){this.N(!this.h.a())},W:function(n){var t=n.a;t&&t.bD.FolderId&&this.M(t.bD.FolderId)},i:function(){if(this.e.a&&this.l&&this.n){this.B("");this.K(!0);return}this.K(!1);this.bc();if(this.e.a)this.B(this.L());else{var n=this;this.T(function(t){n.e.a||n.B(n.S(n.L(),t))})}},bc:function(){this.Z(!this.e.a&&this.d>0)},L:function(){return this.d>0?String.format(_u.n.Rl,this.d):""},T:function(n){var i="";var r=this.v.b().g(this.c,!1,!1);var t=-1;r.a()===1?t=4:(r.a()===2||r.a()===3)&&(t=5);if(!this.C.f(t,this.c.Id)){n(i);return}if(this.k.c()){var u=this;this.f.v(t,new _bc.i(this.c),function(t){i=u.R(t);n(i)})}else{_j.e.c(_ob.b.a,"ClientStore should be available when we try to GetLastUpdateInfo");n(i)}},Y:function(n){n.a===5&&this.P()},P:function(){if(this.k.c()){var t=this.s.nameToId("outbox");if(!t){_j.e.c(_ob.b.a,"There is no FolderId for outbox");return}var n=new _bs.bm(this.k,this.v.a().bD.TimeZone);var i=this,u=this,r=this;n.n("MailOfflineActivityIndicator.UpdateOutboxTotalCount",function(r){n.p(r,t,function(n,t){i.ba(n)})},function(){},function(n){})}else _j.e.c(_ob.b.a,"ClientStore is not available when we try to UpdateOutboxTotalCount")},R:function(n){if(n){var i=_a.d.b(n);var t;t=i.k(_a.d.a())?1:0;return this.Q(i,t)}return""},Q:function(n,t){return String.format(_u.n.PL,n.a(t))}};_ob.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.X=Function.createDelegate(this,this.br);this.Y=Function.createDelegate(this,this.bs);this.W=Function.createDelegate(this,this.bq);this.L=Function.createDelegate(this,this.bt);this.J=Function.createDelegate(this,this.bo);this.K=Function.createDelegate(this,this.bp);this.N=Function.createDelegate(this,this.bC);this.V=Function.createDelegate(this,this.bm);this.Z=Function.createDelegate(this,this.bB);this.H=Function.createDelegate(this,this.bn);this.M=Function.createDelegate(this,this.be);this.bb=new Sys.EventHandlerList;_ob.a.initializeBase(this);_a.b.b(f,"nativeBridge");this.u=n;this.q=u;this.bE(t);this.v=i;this.o=r;this.n=f;this.t=o;this.Q=s;this.G=e;this.x=c;this.z=l;this.C=a;this.A=v;this.y=h;this.bG()};_ob.a.prototype={u:null,v:null,o:null,n:null,G:null,t:null,Q:null,x:null,z:null,C:null,A:null,y:null,p:null,w:null,r:!1,q:null,O:!1,P:!1,R:!1,s:null,E:null,U:null,T:!1,F:!1,bd:null,c:function(){return this.p},bE:function(n){this.p&&this.p.h(this.M);this.p=n;if(this.p){this.be(!1);this.p.f(this.M)}else this.S(!1);return n},d:function(){return this.E},h:function(){return this.U},a:function(){return this.r},S:function(n){if(n!==this.r){this.r=n;var t=this.bb.getHandler("IsClientStoreInstalled");t&&t()}return n},i:function(){return this.q},f:function(){return this.s?this.s.d:0},g:function(){return this.q.a()&&this.r&&this.q.v()?!this.w.a:!1},e:function(){return this.F},b:function(){var n=null;this.t.d()&&(n=this.t.b().a());return n},j:function(n,t,i,r,u,f,e,o){var h=this.q.f();var c=this.q.a();if(c&&!h){var l=this,s=this;this.k(null,t,!1,i,r,e,o,function(t){n(t)},function(t){_j.e.c(_a.a.bI,"Offline Initialization failed - reverting to KIOSK mode. {0}",t.message);s.bd=String.format("OfflineInit failed:{0}",t.message);var i=new _g.k(null,u,f,new _g.dU(o),s.o);i.n.e(!0);n(i)})}else throw Error.invalidOperation();},k:function(n,t,i,r,u,f,e,o,s){_a.b.a(o,"onOfflineReady");var h=this,c=this;this.bx(n,t,i,u,f,e,function(n){_a.bH.a("X-Offline","1","/");h.bF(r);h.u.g(h.o,h.b(),n.o);o(n)},function(n){c.n.b(c.n.a())&&c.n.a().d(1,n.message||"prepare offline component failed with an unknown error");s(n)})},m:function(n,t){this.o.a(_a.cW,new _a.cW(!1));this.B(n,t)},B:function(n,t){_a.bH.a("X-Offline",null,"/");this.q.s();this.ba(n,t)},l:function(n,t){_a.b.a(n,"successCallback");_a.b.a(t,"failureCallback");this.q.g()?this.bg(n,t):n()},D:function(){this.bH();this.F&&this.q.h(!1);this.s&&this.s.dispose();this.E&&this.E.dispose();if(this.t.d()&&this.b()){this.o.c(_a.ec,this.H);this.b().dispose()}},bc:function(n){return new _a.cL(n,this.n)},bx:function(n,t,i,r,u,f,e,o){var s=this;this.bl(function(){s.p.j(function(){_a.j.v=_a.j.a();s.bw(n,s.bj(),new _g.gH,i,f,function(n,f){_a.j.z=_a.j.a();s.p.k(n.C,s.o);var o=t?t.a.connected:null;if("false"===o){n.n.c(!1);n.n.e(!1)}else n.n.e(!0);s.bA(n);s.Q.a(function(o){var h=o.a(new _a.ei,_a.g.n(),_a.g.e(),t);_a.g.e().u(h);s.t.a(function(o){s.bk(n,h,t,r,u);s.o.b(_a.ec,s.H);i&&s.q.J(f.c().bD.UserEmailAddress,f.c().bD.UserDisplayName);e(n)})})},function(n){s.p.e();o(n)})},o)})},bj:function(){return this.n.b(this.n.a())?new _gg.lb(this.n,this.x,this.z,this.C,this.A,this.o,this.y):new _g.dT(null,this.x,this.z,this.C,this.A,this.o,this.y)},bg:function(n,t){_a.b.a(n,"successCallback");_a.b.a(t,"failureCallback");if(this.v.u()){var i=this,r=this;this.p.l(function(){i.q.o();i.u.a();n()},function(n){_j.e.c(_ob.a.a,"We failed to uninstall client store due to error: "+n.message);t(n)})}else n()},ba:function(n,t){if(_bs.r.isInstanceOfType(n)){var r=n;r.U()}this.u.a();if(t){var i=this.bc(t);i.a("DeprovisionAndReload")}},bv:function(){var n=this;this.G.a(function(t){n.U=new _h.ey(_g.b.a);if(n.v.c()&&window.owaSD&&window.owaSD.readyState!==4){var i=_j.n.b(_a.a.df,2,"RegisterSSSDReadyStateChange");window.owaSD.onreadystatechange=n.Z;_a.j.c=3;_j.n.a(i)}else n.bf();n.s=new _ob.b(_g.a.a(),_g.b.a,n.o,n.p,n.b(),t,n.w,n.b().u());n.E=new _ob.f(n.o,n.b(),n.w);n.T&&n.b().x();n.o.d(_h.bQ,new _h.bQ)})},bf:function(){this.u.d(this.p,window.owaSD)},bB:function(){var n=_j.n.b(_a.a.df,0,window.owaSD?"OnSSSDRequestReadyStateChanged_"+window.owaSD.readyState:"OnSSSDRequestReadyStateChanged");if(window.owaSD&&window.owaSD.readyState===4){window.owaSDReceivedTime=(new Date).toString();this.bf()}_j.n.a(n)},bh:function(){if(this.O&&this.r){var n=this;this.G.a(function(n){n.k(_h.a.c("msgfolderroot"))})}},bA:function(n){this.w=n.n;this.bh()},bG:function(){this.o.b(_h.cQ,this.V);this.o.b(_a.cy,this.N);this.o.b(_h.bN,this.K);this.o.b(_h.bw,this.J);this.o.b(_j.P,this.L)},bH:function(){this.o.c(_a.cy,this.N);this.o.c(_h.bN,this.K);this.o.c(_h.bw,this.J);this.o.c(_j.P,this.L)},bm:function(n){var t;if(this.v.c()){var r=this;t=new _a.u([_u.n.EY],0,function(n,t){},0,!1,null,null,null)}else{this.q.s();this.o.a(_a.cW,new _a.cW(!1));var i=this;t=new _a.u([_u.n.Lj,_u.n.RN],0,function(n,t){n&&i.ba(_g.k.a,window.location)},0,!1,_u.R.LU,null,null)}this.o.a(_a.u,t)},bt:function(n){this.q.A(_g.a.a().bD.PolicySettings.AllowOfflineOn)&&this.B(_g.k.a,window.location)},bn:function(n){this.bv()},bp:function(n){if(this.r){if(!this.s)return;this.b().m(n.a.bD.FolderId.Id)}},bo:function(n){this.O=!0;this.bh()},bk:function(n,t,i,r,u){var f="sync";this.T=!i||!i.a[f]||i.a[f].toString()==="true";this.t.b().b(n,t,_a.v.b(),r,_a.g.p,u,this.u)},bw:function(n,t,i,r,u,f,e){var o=this,s=this;this.bz(n,function(s){var h=new _g.a(s);o.bD(n,r,function(n){o.bi(n,t,i,h,u,function(n){n.o.b(_a.g.p);f(n,h)},function(n){_j.e.c(_ob.a.a,"CreateOfflineMailboxDataContextFromClientStore Failed: {0}",n.a);o.p.e();e(new _bs.b(n).b())})},function(n){_j.e.c(_ob.a.a,"Failed to provision the offline client: {0}",n.message);o.p.e();e(n)})},function(n){_j.e.c(_ob.a.a,"Failed to load OWA user configuration: {0}",n.message);s.p.e();e(n)})},bD:function(n,t,i,r){var u=new _gg.jb(this.p.i(),"DeviceType","1.0");u.HasPAL=this.v.c();if(this.n.b(this.n.a())){if(this.n.b(this.n.c())){u.DeviceModel=this.n.c().a().f();u.DeviceFriendlyName=this.n.c().a().u();if(this.n.c().a().a()===1){u.DeviceOS="iOS "+this.n.a().a().c();u.DeviceType="iPhone"}else if(this.n.c().a().a()===2){u.DeviceOS="iOS "+this.n.a().a().c();u.DeviceType="iPad"}else if(this.n.c().a().a()===3){u.DeviceOS="Android "+this.n.a().a().c();u.DeviceType="Android"}else if(this.n.c().a().a()===4){u.DeviceOS="Windows "+this.n.a().a().c();u.DeviceType="Windows 8"}}u.ClientVersion=this.n.a().a().f();u.DeviceOSLanguage=this.n.a().a().u()}var e=_bs.E.a(this.p);var f=this;e.o(function(o){if(o)i(u);else if(u.HasPAL||t){var h=n?n.A():new _g.N(function(){},null,f.x,f.z,f.C,f.A,f.o,f.y);var s=new _g.cr("Exchange2013");s.TimeZoneContext=new _g.dN;s.TimeZoneContext.TimeZoneDefinition=new _g.cK;s.TimeZoneContext.TimeZoneDefinition.Id="UTC";f.v.c()&&f.q.o();h.hk(new _gg.ja(s,u),null,function(n,t){if("Success"===t.Body.ResponseMessages.Items[0].ResponseClass)e.x(!0,function(){i(u)},r);else if("Error"===t.Body.ResponseMessages.Items[0].ResponseClass&&"ErrorMaximumDevicesReached"===t.Body.ResponseMessages.Items[0].ResponseCode){_j.e.c(_ob.a.a,"Maximum number of allowed partnerships already created.");var s=new _a.u([_u.n.Df],0,f.W,0,!1,_wss.i.O,"",_u.n.JY);f.o.a(_a.u,s)}else{_j.e.c(_ob.a.a,"Provisioning call returned a response error.");var o=Error.create(t.Body.ResponseMessages.Items[0].MessageText);r(o)}},r)}else f.B(n,window.location)},r)},bz:function(n,t,i){if(_g.a.a().N){var u=_bs.E.a(this.p);var r=this;u.d(function(u){if(u)t(u);else{var f=n?n.A():new _g.N(function(){},null,r.x,r.z,r.C,r.A,r.o,r.y);f.h(null,function(n,i){t(i)},i)}},_bs.b.f(i))}else t(_g.a.a().bD)},bi:function(n,t,i,r,u,f,e){var c=_bs.E.a(this.p);var s=new _bs.bd(this.p);var h=null;var l=this,o=this;this.p.d().g("OfflineManager.CreateOfflineMailboxDataContextFromClientStore",function(n){l.by(n,c,s,function(n){h=n});s.S(n)},function(){o.t.a(function(e){var c=new _bs.r(o.p,r.a().bD.TimeZone,t,i,new _g.dU(u),o.o,s,n.HasPAL,n.DeviceID,n.DeviceType,h,r.c(),e);c.V(function(){c.J=function(){return _a.g.p};c.W(_j.m.a());f(c)})})},e)},by:function(n,t,i,r){var u=this;i.V(n,function(i){i?t.h(n,function(){r(null)}):t.l(n,function(n){n;r(n)})})},be:function(n){this.q.g()?this.S(!1):this.S(this.p.c());n&&this.q.j()},bC:function(n){if(n.a!==4||this.n.b(this.n.a())){if(n.a===1){if(!this.P){this.P=!0;if(this.n.b(this.n.a()))this.n.a().d(0,"The mowa device id is not longer valid.  It may have been removed via ECP.");else if(this.bu(n.c,this.q.E()))this.B(_g.k.a,window.location);else{var i=new _a.u([String.format(_u.n.TB,this.q.D())],1,this.Y,3,!1,_u.n.RJ,_u.n.Gj,null);this.o.a(_a.u,i)}}}else if(n.a===6){var t=new _a.u([_u.n.PQ],0,this.X,0,!1,null,null,null);this.o.a(_a.u,t)}}else if(!this.R){this.R=!0;this.B(_g.k.a,window.location)}},bu:function(n,t){n=n||"";t=t||"";var r=n.split("@")[0];var i=t.split("@")[0];return r===i},bs:function(n,t){n?this.B(_g.k.a,window.location):this.o.a(_a.co,new _a.co(!1))},br:function(n,t){var i=this.bc(window.location);i.a("OfflinePolicyDisabledConflict")},bq:function(n,t){var i=new _gg.cR(5);this.o.a(_gg.cR,i)},bF:function(n){this.F=!0;this.q.h(!0);var t=this;n.e(_a.a.bv,"StartOfflineSessionInUseThread",function(){t.r&&!t.I&&t.q.h(!0)},5e3)},bl:function(n){if(this.n.b(this.n.c())&&this.n.c().a().r()){var i=this,t=this;this.bg(function(){n()},function(n){t.n.a().d(0,"Unable to remove the client store. "+n.message)})}else n()}};_ob.i=function(){this.c=_a.I.a()};_ob.i.prototype={b:function(n,t,i,r){var u=this.e(n,t,i);this.d(u,0,r)},a:function(n){return this.c.b[_bc.C.toString(n)]},e:function(n,t,i){var r=[new _ob.i.e];var f=new _ob.i.a(n,i);var u=new _ob.i.b(n,i);Array.add(r,f);Array.add(r,u);if(t!=="TouchNarrow"){Array.add(r,new _ob.i.c(f));Array.add(r,new _ob.i.d(u))}return r},d:function(n,t,i){if(t===n.length)i();else{var r=this;this.f(n[t],function(){r.d(n,t+1,i)})}},f:function(n,t){var i=this;n.g(function(n){i.c.a(_bc.C.toString(n.e),n.a);t()})}};_ob.i.f=function(n){this.e=n};_ob.i.f.prototype={e:0,a:null,g:function(n){var t;var u,f;if(f=this.b(u={val:t}),t=u.val,f){var i=this;t.b(function(t){i.f(t);n(i)});var r=this;t.c(function(t){r.a=null;n(r)});_a.g.a.a(t)}else{this.a=null;n(this)}}};_ob.i.h=function(n){_ob.i.h.initializeBase(this,[n])};_ob.i.h.prototype={f:function(n){var t=n;this.a=t.N}};_ob.i.e=function(){_ob.i.e.initializeBase(this,[1])};_ob.i.e.prototype={b:function(n){n.val=new _h.cr;return!0}};_ob.i.g=function(n,t,i){_ob.i.g.initializeBase(this,[i]);this.c=n;this.d=t};_ob.i.g.prototype={c:!1,d:0};_ob.i.a=function(n,t){_ob.i.a.initializeBase(this,[n,t,3])};_ob.i.a.prototype={b:function(n){if(this.c){n.val=null;return!1}var t=_g.b.a.nameToId("inbox");n.val=new _h.bY(t,null,_h.v.a(0,this.d),!1,"All",_h.b.S(t));return!0}};_ob.i.b=function(n,t){_ob.i.b.initializeBase(this,[n,t,4])};_ob.i.b.prototype={b:function(n){if(!this.c){n.val=null;return!1}n.val=new _h.bh(_g.b.a.nameToId("inbox"),null,null,"MailListItem",_h.v.a(0,this.d),!0,"All",null,!1,null,null,0,null,-1,null,!1);return!0}};_ob.i.d=function(n){_ob.i.d.initializeBase(this,[6]);this.c=n};_ob.i.d.prototype={c:null,b:function(n){var i=this.c.a;if(!i){n.val=null;return!1}var t=i.Body.ResponseMessages.Items[0];if(!t.RootFolder.Items||!t.RootFolder.Items.length){n.val=null;return!1}var r=t.RootFolder.Items[0];n.val=new _h.K(101,[r.ItemId],_h.b.h(_h.b.r()),"ItemNormalizedBody",2,!1,null,null);return!0}};_ob.i.c=function(n){_ob.i.c.initializeBase(this,[5]);this.c=n};_ob.i.c.prototype={c:null,b:function(n){var i=this.c.a;if(!i||!i.Body.Conversations.length){n.val=null;return!1}var t=i.Body.Conversations[0];var r=_a.d.b(t.LastModifiedTime);n.val=_h.Z.a(101,t.ConversationId.Id,t.ConversationId.ChangeKey,20,r,_h.b.r(),"ItemPart","",!1);return!0}};_ob.j=function(){};_ob.j.prototype={a:function(n,t,i,r,u,f){return _ob.j.c.a(n,t,i,r,u,f)}};_ob.j.a=function(n,t,i,r,u,f){_ob.j.a.initializeBase(this,[n,t,i,r,u]);_a.b.a(f,"response");this.c=f};_ob.j.a.prototype={c:null,i:function(){this.f.a(this.c);this.b.c(0)},h:function(){for(var t=this.c.Body.Conversations,r=t,f=r.length,n=0;n<f;++n){var u=r[n];u.FolderId=this.e}var i=new _bs.bT(new _bs.bN(this.d,_g.a.a().a().bD.TimeZone),t,[]);i.f=11;var e=this;i.l(function(){})}};_ob.j.b=function(n,t,i,r,u,f){_ob.j.b.initializeBase(this,[n,t,i,r,u]);_a.b.a(f,"response");this.c=f};_ob.j.b.prototype={c:null,i:function(){this.f.b(this.c);this.b.d(0)},h:function(){var i=this.c.Body.ResponseMessages.Items[0];var t=i.RootFolder.Items;var n=new _bs.bU(new _bs.bR(this.d,_g.a.a().a().bD.TimeZone),t,[],[],null);n.f=11;var r=this;n.l(function(){})}};_ob.j.c=function(n,t,i,r,u){_a.b.a(n,"pageDataPayloadAdapter");_a.b.a(t,"clientStore");_a.b.a(i,"inboxFolderId");_a.b.a(r,"datapoint");this.f=n;this.d=t;this.e=i;this.b=r;this.g=u};_ob.j.c.a=function(n,t,i,r,u,f){var s=null;try{s=JsonParser.deserialize(u.responseText)}catch(c){f.a().o().Enabled;throw c;}var h=s;var e=h.findMailFolderItem;if(e)return new _ob.j.b(n,t,i,r,r.a.fi,e);else{var o=h.findConversation;return o?new _ob.j.a(n,t,i,r,r.a.fc,o):null}};_ob.j.c.prototype={f:null,d:null,e:null,b:null,g:0,a:function(){if(this.g){var t=_j.n.b(_a.a.bB,2,"PersistSSSD_GenerateReloadNotification");_a.j.c=1;this.i();this.j();_j.n.a(t)}else{var n=_j.n.b(_a.a.bB,2,"PersistSSSD_NoReloadRequired");if(_a.j.g()){_a.j.c=2;_a.j.J()}_j.n.a(n)}this.h()},j:function(){this.b.m((new Date).toString());_a.j.D=_a.j.D+1;_bs.t.d(this.e.Id,"SSSD",!1)}};function OfflineBootComponent(){}OfflineBootComponent.$$cctor=function(){_a.t.a().a(OfflineBootComponent)};OfflineBootComponent.prototype={b:function(n,t,i){var f=this;n.b(_ob.a,function(){return new _ob.a(n.a(_bc.B),n.a(_a.dz),n.a(_j.o),n.a(_j.j),n.a(_h.bi),n.a(_a.D),n.d(_h.cE),n.d(_h.dH),n.d(_a.fH),n.d(_j.t),n.a(_a.f),n.a(_g.eT),n.d(_g.eU),n.a(_g.cM))}).b(_h.db).a();var e=this;n.b(_ob.h,function(){return new _ob.h(n.a(_ob.e))}).b(_y.dZ).a();var r=this;n.b(_ob.d,function(){return new _ob.d(n.a(_j.j),n.a(_ob.a).q,n.a(_j.v),n.a(_a.dr),_a.g.d)}).a();var u=this;n.b(_ob.e,function(){return new _ob.e(n.a(_j.j),n.a(_j.o),n.a(_ob.a).q,n.a(_j.v),n.a(_a.dr),n.a(_ob.a).w,n.a(_ob.d),n.a(_ob.a).s)}).a();n.e(_ob.i).b(_bc.V);n.e(_ob.j).b(_bc.W)},a:function(){return[]}};_ob.h.registerClass("_ob.h",_a.bu,_y.dZ);_ob.c.registerClass("_ob.c");_ob.d.registerClass("_ob.d");_ob.e.registerClass("_ob.e",_j.R);_ob.f.registerClass("_ob.f",_h.dI,_h.cs,Sys.IDisposable);_ob.b.registerClass("_ob.b",_h.dI,_h.ct,Sys.IDisposable);_ob.a.registerClass("_ob.a",_j.bZ,_h.db,Sys.IDisposable);_ob.i.registerClass("_ob.i",null,_bc.V);_ob.i.f.registerClass("_ob.i.f");_ob.i.h.registerClass("_ob.i.h",_ob.i.f);_ob.i.e.registerClass("_ob.i.e",_ob.i.h);_ob.i.g.registerClass("_ob.i.g",_ob.i.h);_ob.i.a.registerClass("_ob.i.a",_ob.i.g);_ob.i.b.registerClass("_ob.i.b",_ob.i.g);_ob.i.d.registerClass("_ob.i.d",_ob.i.h);_ob.i.c.registerClass("_ob.i.c",_ob.i.h);_ob.j.registerClass("_ob.j",null,_bc.W);_ob.j.c.registerClass("_ob.j.c",null,_bc.bG);_ob.j.a.registerClass("_ob.j.a",_ob.j.c);_ob.j.b.registerClass("_ob.j.b",_ob.j.c);OfflineBootComponent.registerClass("OfflineBootComponent",null,_a.jw,_j.ce);_ob.f.a=_a.a.bv;_ob.b.a=_a.a.bv;_ob.a.a=_a.a.bv;OfflineBootComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.core.offline.boot.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.offline.boot.js'] = (new Date()).getTime();
