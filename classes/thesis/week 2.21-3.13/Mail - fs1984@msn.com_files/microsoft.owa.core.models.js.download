window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.models.js'] = (new Date()).getTime();
Type.registerNamespace("_c");_c.f=function(n,t,i){_a.b.b(n,"activityManager");_a.b.b(t,"chatManagerFactory");_a.b.b(i,"owaLayout");if(i!=="Mouse")this.a=new _c.o(n);else{var r=this;t.a(function(t){var i=t.a();r.a=i.f()?new _c.D(n,i):new _c.o(n)})}};_c.f.prototype={a:null};_c.g=function(n,t,i){this.g=Function.createDelegate(this,this.h);this.c=n;this.d=t;this.f=i;this.a=!0;this.b=!1;this.c.b(_a.fh,this.g)};_c.g.prototype={c:null,d:null,f:null,a:!1,b:!1,h:function(n){if(this.a&&!this.b){_j.e.a(_a.a.bI,"OnSessionTimeoutEvent: Sending refresh session request.");this.b=!0;var r=new _c.E(!0);var t=this;r.b(function(i){t.b=!1;var r=i.N;if(r.TokenResultCode){t.a=!1;t.e(n)}else t.a=!0;_j.e.a(_a.a.D,"RefreshSessionAction result: {0}",r.TokenResultCode)});var i=this;r.c(function(t){i.b=!1;i.a=!1;i.e(n);_j.e.b(_a.a.D,"RefreshSessionAction failed for user")});this.d.a(r)}else this.a||this.e(n)},e:function(n){var t=this;this.f.c(_a.a.bI,"RaiseEvent SessionTimeoutWarningEvent",function(){t.c.a(_a.dO,new _a.dO(n.b()))})}};_c.U=function(){};_c.U.prototype={success:0,warning:1,error:2};_c.U.registerEnum("_c.U",!1);_c.W=function(){};_c.W.prototype={Id:0,Dictionary:1,XmlData:2,BinaryData:3,All:4};_c.W.registerEnum("_c.W",!1);_c.q=function(n,t){_c.q.initializeBase(this);this.e=n;this.f=t};_c.q.prototype={e:null,f:null,K:function(n){n.dy(this.e,this.f,null,this.J,this.H)},cS:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.v=function(n,t){_c.v.initializeBase(this);_a.b.b(n,"folderId");_a.b.b(t,"conversationCount");this.h=n;this.f=t};_c.v.prototype={h:null,f:0,e:null,K:function(n){n.fq(this.h,this.f,null,this.J,this.H)},cS:function(n,t,i){this.e=n.Conversations;t()}};_c.w=function(){_c.w.initializeBase(this)};_c.w.prototype={f:null,e:null,K:function(n){var t=new _gg.lR(this.L);t.actionName="GetRegionalConfiguration";this.e=_a.c.b(_a.a.ez,"GetRegionalConfiguration",!0,null);var i=new _gg.ed;n.E(i,t,this.J,this.H)},cS:function(n,t,i){if(this.e){this.e.o=this.O();_a.c.a(this.e);this.e=null}if(n.SupportedCultures&&n.SupportedCultures.length>0){this.f=n.SupportedCultures;t();return}i(Error.create("Get regional information failed to retrieve at least one valid language."))},bb:function(n){_h.fG.prototype.bb.call(this,Error.create(n.message));if(this.e){this.e.o=this.O();this.e.m=n.name.toString();_a.c.a(this.e);this.e=null}}};_c.y=function(){_c.y.initializeBase(this)};_c.y.prototype={e:null,K:function(n){var t=new _gg.lV(this.L);n.cu(t,this.J,this.H)},cS:function(n,t,i){try{_a.b.b(n,"themeSelectionInfo");this.e=n;t()}catch(r){i(r)}}};_c.E=function(n){_c.E.initializeBase(this);this.e=new _gg.ym(this.L);this.e.isAutomated=n};_c.E.prototype={e:null,K:function(n){n.hl(this.e,this.J,this.H)},cS:function(n,t,i){t()}};_c.N=function(n,t){_c.N.initializeBase(this);this.e=n;this.f=t};_c.N.prototype={e:null,f:!1,K:function(n){var r=new _gg.mc(this.L);var t;var i=(t=new _gg.cH,t.ThemeId=this.e,t.SkipO365Call=this.f,t);n.dh(i,r,this.J,this.H)},cS:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};function CoreModelsComponent(){}CoreModelsComponent.$$cctor=function(){_a.t.a().a(CoreModelsComponent)};CoreModelsComponent.prototype={b:function(n,t,i){n.e(_c.C).b(_h.dz).a();var u=this;n.b(_c.f,function(){return new _c.f(n.a(_a.bo),n.c(_h.cb),i.a())}).a();var r=this;n.b(_c.g,function(){return new _c.g(n.a(_j.j),n.a(_a.q),n.a(_j.v))}).a();n.e(_c.H).a().b(_db.cw);n.e(_c.I).a().b(_db.cx);n.e(_c.J).a().b(_db.cz);n.e(_c.K).a().b(_db.cB);n.e(_c.L).a().b(_db.cC)},a:function(){return[new _j.y(_c.f,2,1),new _j.y(_c.g,2,1)]}};_c.t=function(n,t,i){_c.t.initializeBase(this,[t,i]);this.f=n};_c.t.prototype={f:null,h:function(){return!0},o:function(n){n.ActionType=0},n:function(n,t){for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];if(_ff.e.b(n.c(),r.c())){this.f.n(i);break}}}};_c.u=function(){this.e=-1;_c.u.initializeBase(this)};_c.u.prototype={cS:function(n,t,i){this.e=n;t()},K:function(n){n.bS(null,this.J,this.H)}};_c.O=function(n,t,i){_c.O.initializeBase(this,[n,i]);this.f=t};_c.O.prototype={f:null,h:function(){return!0},o:function(n){var t=_a.d.f(this.f);n.ActionType=1;n.NewReminderTime=t},n:function(n,t){n.k(this.f)}};_c.A=function(n,t){_c.A.initializeBase(this);this.f=n;this.e=t};_c.A.prototype={f:null,e:null,h:null,K:function(n){var r=new _g.e(this.f);var u=new _gg.iW(r,this.e);var t=new _gg.iV(this.M(),u);var i=new _gg.xH(this.L);n.hh(t,i,this.J,this.H)},cI:function(n){this.h=n}};_c.B=function(n){_c.B.initializeBase(this);this.e=n};_c.B.prototype={e:null,K:function(n){var r=new _gg.iU(this.e);var u=new _gg.gu(r);var t=new _gg.gt(this.M(),u);var i=new _gg.pD(this.L);n.es(t,i,this.J,this.H)},cI:function(n){}};_c.z=function(n){_c.z.initializeBase(this);this.e=n};_c.z.prototype={e:null,K:function(n){var t=new _gg.tv(0);t.timeZone=this.Y();n.ci(t,this.J,this.H)},cS:function(n,t,i){try{if(!n){i(Error.create(_nbs.a.Vr));return}this.e.d(n.ExternalAudience);this.e.e(n.ExternalReply);this.e.f(n.InternalReply);this.e.b(n.IsOofOn);this.e.g(n.IsScheduled);this.e.c(_a.d.b(n.EndTime));t()}catch(r){i(r)}}};_c.M=function(n){_c.M.initializeBase(this);this.e=n};_c.M.prototype={e:null,K:function(n){var t=new _gg.kW;t.ExternalAudience=this.e.h();t.ExternalReply=this.e.i();t.InternalReply=this.e.j();t.IsOofOn=this.e.a();n.il(t,null,this.J,this.H)},cS:function(n,t,i){if(!n){i(Error.create(_bms.E.BA));return}t()}};_c.F=function(n){_c.F.initializeBase(this);this.e=n};_c.F.prototype={e:null,K:function(n){n.ht(this.e,null,this.J,this.H)},cS:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.S=function(n,t){_c.S.initializeBase(this);_a.b.b(n,"remindersToPerformAction");_a.b.b(t,"nativeBridge");this.e=n;this.l=t};_c.S.prototype={e:null,l:null,K:function(n){var i=this.q();var t=new _gg.xA(this.L);t.shouldPrecedeOfflineSyncActions=this.h();n.cH(i,t,this.k,this.j)},S:function(){_a.dg.prototype.S.call(this);for(var n=0;n<this.e.length;n++)this.n(this.e[n],this.l)},q:function(){var t=new _gg.eD;t.ReminderItemActions=this.p();var n=new _gg.iR(this.M());n.Body=t;return n},p:function(){for(var i=new Array(this.e.length),n=0;n<this.e.length;n++){var u=this.e[n];var r=new _g.e(u.c().Id);r.ChangeKey=u.c().ChangeKey;var t=new _gg.je;t.ItemId=r;this.o(t);i[n]=t}return i}};_c.h=function(n,t){_c.h.initializeBase(this,[0]);this.h=n;var i=_g.b.a.nameToId("todosearch");t&&t!==i||(t=_g.b.a.nameToId("tasks"));this.bm=_g.m.c(t);this.bf="CreateTask"};_c.h.prototype={h:null,f:null,bk:function(){return[this.j()]},cI:function(n){this.f=n.Items[0].ItemId},j:function(){for(var t=new _g.bP,f=this.h.d,o=this.h.f(),r=o,e=r.length,n=0;n<e;++n){var u=r[n];var i=_c.a.b(u);i&&i(t,f)}t.Owner=_g.a.a().c().bD.UserDisplayName;return t}};_c.r=function(n,t){_c.r.initializeBase(this);_a.b.b(n,"ParentGroup");this.h=n;var i=new _gg.bC;i.c(n.bD.GroupId);this.e=i;this.f=new _gg.fC;this.k=t};_c.r.prototype={e:null,f:null,h:null,k:null,l:function(n){if(!_j.h.b(n)){this.e.a(n);this.f.f(n)}},K:function(n){n.dZ(this.e.bD.FolderName,this.e.bD.ParentGroupId,null,this.J,this.H)},n:function(n){var t=new _g.l(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.f.j(t);this.f.t(_g.b.a.nameToId("tasks"));this.e.e(t);this.e.f(n.NewTaskFolderEntryId);var i=_h.a.c("msgfolderroot");i.by.a(this.f);this.k.n(this.h,this.e,this.f)}};_c.s=function(n,t,i){_c.s.initializeBase(this);_a.b.b(n,"taskFolderToDelete");_a.b.b(t,"parentGroup");_a.b.b(i,"taskGroupsCache");this.e=n;this.f=t;this.h=i};_c.s.prototype={e:null,f:null,h:null,K:function(n){var t=new _g.e(this.e.bD.ItemId.Id);t.ChangeKey=this.e.bD.ItemId.ChangeKey;n.en(t,null,this.J,this.H)},n:function(n){this.h.t(this.f,this.e)}};_c.m=function(n,t,i){_c.m.initializeBase(this,[n,t])};_c.m.prototype={bm:function(){this.bi&&(this.E=new _g.F(_g.m.a(this.bi)));var t=[];var r=this.bl(this.j);var n=new _g.u(new _g.d("TaskStatus"));n.Item=new _g.bP;n.Item.Status=r;Array.add(t,n);if(r==="InProgress"){var i=null;if(this.j.c()){n=new _g.u(new _g.d("TaskStartDate"));n.Item=new _g.bP;n.Item.StartDate=this.j.c().i();Array.add(t,n)}else{i=new _g.bi(new _g.d("TaskStartDate"));Array.add(t,i)}if(this.j.b()){n=new _g.u(new _g.d("TaskDueDate"));n.Item=new _g.bP;n.Item.DueDate=this.j.b().i();Array.add(t,n)}else{i=new _g.bi(new _g.d("TaskDueDate"));Array.add(t,i)}}if(r==="InProgress"||r==="Completed")if(this.j.e()){n=new _g.u(new _g.d("TaskCompleteDate"));n.Item=new _g.bP;n.Item.CompleteDate=this.j.e().i();Array.add(t,n)}else{var u=new _g.bi(new _g.d("TaskCompleteDate"));Array.add(t,u)}return t},t:function(){for(var r=this.bm(),t=new Array(this.l.length),n=0;n<this.l.length;n++){var i=new _g.e(this.l[n].bD.ItemId.Id);i.ChangeKey=this.l[n].bD.ItemId.ChangeKey;t[n]=new _g.bl;t[n].ItemId=i;t[n].Updates=r}return t},S:function(){var t=this.bl(this.j);var n=this.l;var l=this,c=this;_h.c.c(_dg.n,String,n,"Status",function(n){return n.b()},t,function(n,t){n.y(t)});var h=this,a=this;_h.c.c(_dg.n,Boolean,n,"IsComplete",function(n){return n.m()},t==="Completed",function(n,t){n.P(t)});if(t==="InProgress"){if(this.j.c()){var p=this,y=this;_h.c.c(_dg.n,_a.d,n,"StartDate",function(n){return n.j()},this.j.c(),function(n,t){n.U(t)})}if(this.j.b()){var v=this,u=this;_h.c.c(_dg.n,_a.d,n,"DueDate",function(n){return n.f()},this.j.b(),function(n,t){n.N(t)})}if(this.j.e()){var r=this,i=this;_h.c.c(_dg.n,_a.d,n,"CompleteDate",function(n){return n.h()},this.j.e(),function(n,t){n.G(t)})}}else if(t==="Completed"){var f=this,s=this;_h.c.c(_dg.n,String,n,"PercentComplete",function(n){return n.bD.PercentComplete},"100",function(n,t){n.R(t)});var o=this,e=this;_h.c.c(_dg.n,_a.d,n,"CompleteDate",function(n){return n.h()},this.j.e().d(),function(n,t){n.G(t)})}},bl:function(n){var t="NotStarted";switch(n.a()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":t="Completed";break;case"Flagged":t="InProgress";break}return t}};_c.x=function(){_c.x.initializeBase(this)};_c.x.prototype={e:null,K:function(n){var t=new _gg.ur(this.L);n.gq(t,this.J,this.H)},cS:function(n,t,i){try{this.f(n)}catch(r){i(r);return}t()},f:function(n){n&&(this.e=n.TaskGroups)}};_c.n=function(n,t,i,r,u,f){_c.n.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,f,!1,null,null,0,null,-1,null,!1])};_c.n.prototype={bC:function(){return _h.cG.a(this.u.a,this.u.b,this.t)}};_c.G=function(n,t,i){_c.G.initializeBase(this);_a.b.b(n,"taskFolderToRename");_a.b.c(t,"newTaskFolderName");_a.b.b(i,"taskGroupsCache");this.e=n;this.f=t;this.h=i};_c.G.prototype={e:null,f:null,h:null,K:function(n){var t=new _g.e(this.e.bD.ItemId.Id);t.ChangeKey=this.e.bD.ItemId.ChangeKey;n.hA(t,this.f,null,this.J,this.H)},n:function(n){this.e.bD.ItemId.ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.e.a(this.f);if(this.h.b){var t=this.h.j(this.e.bD.TaskFolderId);if(t){t.bD.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.f)}}}};_c.V=function(){this.j=String.format(_nbs.a.dL,-1);_c.V.initializeBase(this)};_c.V.prototype={cS:function(n,t,i){if(!n.WasSuccessful){this.j=_c.P.a(n.ErrorCode);i(Error.create(this.j));return}try{this.n(n)}catch(r){i(r);return}t()}};_c.P=function(){};_c.P.a=function(n){switch(n){case 11:return _nbs.a.gI;case 13:return _nbs.a.kY;case 7:return _nbs.a.JQ;default:return String.format(_nbs.a.dL,n)}};_c.b=function(n,t){this.b=n;this.a=t};_c.b.prototype={b:"FolderId",a:!1};_c.a=function(){};_c.a.b=function(n){_c.a.c();return _c.a.a[n]};_c.a.c=function(){if(!_c.a.a){_c.a.a={};_c.a.a.Subject=function(n,t){n.Subject=t.bD.Subject;return new _c.b("Subject",!1)};_c.a.a.DueDate=function(n,t){var i=!t.f();i||(n.DueDate=t.f().i());return new _c.b("TaskDueDate",i)};_c.a.a.Body=function(n,t){n.Body=new _g.s(t.O().a()==="HTML"?"HTML":"Text",t.O().bD.Value);return new _c.b("Body",!1)};_c.a.a.StartDate=function(n,t){var i=!t.j();i||(n.StartDate=t.j().i());return new _c.b("TaskStartDate",i)};_c.a.a.Importance=function(n,t){n.Importance=t.be();return new _c.b("Importance",!1)};_c.a.a.Status=function(n,t){n.Status=t.b();return new _c.b("TaskStatus",!1)};_c.a.a.CompleteDate=function(n,t){var i=!t.h();i||(n.CompleteDate=t.h().i());return new _c.b("TaskCompleteDate",i)};_c.a.a.PercentComplete=function(n,t){n.PercentComplete=t.bD.PercentComplete;return new _c.b("TaskPercentComplete",!1)};_c.a.a.Sensitivity=function(n,t){n.Sensitivity=t.cl();return new _c.b("Sensitivity",!1)};_c.a.a.TotalWork=function(n,t){n.TotalWork=t.x();return new _c.b("TaskTotalWork",!1)};_c.a.a.ActualWork=function(n,t){n.ActualWork=t.o();return new _c.b("TaskActualWork",!1)};_c.a.a.Mileage=function(n,t){n.Mileage=t.bD.Mileage;return new _c.b("TaskMileage",!1)};_c.a.a.BillingInformation=function(n,t){n.BillingInformation=t.bD.BillingInformation;return new _c.b("TaskBillingInformation",!1)};_c.a.a.Companies=function(n,t){var r=!t.g()&&t.g().b()>0;if(!r){for(var u=new Array(t.g().b()),i=0;i<t.g().b();i++)u[i]=t.g().a(i);n.Companies=u}return new _c.b("TaskCompanies",r)};_c.a.a.ReminderIsSet=function(n,t){n.ReminderIsSet=t.bD.ReminderIsSet;return new _c.b("ReminderIsSet",!1)};_c.a.a.ReminderDueBy=function(n,t){var i=!t.fc();i||(n.ReminderDueBy=t.fc().i());return new _c.b("ReminderDueBy",i)};_c.a.a.Recurrence=function(n,t){var i=!t.C();i||(n.Recurrence=t.C().bD);return new _c.b("TaskRecurrence",i)};_c.a.a.ModernReminders=function(n,t){var i=!t.z();i||(n.ModernReminders=t.z().h.p);return new _c.b("ModernReminders",i)};_c.a.a.Charm=function(n,t){n.Charm=t.q();return new _c.b("TaskCharm",!1)}}};_c.e=function(n){_c.e.initializeBase(this,[0]);this.j=n;var t=n.d;t.bD.ParentFolderId&&(this.bo=_g.m.c(t.bD.ParentFolderId));this.r="UpdateTask"};_c.e.a=function(n,t,i){if(i){var f=new _g.bP;var e=i(f,t);var r=new _g.d(e.b);if(e.a){var o=new _g.bi(r);Array.add(n,o)}else{var u=new _g.u(r);u.Item=f;Array.add(n,u)}}};_c.e.prototype={j:null,t:function(){for(var i=[],u=this.j.d,o=this.j.f(),r=o,f=r.length,n=0;n<f;++n){var e=r[n];_c.e.a(i,u,_c.a.b(e))}var t=new _g.bl;t.ItemId=_g.e.a(u.bD.ItemId);t.Updates=i;return[t]}};_c.CalendarTimePeriodSchema=function(){};_c.o=function(n){_c.o.initializeBase(this,[n])};_c.o.prototype={c:function(){return"KeepAliveActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){var t=new Sys.Net.WebRequest;t.set_url(_j.h.a(_a.g.m)?"ping.owa":_a.g.m);t.set_timeout(6e4);t.invoke()}};_c.D=function(n,t){_c.D.initializeBase(this,[n]);this.f=t};_c.D.prototype={f:null,c:function(){return"PresenceActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){this.f.x()}};_c.d=function(n,t){this.b=n;this.a=t};_c.d.prototype={b:0,a:null};_c.l=function(){_c.l.initializeBase(this)};_c.l.prototype={k:0,l:null,m:null,n:!1,p:!1,o:null,h:function(){return this.k},d:function(n){if(n===this.k)return n;this.k=n;this.eG("ExternalAudience");return n},i:function(){return this.l},e:function(n){if(n===this.l)return n;this.l=n;this.eG("ExternalReply");return n},j:function(){return this.m},f:function(n){if(n===this.m)return n;this.m=n;this.eG("InternalReply");return n},a:function(){return this.n},b:function(n){if(n===this.n)return n;this.n=n;this.eG("IsOofOn");return n},g:function(n){if(n===this.p)return n;this.p=n;this.eG("IsScheduled");return n},c:function(n){if(n===this.o)return n;this.o=n;this.eG("EndTime");return n}};_c.C=function(){};_c.C.prototype={a:function(n,t,i,r){return new _c.i(n,t,new _g.dU(r),i,_g.k.b)}};_c.i=function(n,t,i,r,u){_c.i.initializeBase(this,[null,n,t,i,r]);this.a=u};_c.i.prototype={a:null,A:function(){return this.a},z:function(n,t,i){},u:function(n,t,i){},q:function(n){return n},E:function(n,t,i,r,u){_j.e.a(_c.i.a,"ExecuteWithActionQueue {0}",n);this.a.jo(n,t,i,r,u);return}};_c.T=function(){_c.T.initializeBase(this)};_c.T.prototype={callState:null};_c.R=function(n,t,i){_c.R.initializeBase(this,[n]);this.f=_j.F.a(t)?"All":t;this.e=i?i:new _h.p("TaskDueDate","Ascending");this.i=this.i+"_item_"+this.f+"_"+this.e.a.toString()+"_"+this.e.b.toString()+"_"};_c.R.prototype={f:"All",e:null,c:function(){return this.f},d:function(){return _h.cG.a(this.e.a,this.e.b,this.j)}};_c.p=function(n){_c.p.initializeBase(this,[n,null,_c.p.a(n)])};_c.p.a=function(n){return[new _h.x(n,!1,n.d(),n.c())]};_c.p.prototype={bC:function(){return _a.a.fI},bS:function(){return this.bB.f},bH:function(){return this.bB.e},r:function(){return null},H:function(){return!1},L:function(n,t){var i=this;n.k(function(){i.co==="ErrorConnectionFailed"&&n.i()&&n.f()?t(6):t(1)})},cH:function(n){},ca:function(n){var t=Math.max(this.cL(),this.by.x.length);this.ck(4);this.bN(this.cG(t,this.h()))},bM:function(n,t){if(!_h.m.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.m,"range needs to be an IndexedRange object");return this.cG(n.b,n.a)},Q:function(n){return!1},cO:function(n,t){var i=n;i.dP(t)},dS:function(n,t){return!0},cw:function(n,t){return-2},cF:function(n,t,i){return new _c.n(this.e(),this.r(),n,!1,this.bS(),this.bH())},cG:function(n,t){return new _c.n(this.e(),this.r(),_h.v.a(t,n),!1,this.bS(),this.bH())}};_c.Q=function(){this.g=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.s);this.a={};this.e=[];_c.Q.initializeBase(this)};_c.Q.prototype={c:null,b:!1,d:!1,f:0,m:function(n){this.bA("CachePopulated",n)},u:function(n){if(n!==this.b){this.b=n;this.bw("IsLoaded")}return n},p:function(){return _nbs.a.eX},j:function(n){return this.a?n.Id in this.a?this.a[n.Id]:null:null},k:function(n){if(this.b){n&&n();return!0}n&&Array.add(this.e,n);this.o();return!1},n:function(n,t,i){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolderEntry");_a.b.a(i,"folder");t.c(n.bD.GroupId);n.a().c(t);this.a[t.bD.TaskFolderId.Id]=i},t:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolder");delete this.a[t.bD.TaskFolderId.Id];n.a().k(t)},o:function(){if(!this.d){this.d=!0;this.l()}},l:function(){var n=new _c.x;n.b(this.i);n.c(this.h);n.a(this.g);_a.g.a.a(n)},s:function(n){var c=n;this.c=new _j.l;this.a={};for(var l=!1,s=0;s<c.e.length;s++){var i=new _gg.fB(c.e[s]);i.b()||i.c(_nbs.a.Nu);for(var f=i.a().b()-1;f>=0;f--){var r=i.a().a(f);var t=null;if(r.b()===1){t=_g.j.a("todosearch");l=!0;r.a(_nbs.a.en);t&&t.f(_nbs.a.en)}else{t=_h.a.a(r.bD.TaskFolderId);r.b()===2&&r.a(t.f(this.p()))}t?this.a[r.bD.TaskFolderId.Id]=t:i.a().o(f)}this.c.a(i)}if(!l&&this.c.x.length>0){var h=this.c.x[0];var o=_g.j.a("todosearch");o.f(_nbs.a.en);var u=new _gg.bC;u.a(_nbs.a.en);u.g(1);u.e(o.bD.FolderId);u.c(h.bD.GroupId);h.a().r(0,u);this.a[u.bD.TaskFolderId.Id]=o}this.u(!0);this.d=!1;this.bJ("CachePopulated",this,null);for(var e=0;e<this.e.length;e++)this.e[e]();this.e=[]},r:function(n){if(this.f<3){var t=this;_j.m.a().a(_a.a.bU,"GetTaskFoldersActionRetry",function(){t.l()},2e3);this.f++}else{this.f=0;this.d=!1}},q:function(n){n.U(this.i);n.T(this.h);n.m(this.g)}};_c.c=function(n,t,i,r){_c.c.initializeBase(this,[n,t,_c.c.b(),"None",i,r,null,null])};_c.c.b=function(){if(!_c.c.a){_c.c.a=new _g.X("IdOnly");_c.c.a.AddBlankTargetToLinks=!0;_c.c.a.ClientSupportsIrm=!0;_c.c.a.FilterHtmlContent=!0;_c.c.a.InlineImageUrlTemplate=_g.D.b();_c.c.a.MaximumBodySize=0;_c.c.a.AdditionalProperties=[new _g.d("UID"),new _g.d("ItemParentId"),new _g.d("InstanceKey"),new _g.d("Subject"),new _g.d("TaskDueDate"),new _g.d("Body"),new _g.d("NormalizedBody"),new _g.d("HasAttachments"),new _g.d("Attachments"),new _g.d("TaskStartDate"),new _g.d("Importance"),new _g.d("TaskStatus"),new _g.d("TaskCompleteDate"),new _g.d("TaskPercentComplete"),new _g.d("Sensitivity"),new _g.d("TaskOwner"),new _g.d("Categories"),new _g.d("TaskTotalWork"),new _g.d("TaskActualWork"),new _g.d("TaskMileage"),new _g.d("TaskBillingInformation"),new _g.d("TaskCompanies"),new _g.d("TaskRecurrence"),new _g.d("ReminderDueBy"),new _g.d("ReminderIsSet"),new _g.d("ReminderNextTime"),new _g.d("ReminderMinutesBeforeStart"),new _g.d("ItemLastModifiedTime"),new _g.d("TaskIsComplete"),new _g.d("TaskIsTaskRecurring"),new _g.d("ItemClass"),new _g.d("TaskDelegationState"),new _g.d("TaskDoItTime"),new _g.d("TaskCharm")]}return _c.c.a};_c.c.prototype={cI:function(n){try{_h.bX.prototype.cI.call(this,n)}catch(t){this.bO("ProcessResponseMessageFailed",this);throw t;}}};_c.j=function(n,t){_c.j.initializeBase(this,[n,t,_c.j.a])};_c.H=function(){};_c.H.prototype={a:function(n,t,i){return new _c.j(n,t)}};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.a]);_a.b.b(i,"nativeBridge");this.i=i};_c.CreateAttachmentResponseProcessor.prototype={i:null,j:function(n,t){var r=null;var i=null;if(t.ResponseClass==="Success"){r=t.Attachments[0].AttachmentId;i=new _g.e(r.RootItemId);i.ChangeKey=r.RootItemChangeKey;var f=this.g().Body.ParentItemId;this.e.u(this.b,f,i)}if(this.a()){var e=this.a().attachmentIds[n];this.t(t.ResponseClass,e,r,i);if(this.a().palContext&&this.a().palContext.palActionNeeded&&this.i.b(this.i.i())){var u=this.i.i().b();u.e(this.a().dataFile);this.i.i().a(u.c())}}_h.dM.prototype.j.call(this,n,t)},t:function(n,t,i,r){n==="Success"?this.y(t,i,r):this.u(t)},y:function(n,t,i){var u=new _g.bh(t.Id);this.e.z(this.b,n,u);if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this;this.d().a().d(this.b,this.d().h().b(i.Id),function(t){if(_j.F.a(t)){_j.e.b(r.f,"Message with id {0} not found in local store",i.Id);return}r.z(t,n,u)})}},u:function(n){if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this.c.request.parameters;var t=new _g.e(r.Body.Attachments[0].AttachmentId.RootItemId);var i=this;this.d().a().d(this.b,this.d().h().b(t.Id),function(r){if(!r){_j.e.b(i.f,"Message with id {0} not found in local store",t.Id);return}i.m(r,n)})}},z:function(n,t,i){var u=n;if(!u.HasAttachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if(!u.Attachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var e=u.Attachments,o=e.length,r=0;r<o;++r){var f=e[r];if(f.AttachmentId.Id===t.Id){f.AttachmentId.Id=i.Id;return}}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)},m:function(n,t){var i=n;if(i.HasAttachments&&i.Attachments){for(var r=0;r<i.Attachments.length;r++)if(i.Attachments[r].AttachmentId.Id===t.Id){Array.removeAt(i.Attachments,r);break}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)}}};_c.I=function(){};_c.I.prototype={a:function(n,t,i){return new _c.CreateAttachmentResponseProcessor(n,t,i)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.a])};_c.DeleteAttachmentResponseProcessor.prototype={j:function(n,t){var i=this.a().itemContexts[n];if(t.ResponseClass==="Success"){var f=this.e.q(i.parentItemId);var r=new _g.e(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.e.u(this.b,f,r)}else if(this.l()&&i.clientStoreItem===2){this.b.b().b(!1);var u=this.e.q(i.parentItemId);this.d().a().g(this.b,this.d().h().b(u.Id),i.deletedAttachment)}_h.dM.prototype.j.call(this,n,t)}};_c.J=function(){};_c.J.prototype={a:function(n,t,i){return new _c.DeleteAttachmentResponseProcessor(n,t)}};_c.k=function(n,t){_c.k.initializeBase(this,[n,t,_c.k.a])};_c.K=function(){};_c.K.prototype={a:function(n,t,i){return new _c.k(n,t)}};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.a])};_c.L=function(){};_c.L.prototype={a:function(n,t,i){return new _c.PerformReminderActionResponseProcessor(n,t)}};_c.f.registerClass("_c.f");_c.g.registerClass("_c.g");_c.q.registerClass("_c.q",_h.fG,_a.fE);_c.v.registerClass("_c.v",_h.fG);_c.w.registerClass("_c.w",_h.fG);_c.y.registerClass("_c.y",_h.fG,_a.fE);_c.E.registerClass("_c.E",_h.fG);_c.N.registerClass("_c.N",_h.fG);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.jw,_j.ce);_c.S.registerClass("_c.S",_h.fH);_c.t.registerClass("_c.t",_c.S);_c.u.registerClass("_c.u",_h.fG);_c.O.registerClass("_c.O",_c.S);_c.A.registerClass("_c.A",_h.dr.$$(_gg.xI,_gg.xJ));_c.B.registerClass("_c.B",_h.dr.$$(_gg.pE,_gg.pF));_c.z.registerClass("_c.z",_h.fG);_c.M.registerClass("_c.M",_h.fG);_c.F.registerClass("_c.F",_h.fG,_a.fE);_c.h.registerClass("_c.h",_h.fc);_c.V.registerClass("_c.V",_h.fG);_c.r.registerClass("_c.r",_c.V);_c.s.registerClass("_c.s",_c.V);_c.m.registerClass("_c.m",_h.bo);_c.x.registerClass("_c.x",_h.fG);_c.n.registerClass("_c.n",_h.bh);_c.G.registerClass("_c.G",_c.V);_c.e.registerClass("_c.e",_h.cH);_c.o.registerClass("_c.o",_a.jd);_c.D.registerClass("_c.D",_a.jd);_c.d.registerClass("_c.d");_c.l.registerClass("_c.l",_a.cn);_c.C.registerClass("_c.C",null,_h.dz);_c.i.registerClass("_c.i",_g.k);_c.T.registerClass("_c.T",_no.k);_c.T.prototype.toString=_no.k.prototype.toString;_c.R.registerClass("_c.R",_h.dU.$$(_c.p),_h.fs);_c.p.registerClass("_c.p",_lm.c);_c.Q.registerClass("_c.Q",_j.R);_c.c.registerClass("_c.c",_h.bX);_c.j.registerClass("_c.j",_h.dN.$$(_cz.eK,Boolean));_c.H.registerClass("_c.H",null,_db.cw,_h.eT);_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.dM.$$(_gg.lA,_gg.dF,_gg.fW,_gg.fK));_c.I.registerClass("_c.I",null,_db.cx,_h.eT);_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.dM.$$(_gg.pe,_gg.gg,_gg.gh,_gg.gj));_c.J.registerClass("_c.J",null,_db.cz,_h.eT);_c.k.registerClass("_c.k",_h.dN.$$(_cz.ew,_pc.a));_c.K.registerClass("_c.K",null,_db.cB,_h.eT);_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.dM.$$(_gg.xA,_gg.iR,_gg.iS,_g.gt));_c.L.registerClass("_c.L",null,_db.cC,_h.eT);CoreModelsComponent.$$cctor();_c.a.a=null;_c.CalendarTimePeriodSchema.c=new _a.e("Start",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.a=new _a.e("End",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.b=new _a.e("Recurrence",_dg.x,_dg.ICalendarTimePeriod);_c.i.a=_a.a.fn;_c.c.a=null;_c.j.a=_a.a.dF;_c.CreateAttachmentResponseProcessor.a=_a.a.c;_c.DeleteAttachmentResponseProcessor.a=_a.a.c;_c.k.a=_a.a.eE;_c.PerformReminderActionResponseProcessor.a=_a.a.fk;
window.scriptsLoaded['microsoft.owa.core.models.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.models.js'] = (new Date()).getTime();
