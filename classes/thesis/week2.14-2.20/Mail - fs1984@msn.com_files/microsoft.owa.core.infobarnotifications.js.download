try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.infobarnotifications.js'] = (new Date()).getTime();
Type.registerNamespace("_inot");_inot.f=function(n){_inot.f.initializeBase(this,[n])};_inot.b=function(n,t){_inot.b.initializeBase(this,[n]);this.__type=_inot.b._dataContractName;this.Body=t};_inot.g=function(){_inot.g.initializeBase(this);this.__type=_inot.g._dataContractName;this.Body=new _inot.h};_inot.c=function(n,t){_inot.c.initializeBase(this);this.__type=_inot.c._dataContractName;this.ItemId=n;this.Id=t;this.Notifications=new Array(0)};_inot.h=function(){_inot.h.initializeBase(this);this.__type=_inot.h._dataContractName};_inot.j=function(n){this.c=n};_inot.j.prototype={c:null,a:function(){return this.c},b:function(n,t){if(n&&t){for(var u={},f=0;f<n.ch.b();f++){var r=n.ch.a(f);var i=r.a;var o=this;var e=new _inot.d(r,function(t,i){o.c.b(n,t,i,function(){},function(n){})});this.f(t,e,i,r.Key,this.h(r));if(!(i in u)){u[i]=!0;this.j(t,i,this.i(n,i))}}this.k(t,Object.keys(u))}},f:function(n,t,i,r,u){this.d(n,i,r);var f=String.format("{0}:{1}",i,r);return n.j(12e3,t,f,u)},d:function(n,t,i){var r=String.format("{0}:{1}",t,i);n.m(12e3,r)},j:function(n,t,i){for(var f=this.g(n,t),e=f.length,r=0;r<e;++r){var u=f[r];Array.contains(i,u)||this.d(n,t,u)}},k:function(n,t){for(var o=this.e(n,12e3),f=o,s=f.length,i=0;i<s;++i){var r=f[i];var u=r.split(":",2)[0];var e=r.split(":",2)[1];Array.contains(t,u)||this.d(n,u,e)}},g:function(n,t){for(var u=[],e=this.e(n,12e3),r=e,o=r.length,i=0;i<o;++i){var f=r[i];f.startsWith(t)&&u.push(f.substr(t.length+1))}return u},i:function(n,t){for(var r=[],i=0;i<n.ch.b();i++)n.ch.a(i).a===t&&r.push(n.ch.a(i).Key);return r},h:function(n){var t=n.Type===undefined?0:n.Type;switch(t){case 2:return 0;case 0:return 1;case 1:return 2}return 0},e:function(n,t){for(var u=[],i=0;i<n.e().x.length;i++){var r=n.e().x[i];r.d===t&&r.f&&u.push(r.f)}return u}};function InfoBarNotificationsComponent(){}InfoBarNotificationsComponent.$$cctor=function(){_a.t.a().a(InfoBarNotificationsComponent)};InfoBarNotificationsComponent.prototype={b:function(n,t,i){var f=this;n.b(IPersistedNotificationsManager,function(){return new _inot.e}).a().b(IPersistedNotificationsManager);var u=this;n.b(IExtensibilityNotificationsManager,function(){return new _inot.i(n.a(IPersistedNotificationsManager))}).a().b(IExtensibilityNotificationsManager);var r=this;n.b(IInfoBarNotificationsManager,function(){return new _inot.j(n.a(IExtensibilityNotificationsManager))}).a().b(IInfoBarNotificationsManager)},a:function(){return null}};_inot.i=function(n){this.e=n};_inot.i.prototype={e:null,a:function(){return this.e},b:function(n,t,i,r,u){for(var f=0;f<n.ch.b();f++)if(n.ch.a(f).a===t&&n.ch.a(f).Key===i){var e=n.ch.a(f).b;n.ch.o(f);if(e){var s=this,o=this;this.e.b(t,n,function(){r()},function(n){u(n)})}else r();return}u(9024)},c:function(n,t,i,r){for(var e=5,u=0;u<t.ch.b();u++){var f=t.ch.a(u);if(f.a===n.a){if(f.Key===n.Key){r(9023);return}e--;if(!e){r(9025);return}}}t.ch.c(n);if(n.b){var s=this,o=this;this.e.b(n.a,t,function(){i()},function(n){r(n)})}else i()},d:function(n,t,i,r){for(var u=0;u<t.ch.b();u++){var f=t.ch.a(u);if(f.a===n.a&&f.Key===n.Key){var e=n.b||f.b;t.ch.C(u,n);if(e){var s=this,o=this;this.e.b(n.a,t,function(){i()},function(n){r(n)})}else i();return}}this.c(n,t,i,r)}};_inot.e=function(){};_inot.e.a=function(n,t,i){var u=n.Type===undefined?0:n.Type;var r;return r=new _g.dc,r.a=t.toLowerCase(),r.b=i,r.Key=n.Key,r.Icon=n.Icon,r.Type=u,r.Message=n.Message,r};_inot.e.b=function(n,t){for(var u=[],r=0;r<n.ch.b();r++){var i=n.ch.a(r);i&&i.a===t&&i.b&&u.push(i)}return u};_inot.e.prototype={d:function(n,t){if(!n.ge){n.ge=!0;if(n.dI())for(var u=0;u<n.dI().b();u++){for(var f=!1,i=n.dI().a(u),r=0;r<i.Notifications.length;r++){t&&i.Notifications[r].Type===2&&(f=!0);n.ch.c(_inot.e.a(i.Notifications[r],i.Id,!t||i.Notifications[r].Type!==2))}if(f){var o=this,e=this;this.b(i.Id,n,function(){},function(n){})}}}},b:function(n,t,i,r){var f=_inot.e.b(t,n);if(!t.bD.ItemId||!t.bD.ItemId.Id){r(9028);return}var u=new _inot.k(t.bD.ItemId,n.toLowerCase(),f);var o=this;u.c(function(n){i()});var e=this;u.e(function(n){r(9027)});_a.g.a.a(u)},c:function(n,t,i){var f=!!n.bD.PropertyExistence&&!!n.bD.PropertyExistence.WebExtNotifications;var e=f&&(!n.dI()||!n.dI().b());n.dI()||n.bD.ItemId&&n.bD.ItemId.Id||n.gV(new _a.k);if(e){var r=new _h.I(1300,[new _g.f(n.bD.ItemId.Id)],_h.b.a(),"ItemNormalizedBody",0,!1,null);var u=this;r.c(function(i){var r=_h.d.a().a(n.bD.ItemId.Id);n.gV(r.dI()?r.dI():new _a.k);u.d(n,!0);t()});var o=this;r.e(function(n){i(9026)});_a.g.a.a(r);return}this.d(n,!0);t()},a:function(n){var i=this,t=this;this.c(n,function(){},function(n){})}};_inot.k=function(n,t,i){_inot.k.initializeBase(this);this.g=n;this.d=t;this.i=i};_inot.k.prototype={g:null,d:null,i:null,j:null,L:function(n){var i=new _inot.f(this.M);i.actionName="UpdateClientExtensionNotificationsAction";i.owsVersion="V2_75";var t;var r=new _inot.b(this.X("V2_75"),(t=new _inot.c,t.Id=this.d,t.ItemId=this.g,t.Notifications=this.i,t));n.dl(r,i,this.K,this.J)},cJ:function(n){this.j=n}};_inot.d=function(n,t){this.d=Function.createDelegate(this,this.e);_inot.d.initializeBase(this,["ExtensibilityInfoBarView"]);this.a=n;this.c=t;this.b=new _j.g(this.d,_a.a.h)};_inot.d.prototype={a:null,c:null,b:null,e:function(){this.c(this.a.a,this.a.Key)}};_inot.a=function(){};_inot.a.$$cctor=function(){_inot.a._I()};_inot.a.d=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_inot_2'></span> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_inot_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div>";_j.i.a().appendChild(n);return n};_inot.a.g=function(n){return n.a.Message};_inot.a.f=function(n){return n.b};_inot.a.c=function(n,t){n.a(t)};_inot.a.e=function(n,t){n.T(t)};_inot.a._I=function(){var t="ExtensibilityInfoBarView._tid1";new _j.d(t,function(){_inot.a.a[t]===undefined&&(_inot.a.a[t]=[[[-1,4,null,null,null,"Text",null,_inot.a.c,0,null,null,null,_u.S.A]]]);var n=_inot.a.b.childNodes[0].cloneNode(!0);var i=new _fc.a(n.children[0]);return new _j.a(n,[i])},"",_inot.d,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_inot.a.a);var n="ExtensibilityInfoBarView";new _j.d(n,function(){_inot.a.a[n]===undefined&&(_inot.a.a[n]=[[[-1,0,["InfoBarText"],[_inot.a.g],null,"Text",null,_inot.a.c,1,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_inot.a.f],null,"ClickCommand",null,_inot.a.e,0,null,null,null]]]);var t=_inot.a.b.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(t,[0,2]));r.y("ExtensibilityInfoBarView._tid1");var i=new _fc.a(_j.a.a(t,[0,1]));i.a("|");var u=new _fc.a(_j.a.a(t,[0,0]));return new _j.a(t,[u,i,r])},"",_inot.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_inot.a.a)};_inot.f.registerClass("_inot.f",_g.hA,0,0);_inot.b.registerClass("_inot.b",_g.hM,0,0);_inot.g.registerClass("_inot.g",_g.kd);_inot.c.registerClass("_inot.c",_g.kg);_inot.h.registerClass("_inot.h",_g.gm);InfoBarNotificationsComponent.registerClass("InfoBarNotificationsComponent",null,_a.iz,_j.cd);_inot.k.registerClass("_inot.k",_h.cW.$$(_inot.g,_inot.h));_inot.d.registerClass("_inot.d",_y.iK);_inot.b._dataContractName="UpdateClientExtensionNotificationsJsonRequest:#Exchange";_inot.g._dataContractName="UpdateClientExtensionNotificationsJsonResponse:#Exchange";_inot.c._dataContractName="UpdateClientExtensionNotificationsRequest:#Exchange";_inot.h._dataContractName="UpdateClientExtensionNotificationsResponseMessage:#Exchange";InfoBarNotificationsComponent.$$cctor();_inot.a.b=_inot.a.d();_inot.a.a={};_inot.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.infobarnotifications.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.infobarnotifications.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
