try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.triageshared.js'] = (new Date()).getTime();
Type.registerNamespace("_trs");_trs.h=function(n){this.a=n};_trs.h.prototype={a:null,b:function(){var n=this.a.b();var i=this.a.e();var t=i.bD.UseDatabaseQuotaDefaults?n.c():i.b();return t.bD.IsUnlimited?n.b().bD.IsUnlimited?100:n.b().bD.Value>0?3:0:n.b().bD.Value/t.bD.Value*100},d:function(){var i=this.a.b();var r=this.a.e();var t=r.bD.UseDatabaseQuotaDefaults?i.e():r.c();var u=i.b().bD.Value;var n;if(t.bD.IsUnlimited)return _ops.b.ah;if(u>=t.bD.Value){if(t.bD.Value>=1073741824){n=(t.bD.Value/1073741824).toFixed(2);return _j.h.c(_ops.b.Zm,n)}if(t.bD.Value>=1048576){n=(t.bD.Value/1048576).toFixed(2);return _j.h.c(_ops.b.Wg,n)}n=(t.bD.Value/1024).toFixed(2);return _j.h.c(_ops.b.To,n)}else{if(t.bD.Value>=1073741824){n=(t.bD.Value/1073741824).toFixed(2);return _j.h.c(_ops.b.Wo,n)}if(t.bD.Value>=1048576){n=(t.bD.Value/1048576).toFixed(2);return _j.h.c(_ops.b.aW,n)}n=(t.bD.Value/1024).toFixed(2);return _j.h.c(_ops.b.Fc,n)}},e:function(){var i=this.a.b();var r=this.a.e();var t=r.bD.UseDatabaseQuotaDefaults?i.c():r.b();var u=i.b().bD.Value;var n;if(t.bD.IsUnlimited)return _ops.b.RE;if(t.bD.Value>=1073741824){n=(t.bD.Value/1073741824).toFixed(2);return _j.h.c(_ops.b.Do,n)}if(t.bD.Value>=1048576){n=(t.bD.Value/1048576).toFixed(2);return _j.h.c(_ops.b.N,n)}n=(t.bD.Value/1024).toFixed(2);return _j.h.c(_ops.b.cI,n)},c:function(n,t,i){var r;var f=this.a.b();var u=f.b().bD.Value;if(u>=1073741824){r=(u/1073741824).toFixed(2);return _j.h.c(n,r)}if(u>=1048576){r=(u/1048576).toFixed(2);return _j.h.c(t,r)}r=(u/1024).toFixed(2);return _j.h.c(i,r)}};function TriageSharedComponent(){}TriageSharedComponent.$$cctor=function(){_a.t.a().a(TriageSharedComponent)};TriageSharedComponent.prototype={b:function(n,t,i){var f=this;n.b(IHoverActionViewModelFactory,function(){return new _trs.c(n.a(_a.f),n.a(_g.h),n.a(_j.j))}).b(IHoverActionViewModelFactory);var e=this;n.b(IModuleSwitcherViewModel,function(){return new _trs.f(n.a(_a.X),n.a(_a.f),n.a(_a.eR),n.a(_a.W),n.a(_g.bG))}).b(IModuleSwitcherViewModel).a();var r=this;n.b(INotificationBar,function(){return new _trs.b(window.document.createElement("div"))}).a();var u=this;n.b(IMailboxUsageNotificationViewModel,function(){var t=n.a(_a.f);return t&&t.a().hD().Enabled?new _trs.k(n.a(INotificationBar)):null}).a()},a:function(){return[]}};_trs.k=function(n){this.f=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.n);this.e=Function.createDelegate(this,this.l);this.d=n};_trs.k.prototype={d:null,b:0,c:null,h:null,j:function(){return _j.h.c("Your mailbox is {0}% full.",this.b)},k:function(){return this.b>=98?"You will no longer be able to send or receive email.":"Once it's full, you won't be able to send or receive email."},i:function(){return this.b>=98?1:0},a:function(){var n=new _trs.j;n.c(this.e);_a.g.a.a(n)},l:function(n){var i=n;var t=new _trs.h(i.d);this.b=Math.round(t.b());this.b>=95&&this.o()},o:function(){this.d.d(this.g,this.f,this.i(),this.j(),this.k(),"Clean up mailbox",this.h,null,null,_fm.a.u,this.c)},n:function(n){this.c=n;_a.c.c(_a.a.w,"ShowMailboxUsage",this.b.toString(),0)},m:function(){this.c=null;_a.c.c(_a.a.w,"HideMailboxUsage")}};_trs.c=function(n,t,i){this.f=i;if(n){var u=t.b().h();this.g=u.b()===_trs.c.a.b();if(!_trs.c.c&&this.g){_trs.c.c=!0;for(var r=0;r<_trs.c.a.b();r++)if(u.a(r)!==_trs.c.a.a(r)){_h.l.a(_a.a.O,"CustomHoverActions",-1,0,null);break}}}};_trs.c.prototype={f:null,g:!1,i:null,b:function(n){var i=_g.a.a().b().h();var r=new _a.k;if(this.g)for(var t=0;t<i.b();t++)i.a(t)&&r.c(i.a(t));else r=_trs.c.a;return this.h(r,n)},a:function(n,t){var u=_g.a.a().b().h();var i=new _a.k;if(this.g)if(_g.x.isInstanceOfType(n))for(var r=0;r<u.b();r++)u.a(r)&&i.c(u.a(r));else u.g(1)&&i.c(1);else _g.x.isInstanceOfType(n)?i=_trs.c.a:i.c(1);return this.h(i,t)},e:function(n){var u=_g.a.a().b().h();var t=new _a.k;if(this.g)for(var r=0;r<u.b();r++){var i=u.a(r);(i===4||i===1||i===5)&&t.c(i)}else{t.c(5);t.c(4);t.c(1)}return this.h(t,n)},d:function(n,t){for(var u=this.g?_g.a.a().b().h():_trs.c.b,f=new _a.k,i=0;i<u.b();i++){var r=u.a(i);(_g.x.isInstanceOfType(n)&&r===4||r===1)&&f.c(r)}return this.h(f,t)},c:function(n,t){for(var u=this.g?_g.a.a().b().h():_trs.c.b,f=new _a.k,i=0;i<u.b();i++){var r=u.a(i);(_g.x.isInstanceOfType(n)&&r===4||r===1)&&f.c(r)}return this.h(f,t)},h:function(n,t){var r=new _j.l;if(t&&_a.fO.isInstanceOfType(t)&&t.fc)r.a(this.j(t));else for(var i=0;i<n.b();i++)r.a(this.k(n.a(i),t));return r},k:function(n,t){var i;switch(n){case 1:i=new _trs.g(this.f,t,1,t.S(),_n.b.U(),_n.b.bk(),_u.R.MQ,null,null);break;case 2:i=new _trs.g(this.f,t,2,t.b(),_n.b.cl(),_n.b.dJ(),_u.R.Es,null,null);break;case 5:var f=new _fce.g(new _b.a(_a.o.a(),_j.m.a()),this.f,_y.c.a,_g.a.a());f.c(t.p());f.j(!!t.p()&&t.p().q());var e=_y.fI.isInstanceOfType(t)?t.e():null;i=new _trs.g(this.f,t,5,t.Y(),t.U(),t.T(),t.V(),f,e);break;case 3:var r=t;i=new _trs.g(this.f,t,3,r.f(),r.d(),r.c(),r.a(),null,null);break;case 6:var o=t;var u=new _fce.g(new _b.a(_a.o.a(),_j.m.a()),this.f,_y.c.a,_g.a.a());u.e=!0;u.b=1;i=new _trs.g(this.f,t,6,o.e(),_n.b.cB(),_n.b.eD(),_u.R.PA,u,null);break;case 4:i=new _trs.g(this.f,t,4,t.Z(),_n.b.eW(),_n.b.eX(),t.z(),null,null);break;default:i=this.j(t);break}return i},j:function(n){this.i&&(this.i=new _trs.g(this.f,n,0,_j.g.a,null,null,"",null,null));return this.i}};_trs.d=function(n,t,i,r){this.q=Function.createDelegate(this,this.G);_trs.d.initializeBase(this,[t,n,null,!1,null,null,"ModuleSwitcherView.ContextMenuSwitch"]);this.i=i;this.m=r;this.A(new _j.g(this.q,_trs.f.a))};_trs.d.prototype={m:null,u:function(){return this.m.b===this.i},C:function(){return String.format(_u.R.RB,this.j)},i:null,e:function(){return new _trs.d(this.o,this.j,this.i,this.m)},bw:function(){this.m=null;_j.Q.prototype.bw.call(this)},G:function(){this.m.t(this.i)}};_trs.f=function(n,t,i,r,u){this.f=Function.createDelegate(this,this.s);_trs.f.initializeBase(this);_a.c.c(_trs.f.a,"ModSwitchInit");this.n=n;this.j=t;this.c=i;this.d=r;this.e=u;this.q();this.p(this.c.a());this.c.b(this.f);this.g=!t.a().el().Enabled};_trs.f.prototype={n:null,j:null,c:null,d:null,e:null,b:0,k:null,i:null,l:null,o:null,m:null,g:!1,a:null,h:null,p:function(n){if(this.b!==n){this.b=n;this.eB("CurrentModuleType")}return n},t:function(n){var i=new _a.l;i.b("F",_a.L.toString(this.b));i.b("T",_a.L.toString(n));var t;var u,r;(r=this.u(n,u={val:t}),t=u.val,r)?this.d.c(t):this.n.a(_a.ba.a(n),null);_h.l.a(_trs.f.a,"ModSwitch",19,1,i)},eE:function(){this.c.c(this.f);_a.fO.prototype.eE.call(this)},u:function(n,t){t.val=null;if(n===5){t.val=this.d.b().replace(this.d.l(),"/mail/photohub.aspx");return!0}return!1},q:function(){this.a=new Array(0);this.k=new _trs.d(_fm.b.a(_fm.a.f),_u.R.DF,0,this);this.a.push(this.k);if(this.e.bD.Calendar){this.i=new _trs.d(_fm.b.a(_fm.a.L),_u.R.IO,1,this);this.a.push(this.i)}if(this.e.bD.Contacts){this.l=new _trs.d(_fm.b.a(_fm.a.V),_u.R.FO,2,this);this.a.push(this.l)}if(this.j.a().hf().Enabled){this.m=new _trs.d(_fm.b.a(_fm.a.bU),_u.R.IE,5,this);this.a.push(this.m)}if(this.e.bD.Tasks){this.o=new _trs.d(_fm.b.a(_fm.a.bs),_u.R.En,3,this);this.a.push(this.o)}this.h=new _trs.d(_fm.b.a(_fm.a.h),_u.R.Ox,null,this)},s:function(){this.p(this.c.a())}};_trs.j=function(){_trs.j.initializeBase(this)};_trs.j.prototype={d:null,L:function(n){var i=new _dg.cI(this.M);var t=new _dg.bW(this.N());n.by(t,i,this.K,this.J)},cU:function(n,t,i){if(n&&n.AccountInfo){this.d=new _dg.be(n.AccountInfo);t()}}};_trs.e=function(n){this.a=new _fm.e(null);this.e=new _j.l;_trs.e.initializeBase(this,[n]);this.y("ModuleSwitcherView")};_trs.e.prototype={d:205,b:!1,i:function(n){if(this.d!==n){this.d=n;this.b||this.f()}return n},j:function(n){if(this.b!==n){this.b=n;this.b&&this.f();this.bv("IsVertical")}return n},g:function(){return!this.a.p.x.length},c:!1,f:function(){this.c=!1;var u=this.V();var i=u.a.length;var n;if(this.b)n=Math.min(5,i);else{var f=Math.floor((this.d-5)/40);n=Math.min(f,i);n<i&&(n-=1)}this.e.g();this.h();for(var t=0;t<i;t++){var r=u.a[t];if(t<n)this.e.a(r);else{this.a.p.a(r.e());r.i===u.b&&(this.c=!0)}}this.by("HideMoreModulesButton","IsActiveModuleInOverflowMenu")},h:function(){this.a.q()&&this.a.r.a();for(var t=this.a.p.x.length-1,n=t;n>=0;n--){this.a.p.x[n].dispose();this.a.p.n(n)}}};_trs.b=function(n){this.s=Function.createDelegate(this,this.w);_trs.b.resolveInheritance();this.b=this.us;this.a=this.bo;_trs.b.initializeBase(this,[n]);this.y("NotificationBarView")};_trs.b.prototype={f:null,p:null,o:null,g:0,e:!1,q:null,r:null,i:null,h:null,k:null,j:null,l:null,m:null,n:0,bh:function(n){if(this.e!==n){this.e=n;this.bv("IsNotificationShown")}return n},bk:function(n){if(this.g!==n){this.g=n;this.bv("IsAlert")}return n},br:function(n){if(this.q!==n){this.q=n;this.bv("PrimaryText")}return n},bs:function(n){if(this.r!==n){this.r=n;this.bv("SecondaryText")}return n},E:function(n){if(this.i!==n){this.i=n;this.bv("Button1Text")}return n},x:function(n){if(this.h!==n){this.h=n;this.bv("Button1Command")}return n},be:function(n){if(this.k!==n){this.k=n;this.bv("Button2Text")}return n},bd:function(n){if(this.j!==n){this.j=n;this.bv("Button2Command")}return n},u:function(){this.l||(this.l=new _j.g(this.s,_a.a.w));return this.l},bf:function(n){if(this.m!==n){this.m=n;this.bv("IconImageId")}return n},c:function(){return this.n},bp:function(n){if(this.n!==n){this.n=n;this.bv("NotificationBarHeight")}return n},d:function(n,t,i,r,u,f,e,o,s,h,c){if(!this.f||this.f===c){this.bk(this.g);this.br(r);this.bs(u);this.bf(h);this.E(f);this.x(e);this.be(o);this.bd(s);this.p=n;this.o=t;this.bA()}},bA:function(){if(!this.e){this.t();if(!this.f){this.f=this.v();this.p&&this.p(this.f)}}},w:function(){if(this.e){this.t();this.f=null;this.o&&this.o()}},t:function(){this.bh(!this.e);this.bp(this.e?40:0)},v:function(){return _a.F.b()}};_trs.a=function(){};_trs.a.$$cctor=function(){};_trs.a.C=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_3'></button> </div><div>  <div></div> </div><div><div class='__Microsoft_Owa_TriageShared_templates_cs_2'></div></div><div> <div></div> </div><div> <div class='__Microsoft_Owa_TriageShared_templates_cs_6 flex flexwrap'></div>  <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_c __Microsoft_Owa_TriageShared_templates_cs_7 ms-fcl-tp'></button> </div><div>  <div class='__Microsoft_Owa_TriageShared_templates_cs_4 flex flexwrap ms-bgc-nl'></div> </div><div>  <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_7 __Microsoft_Owa_TriageShared_templates_cs_d ms-fcl-tp'></button> <div></div> </div><div> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_8 __Microsoft_Owa_TriageShared_templates_cs_d ms-font-m ms-fcl-tp ms-bgc-tl-h'></button> </div><div> <a class='__Microsoft_Owa_TriageShared_templates_cs_e ms-bgc-tp ms-fcl-w'></a> <div></div>   </div><div> <span class='__Microsoft_Owa_TriageShared_templates_cs_g ms-font-xl ms-fcl-w'></span> <span class='__Microsoft_Owa_TriageShared_templates_cs_i ms-font-m ms-fwt-sb ms-fcl-w'></span> <span class='__Microsoft_Owa_TriageShared_templates_cs_i ms-font-m ms-fcl-w'></span> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_j'></button> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_j'></button> <button type='button' class='__Microsoft_Owa_TriageShared_templates_cs_h'></button> </div><div> <div class='__Microsoft_Owa_TriageShared_templates_cs_f flex flexCenterItems'></div> </div>";_j.i.a().appendChild(n);return n};_trs.a.V=function(n){return n.f()};_trs.a.S=function(n){return n.d()};_trs.a.U=function(n){return n.b()};_trs.a.T=function(n){return n.e()};_trs.a.X=function(n){return n.h()};_trs.a.R=function(n){return n.bI()};_trs.a.W=function(n){return n.g()};_trs.a.p=function(n){return n.h};_trs.a.m=function(n){return n.j};_trs.a.o=function(n){return n.o};_trs.a.b=function(n){return n.X};_trs.a.bf=function(n){return _trs.e.isInstanceOfType(n)?n.g():null};_trs.a.bh=function(n){return _trs.e.isInstanceOfType(n)?n.c:null};_trs.a.x=function(n){return _trs.e.isInstanceOfType(n)?n.a:null};_trs.a.P=function(n){return n.q()};_trs.a.G=function(n){return n.k()};_trs.a.bg=function(n){return n.e};_trs.a.bi=function(n){return n.b};_trs.a.bd=function(n){return n.C()};_trs.a.n=function(n){return n.u()};_trs.a.v=function(n){return n.k};_trs.a.bc=function(n){return n.i===1};_trs.a.w=function(n){return n.c()};_trs.a.N=function(n){return n.r};_trs.a.O=function(n){return n.u};_trs.a.be=function(n){return n.g};_trs.a.Z=function(n){return _n.G.isInstanceOfType(n)?n.a:null};_trs.a.Y=function(n){return n.b};_trs.a.bo=function(n){return _trs.b.isInstanceOfType(n)?n.m:null};_trs.a.A=function(n){return _trs.b.isInstanceOfType(n)?n.q:null};_trs.a.B=function(n){return _trs.b.isInstanceOfType(n)?n.r:null};_trs.a.bl=function(n){return _trs.b.isInstanceOfType(n)?n.h:null};_trs.a.y=function(n){return _trs.b.isInstanceOfType(n)?n.i:null};_trs.a.bm=function(n){return _trs.b.isInstanceOfType(n)?n.j:null};_trs.a.z=function(n){return _trs.b.isInstanceOfType(n)?n.k:null};_trs.a.bn=function(n){return _trs.b.isInstanceOfType(n)?n.u():null};_trs.a.bq=function(n){return n.e};_trs.a.bp=function(n){return n.g===1};_trs.a.f=function(n,t){n.l(t)};_trs.a.E=function(n,t){n.m(t)};_trs.a.e=function(n,t){n.T(t)};_trs.a.F=function(n,t){n.dP(t)};_trs.a.D=function(n,t){n.cc(t)};_trs.a.g=function(n,t){n.bl(t)};_trs.a.t=function(n,t){n.bk(t)};_trs.a.d=function(n,t){n.K(t)};_trs.a.r=function(n,t){n.Q(t)};_trs.a.I=function(n,t){n.b=t};_trs.a.J=function(n,t){n.c(t)};_trs.a.Q=function(n,t){n.m(t)};_trs.a.H=function(n,t){n.j(t)};_trs.a.s=function(n,t){n.o(t)};_trs.a.bb=function(n,t){n.b=t};_trs.a.ba=function(n,t){n.b=t};_trs.a.l=function(n,t){n.j(t)};_trs.a.K=function(n,t){n.v(t)};_trs.a.L=function(n,t){n.b=t};_trs.a.bk=function(n,t){n.j(t)};_trs.a.bj=function(n,t){n.i(t)};_trs.a.M=function(n,t){n.a(t)};_trs.a.u=function(n,t){n.a(t)};_trs.a.k=function(){_trs.a.h||(_trs.a.h=new _fc.k);return _trs.a.h};_trs.a.q=function(){_trs.a.j||(_trs.a.j=new _fc.l);return _trs.a.j};_trs.a.i=function(){};TriageSharedComponent.registerClass("TriageSharedComponent",null,_a.iz,_j.cd);_trs.d.registerClass("_trs.d",_fm.c);_trs.f.registerClass("_trs.f",_a.bs,IModuleSwitcherViewModel,_a.jk,_j.bq,Sys.IDisposable);_trs.j.registerClass("_trs.j",_h.ff);_trs.e.registerClass("_trs.e",_j.c);_trs.b.registerClass("_trs.b",_j.c,INotificationBar,_j.bq,Sys.IDisposable);TriageSharedComponent.$$cctor();_trs.c.c=!1;_trs.c.a=new _a.k([3,5,4,1]);_trs.c.b=new _a.k([4,1]);_trs.f.a=_a.a.eX;_trs.a.c=_trs.a.C();_trs.a.h=null;_trs.a.j=null;_trs.a.a={};_trs.a.$$cctor();
window.scriptsLoaded['microsoft.owa.triageshared.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.triageshared.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
