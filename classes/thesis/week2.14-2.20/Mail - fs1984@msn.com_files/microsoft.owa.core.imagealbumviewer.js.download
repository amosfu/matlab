try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.imagealbumviewer.js'] = (new Date()).getTime();
function ImageAlbumViewerComponent(){}ImageAlbumViewerComponent.$$cctor=function(){_a.t.a().a(ImageAlbumViewerComponent)};ImageAlbumViewerComponent.prototype={b:function(n,t,i){n.e(_iav.e).b(IImageAlbumViewModelFactory)},a:function(){return null}};Type.registerNamespace("_iav");_iav.d=function(n,t,i){this.c=n;this.a=t;this.b=i};_iav.d.prototype={b:null,c:null,a:null};_iav.e=function(){};_iav.e.prototype={a:function(){return new _iav.c}};_iav.c=function(){_iav.c.initializeBase(this);this.i(new _j.l)};_iav.c.prototype={f:null,g:null,e:function(){return this.g},h:function(n){if(this.g!==n){this.g=n;this.eB("SelectedItem")}return n},i:function(n){if(this.f!==n){this.f=n;this.eB("Images")}return n},d:function(){return this.f.l(this.g)},b:function(n,t,i,r){var u=i;!u&&r&&(u=new _at.w(r,null,0,0,!0));this.f.a(new _iav.d(n,t,u))},c:function(){this.f.g()},a:function(n){for(var i=this.f.x.length,t=0;t<i;t++)if(this.f.x[t].a===n){this.h(this.f.x[t]);break}}};_iav.b=function(n,t){this.k=Function.createDelegate(this,this.bM);this.l=Function.createDelegate(this,this.bO);this.be=Function.createDelegate(this,this.bQ);this.bd=Function.createDelegate(this,this.bL);this.m=Function.createDelegate(this,this.c);this.E=Function.createDelegate(this,this.bD);this.x=Function.createDelegate(this,this.bA);this.w=Function.createDelegate(this,this.bs);this.v=Function.createDelegate(this,this.br);_iav.b.initializeBase(this,[n]);this.y("ImageStrip");this.f=t;this.n=new _j.g(this.v,_a.a.Y);this.o=new _j.g(this.w,_a.a.Y);this.r=new _j.g(this.x,_a.a.Y);this.s=new _j.g(this.E,_a.a.Y)};_iav.b.prototype={e:null,g:null,a:null,n:null,o:null,r:null,s:null,f:null,b:null,i:!1,j:!1,p:null,q:null,h:!1,d:null,bk:function(n){if(this.i!==n){this.i=n;this.bv("LeftArrowHidden")}return n},bp:function(n){if(this.j!==n){this.j=n;this.bv("RightArrowHidden")}return n},t:function(n){if(this.h!==n){this.h=n;this.bv("IsShrunken")}return n},G:function(){_j.c.prototype.G.call(this);this.bR()},H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("ScrollRegion");this.e=this.B.a("ContainerDiv");this.g=this.B.a("BackgroundDiv");this.q=this.B.a("ScaleUpAnimationDiv").cy;this.p=this.B.a("ScaleDownAnimationDiv").cy;this.t(!0);this.a.d(this.m)}this.u();var n=this;this.d=_j.m.a().a(this.J(),"ImageStrip.OnApplyTemplate",function(){n.d=null;n.c()},1e3)},bw:function(){this.bS();this.a.e(this.m);this.d&&(this.d=_j.m.a().b(this.d));_j.c.prototype.bw.call(this)},bR:function(){_j.k.b(this.z,"mouseenter",this.bd);_j.k.b(this.z,"mouseleave",this.be)},bS:function(){_j.k.c(this.z,"mouseenter");_j.k.c(this.z,"mouseleave")},bO:function(n,t){var r=this.V();var i=r.f.l(r.g);i>=0&&this.bN(i)},bQ:function(n){this.b&&this.b.b(!1);var t=this;this.b=this.f.a(this.p,this.g.z,function(){t.t(!0);t.b=null},!1);this.b.a();this.c()},bL:function(n){this.b&&this.b.b(!1);var t=this;this.b=this.f.a(this.q,this.g.z,function(){t.t(!1);t.b=null},!1);this.b.a();this.c()},br:function(){this.bf(!1)},bs:function(){this.bf(!0)},bh:function(){var n=this.a.z;return n.clientWidth-164},bD:function(){var n;(n=this.a).g(n.l()+this.bh())},bA:function(){var n;(n=this.a).g(n.l()-this.bh())},c:function(){var i=this.V();if(i)if(this.a){var r=!1;var n=!1;this.a.l()||(r=!0);var u=i.f.x.length*164;var t=this.a.z;t.scrollLeft+t.clientWidth>=u&&(n=!0);this.bk(r);this.bp(n)}else{this.bk(!0);this.bp(!0)}},bN:function(n){var t=this.a.z;var i=n*164;var r=i+164;i<t.scrollLeft?this.a.g(i):r>t.scrollLeft+t.clientWidth&&this.a.g(r-t.clientWidth)},bf:function(n){var t=this.V();if(t.g)t.h(t.f.x[0]);else{var i=t.f.l(t.g);n?i++:i--;i<0?i=t.f.x.length-1:i>=t.f.x.length&&(i=0);t.h(t.f.x[i])}},bn:function(){_j.bi.prototype.bn.call(this);var n=this.V();if(n){n.rpcl("SelectedItem",this.l);n.rpcl("Images",this.k)}},Y:function(){_j.i.prototype.Y.call(this);var n=this.V();if(n){n.apcl("SelectedItem",this.l);n.apcl("Images",this.k)}this.u();this.c()},bM:function(n,t){this.u();this.c()},u:function(){if(this.e){var n=this.V();if(n&&n.f){var t=n.f.x.length*164+94+1;this.e.z.style.width=t+"px";this.e.z.style.maxWidth="100%"}}}};_iav.a=function(){};_iav.a.$$cctor=function(){_iav.a._I()};_iav.a.k=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_phu_c'></span> </div><div> <div class='_phu_a'> <img/> </div> </div><div><div class='_phu_9'></div></div><div>  <div style=\"display: none\" class='_phu_f'></div> <div style=\"display: none\" class='_phu_d'></div> <div class='_phu_2'> <div class='_phu_4'> <div class='_phu_5'> <button type='button'></button> </div> <div class='_phu_7'> <div>    </div> </div> <div class='_phu_6'> <button type='button'></button> </div> </div> </div>  </div>";_j.i.a().appendChild(n);return n};_iav.a.c=function(n){return n.u()};_iav.a.r=function(n){return 3};_iav.a.q=function(n){return n.b};_iav.a.v=function(n){return n.h};_iav.a.A=function(n){return n.r};_iav.a.y=function(n){return n.i};_iav.a.s=function(n){return n.f};_iav.a.h=function(n){return n.X};_iav.a.w=function(n){return _iav.b.isInstanceOfType(n)?n.n:null};_iav.a.x=function(n){return _iav.b.isInstanceOfType(n)?n.o:null};_iav.a.t=function(n){return n.g};_iav.a.m=function(n){return n.d};_iav.a.B=function(n){return n.s};_iav.a.z=function(n){return n.j};_iav.a.g=function(n,t){n.a(t)};_iav.a.p=function(n,t){n.r(t)};_iav.a.o=function(n,t){n.p(t)};_iav.a.j=function(n,t){n.bl(t)};_iav.a.e=function(n,t){n.l(t)};_iav.a.d=function(n,t){n.T(t)};_iav.a.i=function(n,t){n.K(t)};_iav.a.l=function(n,t){n.i(t)};_iav.a.f=function(n,t){n.l=t};_iav.a.u=function(n,t){n.h(t)};_iav.a.n=function(n,t){n.f(t)};_iav.a._I=function(){var i="ImageStrip._tid1";new _j.d(i,function(){_iav.a.a[i]===undefined&&(_iav.a.a[i]=[[[-1,1,["CurrentImageId"],[_iav.a.c],null,"Id",null,_iav.a.g,1,null,null,null]]]);var n=_iav.a.b.childNodes[0].cloneNode(!0);var t=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[t])},"",_iav.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_iav.a.a);var r="ImageStrip._tid2";new _j.d(r,function(){_iav.a.a[r]===undefined&&(_iav.a.a[r]=[[[-1,1,["CurrentImageId"],[_iav.a.c],null,"Id",null,_iav.a.g,1,null,null,null]]]);var n=_iav.a.b.childNodes[0].cloneNode(!0);var t=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[t])},"",_iav.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_iav.a.a);var n="ImageStrip.ItemTemplate";new _j.d(n,function(){_iav.a.a[n]===undefined&&(_iav.a.a[n]=[[[-1,0,["ThumbnailSize"],[_iav.a.r],null,"ViewSize",null,_iav.a.p,1,null,null,0],[-1,0,["ThumbnailInfo"],[_iav.a.q],null,"AttachmentImageInfo",null,_iav.a.o,1,null,null,null]]]);var t=_iav.a.b.childNodes[1].cloneNode(!0);var i=new _at.y(_j.a.a(t,[0,0]));return new _j.a(t,[i])},"",_iav.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_iav.a.a);var t="ImageStrip";new _j.d(t,function(){_iav.a.a[t]===undefined&&(_iav.a.a[t]=[null,null,[[-1,5,["IsShrunken"],[_iav.a.v],null,"_phu_3",null,null,1,null,null,null]],null,[[-1,4,null,null,null,"Title",null,_iav.a.j,0,null,null,null,_nbs.a.Fx],[-1,4,null,null,null,"ImageId",null,_iav.a.e,0,null,null,null,_fm.a.ci],[-1,1,["ScrollLeftCommand"],[_iav.a.A],null,"ClickCommand",null,_iav.a.d,1,null,null,null],[-1,1,["LeftArrowHidden"],[_iav.a.y],null,"IsHidden",null,_iav.a.i,1,null,null,!0]],null,[[-1,0,["Images"],[_iav.a.s],null,"DataSource",null,_iav.a.l,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_iav.a.j,0,null,null,null,_nbs.a.Fx],[-1,4,null,null,null,"ImageId",null,_iav.a.e,0,null,null,null,_fm.a.D],[-1,1,["ScrollRightCommand"],[_iav.a.B],null,"ClickCommand",null,_iav.a.d,1,null,null,null],[-1,1,["RightArrowHidden"],[_iav.a.z],null,"IsHidden",null,_iav.a.i,1,null,null,!0]]]);var n=_iav.a.b.childNodes[3].cloneNode(!0);var u=new _fc.b(_j.a.a(n,[2,0,2,0]));u.f("ms-font-color-neutralSecondary");u.c("ms-font-color-neutralDark");u.y("ImageStrip._tid2");var r=new _jc.a(_j.a.a(n,[2,0,1,0]));var a=new _fc.g;var o=new _fc.c;o.W(_j.f.a(["ContextParent","KeyboardLeftCommand"],[_iav.a.h,_iav.a.w],null,"Command",null,_iav.a.f,1));o.j("LEFTARROW");var e=new _fc.c;e.W(_j.f.a(["ContextParent","KeyboardRightCommand"],[_iav.a.h,_iav.a.x],null,"Command",null,_iav.a.f,1));e.j("RIGHTARROW");a.a([o,e]);r.C([a]);r.d(function(){var t=_iav.a.b.childNodes[2].cloneNode(!0).childNodes[0];var n=new _j.c(t);n.y("ImageStrip.ItemTemplate");return n});var f=new _jc.b;f.U(_j.f.a(["SelectedItem"],[_iav.a.t],_iav.a.u,"SelectedItem",_iav.a.m,_iav.a.n,2));f.j("_phu_b");r.k(f);var l=new _fce.f(_j.a.a(n,[2,0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var i=new _fc.b(_j.a.a(n,[2,0,0,0]));i.f("ms-font-color-neutralSecondary");i.c("ms-font-color-neutralDark");i.y("ImageStrip._tid1");var v=new _j.i(_j.a.a(n,[2,0]));var s=new _j.i(n.children[2]);var h=new _j.i(n.children[1]);var c=new _j.i(n.children[0]);return new _j.a(n,[c,h,s,v,i,l,r,u]).l({ScaleUpAnimationDiv:c,ScaleDownAnimationDiv:h,BackgroundDiv:s,ContainerDiv:v,ScrollRegion:l})},"",_iav.c,_iav.b,function(n){return new _iav.b(n,_j.b.Instance.a(_b.a))},!1,!1,!1,0,_iav.a.a)};ImageAlbumViewerComponent.registerClass("ImageAlbumViewerComponent",null,_a.iz,_j.cd);_iav.d.registerClass("_iav.d",null,IAlbumImage);_iav.e.registerClass("_iav.e",null,IImageAlbumViewModelFactory);_iav.c.registerClass("_iav.c",_a.bs,IImageStripViewModel,_a.jk,_j.bq,Sys.IDisposable);_iav.b.registerClass("_iav.b",_j.c);ImageAlbumViewerComponent.$$cctor();_iav.a.b=_iav.a.k();_iav.a.a={};_iav.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.imagealbumviewer.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.imagealbumviewer.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
