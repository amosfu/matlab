try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.shellg2.metile.owa.js'] = (new Date()).getTime();
function MeTileComponent(){}MeTileComponent.$$cctor=function(){_a.t.a().a(MeTileComponent)};MeTileComponent.prototype={b:function(n,t,i){var r=this;n.b(_o365sg2c.d,function(){return new _o365sg2pmetile.b}).b(_o365sg2c.d).a()},a:function(){return null}};Type.registerNamespace("_o365sg2pmetile");_o365sg2pmetile.b=function(){this.bg=Function.createDelegate(this,this.bC);_o365sg2pmetile.b.resolveInheritance();this.i=this.R;this.a=this.cj;_o365sg2pmetile.b.initializeBase(this)};_o365sg2pmetile.b.prototype={ba:null,X:null,Y:0,U:null,T:0,M:null,j:function(){return this.M},t:function(n){this.M=n;return n},N:null,b:function(){return this.N},B:null,c:function(){return this.B},s:function(n){if(this.ba!==n){this.ba=n;this.bv("MenuTemplateId")}return n},W:!1,o:function(){return this.W},O:null,e:function(){return this.O},Z:null,p:function(){return this.Z},P:null,g:function(){return this.P},bi:!1,l:function(){return this.bi},k:function(){return this.Y},f:function(n){if(this.Y!==n){this.Y=n;this.bv("UserPresence")}return n},n:function(){return this.U},h:function(n){if(this.U!==n){this.U=n;this.bv("OnMeTileClicked")}return n},m:function(){return this.T},d:function(n){if(this.T!==n){this.T=n;this.bv("MenuState");this.x().c()||this.bj()}return n},q:function(n,t){var r;try{r=n}catch(f){throw _o365cl.a.a(415006,"userPhotoViewModels",6,1);}var i;try{i=t}catch(u){throw _o365cl.a.a(415007,"rightMenusViewModel",6,1);}this.bs(r,i)},bs:function(n,t){if(!t)throw _o365cl.a.a(300443,"rightMenusViewModel",6,1);this.d(0);this.M=new Array(0);this.X=t;if(n.length>0){this.N=n[0];var i=this;this.N.k=function(){i.B&&i.B.e()};n.length>1&&(this.B=n[1])}if(this.x().b())try{this.bk(this.x().b())}catch(r){O365.Log.WriteShellLog(402026,6,1,0,r);throw r;}else O365.Log.WriteShellLog(175143,6,1,0)},bC:function(n,t){this.x().c()||this.bj()},bj:function(){if(this.v&&this.v.p)for(var i=this.bD(),t=0;t<this.v.p.x.length;t++)if(_fm.s.isInstanceOfType(this.v.p.x[t])){var n=this.v.p.x[t];n&&(i?_fm.c.isInstanceOfType(n)&&n.k?n.a(!n.k.b):n.a(!1):n.a(!0))}},bD:function(){var n=!0;this.x().c()||(n=this.T===3||this.T===4);return n},bk:function(n){this.bt();this.bx();this.bu(n.UserDisplayName,n.TruncatedUserDisplayName);this.br(n.AboutMeLink,n.SignOutLink,n.CurrentWorkloadUserSubLinks);if(!_o365sg2pmetile.b.a){_o365sg2pmetile.b.a=!0;O365.PM.rle("M1")}},bx:function(){this.W=!this.x().f()&&!this.x().a().IsConsumerShell;if(!this.W){if(this.N)try{this.N.j()}catch(t){O365.Log.WriteShellLog(402027,6,1,0,t);throw t;}if(this.B)try{this.B.j()}catch(n){O365.Log.WriteShellLog(402028,6,1,0,n);throw n;}}},bt:function(){this.x().a()&&this.x().a().LyncIntegrationDisabled?this.f(1):this.f(0)},bu:function(n,t){if(n){this.O=t?t:n;this.P=n;this.x().a()?this.Z=this.x().a().IsConsumerShell&&this.x().a().NotManagedEmailAddress?this.x().a().NotManagedEmailAddress:this.x().a().UPN:O365.Log.WriteShellLog(175145,6,1,0)}else if(this.x().a()&&this.x().a().UPN)if(this.x().a().IsConsumerShell&&this.x().a().NotManagedEmailAddress){this.O=this.x().a().NotManagedEmailAddress;this.P=this.x().a().NotManagedEmailAddress}else{this.O=this.x().a().UPN;this.P=this.x().a().UPN}else O365.Log.WriteShellLog(175144,1,1,0)},br:function(n,t,i){var r=new Array(0);var h=!1;if(n){var a=this;this.X.a(r,n,function(){O365.Log.WriteShellLog(300934,1,1,0);return!0});h=!0}var u=!1;if(i&&i.length>0){r.push(new _fm.i);u=!0;for(var c=i,l=c.length,e=0;e<l;++e){var o=c[e];if(o){this.X.a(r,o,null);u=!1}else if(!u){r.push(new _fm.i);u=!0}}}if(t){(h||i&&!u)&&r.push(new _fm.i);var f=this;this.X.a(r,t,function(){if(f.M)for(var n=0;n<f.M.length;n++)if(f.M[n])try{f.M[n]()}catch(t){O365.Log.WriteShellLog(300442,6,1,0,n,t)}return!0})}this.r(_s1.ShellG2Strings.l_ShellCore_MeTile_Title_Text);this.be(new _fm.e(null));this.v.p.e(this.bg);this.v.p.m(r);this.s("ContextMenuView");_o365sg2c.j.b(this);_o365sg2c.j.a(this.v);this.v.K(_j.h.a(this.v.M)?"o365cs-me-contextMenu":this.v.M+" "+"o365cs-me-contextMenu");var s=this;this.y(new _j.g(function(){O365.Log.WriteShellLog(300937,1,1,0);if(s.U)try{s.U.a()}catch(n){O365.Log.WriteShellLog(403599,6,1,0,n)}},_ff.c.a))}};_o365sg2pmetile.a=function(){};_o365sg2pmetile.a.$$cctor=function(){_o365sg2pmetile.a._I()};_o365sg2pmetile.a.A=function(){var n=window.document.createElement("DIV");n.innerHTML="<div>  <div class='o365cs-me-tileview-container'></div> <div></div> </div><div> <button autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_0\" type='button' class='o365cs-nav-item o365cs-nav-button ms-fcl-w o365cs-me-nav-item'></button> </div><div> <img autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_4\" class='o365cs-me-personaimg'/> </div><div> <div class='o365cs-me-tileimg'></div> </div><div> <img autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_5\" class='o365cs-me-personaimg'/> </div><div>  <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_2\" class='o365cs-me-presence5x50'></div>  <span autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_3\" class='ms-bgc-nt ms-fcl-w o365cs-me-tileimg o365cs-me-tileimg-doughboy'></span>  <div></div>  <div class='o365cs-me-tileimg'></div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_1\" class='o365cs-me-tileview'></div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_7\" class='o365cs-me-presenceOffline5x50'></div> <div class='o365cs-me-tile-nophoto-username-container'> <span autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_8\" class='o365cs-me-tile-nophoto-username o365cs-me-bidi'></span> </div> <div class='o365cs-me-tile-nophoto-down'> <span class='ms-fcl-nt'></span> </div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_6\" class='o365cs-me-tile-nophoto'></div> </div>";_j.i.a().appendChild(n);return n};_o365sg2pmetile.a.p=function(n){return n.W};_o365sg2pmetile.a.Q=function(n){return n.L};_o365sg2pmetile.a.O=function(n){return n.w};_o365sg2pmetile.a.P=function(n){return n.bm()};_o365sg2pmetile.a.L=function(n){return n.i()};_o365sg2pmetile.a.l=function(n){return n.a()};_o365sg2pmetile.a.n=function(n){return n.q()};_o365sg2pmetile.a.R=function(n){return n.bd};_o365sg2pmetile.a.M=function(n){return n.ba};_o365sg2pmetile.a.D=function(n){return n.k()};_o365sg2pmetile.a.f=function(n){return n.B};_o365sg2pmetile.a.t=function(n){return n.g};_o365sg2pmetile.a.u=function(n){return n.h};_o365sg2pmetile.a.s=function(n){return n.a};_o365sg2pmetile.a.q=function(n){return n.P};_o365sg2pmetile.a.r=function(n){return n.b};_o365sg2pmetile.a.j=function(n){return n.N};_o365sg2pmetile.a.d=function(n){return n.Y};_o365sg2pmetile.a.N=function(n){return n.O};_o365sg2pmetile.a.e=function(n,t){n.K(t)};_o365sg2pmetile.a.C=function(n,t){n.T(t)};_o365sg2pmetile.a.K=function(n,t){n.O(t)};_o365sg2pmetile.a.B=function(n,t){n.Q(t)};_o365sg2pmetile.a.H=function(n,t){n.l=t};_o365sg2pmetile.a.F=function(n,t){n.m(t)};_o365sg2pmetile.a.G=function(n,t){n.c(t)};_o365sg2pmetile.a.J=function(n,t){n.m(t)};_o365sg2pmetile.a.E=function(n,t){n.j(t)};_o365sg2pmetile.a.v=function(n,t){n.g(t)};_o365sg2pmetile.a.w=function(n,t){n.i(t)};_o365sg2pmetile.a.y=function(n,t){n.a(t)};_o365sg2pmetile.a.x=function(n,t){n.b=t};_o365sg2pmetile.a.o=function(n,t){n.bl(t)};_o365sg2pmetile.a.m=function(n,t){n.a(t)};_o365sg2pmetile.a.I=function(n,t){n.a(t)};_o365sg2pmetile.a.k=function(){_o365sg2pmetile.a.g||(_o365sg2pmetile.a.g=new _fc.k);return _o365sg2pmetile.a.g};_o365sg2pmetile.a.c=function(){_o365sg2pmetile.a.i||(_o365sg2pmetile.a.i=new _o365sg2c.v);return _o365sg2pmetile.a.i};_o365sg2pmetile.a.z=function(){_o365sg2pmetile.a.h||(_o365sg2pmetile.a.h=new _fc.l);return _o365sg2pmetile.a.h};_o365sg2pmetile.a._I=function(){var e="MeTileMouseView.MeTileMenu._tid1";new _j.d(e,function(){_o365sg2pmetile.a.a[e]===undefined&&(_o365sg2pmetile.a.a[e]=[[[-1,0,["ShowUserNameInsteadOfPhoto"],[_o365sg2pmetile.a.p],null,"IsHidden",null,_o365sg2pmetile.a.e,1,null,null,!0]],[[-1,0,["ShowUserNameInsteadOfPhoto"],[_o365sg2pmetile.a.p],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var n=_o365sg2pmetile.a.b.childNodes[0].cloneNode(!0);var i=new _j.c(n.children[1]);i.y("MeTileMouseView.MeTileNoPhoto");var t=new _j.c(n.children[0]);t.y("MeTileMouseView.MeTilePhoto");return new _j.a(n,[t,i])},"",_o365sg2pmetile.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var f="MeTileMouseView.MeTileMenu";new _j.d(f,function(){_o365sg2pmetile.a.a[f]===undefined&&(_o365sg2pmetile.a.a[f]=[[[-1,0,["IsHidden"],[_o365sg2pmetile.a.Q],null,"IsHidden",null,_o365sg2pmetile.a.e,1,null,null,!0],[-1,0,["Command"],[_o365sg2pmetile.a.O],null,"ClickCommand",null,_o365sg2pmetile.a.C,1,null,null,null],[-1,0,["AriaId"],[_o365sg2pmetile.a.P],null,"AriaId",null,_o365sg2pmetile.a.K,1,null,null,null],[-1,0,["AriaLabel"],[_o365sg2pmetile.a.L],null,"AriaLabel",null,_o365sg2pmetile.a.B,1,null,null,null],[-1,5,["MenuViewModel","IsShown"],[_o365sg2pmetile.a.l,_o365sg2pmetile.a.n],null,"o365cs-spo-topbarMenuOpen ms-fcl-b ms-bgc-w:ms-fcl-w ms-bgc-tdr-h o365cs-topnavText",null,null,0,null,null,null]]]);var r=_o365sg2pmetile.a.b.childNodes[1].cloneNode(!0);var t=new _fc.b(r.children[0]);t.F(10);var u=new _fc.g;var i=new _fc.c;i.U(_j.f.a(["MenuCommand"],[_o365sg2pmetile.a.R],null,"Command",null,_o365sg2pmetile.a.H,1));i.j("DOWNARROW");u.a([i]);var n=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["MenuTemplateId"],[_o365sg2pmetile.a.M],null,"TemplateId",null,_o365sg2pmetile.a.F,1)).U(_j.f.a(["MenuViewModel"],[_o365sg2pmetile.a.l],null,"MenuDataContext",null,_o365sg2pmetile.a.G,1)).U(_j.f.a(["MenuViewModel","IsShown"],[_o365sg2pmetile.a.l,_o365sg2pmetile.a.n],_o365sg2pmetile.a.J,"IsShown",_o365sg2pmetile.a.D,_o365sg2pmetile.a.E,2,null,null,!1));n.e=!0;n.a=1;n.b=5;n.g="o365cs-nav-contextMenu o365spo";n.i=1;t.C([u,n]);t.y("MeTileMouseView.MeTileMenu._tid1");return new _j.a(r,[t]).b(t)},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a);var s="MeTileMouseView.MeTilePhoto._tid2._tid3._tid4";new _j.d(s,function(){_o365sg2pmetile.a.a[s]===undefined&&(_o365sg2pmetile.a.a[s]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pmetile.a.x,0,null,null,0,1],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.t],null,"LoadCommand",null,_o365sg2pmetile.a.v,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.u],null,"LoadErrorCommand",null,_o365sg2pmetile.a.w,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.s],null,"Source",null,_o365sg2pmetile.a.y,1,null,null,null],[-1,0,["UserNameTooltip"],[_o365sg2pmetile.a.q],null,"Title",null,_o365sg2pmetile.a.o,1,null,null,null]]]);var t=_o365sg2pmetile.a.b.childNodes[2].cloneNode(!0);var n=new _o365sg2c.g(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var o="MeTileMouseView.MeTilePhoto._tid2._tid3";new _j.d(o,function(){_o365sg2pmetile.a.a[o]===undefined&&(_o365sg2pmetile.a.a[o]=[[[-1,0,["SecondaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.r],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var t=_o365sg2pmetile.a.b.childNodes[3].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeTileMouseView.MeTilePhoto._tid2._tid3._tid4");return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var u="MeTileMouseView.MeTilePhoto._tid2._tid5";new _j.d(u,function(){_o365sg2pmetile.a.a[u]===undefined&&(_o365sg2pmetile.a.a[u]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pmetile.a.x,0,null,null,0,1],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.t],null,"LoadCommand",null,_o365sg2pmetile.a.v,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.u],null,"LoadErrorCommand",null,_o365sg2pmetile.a.w,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.s],null,"Source",null,_o365sg2pmetile.a.y,1,null,null,null],[-1,0,["UserNameTooltip"],[_o365sg2pmetile.a.q],null,"Title",null,_o365sg2pmetile.a.o,1,null,null,null]]]);var t=_o365sg2pmetile.a.b.childNodes[4].cloneNode(!0);var n=new _o365sg2c.g(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var t="MeTileMouseView.MeTilePhoto._tid2";new _j.d(t,function(){_o365sg2pmetile.a.a[t]===undefined&&(_o365sg2pmetile.a.a[t]=[[[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Unknown",null,null,0,_o365sg2pmetile.a.c(),0,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Offline",null,null,0,_o365sg2pmetile.a.c(),1,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Available",null,null,0,_o365sg2pmetile.a.c(),2,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Away",null,null,0,_o365sg2pmetile.a.c(),3,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Busy",null,null,0,_o365sg2pmetile.a.c(),4,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Blocked",null,null,0,_o365sg2pmetile.a.c(),5,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-DND",null,null,0,_o365sg2pmetile.a.c(),6,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pmetile.a.m,0,null,null,null,_o365sg2c.b.b]],[[-1,0,["SecondaryUserPhotoViewModel"],[_o365sg2pmetile.a.f],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.z(),null,!0]],[[-1,0,["PrimaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.r],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var n=_o365sg2pmetile.a.b.childNodes[5].cloneNode(!0);var u=new _j.c(n.children[3]);u.y("MeTileMouseView.MeTilePhoto._tid2._tid5");var r=new _j.c(n.children[2]);r.y("MeTileMouseView.MeTilePhoto._tid2._tid3");var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.N(!0);var f=new _j.c(n.children[0]);return new _j.a(n,[f,i,r,u])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var n="MeTileMouseView.MeTilePhoto";new _j.d(n,function(){_o365sg2pmetile.a.a[n]===undefined&&(_o365sg2pmetile.a.a[n]=[null]);var i=_o365sg2pmetile.a.b.childNodes[6].cloneNode(!0);var t=new _j.c(i.children[0]);t.y("MeTileMouseView.MeTilePhoto._tid2");return new _j.a(i,[t])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a);var r="MeTileMouseView.MeTileNoPhoto._tid6";new _j.d(r,function(){_o365sg2pmetile.a.a[r]===undefined&&(_o365sg2pmetile.a.a[r]=[null,[[-1,0,["UserDisplayName"],[_o365sg2pmetile.a.N],null,"Text",null,_o365sg2pmetile.a.I,1,null,null,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pmetile.a.m,0,null,null,null,_o365sg2c.b.i]]]);var n=_o365sg2pmetile.a.b.childNodes[7].cloneNode(!0);var u=new _fc.d(_j.a.a(n,[2,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _j.c(n.children[0]);return new _j.a(n,[t,i,u])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var i="MeTileMouseView.MeTileNoPhoto";new _j.d(i,function(){_o365sg2pmetile.a.a[i]===undefined&&(_o365sg2pmetile.a.a[i]=[null]);var t=_o365sg2pmetile.a.b.childNodes[8].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeTileMouseView.MeTileNoPhoto._tid6");return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a)};MeTileComponent.registerClass("MeTileComponent",null,_a.iz,_j.cd);_o365sg2pmetile.b.registerClass("_o365sg2pmetile.b",_o365sg2c.B,_o365sg2c.d);MeTileComponent.$$cctor();_o365sg2pmetile.b.a=!1;_o365sg2pmetile.a.b=_o365sg2pmetile.a.A();_o365sg2pmetile.a.g=null;_o365sg2pmetile.a.i=null;_o365sg2pmetile.a.h=null;_o365sg2pmetile.a.a={};_o365sg2pmetile.a.$$cctor();
window.scriptsLoaded['microsoft.o365.shellg2.metile.owa.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.shellg2.metile.owa.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
