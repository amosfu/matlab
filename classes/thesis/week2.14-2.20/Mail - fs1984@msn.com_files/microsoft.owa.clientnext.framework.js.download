try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime();
Type.registerNamespace("_cnf");function ClientNextFrameworkComponent(){}ClientNextFrameworkComponent.$$cctor=function(){_a.t.a().a(ClientNextFrameworkComponent)};ClientNextFrameworkComponent.prototype={b:function(n,t,i){var e=this;n.b(_cnf.b,function(){return new _cnf.b(n.a(_a.f))}).a();var o=this;n.b(_cnf.a,function(){return new _cnf.a(n.a(_j.j),n.a(_cnf.b),n.a(_y.a),n.a(_a.f))}).a();var s=this;n.b(_cnf.c,function(){return new _cnf.c(n.a(_y.a),n.a(_a.f),n.a(_g.h))}).a();var r=this;n.b(_cnf.f,function(){return new _cnf.f(n.c(_h.cD))}).a();var u=this;n.b(_cnf.e,function(){return new _cnf.e(_a.a.cy)}).a();var f=this;n.b(_cnf.d,function(){return new _cnf.d(_a.a.cy)}).a()},a:function(){return[new _j.x(_cnf.c,1,-1),new _j.x(_cnf.e,0,-1),new _j.x(_cnf.d,0,-1)]}};_cnf.f=function(n){this.c=Function.createDelegate(this,this.d);this.b=n;OwaNext.initializeActionDispatcher(this.c)};_cnf.f.prototype={b:null,a:null,d:function(n,t,i){if(!this.a){var r=this;this.b.a(function(u){r.a=u;r.d(n,t,i)});return}var u=this.a.a(n,i,t,!0);_a.g.a.a(u)}};_cnf.d=function(n){this.b=Function.createDelegate(this,this.g);this.a=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.h);this.d=n;OwaNext.application.initializeCtq(this.c,this.a,this.b,this.f())};_cnf.d.prototype={d:null,h:function(n,t){t=t?t:_a.a.cy;return _a.c.b(t,n)},e:function(n,t,i,r){n.j=t;n.k=i;n.m=r;_a.c.a(n)},g:function(n,t,i){i=i?i:_a.a.cy;_a.c.c(i,n,t,0)},f:function(){var n={};n.calendar=_a.a.b;n.extensibility=_a.a.h;n.oxford=_a.a.cy;return n}};_cnf.e=function(n){this.b=Function.createDelegate(this,this.c);this.a=n;OwaNext.application.initializeLogger(this.b)};_cnf.e.prototype={a:null,c:function(n){_j.e.d(this.a,n,"ReactComponent Caused an Exception {0}",n.message)}};_cnf.c=function(n,t,i){var u=i.g();var s=i.c();var r=i.a();var h={DefaultList:u.h().j.p,MasterList:u.a().j.p};var o={IsUserCultureRightToLeft:s.bD.IsUserCultureRightToLeft};var f={DateFormat:r.bD.DateFormat,TimeFormat:r.bD.TimeFormat,TimeZone:r.bD.TimeZone,WeekStartDay:r.bD.WeekStartDay,WeatherEnabled:r.H(),WeatherUnit:r.V()};var e={isNonLatinLanguage:_a.C.e(),isMouseLayout:n.a()==="Mouse",mcl:h,sessionSettings:o,userOptions:f};OwaNext.application.initializeSettings(e)};_cnf.b=function(n){this.a=n.a().he().Enabled};_cnf.b.prototype={a:!1,b:function(n,t){this.a&&OwaNext.application.raiseEvent(n,t)}};_cnf.a=function(n,t,i,r){this.d=Function.createDelegate(this,this.l);this.b={};this.a=t;this.f=r;this.c=i;n.b(_h.cP,this.d)};_cnf.a.prototype={a:null,f:null,c:null,l:function(n){var t={};t.queryKey=n.a.c().a();t.folderIdObject=n.a.e();this.a.b("TABLE_ADDED",t);var i=this;n.a.a().e(function(t,r){i.k(n.a.c().a(),r)})},k:function(n,t){var r=!1;var o=this.i(n);var i={};i.queryKey=n;i.action=_j.NotifyCollectionChangedAction.toString(t.c);i.changeIndex=t.d;i.toIndex=t.e;var s,e;i.oldItems=(e=this.g(t.b,s={val:r},o,!1),r=s.val,e);var u,f;i.newItems=(f=this.g(t.a,u={val:r},o,!0),r=u.val,f);r||this.a.b("TABLE_COLLECTION_CHANGED",i)},g:function(n,t,i,r){if(!n)return null;for(var e=[],o=n,s=o.length,f=0;f<s;++f){var u=o[f];if(_g.p.isInstanceOfType(u)){e.push(this.e(u));r?u.I(i):u.D(i)}else{t.val=!0;return null}}return e},i:function(n){if(!(n in this.b)){var t=this;this.b[n]=function(i,r){if(Array.indexOf(_cnf.a.a,r)>-1){var u={item:t.e(i),queryKey:n};t.a.b("ITEM_CHANGED",u)}}}return this.b[n]},h:function(n){var t;var i=!0;t=i&&!n.Y()?n.l():n.h();return this.c.a()==="Mouse"?(new _b.R).a(t,null):(new _b.K).a(t,null)},j:function(n){return _h.Y.b(n,!1)},e:function(n){var r=0;switch(n.K()){case"Complete":r=1;break;case"Flagged":r=2;break;case"NotFlagged":r=0;break}var i=0;switch(n.bc()){case"Low":i=0;break;case"Normal":i=1;break;case"High":i=2;break}var f=this.j(n);var u=null;if(n&&n.l()){u=new Date(n.l().m.getTime());u.setMinutes(n.l().m.getMinutes()+n.l().m.getTimezoneOffset())}var t={};t.conversationObject=n;t.topPropertyIconsToShow=f.c(3);t.smallIcon=f.b();t.dateTimeToDisplay=this.h(n);t.lastDeliveryOrRenewTime=u;t.importance=i;t.smimeType=n.bz();t.conversationId=n.bD.ConversationId.Id;t.unreadCount=n.bD.UnreadCount;t.conversationTopic=n.bD.ConversationTopic;t.globalMessageCount=n.bD.GlobalMessageCount;t.messageCount=n.bD.MessageCount;t.preview=n.bD.Preview;t.uniqueRecipients=n.n()?n.n().e():[];t.uniqueSenders=n.g()?n.g().e():[];t.flagStatus=r;t.isSmimeClass=n.bx();t.isPinned=n?n.x:!1;return t}};ClientNextFrameworkComponent.registerClass("ClientNextFrameworkComponent",null,_a.iz,_j.cd);_cnf.f.registerClass("_cnf.f");_cnf.d.registerClass("_cnf.d");_cnf.e.registerClass("_cnf.e");_cnf.c.registerClass("_cnf.c");_cnf.b.registerClass("_cnf.b");_cnf.a.registerClass("_cnf.a");ClientNextFrameworkComponent.$$cctor();_cnf.a.a=["ConversationId","ConversationTopic","FlagStatus","GlobalMessageCount","Importance","IsPinned","LastDeliveryTime","LastDeliveryOrRenewTime","Preview","UniqueRecipients","UniqueSenders","UnreadCount"];
window.scriptsLoaded['microsoft.owa.clientnext.framework.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
