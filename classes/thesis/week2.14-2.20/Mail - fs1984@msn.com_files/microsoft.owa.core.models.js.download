try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.models.js'] = (new Date()).getTime();
Type.registerNamespace("_c");_c.f=function(n,t,i){_a.b.b(n,"activityManager");_a.b.b(t,"chatManagerFactory");_a.b.b(i,"owaLayout");if(i!=="Mouse")this.a=new _c.n(n);else{var r=this;t.a(function(t){var i=t.a();r.a=i.f()?new _c.C(n,i):new _c.n(n)})}};_c.f.prototype={a:null};_c.S=function(){};_c.S.prototype={success:0,warning:1,error:2};_c.S.registerEnum("_c.S",!1);_c.U=function(){};_c.U.prototype={Id:0,Dictionary:1,XmlData:2,BinaryData:3,All:4};_c.U.registerEnum("_c.U",!1);_c.p=function(n,t){_c.p.initializeBase(this);this.d=n;this.g=t};_c.p.prototype={d:null,g:null,L:function(n){n.du(this.d,this.g,null,this.K,this.J)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.u=function(n,t){_c.u.initializeBase(this);_a.b.b(n,"folderId");_a.b.b(t,"conversationCount");this.i=n;this.g=t};_c.u.prototype={i:null,g:0,d:null,L:function(n){n.fn(this.i,this.g,null,this.K,this.J)},cU:function(n,t,i){this.d=n.Conversations;t()}};_c.v=function(){_c.v.initializeBase(this)};_c.v.prototype={g:null,d:null,L:function(n){var t=new _gg.mi(this.M);t.actionName="GetRegionalConfiguration";this.d=_a.c.b(_a.a.ev,"GetRegionalConfiguration",!0);var i=new _gg.el;n.F(i,t,this.K,this.J)},cU:function(n,t,i){if(this.d){this.d.l=this.P();_a.c.a(this.d);this.d=null}if(n.SupportedCultures&&n.SupportedCultures.length>0){this.g=n.SupportedCultures;t();return}i(Error.create("Get regional information failed to retrieve at least one valid language."))},bb:function(n){_h.ff.prototype.bb.call(this,Error.create(n.message));if(this.d){this.d.l=this.P();this.d.k=n.name.toString();_a.c.a(this.d);this.d=null}}};_c.x=function(){_c.x.initializeBase(this)};_c.x.prototype={d:null,L:function(n){var t=new _gg.mm(this.M);n.cs(t,this.K,this.J)},cU:function(n,t,i){try{_a.b.b(n,"themeSelectionInfo");this.d=n;t()}catch(r){i(r)}}};_c.L=function(n,t){_c.L.initializeBase(this);this.d=n;this.g=t};_c.L.prototype={d:null,g:!1,L:function(n){var r=new _gg.mu(this.M);var t;var i=(t=new _gg.cL,t.ThemeId=this.d,t.SkipO365Call=this.g,t);n.dd(i,r,this.K,this.J)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.n=function(n){_c.n.initializeBase(this,[n])};_c.n.prototype={c:function(){return"KeepAliveActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){var t=new Sys.Net.WebRequest;t.set_url(_j.h.a(_a.g.m)?"ping.owa":_a.g.m);t.set_timeout(6e4);t.invoke()}};function CoreModelsComponent(){}CoreModelsComponent.$$cctor=function(){_a.t.a().a(CoreModelsComponent)};CoreModelsComponent.prototype={b:function(n,t,i){n.e(_c.B).b(_h.dd).a();var r=this;n.b(_c.f,function(){return new _c.f(n.a(_a.bt),n.c(IChatManagerFactory),i.a())}).a();n.e(_c.F).a().b(IAddEventToMyCalendarResponseProcessorFactory);n.e(_c.G).a().b(ICreateAttachmentResponseProcessorFactory);n.e(_c.H).a().b(IDeleteAttachmentResponseProcessorFactory);n.e(_c.I).a().b(IDeletePlaceResponseProcessorFactory);n.e(_c.J).a().b(IPerformReminderActionResponseProcessorFactory)},a:function(){return[new _j.x(_c.f,2,1)]}};_c.s=function(n,t,i){_c.s.initializeBase(this,[t,i]);this.g=n};_c.s.prototype={g:null,i:function(){return!0},q:function(n){n.ActionType=0},p:function(n,t){for(var i=0;i<this.g.x.length;i++){var r=this.g.x[i];if(_ff.e.b(n.c(),r.c())){this.g.n(i);break}}}};_c.t=function(){this.d=-1;_c.t.initializeBase(this)};_c.t.prototype={cU:function(n,t,i){this.d=n;t()},L:function(n){n.bR(null,this.K,this.J)}};_c.M=function(n,t,i){_c.M.initializeBase(this,[n,i]);this.g=t};_c.M.prototype={g:null,i:function(){return!0},q:function(n){var t=_a.d.f(this.g);n.ActionType=1;n.NewReminderTime=t},p:function(n,t){n.k(this.g)}};_c.z=function(n,t){_c.z.initializeBase(this);this.g=n;this.d=t};_c.z.prototype={g:null,d:null,i:null,L:function(n){var r=new _g.f(this.g);var u=new _gg.jg(r,this.d);var t=new _gg.jf(this.N(),u);var i=new _gg.yb(this.M);n.ha(t,i,this.K,this.J)},cJ:function(n){this.i=n}};_c.A=function(n){_c.A.initializeBase(this);this.d=n};_c.A.prototype={d:null,L:function(n){var r=new _gg.je(this.d);var u=new _gg.gG(r);var t=new _gg.gF(this.N(),u);var i=new _gg.qa(this.M);n.eq(t,i,this.K,this.J)},cJ:function(n){}};_c.y=function(n){_c.y.initializeBase(this);this.d=n};_c.y.prototype={d:null,L:function(n){var t=new _gg.tT(0);t.timeZone=this.Z();n.ch(t,this.K,this.J)},cU:function(n,t,i){try{if(!n){i(Error.create(_nbs.a.VV));return}this.d.d(n.ExternalAudience);this.d.e(n.ExternalReply);this.d.f(n.InternalReply);this.d.b(n.IsOofOn);this.d.g(n.IsScheduled);this.d.c(_a.d.b(n.EndTime));t()}catch(r){i(r)}}};_c.K=function(n){_c.K.initializeBase(this);this.d=n};_c.K.prototype={d:null,L:function(n){var t=new _gg.lk;t.ExternalAudience=this.d.h();t.ExternalReply=this.d.i();t.InternalReply=this.d.j();t.IsOofOn=this.d.a();n.ie(t,null,this.K,this.J)},cU:function(n,t,i){if(!n){i(Error.create(_bms.E.BA));return}t()}};_c.D=function(n){_c.D.initializeBase(this);this.d=n};_c.D.prototype={d:null,L:function(n){n.hn(this.d,null,this.K,this.J)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.Q=function(n,t){_c.Q.initializeBase(this);_a.b.b(n,"remindersToPerformAction");_a.b.b(t,"nativeBridge");this.d=n;this.l=t};_c.Q.prototype={d:null,l:null,L:function(n){var i=this.s();var t=new _gg.xU(this.M);t.shouldPrecedeOfflineSyncActions=this.i();n.cF(i,t,this.k,this.j)},S:function(){_a.db.prototype.S.call(this);for(var n=0;n<this.d.length;n++)this.p(this.d[n],this.l)},s:function(){var t=new _gg.eM;t.ReminderItemActions=this.r();var n=new _gg.jb(this.N());n.Body=t;return n},r:function(){for(var i=new Array(this.d.length),n=0;n<this.d.length;n++){var u=this.d[n];var r=new _g.f(u.c().Id);r.ChangeKey=u.c().ChangeKey;var t=new _gg.jo;t.ItemId=r;this.q(t);i[n]=t}return i}};_c.g=function(n,t){_c.g.initializeBase(this,[0]);this.i=n;var i=_g.b.a.nameToId("todosearch");t&&t!==i||(t=_g.b.a.nameToId("tasks"));this.bn=_g.m.c(t);this.bg="CreateTask"};_c.g.prototype={i:null,g:null,bl:function(){return[this.j()]},cJ:function(n){this.g=n.Items[0].ItemId},j:function(){for(var t=new _g.bO,f=this.i.d,o=this.i.f(),r=o,e=r.length,n=0;n<e;++n){var u=r[n];var i=_c.a.b(u);i&&i(t,f)}t.Owner=_g.a.a().c().bD.UserDisplayName;return t}};_c.q=function(n,t){_c.q.initializeBase(this);_a.b.b(n,"ParentGroup");this.i=n;var i=new _gg.by;i.c(n.bD.GroupId);this.d=i;this.g=new _gg.fM;this.k=t};_c.q.prototype={d:null,g:null,i:null,k:null,l:function(n){if(!_j.h.b(n)){this.d.a(n);this.g.f(n)}},L:function(n){n.dW(this.d.bD.FolderName,this.d.bD.ParentGroupId,null,this.K,this.J)},p:function(n){var t=new _g.l(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.g.j(t);this.g.v(_g.b.a.nameToId("tasks"));this.d.e(t);this.d.f(n.NewTaskFolderEntryId);var i=_h.a.c("msgfolderroot");i.bx.a(this.g);this.k.n(this.i,this.d,this.g)}};_c.r=function(n,t,i){_c.r.initializeBase(this);_a.b.b(n,"taskFolderToDelete");_a.b.b(t,"parentGroup");_a.b.b(i,"taskGroupsCache");this.d=n;this.g=t;this.i=i};_c.r.prototype={d:null,g:null,i:null,L:function(n){var t=new _g.f(this.d.bD.ItemId.Id);t.ChangeKey=this.d.bD.ItemId.ChangeKey;n.ek(t,null,this.K,this.J)},p:function(n){this.i.t(this.g,this.d)}};_c.l=function(n,t,i){_c.l.initializeBase(this,[n,t])};_c.l.prototype={bm:function(){this.bi&&(this.G=new _g.E(_g.m.a(this.bi)));var t=[];var r=this.bl(this.j);var n=new _g.u(new _g.d("TaskStatus"));n.Item=new _g.bO;n.Item.Status=r;Array.add(t,n);if(r==="InProgress"){var i=null;if(this.j.c()){n=new _g.u(new _g.d("TaskStartDate"));n.Item=new _g.bO;n.Item.StartDate=this.j.c().i();Array.add(t,n)}else{i=new _g.bg(new _g.d("TaskStartDate"));Array.add(t,i)}if(this.j.b()){n=new _g.u(new _g.d("TaskDueDate"));n.Item=new _g.bO;n.Item.DueDate=this.j.b().i();Array.add(t,n)}else{i=new _g.bg(new _g.d("TaskDueDate"));Array.add(t,i)}}if(r==="InProgress"||r==="Completed")if(this.j.e()){n=new _g.u(new _g.d("TaskCompleteDate"));n.Item=new _g.bO;n.Item.CompleteDate=this.j.e().i();Array.add(t,n)}else{var u=new _g.bg(new _g.d("TaskCompleteDate"));Array.add(t,u)}return t},v:function(){for(var r=this.bm(),t=new Array(this.q.length),n=0;n<this.q.length;n++){var i=new _g.f(this.q[n].bD.ItemId.Id);i.ChangeKey=this.q[n].bD.ItemId.ChangeKey;t[n]=new _g.bo;t[n].ItemId=i;t[n].Updates=r}return t},S:function(){var t=this.bl(this.j);var n=this.q;var l=this,c=this;_h.c.c(_dg.m,String,n,"Status",function(n){return n.b()},t,function(n,t){n.x(t)});var h=this,a=this;_h.c.c(_dg.m,Boolean,n,"IsComplete",function(n){return n.l()},t==="Completed",function(n,t){n.P(t)});if(t==="InProgress"){if(this.j.c()){var p=this,y=this;_h.c.c(_dg.m,_a.d,n,"StartDate",function(n){return n.j()},this.j.c(),function(n,t){n.T(t)})}if(this.j.b()){var v=this,u=this;_h.c.c(_dg.m,_a.d,n,"DueDate",function(n){return n.f()},this.j.b(),function(n,t){n.N(t)})}if(this.j.e()){var r=this,i=this;_h.c.c(_dg.m,_a.d,n,"CompleteDate",function(n){return n.h()},this.j.e(),function(n,t){n.G(t)})}}else if(t==="Completed"){var f=this,s=this;_h.c.c(_dg.m,String,n,"PercentComplete",function(n){return n.bD.PercentComplete},"100",function(n,t){n.R(t)});var o=this,e=this;_h.c.c(_dg.m,_a.d,n,"CompleteDate",function(n){return n.h()},this.j.e().d(),function(n,t){n.G(t)})}},bl:function(n){var t="NotStarted";switch(n.a()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":t="Completed";break;case"Flagged":t="InProgress";break}return t}};_c.w=function(){_c.w.initializeBase(this)};_c.w.prototype={d:null,L:function(n){var t=new _gg.uK(this.M);n.gk(t,this.K,this.J)},cU:function(n,t,i){try{this.g(n)}catch(r){i(r);return}t()},g:function(n){n&&(this.d=n.TaskGroups)}};_c.m=function(n,t,i,r,u,f){_c.m.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,f,!1,null,null,0,null,-1,null,!1])};_c.m.prototype={bD:function(){return _h.cm.a(this.w.a,this.w.b,this.v)}};_c.E=function(n,t,i){_c.E.initializeBase(this);_a.b.b(n,"taskFolderToRename");_a.b.c(t,"newTaskFolderName");_a.b.b(i,"taskGroupsCache");this.d=n;this.g=t;this.i=i};_c.E.prototype={d:null,g:null,i:null,L:function(n){var t=new _g.f(this.d.bD.ItemId.Id);t.ChangeKey=this.d.bD.ItemId.ChangeKey;n.hu(t,this.g,null,this.K,this.J)},p:function(n){this.d.bD.ItemId.ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.d.a(this.g);if(this.i.b){var t=this.i.j(this.d.bD.TaskFolderId);if(t){t.bD.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.g)}}}};_c.T=function(){this.j=String.format(_nbs.a.cg,-1);_c.T.initializeBase(this)};_c.T.prototype={cU:function(n,t,i){if(!n.WasSuccessful){this.j=_c.N.a(n.ErrorCode);i(Error.create(this.j));return}try{this.p(n)}catch(r){i(r);return}t()}};_c.N=function(){};_c.N.a=function(n){switch(n){case 11:return _nbs.a.fZ;case 13:return _nbs.a.jm;case 7:return _nbs.a.JG;default:return String.format(_nbs.a.cg,n)}};_c.b=function(n,t){this.b=n;this.a=t};_c.b.prototype={b:"FolderId",a:!1};_c.a=function(){};_c.a.b=function(n){_c.a.c();return _c.a.a[n]};_c.a.c=function(){if(!_c.a.a){_c.a.a={};_c.a.a.Subject=function(n,t){n.Subject=t.bD.Subject;return new _c.b("Subject",!1)};_c.a.a.DueDate=function(n,t){var i=!t.f();i||(n.DueDate=t.f().i());return new _c.b("TaskDueDate",i)};_c.a.a.Body=function(n,t){n.Body=new _g.s(t.O().a()==="HTML"?"HTML":"Text",t.O().bD.Value);return new _c.b("Body",!1)};_c.a.a.StartDate=function(n,t){var i=!t.j();i||(n.StartDate=t.j().i());return new _c.b("TaskStartDate",i)};_c.a.a.Importance=function(n,t){n.Importance=t.bc();return new _c.b("Importance",!1)};_c.a.a.Status=function(n,t){n.Status=t.b();return new _c.b("TaskStatus",!1)};_c.a.a.CompleteDate=function(n,t){var i=!t.h();i||(n.CompleteDate=t.h().i());return new _c.b("TaskCompleteDate",i)};_c.a.a.PercentComplete=function(n,t){n.PercentComplete=t.bD.PercentComplete;return new _c.b("TaskPercentComplete",!1)};_c.a.a.Sensitivity=function(n,t){n.Sensitivity=t.ck();return new _c.b("Sensitivity",!1)};_c.a.a.TotalWork=function(n,t){n.TotalWork=t.w();return new _c.b("TaskTotalWork",!1)};_c.a.a.ActualWork=function(n,t){n.ActualWork=t.n();return new _c.b("TaskActualWork",!1)};_c.a.a.Mileage=function(n,t){n.Mileage=t.bD.Mileage;return new _c.b("TaskMileage",!1)};_c.a.a.BillingInformation=function(n,t){n.BillingInformation=t.bD.BillingInformation;return new _c.b("TaskBillingInformation",!1)};_c.a.a.Companies=function(n,t){var r=!t.g()&&t.g().b()>0;if(!r){for(var u=new Array(t.g().b()),i=0;i<t.g().b();i++)u[i]=t.g().a(i);n.Companies=u}return new _c.b("TaskCompanies",r)};_c.a.a.ReminderIsSet=function(n,t){n.ReminderIsSet=t.bD.ReminderIsSet;return new _c.b("ReminderIsSet",!1)};_c.a.a.ReminderDueBy=function(n,t){var i=!t.eW();i||(n.ReminderDueBy=t.eW().i());return new _c.b("ReminderDueBy",i)};_c.a.a.Recurrence=function(n,t){var i=!t.C();i||(n.Recurrence=t.C().bD);return new _c.b("TaskRecurrence",i)};_c.a.a.ModernReminders=function(n,t){var i=!t.z();i||(n.ModernReminders=t.z().j.p);return new _c.b("ModernReminders",i)};_c.a.a.Charm=function(n,t){n.Charm=t.p();return new _c.b("TaskCharm",!1)}}};_c.e=function(n){_c.e.initializeBase(this,[0]);this.j=n;var t=n.d;t.bD.ParentFolderId&&(this.bp=_g.m.c(t.bD.ParentFolderId));this.t="UpdateTask"};_c.e.a=function(n,t,i){if(i){var f=new _g.bO;var e=i(f,t);var r=new _g.d(e.b);if(e.a){var o=new _g.bg(r);Array.add(n,o)}else{var u=new _g.u(r);u.Item=f;Array.add(n,u)}}};_c.e.prototype={j:null,v:function(){for(var i=[],u=this.j.d,o=this.j.f(),r=o,f=r.length,n=0;n<f;++n){var e=r[n];_c.e.a(i,u,_c.a.b(e))}var t=new _g.bo;t.ItemId=_g.f.a(u.bD.ItemId);t.Updates=i;return[t]}};_c.CalendarTimePeriodSchema=function(){};_c.C=function(n,t){_c.C.initializeBase(this,[n]);this.f=t};_c.C.prototype={f:null,c:function(){return"PresenceActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){this.f.x()}};_c.d=function(n,t){this.b=n;this.a=t};_c.d.prototype={b:0,a:null};_c.k=function(){_c.k.initializeBase(this)};_c.k.prototype={k:0,l:null,m:null,n:!1,p:!1,o:null,h:function(){return this.k},d:function(n){if(n===this.k)return n;this.k=n;this.eB("ExternalAudience");return n},i:function(){return this.l},e:function(n){if(n===this.l)return n;this.l=n;this.eB("ExternalReply");return n},j:function(){return this.m},f:function(n){if(n===this.m)return n;this.m=n;this.eB("InternalReply");return n},a:function(){return this.n},b:function(n){if(n===this.n)return n;this.n=n;this.eB("IsOofOn");return n},g:function(n){if(n===this.p)return n;this.p=n;this.eB("IsScheduled");return n},c:function(n){if(n===this.o)return n;this.o=n;this.eB("EndTime");return n}};_c.B=function(){};_c.B.prototype={a:function(n,t,i,r){return new _c.h(n,t,new _g.dS(r),i,_g.k.b)}};_c.h=function(n,t,i,r,u){_c.h.initializeBase(this,[null,n,t,i,r]);this.a=u};_c.h.prototype={a:null,A:function(){return this.a},z:function(n,t,i){},u:function(n,t,i){},q:function(n){return n},E:function(n,t,i,r,u){_j.e.a(_c.h.a,"ExecuteWithActionQueue {0}",n);this.a.ji(n,t,i,r,u);return}};_c.R=function(){_c.R.initializeBase(this)};_c.R.prototype={callState:null};_c.P=function(n,t,i){_c.P.initializeBase(this,[n]);this.h=_j.E.a(t)?"All":t;this.e=i?i:new _h.o("TaskDueDate","Ascending");this.f=this.f+"_item_"+this.h+"_"+this.e.a.toString()+"_"+this.e.b.toString()+"_"};_c.P.prototype={h:"All",e:null,c:function(){return this.h},d:function(){return _h.cm.a(this.e.a,this.e.b,this.g)}};_c.o=function(n){_c.o.initializeBase(this,[n,null,_c.o.a(n)])};_c.o.a=function(n){return[new _h.v(n,!1,n.d(),n.c())]};_c.o.prototype={bB:function(){return _a.a.fE},bS:function(){return this.bA.h},bE:function(){return this.bA.e},r:function(){return null},F:function(){return!1},J:function(n,t){var i=this;n.k(function(){i.cm==="ErrorConnectionFailed"&&n.i()&&n.f()?t(6):t(1)})},cD:function(n){},bW:function(n){var t=Math.max(this.cJ(),this.bx.x.length);this.ck(4);this.bM(this.cC(t,this.g()))},bL:function(n,t){if(!_h.m.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.m,"range needs to be an IndexedRange object");return this.cC(n.b,n.a)},O:function(n){return!1},cY:function(n,t){var i=n;i.dM(t)},dO:function(n,t){return!0},ct:function(n,t){return-2},cB:function(n,t,i){return new _c.m(this.e(),this.r(),n,!1,this.bS(),this.bE())},cC:function(n,t){return new _c.m(this.e(),this.r(),_h.t.a(t,n),!1,this.bS(),this.bE())}};_c.O=function(){this.g=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.s);this.a={};this.e=[];_c.O.initializeBase(this)};_c.O.prototype={c:null,b:!1,d:!1,f:0,m:function(n){this.bz("CachePopulated",n)},u:function(n){if(n!==this.b){this.b=n;this.bv("IsLoaded")}return n},p:function(){return _nbs.a.dr},j:function(n){return this.a?n.Id in this.a?this.a[n.Id]:null:null},k:function(n){if(this.b){n&&n();return!0}n&&Array.add(this.e,n);this.o();return!1},n:function(n,t,i){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolderEntry");_a.b.a(i,"folder");t.c(n.bD.GroupId);n.a().c(t);this.a[t.bD.TaskFolderId.Id]=i},t:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolder");delete this.a[t.bD.TaskFolderId.Id];n.a().m(t)},o:function(){if(!this.d){this.d=!0;this.l()}},l:function(){var n=new _c.w;n.c(this.i);n.e(this.h);n.a(this.g);_a.g.a.a(n)},s:function(n){var c=n;this.c=new _j.l;this.a={};for(var l=!1,s=0;s<c.d.length;s++){var i=new _gg.fL(c.d[s]);i.b()||i.c(_nbs.a.Ni);for(var f=i.a().b()-1;f>=0;f--){var t=i.a().a(f);var u=null;if(t.b()===1){u=_g.j.a("todosearch");l=!0;t.a(_nbs.a.eG);u.f(_nbs.a.eG)}else{u=_h.a.a(t.bD.TaskFolderId);t.b()===2&&t.a(u.f(this.p()))}u?this.a[t.bD.TaskFolderId.Id]=u:i.a().o(f)}this.c.a(i)}if(!l&&this.c.x.length>0){var h=this.c.x[0];var o=_g.j.a("todosearch");o.f(_nbs.a.eG);var r=new _gg.by;r.a(_nbs.a.eG);r.g(1);r.e(o.bD.FolderId);r.c(h.bD.GroupId);h.a().r(0,r);this.a[r.bD.TaskFolderId.Id]=o}this.u(!0);this.d=!1;this.bJ("CachePopulated",this,null);for(var e=0;e<this.e.length;e++)this.e[e]();this.e=[]},r:function(n){if(this.f<3){var t=this;_j.m.a().a(_a.a.bQ,"GetTaskFoldersActionRetry",function(){t.l()},2e3);this.f++}else{this.f=0;this.d=!1}},q:function(n){n.W(this.i);n.V(this.h);n.o(this.g)}};_c.c=function(n,t,i,r){_c.c.initializeBase(this,[n,t,_c.c.b(),"None",i,r,null])};_c.c.b=function(){if(!_c.c.a){_c.c.a=new _g.Z("IdOnly");_c.c.a.AddBlankTargetToLinks=!0;_c.c.a.ClientSupportsIrm=!0;_c.c.a.FilterHtmlContent=!0;_c.c.a.InlineImageUrlTemplate=_g.C.b();_c.c.a.MaximumBodySize=0;_c.c.a.AdditionalProperties=[new _g.d("UID"),new _g.d("ItemParentId"),new _g.d("InstanceKey"),new _g.d("Subject"),new _g.d("TaskDueDate"),new _g.d("Body"),new _g.d("NormalizedBody"),new _g.d("HasAttachments"),new _g.d("Attachments"),new _g.d("TaskStartDate"),new _g.d("Importance"),new _g.d("TaskStatus"),new _g.d("TaskCompleteDate"),new _g.d("TaskPercentComplete"),new _g.d("Sensitivity"),new _g.d("TaskOwner"),new _g.d("Categories"),new _g.d("TaskTotalWork"),new _g.d("TaskActualWork"),new _g.d("TaskMileage"),new _g.d("TaskBillingInformation"),new _g.d("TaskCompanies"),new _g.d("TaskRecurrence"),new _g.d("ReminderDueBy"),new _g.d("ReminderIsSet"),new _g.d("ReminderNextTime"),new _g.d("ReminderMinutesBeforeStart"),new _g.d("ItemLastModifiedTime"),new _g.d("TaskIsComplete"),new _g.d("TaskIsTaskRecurring"),new _g.d("ItemClass"),new _g.d("TaskDelegationState"),new _g.d("TaskDoItTime"),new _g.d("TaskCharm")]}return _c.c.a};_c.c.prototype={cJ:function(n){try{_h.bT.prototype.cJ.call(this,n)}catch(t){this.bP("ProcessResponseMessageFailed",this);throw t;}}};_c.i=function(n,t){_c.i.initializeBase(this,[n,t,_c.i.a])};_c.F=function(){};_c.F.prototype={a:function(n,t,i){return new _c.i(n,t)}};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.a]);_a.b.b(i,"nativeBridge");this.i=i};_c.CreateAttachmentResponseProcessor.prototype={i:null,j:function(n,t){var r=null;var i=null;if(t.ResponseClass==="Success"){r=t.Attachments[0].AttachmentId;i=new _g.f(r.RootItemId);i.ChangeKey=r.RootItemChangeKey;var f=this.g().Body.ParentItemId;this.e.u(this.b,f,i)}if(this.a()){var e=this.a().attachmentIds[n];this.t(t.ResponseClass,e,r,i);if(this.a().palContext&&this.a().palContext.palActionNeeded&&this.i.b(this.i.i())){var u=this.i.i().b();u.e(this.a().dataFile);this.i.i().a(u.c())}}_h.dq.prototype.j.call(this,n,t)},t:function(n,t,i,r){n==="Success"?this.y(t,i,r):this.u(t)},y:function(n,t,i){var u=new _g.bk(t.Id);this.e.z(this.b,n,u);if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this;this.d().a().d(this.b,this.d().h().b(i.Id),function(t){if(_j.E.a(t)){_j.e.b(r.f,"Message with id {0} not found in local store",i.Id);return}r.z(t,n,u)})}},u:function(n){if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this.c.request.parameters;var t=new _g.f(r.Body.Attachments[0].AttachmentId.RootItemId);var i=this;this.d().a().d(this.b,this.d().h().b(t.Id),function(r){if(!r){_j.e.b(i.f,"Message with id {0} not found in local store",t.Id);return}i.m(r,n)})}},z:function(n,t,i){var u=n;if(!u.HasAttachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if(!u.Attachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var e=u.Attachments,o=e.length,r=0;r<o;++r){var f=e[r];if(f.AttachmentId.Id===t.Id){f.AttachmentId.Id=i.Id;return}}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)},m:function(n,t){var i=n;if(i.HasAttachments&&i.Attachments){for(var r=0;r<i.Attachments.length;r++)if(i.Attachments[r].AttachmentId.Id===t.Id){Array.removeAt(i.Attachments,r);break}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)}}};_c.G=function(){};_c.G.prototype={a:function(n,t,i){return new _c.CreateAttachmentResponseProcessor(n,t,i)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.a])};_c.DeleteAttachmentResponseProcessor.prototype={j:function(n,t){var i=this.a().itemContexts[n];if(t.ResponseClass==="Success"){var f=this.e.q(i.parentItemId);var r=new _g.f(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.e.u(this.b,f,r)}else if(this.l()&&i.clientStoreItem===2){this.b.b().b(!1);var u=this.e.q(i.parentItemId);this.d().a().g(this.b,this.d().h().b(u.Id),i.deletedAttachment)}_h.dq.prototype.j.call(this,n,t)}};_c.H=function(){};_c.H.prototype={a:function(n,t,i){return new _c.DeleteAttachmentResponseProcessor(n,t)}};_c.j=function(n,t){_c.j.initializeBase(this,[n,t,_c.j.a])};_c.I=function(){};_c.I.prototype={a:function(n,t,i){return new _c.j(n,t)}};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.a])};_c.J=function(){};_c.J.prototype={a:function(n,t,i){return new _c.PerformReminderActionResponseProcessor(n,t)}};_c.f.registerClass("_c.f");_c.p.registerClass("_c.p",_h.ff,_a.fu);_c.u.registerClass("_c.u",_h.ff);_c.v.registerClass("_c.v",_h.ff);_c.x.registerClass("_c.x",_h.ff,_a.fu);_c.L.registerClass("_c.L",_h.ff);_c.n.registerClass("_c.n",_a.ie);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.iz,_j.cd);_c.Q.registerClass("_c.Q",_h.fg);_c.s.registerClass("_c.s",_c.Q);_c.t.registerClass("_c.t",_h.ff);_c.M.registerClass("_c.M",_c.Q);_c.z.registerClass("_c.z",_h.cW.$$(_gg.yc,_gg.yd));_c.A.registerClass("_c.A",_h.cW.$$(_gg.qb,_gg.qc));_c.y.registerClass("_c.y",_h.ff);_c.K.registerClass("_c.K",_h.ff);_c.D.registerClass("_c.D",_h.ff,_a.fu);_c.g.registerClass("_c.g",_h.eD);_c.T.registerClass("_c.T",_h.ff);_c.q.registerClass("_c.q",_c.T);_c.r.registerClass("_c.r",_c.T);_c.l.registerClass("_c.l",_h.bk);_c.w.registerClass("_c.w",_h.ff);_c.m.registerClass("_c.m",_h.bc);_c.E.registerClass("_c.E",_c.T);_c.e.registerClass("_c.e",_h.cn);_c.C.registerClass("_c.C",_a.ie);_c.d.registerClass("_c.d");_c.k.registerClass("_c.k",_a.cl);_c.B.registerClass("_c.B",null,_h.dd);_c.h.registerClass("_c.h",_g.k);_c.R.registerClass("_c.R",_no.k);_c.R.prototype.toString=_no.k.prototype.toString;_c.P.registerClass("_c.P",_h.dz.$$(_c.o),_h.eS);_c.o.registerClass("_c.o",_lm.d);_c.O.registerClass("_c.O",_j.Q);_c.c.registerClass("_c.c",_h.bT);_c.i.registerClass("_c.i",_h.dr.$$(_cz.dU,Boolean));_c.F.registerClass("_c.F",null,IAddEventToMyCalendarResponseProcessorFactory,_h.eu);_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.dq.$$(_gg.lQ,_gg.dH,_gg.gg,_gg.fT));_c.G.registerClass("_c.G",null,ICreateAttachmentResponseProcessorFactory,_h.eu);_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.dq.$$(_gg.pz,_gg.gq,_gg.gr,_gg.gt));_c.H.registerClass("_c.H",null,IDeleteAttachmentResponseProcessorFactory,_h.eu);_c.j.registerClass("_c.j",_h.dr.$$(_cz.eT,_pc.a));_c.I.registerClass("_c.I",null,IDeletePlaceResponseProcessorFactory,_h.eu);_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.dq.$$(_gg.xU,_gg.jb,_gg.jc,_g.gm));_c.J.registerClass("_c.J",null,IPerformReminderActionResponseProcessorFactory,_h.eu);CoreModelsComponent.$$cctor();_c.a.a=null;_c.CalendarTimePeriodSchema.c=new _a.e("Start",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.a=new _a.e("End",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.b=new _a.e("Recurrence",_dg.w,_dg.ICalendarTimePeriod);_c.h.a=_a.a.fj;_c.c.a=null;_c.i.a=_a.a.dC;_c.CreateAttachmentResponseProcessor.a=_a.a.c;_c.DeleteAttachmentResponseProcessor.a=_a.a.c;_c.j.a=_a.a.eA;_c.PerformReminderActionResponseProcessor.a=_a.a.fg;
window.scriptsLoaded['microsoft.owa.core.models.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.models.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
