try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.quickcompose.js'] = (new Date()).getTime();
Type.registerNamespace("_qc");_qc.q=function(n,t,i,r,u){this.a=n;this.b=t;this.h=i;this.g=r;this.i=u};_qc.q.prototype={a:null,b:null,h:null,k:null,e:null,g:null,f:null,d:null,i:null,c:null,j:null};_qc.f=function(n){this.a=n};_qc.f.prototype={a:null,c:!1,b:!1};_qc.n=function(){};_qc.c=function(n){this.a=n};_qc.c.prototype={a:0};_qc.t=function(n){this.b=n};_qc.t.prototype={b:null,a:function(){return this.b}};_qc.u=function(n){this.b=n};_qc.u.prototype={b:null,a:function(){return this.b}};_qc.v=function(n){_qc.v.initializeBase(this,[n])};_qc.v.prototype={b:function(n){var t=this.d.m(n)+1;return t<this.d.d.length?this.d.d[t]:""},c:function(n,t,i,r){for(var e=this.d.m(t),f=e;f<this.d.d.length;f++){var o="QC:"+this.d.d[f];var u=n.c[o];if(f!==e&&!u.w())break;u.r(i);u.A(r);n.d.a(_a.dP,new _a.dP(o,u))}},f:function(n,t,i){if(_bc.f.a(t.h().bD.ItemId)&&this.d.d.length>1){var f=this.d.m(i)-1;var e="QC:"+this.d.d[f];var r=n.c[e];if(!r.k()){var u=this.e(n);t.o(u.f())}}},g:function(n,t,i){var r=null;if(!this.d.m(t)&&this.d.d.length>1){var f="QC:"+this.d.d[1];r=n.c[f];var u=this.e(n);r.o(u.f())}this.d.n(t);return r},e:function(n){if(!!this.d.d.length){var t="QC:"+this.d.d[0];return n.c[t]}return null}};function QuickComposeComponent(){}QuickComposeComponent.$$cctor=function(){_a.t.a().a(QuickComposeComponent)};QuickComposeComponent.prototype={b:function(n,t,i){n.e(_qc.B).b(IQuickComposeEventAggregatorFactory).a();var o=this;n.b(_y.eX,function(){return new _qc.C(n.a(_g.G),n.d(IRecipientWellViewModelFactory),n.a(_j.u))}).a();var s=this;n.b(_y.eY,function(){return new _qc.D(n.a(_a.s),n.a(_j.j),n.a(_a.cr),i.a()==="Mouse"?n.c(_y.cL):null,n.a(_h.p).a())}).a();var h=this;n.b(_y.eW,function(){return new _qc.A(n.a(_a.s),n.d(IAttachmentWellViewModelFactory),n.d(_y.bC),n.a(_a.y),n.a(_a.bp),n.a(_a.o),n.a(_y.a),n.a(_g.a).bD.AttachmentPolicy,n.a(_j.j))}).a();var e=this;n.b(_qc.s,function(){return new _qc.s(n.d(IMailComposeContextFactory),n.a(_a.y),n.a(_a.o))}).a();var r=this;n.b(_y.gb,function(){return new _qc.y(n.a(_j.j),n.a(_g.G),n.a(_a.o))}).a();var u=this;n.b(IMailQuickComposeViewModel,function(){return new _qc.z(n.a(_j.j),n.a(_a.cr),n.a(_y.gb),n.a(IQuickComposeEventAggregatorFactory),n.a(_y.eX),n.a(_y.eY),n.a(_y.eW),n.a(_qc.s),n.a(_a.o).M,n.a(_a.y),n.c(IAtMentionsHandler))});var f=this;n.b(IMailInlineComposeConductorViewModelFactory,function(){return new _qc.x(n.a(_a.cr),n.d(IMailInlineComposeViewModelFactory),n.d(IMailSimpleComposeViewModelFactory),n.d(IMailComposeContextFactory),n.a(_a.f),n.a(_pe.g),n.a(_a.o))}).a()},a:function(){return null}};_qc.e=function(n,t,i,r,u,f,e,o,s,h,c,l){_qc.e.initializeBase(this);this.bo=_qc.e.b++;this.S=n;_qc.d.isInstanceOfType(t)&&(t.l=this);this.J=t;_qc.j.isInstanceOfType(i)&&(i.i=this);this.N=i;_qc.m.isInstanceOfType(r)&&(r.g=this);this.L=r;_qc.i.isInstanceOfType(u)&&(u.f=this);this.V=u;this.K=f;this.ba=e;this.br=s;this.bl=h;this.bb=c;this.U=l;var a=new _g.i;a.cL(new _g.w(new _g.s("HTML","")));a.dZ("Normal");a.dP("Normal");a.hi(new _a.k);a.cR(o.f());this.H=a;this.T={};this.Z={};this.bn(!0);this.G("Creating new QuickComposeContext in context service with key "+n);e.a(_a.bV,new _a.bV(n,this))};_qc.e.prototype={ba:null,br:null,bl:null,H:null,bo:0,K:!1,bm:null,S:null,Q:null,P:null,bc:!1,bj:!1,U:null,bb:null,R:!1,bk:null,bd:!1,bp:!1,bi:null,W:null,Y:!1,bg:null,O:0,J:null,N:null,L:null,V:null,bA:function(n){this.apcl("SendSemaphore",n)},bs:function(n){this.rpcl("SendSemaphore",n)},c:function(){return this.J},b:function(){return this.N},m:function(){return this.L},E:function(){return this.V},d:function(){return this.S},x:function(){return this.bl},a:function(){return this.H},j:function(){return this.bb},k:function(){return this.R},r:function(n){this.R=n;return n},A:function(n){this.bk=n;return n},w:function(){return this.bd},F:function(n){this.U=n;return n},v:function(){return this.Q},q:function(n){if(this.Q!==n){this.Q=n;this.by("InReplyToItem","InReplyToText")}return n},f:function(){return this.P},o:function(n){this.P=n;this.G("Updated default original item to be "+this.P?this.P.bD.ItemId.Id:"null");return n},h:function(){if(this.Q){this.G("returning inReplyToItem as the original item to respond to");return this.Q}if(this.P){this.G("returning the default original item from the defaultOriginalItemPartViewModelGetter.");return this.P}this.G("neither inReplyToItem nor defaultOriginalItemPartViewModelGetter were present, returning null as original item");return null},bf:function(){if(this.bp)return!0;var n;var r=this.L.e();var u=this.J.j();if(this.Y){n=this.s();this.G("active context updated message body with editor content prior to IsEmpty check, contentLength="+(n?n.length:0))}else{var f=this.H;n=f.O().bD.Value;this.G("inactive context using body value as content for IsEmpty check, contentLength="+(n?n.length:0))}var t=_j.h.a(n)||this.W===n.replace("&nbsp;","");var i=t&&r&&u;this.G("IsEmpty="+i+" since isContentEmpty="+t+", isAttachmentWellEmpty="+r+", isRecipientWellUntouched="+u);return i},g:function(){return this.bc},e:function(n){if(this.bc!==n){if(n&&this.K){this.bL();var r;var i;var t;var e,f,u;this.bG(e={val:r},f={val:i},u={val:t}),r=e.val,i=f.val,t=u.val;if(!r||!i){this.G("Cannot enable edit mode since original item is not allowed reply all or edit");this.bc=!1;this.bv("IsInEditMode");_a.E.a(_nbs.a.ht,0);return n}this.bM();t?this.J.d():this.J.f()}else n&&this.J.d();this.bc=n;this.bv("IsInEditMode");this.bt(n)}else n&&this.y(new _cmc.H(!1));return n},bt:function(n){if(this.bj!==n){this.bj=n;this.bv("IsInEditModeCompleted")}return n},u:function(){return this.bi},y:function(n){if(this.bi!==n){var t=_y.ek.isInstanceOfType(n)?n.b():!1;this.bi=n;t&&this.bD(n);this.bv("EditorCallContext")}return n},l:function(n){if(this.Y!==n){this.Y=n;this.bv("IsActive")}return n},z:function(n){this.bp=n;return n},n:function(){return this.W},p:function(n){this.W=n;return n},t:function(){this.bm||(this.bm=this.bB());return this.bm},T:null,i:function(){return this.T},bF:function(){return _cmc.h.c(_g.cp,this.T,_cmc.c.b,null)},Z:null,bE:function(){return _cmc.a.f(this.Z,null,!0)},be:function(n){if(this.O!==n){this.O=n;this.bv("SendSemaphore")}return n},iH:function(){return!1},G:function(n){_j.e.a(_qc.e.c,this.bo+":"+this.S+": "+n)},s:function(){var t=new _cmc.l(!1);this.y(t);var n=t.d;if(n){this.H.O().b(n);this.G("updated message body with editor content "+n);return n}this.G("content is null, skipping message body update");return this.H.O().bD.Value},B:function(){var n=this.H.O().bD.Value;var t=new _cmc.u(n);this.y(t);this.G("updated editor content with message body "+n)},C:function(n){if(this.bd){this.G("update original item to "+n.bD.ItemId.Id);this.P=n;this.G("original item has valid item id and pending message is ready to be sent");this.N.h()}},bn:function(n){this.N.b().c(n);this.V.a().c(n);this.L.b().c((this.br.q()||!this.L.d())&&n)},bh:function(){var n=new _qc.q(this.S,this.W,this.bb,this.U,this.bl);_qc.d.isInstanceOfType(this.J)&&this.J.X(n);_qc.j.isInstanceOfType(this.N)&&this.N.Q(n);this.ba.a(_qc.q,n);this.G("mark current context as inactive");this.l(!1);if(this.bg){this.G("restoring bottom app bar after creating initial state clone of the context");this.ba.a(_y.dj,new _y.dj(this.S,2,this.bg))}},bC:function(n,t){return _cmc.k.c(n,this.H,_mco.a.b(this.H.bD.From)||this.J.e(),_mco.a.b(this.H.bD.Sender)||this.J.e(),t)},bq:function(){this.y(new _cmc.u(""));this.G("resetting editor to empty string")},bu:function(){if(this.L.a()&&this.L.a().s()){var n=null;this.J.b()&&this.J.a()?n=this.J.a().g():!this.J.b()&&this.J.c()&&(n=this.J.c().g());n&&this.L.a().bt(n)}},bw:function(){this.G("disposing this instance");this.G("dereferenced any variables holding external references");this.Q=null;this.J.g();this.N.d();this.L.c();this.V.b();this.J=null;this.N=null;this.L=null;this.V=null;_j.Q.prototype.bw.call(this)},bD:function(n){if(_y.bX.isInstanceOfType(n)){var i=this.H.O();if(_j.h.a(this.W)){var t=n.c();this.W=t;i.b(t);this.G("set the empty content and body content on editor get content callback to "+t)}}},bB:function(){var t=[new _y.g(_y.b.y(),_y.b.z(),_nbs.a.OM,this.N.b()),new _y.g(_y.b.M(),_y.b.N(),_nbs.a.kQ,this.L.b()),new _y.g(_y.b.m(),_y.b.n(),_nbs.a.jS,this.V.a())];var n=_y.l.a(null,t,null,!0);n.L(!0);return n},bL:function(){if(this.U){var n=this.U();if(n){this.G("Setting the default original item from the defaultOriginalItemPartViewModelGetter.");this.P=n.a()}}},bM:function(){this.G("entering edit mode, raising swap app bar event for the tnarrow reply scenario");var t=new _y.dj(this.S,1,this.t());this.ba.a(_y.dj,t);var n=t.b;if(n){this.G("recording bottom app bar since it is not null");this.bg=n}},bG:function(n,t,i){var u=this.h();var r=u?u.bV():null;if(r&&!r.a()){n.val=r.c();t.val=r.j();i.val=r.e()}else{n.val=!0;t.val=!0;i.val=!0}}};_qc.F=function(n,t,i){this.b=n;this.c=t;this.d=i};_qc.F.prototype={b:null,c:null,d:null};_qc.G=function(n,t,i,r,u,f,e,o,s){this.Q=Function.createDelegate(this,this.bu);this.bc=Function.createDelegate(this,this.bl);this.Z=Function.createDelegate(this,this.bf);this.bb=Function.createDelegate(this,this.bk);this.Y=Function.createDelegate(this,this.bd);this.O=Function.createDelegate(this,this.br);this.P=Function.createDelegate(this,this.bt);this.ba=Function.createDelegate(this,this.bp);_qc.G.initializeBase(this);this.u=n;this.J=t;this.T=i;this.U=r;this.V=u;this.R=f;this.K=e;this.s=o;this.s&&this.s.c()&&s&&s.a(this.ba);this.u.b(_a.bV,this.P);this.u.b(_qc.q,this.O)};_qc.G.prototype={u:null,J:null,T:null,U:null,V:null,R:null,K:!1,w:null,E:null,H:null,B:!1,s:null,a:function(){var n=this.E;if(!n){_j.e.a(_a.a.v,"returning null context since key is null");return null}return this.J.c[n]},n:function(){return this.B},p:function(n){this.B=n;return n},f:function(){return this.B&&this.K},h:function(){return this.B&&!this.K},bx:function(){return 0},x:function(){return null},y:function(){return this.H},k:function(n){this.H=n;return n},by:function(){return!1},m:function(){var n=_y.jg.prototype.m.call(this);return n===2?1:n},o:function(){return null},c:function(n){return n},bg:function(){return _nbs.a.uS},bi:function(){return _nbs.a.ZY},bh:function(){return!1},bj:function(){return"sentitems"},q:function(n){var t=this.J.c[n];t&&t.s()},e:function(n,t,i,r,u,f,e){this.t("switching to context "+n);var s=this.a();if(s){this.t("calling oldContext.UpdateMessageBodyWithEditorContent to preserve the content before switching context, marking it inactive");s.s();s.l(!1)}this.E=n;var o=this.J.c[n];this.t(i.b()+" to recipients are passed from modern reading pane in context switch");this.t(r.b()+" cc recipients are passed from modern reading pane in context switch");var h;var l;var c;if(f){h=this.bi();this.t("setting place holder text to "+h+" for reply during context switch");l=this.Z;c=this.bc}else{h=this.bg();this.t("setting place holder text to "+h+" for new compose during context switch");l=this.Y;c=this.bb}if(o){this.t("Updating existing context and firing the context changed event");o.F(u);this.eB("Context");this.eO(o.t());this.t("updating editor content with message body on context switch");o.B();o.c().k(i,r)}else{o=this.be(n,t,i,r,u,f,e,h,l,c);if(s)if(_j.h.a(s.n()))this.t("skipped transfer of empty content from old context to new context since it is not set in the old context");else{o.p(s.n());this.t("transferred empty content from old context to new context")}}this.t("marking the current context as active");o.l(!0)},d:function(n,t,i){return this.B?new _mco.f(new _g.bs,t.g().bD.ItemId,this.s,this.u):new _mco.a(t.E(!1),null,this.s,this.u)},i:function(n){if(this.w&&this.a()){var t=this.a().i();n.c()?this.w.a(n.a(),t):this.w.b(n,t,this.a().c().a(),null)}},j:function(n){if(this.w&&this.a()){var t=this.a().i();n.c()?this.w.c(n.a(),t):this.w.d(n,t,this.a().c().a(),_cmc.c.g)}},g:function(){return this.a()?_cmc.c.f(this.a().i()):null},bd:function(n,t){return new _mco.a(n.a(),null,this.s,this.u)},bf:function(n,t){return new _mco.f(new _g.bs,n.h().bD.ItemId,this.s,this.u)},bk:function(n){},bl:function(n){},eE:function(){this.u.c(_a.bV,this.P);this.u.c(_qc.q,this.O);this.bo();_y.jg.prototype.eE.call(this)},be:function(n,t,i,r,u,f,e,o,s,h){_j.e.a(_a.a.v,"Creating new context with key "+n);var c=this.T.a();var v=this.U.a(e,c,i,r);var a=this.V.a(c,this.bh(),s,f,t,this.bj(),h);var l=this.R.a(t,c);return this.S(n,v,a,l,c,o,t,u)},br:function(n){if(n.a===this.E){this.t("Create a new context on initial state clone event");var t=this.be(n.a,n.h,n.k,n.e,n.g,n.f,n.d,n.i,n.c,n.j);this.t("mark the new context as active");t.l(!0);this.t("transferring empty content to new context, content="+n.b);t.p(n.b)}},bt:function(n){if(n.b===this.E){this.t("firing context changed event on new context with the same key, updating the new app bar");this.eB("Context");this.eO(n.a.t());if(this.H){this.t("closing the popup on new context");this.H()}}},t:function(n){_j.e.a(_a.a.v,this.E+": "+n)},bp:function(n){this.w=n;this.u.b(_y.cK,this.Q)},bo:function(){this.u.c(_y.cK,this.Q);this.w=null},bu:function(n){if(this.w&&this.a()&&this.a().c()){var t=this.a().c().a();this.w.e(n.a(),this.a().i())}}};_qc.h=function(n,t,i,r,u,f,e,o,s,h){_qc.h.initializeBase(this);this.v=new _qc.p(n,t,this,e,o,s);this.w=i;this.u=r;this.r=u;this.C=f;this.t=new _y.x;this.P=h;this.y=e};_qc.h.b=function(n){return _qc.h.a(n.bi(),n.V()?n.V().EmailAddress:null,!n.a())};_qc.h.a=function(n,t,i){var r=null;i&&!_j.h.a(t)?r=t:!i&&n&&(r=n.Id);if(r)return"QC:"+r;else{_j.e.b(_a.a.v,"context key is null. conversationId: "+(n?n.Id:"null")+" groupEmailAddress: "+t+" isNewMail: "+i);return null}};_qc.h.prototype={y:!1,u:null,w:null,r:null,E:!1,O:!1,z:!1,x:null,J:!1,C:null,t:null,v:null,P:null,G:null,k:function(){return this.y},Y:function(){return this.y&&this.S()},Z:function(){return this.y&&!this.S()},S:function(){return _j.F.a().M},c:function(){return this.z},n:function(n){if(this.z!==n){this.z=n;this.bv("IsShowingCompose")}return n},b:function(){return this.t.a()},o:function(n){this.J=n;return n},d:function(n){this.x=n;return n},q:function(){return this.E},j:function(n){this.E=n;this.U();return n},s:function(n){this.O=n;return n},p:function(){return this.H()?this.H().bD.SmtpAddress:null},H:function(){return this.C?this.C():null},U:function(){},m:function(n){this.r&&this.r.a(n)},f:function(n,t){if(!this.E)if(this.J){this.J=!1;this.r.cL(this)}else{this.j(!0);this.n(!1);this.ba(n.a());this.t&&this.t.c(this.v);if(this.r.bT()){this.r.bT()();this.r.Z(null)}}},l:function(){this.g(!0);var t=this.H();var n=_qc.h.a(this.w?this.w.bD.ConversationId:null,t?t.bD.SmtpAddress:null,!this.w);if(n&&this.u.c[n]&&_y.dd.isInstanceOfType(this.u.c[n])){var i=this.u.c[n];this.F(i);this.x&&this.r.bE(this.x);return}this.n(!1);this.V();this.t.c(this.v)},g:function(n){if(this.z){var t=this.b();t.u(!0);var i=t.a();this.f(t,!1);n&&this.X(i)}},i:function(){if(this.z){var n=this.b();this.f(n,!1)}},V:function(){},T:function(){this.r.j(!1);this.j(!1);this.O=!1;this.n(!0)},bw:function(){this.t.dispose();this.t=null;var n;_a.h.a(n={val:this.v}),this.v=n.val;this.C=null;this.r=null;this.x=null;_j.Q.prototype.bw.call(this)},X:function(n){var t=_qc.h.b(n);t&&!this.u.c[t]&&this.u.d.a(_a.bV,new _a.bV(t,n))},ba:function(n){var t=_qc.h.b(n);t&&n===this.u.c[t]&&this.u.d.a(_a.bJ,new _a.bJ(t))},e:function(){return this.G},bb:function(n){if(n!==this.G){this.G=n;this.bv("ScrollManager")}return n},h:function(n,t,i){this.bb(new _cmc.i(n,t,i,null,10,this.P));return this.G}};_qc.w=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_qc.w.initializeBase(this,[n,i,r,u,o,s,h,c,l,a]);this.K=f;this.L=e;this.M=n;this.A=t;this.B=!!c&&c.a().cp().Enabled};_qc.w.prototype={K:null,L:null,M:null,A:null,B:!1,U:function(){this.r&&this.r.j(this.E)},a:function(n){n.J()?this.m(n):this.F(n)},F:function(n){var i=!1;if(this.B&&this.A){var t=this.A();i=!!t.a()&&_g.e.r(t.a().bD.ItemClass);if(i){n.ce(t.a());n.d(15);n.e(!1);n.h("Text");var u=this;this.L.a(function(t){u.N(t,n)})}}if(!i){var r=this;this.K.a(function(t){r.N(t,n)})}},N:function(n,t){this.r.cV();var i=n.a(t,null,null);i.e(this);this.T();this.t.c(i)}};_qc.x=function(n,t,i,r,u,f,e){this.b=n;this.e=t;this.f=i;this.d=r;this.g=f;this.c=u;this.h=e};_qc.x.prototype={b:null,e:null,f:null,d:null,c:null,g:null,h:null,a:function(n,t,i,r,u,f){return new _qc.w(t,i,this.d,n,this.b,this.e,this.f,r,u,f,this.c,this.g,this.h)}};_qc.p=function(n,t,i,r,u,f){this.k=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);_qc.p.initializeBase(this);this.c=n;this.g=t;this.a=i;this.d=r;this.i=f;this.f=!!u&&u.a().ca().Enabled;this.j=new _j.g(this.n,_a.a.v);this.h=new _j.g(this.k,_a.a.v);this.b=!0};_qc.p.prototype={j:null,h:null,f:!1,i:null,a:null,c:null,g:null,d:!1,e:null,b:!1,o:function(){return this.d?_nbs.a.Ut:_nbs.a.uS},s:function(){return this.d?this.j:this.h},p:function(n){if(this.b!==n){this.b=n;this.eB("ButtonEnabled")}return n},u:function(){this.e||(this.e=this.q());return this.e},t:function(){return this.d&&this.f},eE:function(){this.c=null;this.a=null;_y.jg.prototype.eE.call(this)},x:function(){if(this.c){var n=this.c();if(n){_j.e.a(_a.a.v,"on reply all in inline compose");if(n.b().k.b){this.a.d(null);n.b().k.a()}else _a.E.a(_nbs.a.ht,0)}}},w:function(){var n=this;this.g.a(function(t){var i=t.a(!1,!1);i.x(_y.k.b(_a.a.w,"MailComposeNew",!0));i.bw();i.d(0);i.e(!1);i.cH(!0);i.v(n.o());n.a.d(null);n.a.a(i)})},q:function(){var t=_g.a.a().c();var n=new _g.g;n.EmailAddress=t.bD.UserEmailAddress;n.Name=t.bD.UserDisplayName;var i=_h.i.a(n,!1);return this.i.b(i,2,!1,5,!1,null,!1,8,!1,!1,!1)}};_qc.C=function(n,t,i){this.c=n;this.b=t;this.d=i};_qc.C.prototype={c:null,b:null,d:null,a:function(n,t,i,r){return new _qc.d(this.c,t,this.d,n,this.b,i,r)}};_qc.d=function(n,t,i,r,u,f,e){this.F=Function.createDelegate(this,this.bb);this.C=Function.createDelegate(this,this.P);this.B=Function.createDelegate(this,this.Y);this.E=Function.createDelegate(this,this.ba);this.G=Function.createDelegate(this,this.bc);this.K=Function.createDelegate(this,this.Z);_qc.d.resolveInheritance();this.g=this.dispose;_qc.d.initializeBase(this);this.A=n;this.p=t;this.J=i;this.r=r;this.v=u;this.u=f;this.t=e;this.H=new _j.g(this.K,_qc.d.a);this.p.b(_qc.n,this.G);this.p.b(_qc.f,this.E)};_qc.d.prototype={p:null,A:null,J:null,v:null,r:null,H:null,l:null,u:null,t:null,m:null,q:null,o:!1,z:null,s:!1,n:null,y:null,x:null,a:function(){return this.m},W:function(n){if(this.m===n)return n;if(this.m){this.l.G("unhook To well bulk resolve event and collection changed event");this.m.G&&this.m.G.f(this.B);this.m.cs(this.C);this.l.G("disposing and dereferencing the To recipient well");this.m.dispose()}if(n){this.m=n;this.m.x(!1);var t=this.m.H();t?t.L(!1):this.m.apcl("FindRecipientViewModel",this.F);this.s=!1;this.m.G&&this.m.G.e(this.B);this.m.ci(this.C)}else this.m=null;this.by("ReadWriteRecipientWellViewModel","IsRecipientWellNull");return n},c:function(){return this.q},V:function(n){if(this.q!==n){this.q=n;this.by("ReadOnlyRecipientWellViewModel","IsRecipientWellNull")}return n},b:function(){return this.o},U:function(n){if(this.o!==n){this.o=n;this.bv("IsReadWrite")}return n},h:function(){return this.o?!this.m:!this.q},i:function(){return this.H},e:function(){if(!this.z){var n=new _g.P;n.Mailbox=new _g.g;n.Mailbox.EmailAddress=this.A.bD.UserEmailAddress;n.Mailbox.Name=this.A.bD.UserDisplayName;n.Mailbox.RoutingType="SMTP";this.z=n}return this.z},N:function(){this.y||(this.y=_a.F.a(this.e().Mailbox.EmailAddress));return this.y},M:function(){!this.x&&this.r&&(this.x=_a.F.a(this.r.EmailAddress));return this.x},j:function(){return this.o?this.l.Y?!this.m||!this.s&&(!this.m.H()||_j.h.b(this.m.H().c())):!this.s:!0},Z:function(){this.S()},k:function(n,t){this.u=n;this.t=t},d:function(){this.U(!0);if(!this.m||!this.s){this.l.G("creating the read write to well first before showing the read write recipient well, wereToRecipientsEdited="+this.s);var n=this;this.v.a(function(t){n.l.G("framework read write recipient well factory called back");n.n={};var i=n.L();n.W(t.a(_qc.d.c,4,i,!0,!1,null,null,0,0,!1,!0))})}},f:function(){this.U(!1);if(!this.q){this.l.G("creating the read only to well first before showing the read only recipient well");var n=this;this.v.a(function(t){n.l.G("framework read only recipient well factory called back");n.n={};var i=n.L();n.V(t.b(_qc.d.b,_bc.e.a,i,2,!1,!0))})}},X:function(n){n.k=this.u;n.e=this.t;n.d=this.r},T:function(n,t){n.val=new _a.k;t.val=new _a.k;var i=null;this.o&&this.m?i=this.m.J:!this.o&&this.q&&(i=this.q.b());if(i)for(var e=i.x.length,u=0;u<e;u++){var r=i.x[u];var f=this.w(r);if(f in this.n)this.n[f]?t.val.c(r):n.val.c(r);else{this.l.G("Email address "+f+" is not in the local bookkeeping, add it to To");n.val.c(r)}}},bw:function(){this.u=null;this.t=null;this.p.c(_qc.n,this.G);this.p.c(_qc.f,this.E);this.V(null);this.W(null);_j.Q.prototype.bw.call(this)},S:function(){if(this.m){this.m.bo();this.m.cm()}},bc:function(n){var t;(t=this.l).be(t.O+1);if(this.o){if(!this.m.J.x.length&&(!this.m.H()||_j.h.a(this.m.H().c()))){this.l.G("There are no recipients in the read write To well.");this.p.a(_qc.c,new _qc.c(2));return}this.l.G("start resolving recipients");try{this.S()}catch(i){this.l.G("Something went wrong during force resolve, we throw it but clean up send");this.p.a(_qc.c,new _qc.c(4));throw i;}}else this.P(!0)},ba:function(n){if(!n.c){if(this.o&&this.m||!this.o&&this.q){var i;var t;var u,r;this.T(u={val:i},r={val:t}),i=u.val,t=r.val;n.a.s(i.f);n.a.bb(t.f)}n.c=!0;this.p.a(_qc.f,n)}},bb:function(n,t){this.m.H().L(!1);this.m.rpcl("FindRecipientViewModel",this.F)},Y:function(n,t){var i=t.c;this.l.G("user edited the To recipients, marking the edited flag and process the "+i+" change");this.s=!0;this.l.L&&this.l.L.a()&&this.l.L.a().A(t);var u=t.b;var r=t.a;switch(i){case 0:this.Q(r);break;case 2:this.R(u);break;case 3:this.R(u);this.Q(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and quick compose does not work with it");}},R:function(n){if(n)for(var f=n.length,r=0;r<f;r++){var u=n[r].k.a();var t=this.w(u);this.l.G("recording removed recipient "+t);if(t in this.n)if(t===this.M()){var i=this;this.J.a(_qc.d.a,"ProcessAlwaysKeepRecipients",function(){if(i.m){i.l.G("adding the always keep address "+t+" back in To well");i.m.bv(i.r)}},0)}else{this.l.G("removing removed recipient "+t+" from local copy");delete this.n[t]}}},Q:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].k.a();var i=this.w(u);this.l.G("adding added recipient "+i+" to local copy");this.n[i]=0}},P:function(n){if(n){this.l.G("resolve succeeded");var i;var t;var f,u;this.T(f={val:i},u={val:t}),i=f.val,t=u.val;this.l.H.cr(t);this.l.H.cl(i);if(this.l.R){var r;(r=this.l).be(r.O-1)}}else{this.l.G("resolve canceled, canceling send and switching from system initiated editing recipient to user initiated editing recipient state");this.p.a(_qc.c,new _qc.c(4))}},L:function(){this.l.G("begin calculating initial audience");var n=new _j.l;this.O(n,this.u,0);this.O(n,this.t,1);if(!n.x.length)if(this.l.M()){var i=this.M();this.l.G("adding always keep address "+i+" for group since the initial audience from To and Cc passed in is empty");n.a(this.r);this.n[i]=0}else{var t=this.N();this.l.G("adding self address "+t+" for non group since the initial audience from To and Cc passed in is empty");n.a(this.e().Mailbox);this.n[t]=0}this.l.G("end calculating initial audience");return n},O:function(n,t,i){var e=t?t.b():0;this.l.G("merging "+e+" "+i+" partial audience into audience");for(var o=this.l.M(),s=o?null:this.N(),r=0;r<e;r++){var u=t.a(r);var f=this.w(u);if(o){n.a(u);this.n[f]=i}else if(s!==f){n.a(u);this.n[f]=i}}},w:function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id}};_qc.D=function(n,t,i,r,u){this.b=n;this.d=t;this.c=i;this.f=r;this.e=u};_qc.D.prototype={b:null,d:null,c:null,f:null,e:!1,a:function(n,t,i,r,u,f,e){return new _qc.j(this.c,this.b,this.d,n,this.f,this.e,t,i,r,u,f,e)}};_qc.j=function(n,t,i,r,u,f,e,o,s,h,c,l){this.J=Function.createDelegate(this,this.Y);this.G=Function.createDelegate(this,this.V);this.H=Function.createDelegate(this,this.W);this.t=Function.createDelegate(this,this.ba);this.B=Function.createDelegate(this,this.X);this.A=Function.createDelegate(this,this.S);this.F=Function.createDelegate(this,this.U);this.K=Function.createDelegate(this,this.Z);_qc.j.resolveInheritance();this.d=this.dispose;_qc.j.initializeBase(this);this.k=n;this.u=t;this.o=i;this.m=r;this.p=u;this.x=f;this.w=e;this.q=o;this.l=s;this.r=h;this.z=c;this.s=l;var a=_a.o.a();this.v=!a.k();this.y=new _j.g(this.K,_qc.j.a);this.C=new _j.g(this.F,_qc.j.a);this.m.b(_qc.c,this.A)};_qc.j.prototype={w:!1,C:null,u:null,o:null,m:null,p:null,x:!1,v:!1,z:"none",k:null,n:null,j:null,i:null,y:null,l:null,r:null,q:null,s:null,b:function(){return this.y},e:function(){return this.C},f:function(){return this.v},a:function(){return this.p},c:function(){this.i.G("update original item for resend");var t="OQC:"+this.l.bD.ConversationId.Id;var n=this.k.c[t];n.f(this.k,this.i,this.i.H.bD.InternetMessageId);this.h();this.i.G("update subsequent outstanding context to be pending send");n.c(this.k,this.i.H.bD.InternetMessageId,!0,"")},g:function(n){var r="OQC:"+this.l.bD.ConversationId.Id;var i=this.k.c[r];var t=i.g(this.k,n,this.i);i.d.d.length||this.k.d.a(_a.bJ,new _a.bJ(r));_h.c.m(this.l.bD.ConversationId,n);if(t&&this.p){var u=this;this.p.a(function(){u.o.a(IQuickComposeSendFailedEvent,new _qc.t(t))})}},h:function(){this.i.G("creating the action");var n=this.q(this.i,this.k);if(!this.i.M()){this.i.G("Setting CreateMessageItemAction fields for mail scenarios");this.O(n);if(this.i.K){this.i.G("set CreateResponseAction fields for the mail reply scenario");this.P(n)}}this.i.K&&n.e(this.B);this.i.G("submitting the resend action");this.u.a(n);this.M();this.i.bd=!1},Z:function(){var n=this.R("QuickReplySendMeSpace","QuickReplySendWeSpace","QuickComposeSendWeSpace");n==="QuickReplySendMeSpace"&&(this.j=_a.c.b(_a.a.v,n));this.i.K&&(this.n=_a.c.b(_a.a.v,"Quick"+n));if(this.T()){this.i.be(_qc.e.a);this.bb();this.m.a(_qc.n,new _qc.n);if(this.i.O===_qc.e.a){this.i.G("Send semaphore is AllowSendCount before property changed attached, OK to send");this.N()}else this.i.R&&this.i.bA(this.t)}else if(this.n&&this.i.K){this.n.k="InvalidToSend";_a.c.a(this.n);this.n=null}},Q:function(n){n.f=this.l;n.c=this.q;n.j=this.s},bw:function(){this.q=null;this.s=null;this.l=null;this.r=null;this.i.bs(this.t);this.m.c(_qc.c,this.A);_j.Q.prototype.bw.call(this)},N:function(){if(this.s){this.i.G("start ctq tracing for send");this.s(this.i)}else this.i.G("ctq tracing is missing");if(this.i.K){this.i.G("perform immediate update by creating initial state clone to reset the compose UI back to initial state");this.i.bq();this.i.bh();if(!this.x||this.w){this.i.G("need to handle quick quickness reply");var i=this.i.H.bD.InternetMessageId;this.i.G("re-key current context to InternetMessageId: "+i);var u="QC:"+i;this.i.S=u;this.o.a(_a.bV,new _a.bV(u,this.i));var r="OQC:"+this.l.bD.ConversationId.Id;var t=this.k.c[r];if(t){this.i.G("update outstanding quick compose context with key "+r+" to track this context");t.d.c(i);t.f(this.k,this.i,i)}else{this.i.G("create outstanding quick compose context with key "+r+" to track this context");t=new _qc.v(i);this.o.a(_a.bV,new _a.bV(r,t))}this.i.G("create message for show and update the reading pane with it");var f=this.i.bC(this.l.bD,this.z);_h.c.G(this.l.bD.ConversationId);_h.c.B(f,this.L(this.i.h()),this.i.Q);this.M();if(this.i.K){_a.c.a(this.n);this.n=null}}}_cmc.c.e(this.i.H.O().bD.Value,this.i.H.bD.Subject,this.i.T);_cmc.a.e(this.i.H.O().bD.Value,this.i.H.bD.Subject,this.i.Z);this.i.H.gg(_cmc.c.d(this.i.H.O().bD.Value,this.i.H.bD.Subject,this.i.T));_cmc.h.b(this.i.H,this.i.T,this.i.bF(),this.i.Z,this.i.bE());var n=this.q(this.i,this.k);if(!this.i.M()){this.i.G("Setting CreateMessageItemAction fields for mail scenarios");this.O(n);if(this.i.K){this.i.G("set CreateResponseAction fields for the mail reply scenario");this.P(n);n.bM=this.j}}if(this.i.K){n.c(this.J);n.e(this.B)}else{this.i.G("New compose send since conversation=null, setup success/failure callback on action since immediate update is not supported");n.c(this.H);n.e(this.G)}if(this.i.h()&&_bc.f.a(this.i.h().bD.ItemId)){this.i.G("do not submit send action yet since reference item still has client id");this.i.bd=!0}else{this.i.G("submitting the send action");this.u.a(n)}},E:function(){this.i.G("leaving sending state, re-enabling send and attach commands");this.i.R=!1;this.i.bn(!0)},T:function(){if(this.i.R){this.i.G("CanSend=false since we are already sending.");this.m.a(_qc.c,new _qc.c(0));if(this.j){this.j.k="alreadySending";_a.c.a(this.j);this.j=null}return!1}if(this.i.bf()){this.i.G("CanSend=false since the content and the attachments are empty, recipient well was not edited.");this.m.a(_qc.c,new _qc.c(1));if(this.j){this.j.k="Empty";_a.c.a(this.j);this.j=null}return!1}if(this.l){var n=_y.Q.c(this.i.h(),!1,!0,null);this.i.G("calling MailResponseCommandViewModel.IsReplyAllAllowedOnItem, result="+n);if(!n){this.m.a(_qc.c,new _qc.c(3));if(this.j){this.j.k="ReplyNotAllowedOnItem";_a.c.a(this.j);this.j=null}return!1}}return!0},bc:function(n){n===1?_a.E.a(_nbs.a.Wm,0):n===2?_a.E.a(_nbs.a.pk,0):n===3?_a.E.a(_nbs.a.tA,0):n===5&&_a.E.a(_nbs.a.jC,0)},S:function(n){this.bc(n.a);this.E();this.i.bs(this.t)},ba:function(n,t){this.i.G("Send semaphore is "+this.i.O);if(this.i.O===_qc.e.a){this.i.G("Send semaphore is AllowSendCount after property changed attached, OK to send");this.N()}},U:function(){if(this.v){this.i.G("user triggered alt+s send, calling OnSend");this.y.a()}else this.i.G("user triggered alt+s send but it is not supported, ignoring the request")},bb:function(){this.i.G("entering sending state, disabling send and attach commands");this.i.R=!0;this.i.bn(!1)},M:function(){var t=this.i.h();if(_g.i.isInstanceOfType(t)){this.i.G("marking last verb on original item");var n=t;n.cZ(103);n.dd(_a.d.a())}},O:function(n){n.w=1;n.bE=!0;n.bo=this.l.bD.ConversationId;if(!this.x||this.w){n.bY=this.k;n.bj=_g.b.a.nameToId(this.z);n.bn=_g.m.c(n.bj);n.bD="QuickComposeItemPart";n.bq=_ff.e.a(_h.b.d());n.bq.ConversationShapeName="ConversationUberListView";n.bq.ConversationFolderId=_g.r.isInstanceOfType(this.r)?new _g.E(this.r):_g.m.c(this.r)}},P:function(n){this.i.H.bD.Subject||this.i.H.cY(this.i.h().bD.Subject);n.bA=this.i.h().eT();n.bL(this.i.H);n.bo=this.l.bD.ConversationId;n.bx=this.L(this.i.h())},L:function(n){return _g.i.isInstanceOfType(n)?n.bD.InternetMessageId:_g.bj.isInstanceOfType(n)?n.bD.InternetMessageId:null},W:function(n){this.i.G("send server call succeeded, creating initial state clone to reset the compose UI back to initial state");this.i.bu();this.i.bq();this.i.bh();this.E();this.i.G("Firing QuickComposeSendEvent");this.o.a(_a.ei,new _a.ei);this.i.G("start disposing of associated context instance");this.i.dispose()},V:function(n){if(n.H){var t=n.H.message;this.i.G("send server call failed, recording context.LastErrorMessage: "+t);this.i.bk=t}var i=String.format(_nbs.a.kb,this.i.bk);_a.E.a(i,0);this.E()},X:function(n){if(this.p){var t=this;this.p.a(function(){t.o.a(IQuickComposeSendFailedEvent,new _qc.t(t.i))})}},Y:function(n){this.i.bu()},R:function(n,t,i){var r;r=this.i.M()&&this.i.K?t:!this.i.M()&&this.i.K?n:i;return r}};_qc.A=function(n,t,i,r,u,f,e,o,s){this.b=n;this.c=t;this.g=i;this.f=r;this.h=u;this.j=f;this.i=e;this.d=o;this.e=s};_qc.A.prototype={b:null,c:null,g:null,f:null,h:null,j:null,i:null,d:null,e:null,a:function(n,t){return new _qc.m(this.b,t,this.h,this.c,this.g,this.j,n,this.f,this.i,this.d,this.e)}};_qc.m=function(n,t,i,r,u,f,e,o,s,h,c){this.F=Function.createDelegate(this,this.Q);this.G=Function.createDelegate(this,this.R);this.C=Function.createDelegate(this,this.z);this.E=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.N);this.t=Function.createDelegate(this,this.O);this.u=Function.createDelegate(this,this.W);this.B=Function.createDelegate(this,this.M);_qc.m.resolveInheritance();this.c=this.dispose;_qc.m.initializeBase(this);this.v=n;this.j=t;this.r=i;this.w=r;this.p=u;this.k=f;this.m=e;this.l=o;this.A=s;this.n=h;this.o=c;this.x=new _j.g(this.B,_qc.m.a);this.j.b(_qc.n,this.u);this.j.b(_qc.f,this.t)};_qc.m.prototype={r:null,x:null,k:null,v:null,j:null,w:null,p:null,A:null,n:null,q:null,g:null,h:null,l:null,i:null,m:null,o:null,b:function(){return this.x},a:function(){return this.h},S:function(n){if(this.h!==n){this.h=n;this.bv("AttachmentWellViewModel")}return n},d:function(){return!this.g.M()||!this.r.a(this.m.a.Mailbox.EmailAddress,"DraftsForGroupAttachments")},T:function(n){this.H();this.g.H.cb(n);this.g.H.gk(!0);if(this.i&&this.i.b()>0){var t=this;this.y(function(){t.h.f(t.g.H.bD.ItemId,t.i,null)})}this.h&&this.h.f(this.g.H.bD.ItemId,this.i,null)},e:function(){if(this.g.Y)return!this.h||!this.h.m();else{var n=this.g.H;return!n.ez()||!n.ez().b()}},f:function(){if(this.g.M()&&this.h&&this.h.a())for(var n=0;n<this.h.a().x.length;n++)if(this.h.a().x[n].ek){this.o.a(_a.u,new _a.u([String.format(_nbs.a.CU,this.h.Y())],1,null,0,!1,null,null,String.format(_nbs.a.qG,this.h.Y())));return}},P:function(){this.g.G("start populating message with attachments in well");var u=this.h;if(!u){this.g.G("attachment well was not created, end populating message with attachments");return}var t=u.a();if(!t){this.g.G("no attachments found in well, end populating message with attachments");return}var n=t.x.length;if(!n){this.g.G("no attachments found in well, end populating message with attachments");return}var i=new Array(n);var f=0;var e=this;t.o(function(n){var u=n;var e=u.bj;var t=e;t.l(u.bO);var r=t.v();r.AttachmentId=t.bD.AttachmentId;i[f++]=r});var r=this.g.H.be();if(r){this.g.G("updating message attachments with "+n+" attachments");r.z(i)}else{this.g.G("creating message attachments and populating with "+n+" attachments");this.g.H.bm(new(_a.fE.$$(_g.Attachment,_g.bn))(i))}},bw:function(){this.j.c(_qc.n,this.u);this.j.c(_qc.f,this.t);var n=this.h;if(n){this.g.G("unhook events and dereferencing the attachment well view model");n.C(this.s);n=null}_j.Q.prototype.bw.call(this)},M:function(){var i=this.k.e()&&this.k.c()&&this.k.d().c().b>=4.4&&this.k.g()&&this.k.d().b()<33;if(i){var r=this.y(this.E);r&&this.J()}else{var n=this.y(this.C);if(n)if(this.k.a()){var t=this;_j.m.a().a(_qc.m.a,"On attach in quick compose",function(){t.z()},100)}else this.z()}},W:function(n){var i;(i=this.g).be(i.O+1);this.g.M()||this.P();if(this.h&&this.h.j())this.j.a(_qc.c,new _qc.c(5));else{var t;(t=this.g).be(t.O-1)}},O:function(n){if(!n.b){this.h&&n.a.U(this.h.a());n.b=!0;this.j.a(_qc.f,n)}},y:function(n){var i=this.h;if(!i){this.g.G("start creating the attachment well");var t=this;this.w.a(function(r){t.g.G("creating the attachment well");var u=r.b(null);u.i(1);u.k(t.g.H.bD.ItemId);var f=t.g.M()?t.g.bb.a.Mailbox.EmailAddress:null;i=r.c(u,t.i,!1,0,!0,null,!0,new _db.i,null,null,null,null,f,!!t.g.J.a());i.cl(t.d());i.q(t.s);i.cm(!0);t.S(i);if(n){t.g.G("calling the on attachment well created callback");n()}});return null}this.g.G("returning the existing attachment well");return i},z:function(){if(this.L()){var t=_a.c.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_j.e.a(_a.a.c,"Opening OWA's file picker from group quick compose");this.U(t)}else{var n=this.h;n.h(!1,null,null)}},J:function(){this.h.B(!1)},U:function(n){if(this.p){var t=this;this.p.a(function(i){t.q=i;if(t.q){var r=t.A;t.q.a(t.h,n,!1,r.u||(r.u=Function.createDelegate(r,r.d)),null,!1,0)}})}},N:function(){if(this.g.M()&&this.r.a(this.m.a.Mailbox.EmailAddress,"DraftsForGroupAttachments"))if(this.g.H.bD.ItemId){this.H();this.h&&this.h.f(this.g.H.bD.ItemId,this.i,null)}else{var n=this.K();this.V(n,this.G,this.F,null)}else this.h.f(null,new _j.l,null)},K:function(){var i=null;if(this.g.K){var r=new _g.bs;r.IsSpecificMessageReply=this.g.Q?!0:!1;var n=new _mco.f(r,this.g.h().bD.ItemId,this.l,this.o);n.T=this.m.a.Mailbox.EmailAddress;n.bL(this.g.H);n.bA=this.g.h().eT();n.bo=this.g.h().bD.ConversationId;n.bx=this.g.h().bD.InternetMessageId;n.bE=!0;i=n}else{var t=new _mco.a(this.g.H,null,this.l,this.o);t.T=this.m.a.Mailbox.EmailAddress;t.bE=!0;i=t}return i},V:function(n,t,i,r){t&&n.c(t);n.e(i);r&&n.a(r);this.v.a(n)},H:function(){this.i||(this.i=new _j.l)},R:function(n){this.T(n.G)},Q:function(n){this.h&&this.h.E()},L:function(){return!!this.l&&!!this.n&&this.l.j(this.n.AttachmentDataProviderAvailable||this.n.GroupsOneDriveDataProviderAvailable)&&this.g.M()}};_qc.i=function(){this.k=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.n);this.l=Function.createDelegate(this,this.p);_qc.i.resolveInheritance();this.b=this.dispose;_qc.i.initializeBase(this);this.i=new _j.g(this.l,_qc.i.a)};_qc.i.prototype={i:null,f:null,g:null,h:!1,a:function(){return this.i},c:function(){return this.g},q:function(n){if(n!==this.g){this.g=n;this.bv("DiscardConfirmDialogButtonData")}return n},d:function(){return this.h},e:function(n){if(n!==this.h){this.h=n;this.bv("IsDiscardConfirmDialogShown")}return n},bw:function(){_j.Q.prototype.bw.call(this)},p:function(){var t=this.m("QuickReplyMeSpaceShowDiscardDialog","QuickReplyWeSpaceShowDiscardDialog","QuickComposeWeSpaceShowDiscardDialog");var n=_a.c.b(_a.a.v,t);this.f.G("user chose to discard");if(!this.i.b){this.f.G("skip this discard since the discard command has been disabled.");n.k="CommandDisabled";_a.c.a(n);return}if(this.f.bf()){this.f.G("calling discard directly without showing the dialog since this instance is empty.");n.j="Empty editor";_a.c.a(n);this.n()}else{this.r();this.f.G("show the discard dialog");this.e(!0);_a.c.a(n)}},n:function(){var t=this.m("QuickReplyMeSpaceDiscard","QuickReplyWeSpaceDiscard","QuickComposeWeSpaceDiscard");var n=_a.c.b(_a.a.v,t);this.f.G("perform the discard by resetting the editor, creating an initial state clone and disposing the current instance");this.o();this.f.L.f();this.f.bq();this.f.bh();this.f.dispose();_a.c.a(n);this.cd("IsDiscardingCompose")},o:function(){if(this.h){this.f.G("hide the dialog");this.e(!1)}},r:function(){if(!this.g){this.f.G("setup discard confirm dialog");var n=new _j.l;n.a(new _ff.d(new _j.g(this.j,_qc.i.a),_nbs.a.Kl,_nbs.a.bT,!0,!1));n.a(new _ff.d(new _j.g(this.k,_qc.i.a),_nbs.a.qB,_nbs.a.kW,!1,!1));this.q(n)}},m:function(n,t,i){var r;r=this.f.M()&&this.f.K?t:!this.f.M()&&this.f.K?n:i;return r}};_qc.s=function(n,t,i){this.b=n;this.a=t;this.c=i};_qc.s.prototype={b:null,a:null,c:null,d:function(n,t){return new _qc.o(n,t,this.b,this.c,this.a)}};_qc.o=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.p);this.g=n;this.k=t;this.j=i;this.n=r;this.i=u;this.f=new _j.g(this.l,_qc.o.a);this.g.b(_qc.f,this.h)};_qc.o.prototype={g:null,k:!1,f:null,n:null,j:null,d:null,e:null,i:null,b:function(){return this.k},c:function(){return this.f},a:function(){this.g.c(_qc.f,this.h)},p:function(){this.d.G("starting to upconvert, disabling the command first");this.f.c(!1);var t=_a.c.b(_a.a.v,"QuickReplyUpConvertMeSpace");if(this.e){this.d.G("using existing mail compose context and calling upconvert");this.m()}else{this.d.G("starting to create the mail compose context");var n=this;this.j.a(function(t){n.d.G("creating the mail compose context and calling upconvert");n.e=t.a(!1,!1);n.m()})}_a.c.a(t);t=null},m:function(){var n=this.e;if(this.d.K){this.d.G("preparing mail compose context for reply all upconvert");n.d(2);n.T(this.d.h())}else{this.d.G("preparing mail compose context for new compose upconvert");n.d(0)}this.d.G("stamping body and attachments, updating message body with edtior content first");this.d.s();var f=this.d.H;var i=f.O();n.h(i.a());if(this.i.b())n.r(i.bD.Value);else{var t;var u,r;r=_a.z.a(i.bD.Value,u={val:t}),t=u.val,r;n.r(t)}n.e(!1);this.g.a(_qc.f,new _qc.f(n))},o:function(n){if(n.b&&n.c&&!this.f.b){this.e=n.a;var t;if(this.d.K){this.d.G("using the factory on original item part to create a conductor for reply all upconvert");t=this.d.U().cf()}else{this.d.G("creating a new conductor for new compose upconvert");t=new _y.bo}this.d.G("navigate to full compose");t.a(this.e);this.d.G("reset with an initial state clone after upconvert");this.d.bh();this.d.G("dispose the current instance after upconvert");this.d.dispose();this.f.c(!0)}}};_qc.B=function(){};_qc.B.prototype={a:function(){return new _j.j}};_qc.z=function(n,t,i,r,u,f,e,o,s,h,c){_qc.z.initializeBase(this,[n,t,r,u,f,e,s,h,c]);this.A=o;this.z=i};_qc.z.prototype={A:null,z:null,C:function(){return!1},S:function(n,t,i,r,u,f,e,o){var s=this.A.d(u,this.C());return this.z.a(n,t,i,r,s,this.B,f,e,o)}};_qc.r=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_qc.r.initializeBase(this,[n,t,i,r,u,e,o,s,h,c,l,a]);_qc.o.isInstanceOfType(f)&&(f.d=this);this.bx(f)};_qc.r.prototype={X:null,bx:function(n){if(this.X!==n){this.X=n;this.bv("UpconvertComponent")}return n},M:function(){return!1},bw:function(){this.X.a();this.X=null;_qc.e.prototype.bw.call(this)}};_qc.y=function(n,t,i){_qc.y.initializeBase(this,[n,t,i])};_qc.y.prototype={a:function(n,t,i,r,u,f,e,o,s){return new _qc.r(n,t,i,r,new _qc.i,u,f,this.b,this.c,this.d,e,o,s)}};_qc.l=function(){};_qc.l.d=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_qc.l.f=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_qc.l.g=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_qc.l.e=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_qc.l.a=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_qc.l.b=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_qc.l.c=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_qc.b=function(n,t,i,r,u,f){this.bf=Function.createDelegate(this,this.ch);this.bh=Function.createDelegate(this,this.ci);this.q=Function.createDelegate(this,this.cg);this.be=Function.createDelegate(this,this.cc);this.bk=Function.createDelegate(this,this.co);_qc.b.initializeBase(this,[n]);this.o=t;this.d=i;this.j=u;this.br=f;this.c=r.a();this.y("QuickComposeView");this.x=new _j.g(this.bk,_qc.b.a);this.u=new _j.g(this.be,_qc.b.a);this.b=new _j.q;if(this.j){this.bA=this.j.a().r().Enabled;this.bD=this.j.a().p().Enabled}};_qc.b.b=function(n,t){t?_j.k.a(n,_b.n.a(),""):_j.k.a(n,_b.n.a(),_b.n.c(0,-1e4))};_qc.b.prototype={o:null,d:null,j:null,br:null,c:0,u:null,l:!1,s:!1,k:0,a:null,n:null,i:null,h:null,m:null,E:null,bd:0,x:null,p:!1,e:!1,g:null,t:null,f:null,r:!1,b:null,bA:!1,bD:!1,bL:function(n){if(this.l!==n){this.l=n;this.bv("IsShowingContent");if(this.l!==n)return n;if(this.d.a()&&!n&&this.a){_j.e.a(_qc.b.a,"iOS fix for soft keyboard not hidden when quick compose session is done.");this.a.z.blur()}if(!n){if(this.g){_j.e.a(_qc.b.a,"moving quick compose back to under the original parent at the end of this compose session");_j.k.y(this.g,this.z);this.bM()}this.m&&this.m.R()}}n&&this.bs();return n},ck:function(n){if(this.s!==n){this.s=n;this.bv("IsShowingContentCompleted")}n&&this.bs();return n},cl:function(n){n!==this.bd&&(this.bd=n);return n},v:function(n){if(this.e!==n){this.e=n;this.by("IsImmersive","IsTouchNarrowOrIsImmersiveInTouchLayout")}return n},cb:function(){var n=this.c;return n==="TouchNarrow"||this.e&&n!=="Mouse"},bX:function(){return _qc.l.d()},bY:function(){return _qc.l.g()},bW:function(){return _qc.l.f()},bU:function(){return _qc.l.e()},bR:function(){return _qc.l.a()},bS:function(){return _qc.l.c()},bQ:function(){return _qc.l.b()},bZ:function(){return this.a&&!this.a.bq()&&this.a.z.offsetHeight>0?!0:!1},bp:function(n){if(this.b){_qc.b.b(n,!1);this.b.c(n);var t=this;this.o.a(_qc.b.a,"Restore this element on timer",function(){t.bO(n)},0)}},bO:function(n){if(this.b){_qc.b.b(n,!0);this.b.n(n)}},bN:function(){if(this.b)for(var n=this.b.d.length-1;n>=0;n--){_qc.b.b(this.b.d[n],!0);this.b.j(n)}},H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("Editor");this.n=this.B.a("SendButtonId");this.i=this.B.a("DiscardButtonId");this.h=this.B.a("AttachButtonId");this.m=this.B.a("PlaceholderButtonId");this.E=this.B.a("ToReadWriteRecipientWellViewId")}else{this.a=null;this.n=null;this.i=null;this.h=null;this.m=null;this.E=null}},G:function(){_j.c.prototype.G.call(this);if(!this.p){if(this.d.a()){_j.k.b(this.n.z,"touchend",this.q);_j.k.b(this.i.z,"touchend",this.q);_j.k.b(this.h.z,"touchend",this.q)}else this.d.b()&&this.c==="Mouse"&&_j.k.b(this.a.z,"click",this.bh);this.p=!0}},bw:function(){if(this.p){if(this.d.a()){_j.k.c(this.n.z,"touchend");_j.k.c(this.i.z,"touchend");_j.k.c(this.h.z,"touchend")}else this.d.b()&&this.c==="Mouse"&&_j.k.c(this.a.z,"click");this.p=!1}this.a=null;this.b=null;_j.c.prototype.bw.call(this)},w:function(n){this.t.style.height=String.format("{0}px",n)},co:function(){this.bL(!0)},cg:function(n){_j.e.a(_qc.b.a,"user touched button, blur the editor to make the soft keyboard go away in iOS");this.a.z.blur()},ch:function(n){var t=this;this.o.a(_qc.b.a,"Store scroll buffer's original height",function(){t.w(10)},500);_j.k.c(this.a.z,"blur")},ci:function(n){_j.e.a(_qc.b.a,"Editor clicked.");this.a.R()},cc:function(){_j.e.a(_qc.b.a,"Preventing BACKSPACE/DELETE keys from deleting the conversation, HOME/END/UP/DOWN keys from navigating away in list view while in the quick compose view")},bs:function(){_j.e.a(_qc.b.a,"setting focus to the editor and scroll compose into view");if(this.c==="Mouse")this.z.scrollIntoView(!1);else if(!this.e&&this.bZ()&&!this.r&&_j.k.g(this.t)>0){this.bp(this.g);var i=this.f.c();this.a.R();this.f.b(i);_j.k.b(this.a.z,"blur",this.bf);var t=this;this.o.a(_qc.b.a,"Scroll quick compose editor to the top",function(){t.bN();t.cj()},500);this.r=!0}if((this.e||this.c==="Mouse")&&this.a){this.a.R();if(this.d.f()){var n=this.a.z;n.innerHTML=n.innerHTML+"&#8203;";n.innerHTML=""}}},bM:function(){this.w(10);this.r=!1;this.k=0},cj:function(){var n;n=this.k?this.k+this.z.offsetTop:this.g.offsetTop;this.c==="TouchNarrow"&&(n-=20);n>this.f.c()&&this.w(n-this.f.c());this.f.b(n)}};_qc.g=function(n,t){this.g=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);_qc.g.initializeBase(this,[n]);this.y("InlineComposeView");this.j=new _j.g(this.l,_qc.g.a);this.n=t};_qc.g.prototype={n:null,f:null,a:null,e:!1,d:null,j:null,i:!1,s:function(n){if(n!==this.f){this.f=n;this.f&&this.f.d(this);this.bv("ScrollManager")}return n},p:function(n){if(this.e!==n){this.e=n;this.bv("IsConductorShowingCompose");if(!n&&this.d){_j.e.a(_qc.g.a,"moving inline compose back to under the original parent at the end of this compose session");this.d.appendChild(this.z)}}return n},c:!1,b:!1,H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("Conductor");this.a.gd(this.h);this.a.apcl("CurrentConductableView",this.g);this.d=this.X.z}else{this.m();this.d=null}},bw:function(){this.m();_j.c.prototype.bw.call(this)},t:function(n){var t=this.V();if(t){this.p(!1);t.l();this.o(null,null)}},q:function(n,t,i){return new _ff.h(1e4,1e4,4)},o:function(n,t){if(!this.e&&this.i&&this.a.a){var i=this.a.a.a().z;i.style.display="none"}},m:function(){if(this.a){this.a.kD(this.h);this.a.rpcl("CurrentConductableView",this.g);this.a=null}},r:function(){_j.e.a(_qc.g.a,"Preventing HOME/END/UP/DOWN keys from navigating away in list view while in the inline compose view")}};_qc.k=function(n){_qc.k.initializeBase(this,[n]);this.y("QuickReplyViewWrapper")};_qc.k.prototype={a:null,b:null,c:null,H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("QuickReplyViewId");this.b=this.B.a("QuickReplyScrollBufferRegionId");this.a.g=this.z;this.a.t=this.b.z;this.a.f=this.c}else{this.a=null;this.b=null}}};_qc.a=function(){};_qc.a.$$cctor=function(){_qc.a._I()};_qc.a.bj=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_qc_2 ms-bg-color-white ms-border-color-neutralLight'></span> </div><div> <div class='_qc_d'></div> <div autoid=\"_qc_2\" class='_qc_e'></div> </div><div>  <div class='_qc_b ms-font-weight-semibold ms-font-color-neutralSecondary ms-bg-color-white ms-border-color-neutralLight'></div>  <div class='_qc_c ms-border-color-neutralLight'></div> </div><div> <span class='_qc_r'></span> <span class='_qc_s'></span> </div><div> <div class='_qc_t customScrollBar'> <div class='_qc_u ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> </div><div>  <div class='_qc_8'></div>  <div tabindex='-1' class='_qc_9 ms-border-color-neutralLight'>   <button autoid=\"_qc_0\" type='button' class='_qc_g ms-font-weight-semilight ms-font-color-themePrimary'></button>  <div> <div>  <div class='_qc_b ms-font-weight-semibold ms-font-color-neutralSecondary ms-bg-color-white ms-border-color-neutralLight'> <div class='_qc_d'></div> <div autoid=\"_qc_1\" class='_qc_e'></div> </div>  <div class='_qc_c ms-border-color-neutralLight'></div> </div> <div></div>  <div autoid=\"_qc_3\" class='_qc_q ms-bg-color-white ms-bg-color-white-hover'></div>  <div autoid=\"_qc_4\"></div>  <div autoid=\"_qc_5\" class='_qc_h ms-bg-color-white'></div>   <div autoid=\"_qc_6\" class='_qc_j ms-border-color-neutralLight'> <button autoid=\"_qc_7\" type='button' class='_qc_k _qc_n'></button> <button autoid=\"_qc_8\" type='button' class='_qc_k _qc_o'></button>  <button autoid=\"_qc_9\" type='button' class='_qc_p'></button> <button autoid=\"_qc_a\" type='button' class='_qc_p'></button> </div> </div>  </div>   <div></div> </div><div> <div class='_qc_x'></div> </div><div> <div></div> </div><div> <hr class='_qc_B'/>  <div></div>  <div tabindex='-1' class='_qc_y ms-border-color-neutralLight'>  <div class='_qc_A ms-border-color-neutralLight'></div> </div>  <div></div> </div><div> <div class='_qc_E ms-bg-color-white'></div> </div><div> <div class='_qc_C ms-bg-color-white'></div>   </div><div> <div class='_qc_F ms-bg-color-white'></div> </div><div> <button autoid=\"_qc_b\" type='button' class='_qc_H ms-font-weight-semilight ms-font-color-themePrimary'></button> <div class='_qc_L'> <span class='_qc_I'></span> <div class='_qc_J'> <button type='button' class='_qc_K ms-font-weight-regular ms-font-color-neutralSecondary ms-bg-color-neutralLighter ms-font-color-neutralPrimary-hover ms-bg-color-neutralLight-hover'></button> </div> </div> </div><div> <span class='_qc_N ms-bg-color-white ms-border-color-neutralLight'></span> </div><div> <div class='_qc_U ms-bg-color-white'></div>  <div></div> </div><div> <div class='_qc_T'></div> </div><div> <div class='_qc_V'> <div></div> </div> </div><div> <div class='_qc_W'></div> <div class='_qc_X'></div> </div>";_j.i.a().appendChild(n);return n};_qc.a.bh=function(n){return n.n()};_qc.a.O=function(n){return n.sh()};_qc.a.bX=function(n){return n.f()};_qc.a.bY=function(n){return n.h()};_qc.a.b=function(n){return n.a()};_qc.a.h=function(n){return n.c()};_qc.a.bQ=function(n){return n.c()};_qc.a.w=function(n){return n.h()};_qc.a.i=function(n){return n.m()};_qc.a.m=function(n){return n.a()};_qc.a.l=function(n){return n.m()};_qc.a.bJ=function(n){return n.e};_qc.a.u=function(n){return n.E()};_qc.a.be=function(n){return n.a()};_qc.a.v=function(n){return n.b()};_qc.a.bT=function(n){return n.e()};_qc.a.bU=function(n){return n.f()};_qc.a.bg=function(n){return n.b()};_qc.a.c=function(n){return n.X};_qc.a.n=function(n){return n.u};_qc.a.bS=function(n){return n.i()};_qc.a.bu=function(n){return n.x()};_qc.a.q=function(n){return n.l};_qc.a.ba=function(n){return _qc.b.isInstanceOfType(n)?n.x:null};_qc.a.bo=function(n){return n.X};_qc.a.bf=function(n){return n.b()};_qc.a.bR=function(n){return n.a()};_qc.a.bt=function(n){return n.u()};_qc.a.br=function(n){return n.i};_qc.a.bK=function(n){return n.cb()};_qc.a.U=function(n){return _qc.r.isInstanceOfType(n)?n.X:null};_qc.a.bV=function(n){return n.b()};_qc.a.bW=function(n){return n.c()};_qc.a.Y=function(n){return n.bR()};_qc.a.bD=function(n){return n.bQ()};_qc.a.bE=function(n){return n.bS()};_qc.a.bM=function(n){return n.b()};_qc.a.bH=function(n){return n.bX()};_qc.a.bF=function(n){return n.bU()};_qc.a.bG=function(n){return n.bW()};_qc.a.bI=function(n){return n.bY()};_qc.a.bN=function(n){return n.c()};_qc.a.bO=function(n){return n.d()};_qc.a.bk=function(n){return n.b()};_qc.a.B=function(n){return n.y};_qc.a.X=function(n){return n.c};_qc.a.bA=function(n){return n.b};_qc.a.k=function(n){return n.j};_qc.a.bw=function(n){return n.t};_qc.a.bc=function(n){return n.b()};_qc.a.bB=function(n){return n.k};_qc.a.H=function(n){return n.c()};_qc.a.D=function(n){return n.e};_qc.a.bd=function(n){return n.k()};_qc.a.bL=function(n){return n.e()};_qc.a.T=function(n){return n.t()};_qc.a.S=function(n){return n.o()};_qc.a.R=function(n){return n.s()};_qc.a.C=function(n){return n.b};_qc.a.bz=function(n){return n.u()};_qc.a.bx=function(n){return n.Y()};_qc.a.by=function(n){return n.Z()};_qc.a.z=function(n){return n.g()};_qc.a.V=function(n){return _qc.e.isInstanceOfType(n)?n.bj:null};_qc.a.Z=function(n){return n.s};_qc.a.y=function(n,t){n.a(t)};_qc.a.p=function(n,t){n.ba(t)};_qc.a.P=function(n,t){n.Q(t)};_qc.a.f=function(n,t){n.K(t)};_qc.a.bn=function(n,t){n.a(t)};_qc.a.e=function(n,t){n.l=t};_qc.a.bm=function(n,t){n.n=t};_qc.a.o=function(n,t){n.j(t)};_qc.a.j=function(n,t){n.T(t)};_qc.a.bv=function(n,t){n.y(t)};_qc.a.bs=function(n,t){n.k(t)};_qc.a.Q=function(n,t){n.bl(t)};_qc.a.L=function(n,t){n.l(t)};_qc.a.J=function(n,t){n.x(t)};_qc.a.K=function(n,t){n.m(t)};_qc.a.N=function(n,t){n.s(t)};_qc.a.bq=function(n,t){n.m(t)};_qc.a.bp=function(n,t){n.d(t)};_qc.a.bP=function(n,t){n.e(t)};_qc.a.bl=function(n,t){n.a(t)};_qc.a.ca=function(n,t){n.b(t)};_qc.a.bZ=function(n,t){n.c(t)};_qc.a.cb=function(n,t){n.g=t};_qc.a.I=function(n,t){n.n(t)};_qc.a.E=function(n,t){n.p(t)};_qc.a.bC=function(n,t){n.s(t)};_qc.a.M=function(n,t){n.o(t)};_qc.a.G=function(n,t){n.cl(t)};_qc.a.A=function(n,t){n.e(t)};_qc.a.F=function(n,t){n.bL(t)};_qc.a.W=function(n,t){n.bt(t)};_qc.a.bb=function(n,t){n.ck(t)};_qc.a.g=function(){_qc.a.r||(_qc.a.r=new _fc.k);return _qc.a.r};_qc.a.bi=function(){_qc.a.t||(_qc.a.t=new _b.W);return _qc.a.t};_qc.a.x=function(){_qc.a.s||(_qc.a.s=new _fce.t);return _qc.a.s};_qc.a._I=function(){var c="NotchView";new _j.d(c,function(){_qc.a.a[c]===undefined&&(_qc.a.a[c]=[[[-1,5,["IsReply"],[_qc.a.bh],null,"_qc_3",null,null,0,null,null,null],[-1,5,["IsHtml5BaselineSupported"],[_qc.a.O],null,"_qc_4:_qc_6",null,null,1,null,null,null],[-1,5,["IsHtml5Reply"],[_qc.a.bX],null,"_qc_5",null,null,0,null,null,null],[-1,5,["IsNonHtml5Reply"],[_qc.a.bY],null,"_qc_7",null,null,0,null,null,null]]]);var n=_qc.a.d.childNodes[0].cloneNode(!0);var t=new _j.i(n.children[0]);return new _j.a(n,[t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var l="QuickComposeView._tid2._tid3";new _j.d(l,function(){_qc.a.a[l]===undefined&&(_qc.a.a[l]=[[[-1,4,null,null,null,"Text",null,_qc.a.y,0,null,null,null,_nbs.a.SW]],[[-1,4,null,null,null,"AriaLabel",null,_qc.a.P,0,null,null,null,_nbs.a.rb],[-1,0,["Context","RecipientComponent","ReadOnlyRecipientWellViewModel"],[_qc.a.b,_qc.a.h,_qc.a.bQ],null,"DataContext",null,_qc.a.p,1,null,null,null]]]);var n=_qc.a.d.childNodes[1].cloneNode(!0);var t=new _j.c(n.children[1]);t.y("ReadOnlyRecipientWellView");var i=new _b.M(n.children[0]);return new _j.a(n,[i,t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var s="QuickComposeView._tid2";new _j.d(s,function(){_qc.a.a[s]===undefined&&(_qc.a.a[s]=[[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var n=_qc.a.d.childNodes[2].cloneNode(!0);var i=new _j.c(n.children[1]);var t=new _j.c(n.children[0]);t.y("QuickComposeView._tid2._tid3");return new _j.a(n,[t,i])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var h="QuickComposeView._tid4";new _j.d(h,function(){_qc.a.a[h]===undefined&&(_qc.a.a[h]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"Text",null,_qc.a.y,1,_qc.a.bi(),null,null]],[[-1,4,null,null,null,"Id",null,_qc.a.bn,0,null,null,null,_n.b.f()]]]);var n=_qc.a.d.childNodes[3].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var y="QuickComposeView._tid5";new _j.d(y,function(){_qc.a.a[y]===undefined&&(_qc.a.a[y]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel"],[_qc.a.b,_qc.a.i,_qc.a.m],null,"DataContext",null,_qc.a.p,1,null,null,null],[0,5,["VisibleCount"],[_qc.a.l],null,"_qc_v",null,null,0,_qc.a.x(),null,null]]]);var t=_qc.a.d.childNodes[4].cloneNode(!0);var n=new _j.c(_j.a.a(t,[0,0]));n.y("AttachmentWellViewWrapper");n.L(!0);return new _j.a(t,[n])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var p="QuickComposeView";new _j.d(p,function(){_qc.a.a[p]===undefined&&(_qc.a.a[p]=[[[-1,1,["IsImmersive"],[_qc.a.bJ],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,5,["IsReply"],[_qc.a.bh],null,"_qc_a",null,null,0,null,null,null]],[[-1,1,["IsShowingContent"],[_qc.a.q],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,1,["ShowContentCommand"],[_qc.a.ba],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["Context","PlaceHolderText"],[_qc.a.b,_qc.a.bu],null,"Text",null,_qc.a.o,1,null,null,null]],[[-1,1,["IsShowingContent"],[_qc.a.q],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsReadWrite"],[_qc.a.b,_qc.a.h,_qc.a.bf],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_qc.a.y,0,null,null,null,_nbs.a.SW]],[[-1,4,null,null,null,"AriaLabel",null,_qc.a.P,0,null,null,null,_nbs.a.eF],[-1,0,["Context","RecipientComponent","ReadWriteRecipientWellViewModel"],[_qc.a.b,_qc.a.h,_qc.a.bR],null,"DataContext",null,_qc.a.p,1,null,null,null]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsReadWrite"],[_qc.a.b,_qc.a.h,_qc.a.bf],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,0,["Context","EditorCallContext"],[_qc.a.b,_qc.a.bt],_qc.a.bv,"CallContext",_qc.a.br,_qc.a.bs,2,null,null,null]],[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"IsHidden",null,_qc.a.f,1,_qc.a.x(),null,!0]],[[-1,5,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"_qc_w",null,null,0,_qc.a.x(),null,null]],[[-1,1,["IsTouchNarrowOrIsImmersiveInTouchLayout"],[_qc.a.bK],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_qc.a.o,0,null,null,null,_nbs.a.pT],[-1,0,["Context","SendComponent","SendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bg],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_qc.a.o,0,null,null,null,_nbs.a.VK],[-1,0,["Context","DiscardComponent","DiscardCommand"],[_qc.a.b,_qc.a.u,_qc.a.be],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_qc.a.Q,0,null,null,null,_nbs.a.Bf],[-1,1,["AffordanceImageId"],[_qc.a.Y],null,"ImageId",null,_qc.a.L,0,null,null,null],[-1,1,["AffordanceImageId"],[_qc.a.Y],null,"DisabledImageId",null,_qc.a.J,0,null,null,null],[-1,1,["AffordanceHoverImageId"],[_qc.a.bD],null,"HoveredImageId",null,_qc.a.K,0,null,null,null],[-1,1,["AffordancePressedImageId"],[_qc.a.bE],null,"PressedImageId",null,_qc.a.N,0,null,null,null],[-1,0,["Context","UpconvertComponent","ShouldHideUpconvertButton"],[_qc.a.b,_qc.a.U,_qc.a.bV],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,0,["Context","UpconvertComponent","UpconvertCommand"],[_qc.a.b,_qc.a.U,_qc.a.bW],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_qc.a.Q,0,null,null,null,_nbs.a.FO],[-1,1,["AttachImageId"],[_qc.a.bH],null,"ImageId",null,_qc.a.L,0,null,null,null],[-1,1,["AttachDisabledImageId"],[_qc.a.bF],null,"DisabledImageId",null,_qc.a.J,0,null,null,null],[-1,1,["AttachHoverImageId"],[_qc.a.bG],null,"HoveredImageId",null,_qc.a.K,0,null,null,null],[-1,1,["AttachPressedImageId"],[_qc.a.bI],null,"PressedImageId",null,_qc.a.N,0,null,null,null],[-1,0,["Context","AttachmentComponent","AttachCommand"],[_qc.a.b,_qc.a.i,_qc.a.bM],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_qc.a.bq,0,null,null,null,_nbs.a.jQ],[-1,0,["Context","DiscardComponent","DiscardConfirmDialogButtonData"],[_qc.a.b,_qc.a.u,_qc.a.bN],null,"ButtonDataList",null,_qc.a.bp,1,null,null,null],[-1,0,["Context","DiscardComponent","IsDiscardConfirmDialogShown"],[_qc.a.b,_qc.a.u,_qc.a.bO],_qc.a.bP,"IsShown",_qc.a.bk,_qc.a.bl,2,null,null,!1]]]);var n=_qc.a.d.childNodes[5].cloneNode(!0);var it=new _b.p(n.children[2],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));it.g(!1);var rt=new _fc.b(_j.a.a(n,[1,1,5,3]));var et=new _fc.b(_j.a.a(n,[1,1,5,2]));var t=new _fc.b(_j.a.a(n,[1,1,5,1]));t.c("ms-font-color-black ms-bg-color-neutralLight ms-border-color-neutralLight");t.e("ms-font-color-white ms-bg-color-themePrimary ms-border-color-themePrimary");t.g("ms-font-color-neutralTertiary ms-bg-color-neutralLighter ms-border-color-neutralLighter");t.i("_qc_m ms-fwt-sb ms-font-color-neutralPrimary");t.f("ms-bg-color-neutralLighter ms-border-color-neutralLighter");var i=new _fc.b(_j.a.a(n,[1,1,5,0]));i.c("ms-bg-color-themeDark ms-border-color-themeDark");i.e("ms-bg-color-themePrimary ms-border-color-themePrimary");i.g("ms-font-color-neutralTertiary ms-bg-color-neutralLighter ms-border-color-neutralLighter");i.i("_qc_l ms-fwt-sb ms-font-color-white");i.f("ms-bg-color-themePrimary ms-border-color-themePrimary");var lt=new _j.i(_j.a.a(n,[1,1,5]));var tt=new _j.c(_j.a.a(n,[1,1,4]));tt.y("QuickComposeView._tid5");var g=new _j.c(_j.a.a(n,[1,1,3]));g.y("QuickComposeView._tid4");var nt=new _cmc.m(_j.a.a(n,[1,1,2]),_j.b.Instance.a(_j.o),_j.b.Instance.a(_g.h),_j.b.Instance.a(_ff.b));var ut=new _j.c(_j.a.a(n,[1,1,1]));ut.y("QuickComposeView._tid2");var ct=new _j.c(_j.a.a(n,[1,1,0,1]));var w=new _j.c(_j.a.a(n,[1,1,0,0,1]));w.y("ReadWriteRecipientWellView");var ht=new _b.M(_j.a.a(n,[1,1,0,0,0]));var at=new _j.i(_j.a.a(n,[1,1,0,0]));var ot=new _j.i(_j.a.a(n,[1,1,0]));var st=new _j.i(_j.a.a(n,[1,1]));var v=new _fc.b(_j.a.a(n,[1,0]));var d=new _fc.g;var a=new _fc.c;a.W(_j.f.a(["AttachedControl","ShowContentCommand"],[_qc.a.bo,_qc.a.ba],null,"Command",null,_qc.a.e,1));a.j("ENTER");d.a([a]);v.C([d]);var k=new _j.i(n.children[1]);var b=new _fc.g;var y=new _fc.c;y.U(_j.f.a(["Context","DiscardComponent","DiscardCommand"],[_qc.a.b,_qc.a.u,_qc.a.be],null,"Command",null,_qc.a.e,1));y.j("ESC");var h=new _fc.c;h.U(_j.f.a(["Context","SendComponent","AltSSendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bT],null,"Command",null,_qc.a.e,1)).U(_j.f.a(["Context","SendComponent","DoesSupportAltSForSend"],[_qc.a.b,_qc.a.v,_qc.a.bU],null,"PreventDefault",null,_qc.a.bm,1,null,null,!1));h.j("S");h.k=4;var c=new _fc.c;c.U(_j.f.a(["Context","SendComponent","SendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bg],null,"Command",null,_qc.a.e,1));c.j("ENTER");c.k=2;var u=new _fc.c;u.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));u.j("BACKSPACE");u.m=!0;u.n=!1;var r=new _fc.c;r.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));r.j("DELETE");r.m=!0;r.n=!1;var f=new _fc.c;f.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));f.j("HOME");f.m=!0;f.n=!1;var e=new _fc.c;e.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));e.j("END");e.m=!0;e.n=!1;var s=new _fc.c;s.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));s.j("UPARROW");s.m=!0;s.n=!1;var o=new _fc.c;o.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));o.j("DOWNARROW");o.m=!0;o.n=!1;var l=new _fc.c;l.U(_j.f.a(["Context","RecipientComponent","ResolveCommand"],[_qc.a.b,_qc.a.h,_qc.a.bS],null,"Command",null,_qc.a.e,1));l.j("K");l.k=2;b.a([y,h,c,u,r,f,e,s,o,l]);k.C([b]);var ft=new _j.c(n.children[0]);ft.y("NotchView");return new _j.a(n,[ft,k,v,st,ot,at,ht,w,ct,ut,nt,g,tt,lt,i,t,et,rt,it]).l({PlaceholderButtonId:v,ToReadWriteRecipientWellViewId:w,Editor:nt,SendButtonId:i,DiscardButtonId:t,AttachButtonId:rt})},"",IQuickComposeViewModel,_qc.b,function(n){return new _qc.b(n,_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j))},!1,!1,!1,0,_qc.a.a);var a="InlineComposeView._tid6";new _j.d(a,function(){_qc.a.a[a]===undefined&&(_qc.a.a[a]=[[[-1,0,["IsReply"],[_qc.a.B],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var t=_qc.a.d.childNodes[6].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("InlineComposeNotchView");return new _j.a(t,[n])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var v="InlineComposeView._tid7";new _j.d(v,function(){_qc.a.a[v]===undefined&&(_qc.a.a[v]=[[[-1,0,["IsReply"],[_qc.a.B],null,"IsHidden",null,_qc.a.f,1,null,null,!0]]]);var t=_qc.a.d.childNodes[7].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("InlineComposeNotchView");return new _j.a(t,[n])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var i="InlineComposeView";new _j.d(i,function(){_qc.a.a[i]===undefined&&(_qc.a.a[i]=[[[-1,1,["ShouldShowNotch"],[_qc.a.X],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,5,["ShouldShowBorder"],[_qc.a.bA],null,"_qc_z",null,null,1,_qc.a.g(),null,null]],[[-1,1,["TransitionProvider"],[_qc.a.bB],null,"TransitionProvider",null,_qc.a.cb,0,null,null,null],[-1,0,["Conductor"],[_qc.a.bw],null,"DataContext",null,_qc.a.p,1,null,null,null],[0,0,["ActiveNavigationStack"],[_qc.a.bc],null,"ActiveNavigationStack",null,_qc.a.ca,1,null,null,null],[0,0,["ActiveNavigationStack"],[_qc.a.bc],null,"ActiveItems",null,_qc.a.bZ,1,null,null,null]],[[-1,1,["ShouldShowNotch"],[_qc.a.X],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var o=_qc.a.d.childNodes[8].cloneNode(!0);var h=new _j.c(o.children[3]);h.y("InlineComposeView._tid7");var a=new _n.g(_j.a.a(o,[2,0]),_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));var l=new _j.i(o.children[2]);var v=new _fc.g;var e=new _fc.c;e.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));e.j("HOME");e.m=!0;e.n=!1;var t=new _fc.c;t.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));t.j("END");t.m=!0;t.n=!1;var n=new _fc.c;n.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));n.j("UPARROW");n.m=!0;n.n=!1;var r=new _fc.c;r.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));r.j("DOWNARROW");r.m=!0;r.n=!1;var s=new _fc.c;s.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));s.j("R");s.n=!1;var f=new _fc.c;f.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));f.j("R");f.k=1;f.n=!1;var u=new _fc.c;u.W(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));u.j("F");u.k=1;u.n=!1;v.a([e,t,n,r,s,f,u]);l.C([v]);var c=new _j.c(o.children[1]);c.y("InlineComposeView._tid6");return new _j.a(o,[c,l,a,h]).l({Conductor:a})},"",_qc.h,_qc.g,function(n){return new _qc.g(n,_j.b.Instance.a(_j.j))},!0,!1,!1,0,_qc.a.a);var r="InlineComposeViewWrapper.GroupReplyWrapper";new _j.d(r,function(){_qc.a.a[r]===undefined&&(_qc.a.a[r]=[[[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1]]]);var t=_qc.a.d.childNodes[9].cloneNode(!0);var n=new _qc.g(t.children[0],_j.b.Instance.a(_j.j));n.c=!1;n.b=!1;return new _j.a(t,[n])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var n="InlineComposeViewWrapper";new _j.d(n,function(){_qc.a.a[n]===undefined&&(_qc.a.a[n]=[[[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1],[-1,5,["IsReply"],[_qc.a.bd],null,"_qc_D",null,null,0,null,null,null]]]);var i=_qc.a.d.childNodes[10].cloneNode(!0);var t=new _qc.g(i.children[0],_j.b.Instance.a(_j.j));t.c=!0;t.b=!0;return new _j.a(i,[t])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var t="InlineComposeEmptyPlaceholderViewWrapper";new _j.d(t,function(){_qc.a.a[t]===undefined&&(_qc.a.a[t]=[[[-1,0,["ScrollManager"],[_qc.a.bL],null,"ScrollManager",null,_qc.a.bC,1,null,null,null],[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1],[-1,5,["IsReply"],[_qc.a.bd],null,"_qc_G",null,null,0,null,null,null]]]);var i=_qc.a.d.childNodes[11].cloneNode(!0);var n=new _qc.g(i.children[0],_j.b.Instance.a(_j.j));n.i=!0;n.c=!1;n.b=!1;return new _j.a(i,[n])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var e="InlineComposePlaceholderView";new _j.d(e,function(){_qc.a.a[e]===undefined&&(_qc.a.a[e]=[[[-1,0,["ShouldShowPlaceholderWithPhoto"],[_qc.a.T],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,0,["PlaceholderText"],[_qc.a.S],null,"Text",null,_qc.a.o,1,null,null,null],[-1,0,["ComposeCommand"],[_qc.a.R],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["ButtonEnabled"],[_qc.a.C],null,"IsEnabled",null,_qc.a.M,1,null,null,!1]],[[-1,0,["ShouldShowPlaceholderWithPhoto"],[_qc.a.T],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0],[-1,5,["ButtonEnabled"],[_qc.a.C],null,"_qc_M",null,null,0,_qc.a.g(),null,null]],[[-1,0,["UserPersonaViewModel"],[_qc.a.bz],null,"DataContext",null,_qc.a.p,1,null,null,null]],[[-1,0,["PlaceholderText"],[_qc.a.S],null,"Text",null,_qc.a.o,1,null,null,null],[-1,0,["ComposeCommand"],[_qc.a.R],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["ButtonEnabled"],[_qc.a.C],null,"IsEnabled",null,_qc.a.M,1,null,null,!1]]]);var n=_qc.a.d.childNodes[12].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[1,1,0]));r.g("ms-font-color-neutralSecondary-hover ms-bg-color-neutralLighter-hover");var i=new _pe.d(_j.a.a(n,[1,0]),_j.b.Instance.a(_a.q),_j.b.Instance.a(_pe.e));i.y("PersonaView.DisplayPictureNoMargin");var u=new _j.i(n.children[1]);var t=new _fc.b(n.children[0]);t.g("ms-font-color-neutralTertiary ms-border-color-neutralLighter");return new _j.a(n,[t,u,i,r])},"",_qc.p,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_qc.a.a);var o="InlineComposeNotchView";new _j.d(o,function(){_qc.a.a[o]===undefined&&(_qc.a.a[o]=[[[-1,5,["IsReply"],[_qc.a.B],null,"_qc_O",null,null,0,null,null,null],[-1,5,["IsHtml5BaselineSupported"],[_qc.a.O],null,"_qc_P:_qc_R",null,null,1,null,null,null],[-1,5,["IsHtml5Reply"],[_qc.a.bx],null,"_qc_Q",null,null,0,null,null,null],[-1,5,["IsNonHtml5Reply"],[_qc.a.by],null,"_qc_S",null,null,0,null,null,null]]]);var n=_qc.a.d.childNodes[13].cloneNode(!0);var t=new _j.i(n.children[0]);return new _j.a(n,[t])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var u="QuickComposeViewWrapper";new _j.d(u,function(){_qc.a.a[u]===undefined&&(_qc.a.a[u]=[null,[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"VisibleAttachmentCount",null,_qc.a.G,1,null,null,0],[-1,0,["Context","IsInEditMode"],[_qc.a.b,_qc.a.z],_qc.a.A,"IsShowingContent",_qc.a.q,_qc.a.F,2,null,null,!1],[-1,0,["Context","IsInEditModeCompleted"],[_qc.a.b,_qc.a.V],_qc.a.W,"IsShowingContentCompleted",_qc.a.Z,_qc.a.bb,2,null,null,!1]]]);var n=_qc.a.d.childNodes[16].cloneNode(!0);var t=new _qc.b(_j.a.a(n,[0,0]),_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j));t.v(!0);var i=new _fce.f(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));return new _j.a(n,[i,t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_qc.a.a);var f="QuickReplyViewWrapper";new _j.d(f,function(){_qc.a.a[f]===undefined&&(_qc.a.a[f]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"VisibleAttachmentCount",null,_qc.a.G,1,null,null,0],[-1,0,["Context","IsInEditMode"],[_qc.a.b,_qc.a.z],_qc.a.A,"IsShowingContent",_qc.a.q,_qc.a.F,2,null,null,!1],[-1,0,["Context","IsInEditModeCompleted"],[_qc.a.b,_qc.a.V],_qc.a.W,"IsShowingContentCompleted",_qc.a.Z,_qc.a.bb,2,null,null,!1]],null]);var t=_qc.a.d.childNodes[17].cloneNode(!0);var i=new _j.c(t.children[1]);var n=new _qc.b(t.children[0],_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j));n.v(!1);return new _j.a(t,[n,i]).l({QuickReplyViewId:n,QuickReplyScrollBufferRegionId:i})},"",IQuickComposeViewModel,_qc.k,function(n){return new _qc.k(n)},!1,!1,!1,0,_qc.a.a)};_qc.q.registerClass("_qc.q");_qc.f.registerClass("_qc.f");_qc.n.registerClass("_qc.n");_qc.c.registerClass("_qc.c");_qc.v.registerClass("_qc.v",_cmc.bF,_h.eW,IOutstandingComposeContext,IContext);QuickComposeComponent.registerClass("QuickComposeComponent",null,_a.iz,_j.cd);_qc.e.registerClass("_qc.e",_j.Q,IQuickComposeContext,IQuickComposeContextModelScope,IContext,_j.bq,Sys.IDisposable);_qc.F.registerClass("_qc.F");_qc.G.registerClass("_qc.G",_y.jg,IQuickComposeViewModel,_bc.i,_bc.o,_bc.s,_a.jk,_j.bq,Sys.IDisposable,_y.hv);_qc.h.registerClass("_qc.h",_j.Q,IInlineComposeConductorViewModel,_y.ga,_j.bq,Sys.IDisposable);_qc.w.registerClass("_qc.w",_qc.h);_qc.p.registerClass("_qc.p",_y.jg);_qc.d.registerClass("_qc.d",_j.Q,IQuickComposeRecipientComponent);_qc.j.registerClass("_qc.j",_j.Q,IQuickComposeSendComponent);_qc.m.registerClass("_qc.m",_j.Q,IQuickComposeAttachmentComponent);_qc.i.registerClass("_qc.i",_j.Q,IQuickComposeDiscardComponent);_qc.s.registerClass("_qc.s");_qc.o.registerClass("_qc.o",null,IQuickComposeUpconvertComponent);_qc.B.registerClass("_qc.B",null,IQuickComposeEventAggregatorFactory);_qc.z.registerClass("_qc.z",_qc.G,IMailQuickComposeViewModel,IQuickComposeViewModel);_qc.r.registerClass("_qc.r",_qc.e);_qc.y.registerClass("_qc.y",_qc.F,_y.gb);_qc.b.registerClass("_qc.b",_j.c);_qc.g.registerClass("_qc.g",_j.c);_qc.k.registerClass("_qc.k",_j.c);QuickComposeComponent.$$cctor();_qc.e.a=0;_qc.e.c=_a.a.v;_qc.e.b=1;_qc.d.a=_a.a.v;_qc.d.c=7;_qc.d.b=1;_qc.j.a=_a.a.v;_qc.m.a=_a.a.v;_qc.i.a=_a.a.v;_qc.o.a=_a.a.v;_qc.b.a=_a.a.v;_qc.g.a=_a.a.v;_qc.a.d=_qc.a.bj();_qc.a.r=null;_qc.a.t=null;_qc.a.s=null;_qc.a.a={};_qc.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.quickcompose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.quickcompose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
