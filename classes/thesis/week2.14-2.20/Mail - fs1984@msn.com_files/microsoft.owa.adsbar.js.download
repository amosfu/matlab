try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.adsbar.js'] = (new Date()).getTime();
Type.registerNamespace("_ab");function AdsbarComponent(){}AdsbarComponent.$$cctor=function(){_a.t.a().a(AdsbarComponent)};AdsbarComponent.prototype={b:function(n,t,i){var r=this;n.b(IAdsbarViewModelFactory,function(){return new _ab.d(n.a(_g.a),n.a(_j.ba),n.a(_a.cF),n.a(_j.j),n.a(_g.G),n.a(IInferenceTracker),n.a(_a.x).b(),n.a(_db.w),n.a(_a.s),n.a(_a.x),n.a(_j.o))}).a()},a:function(){return null}};_ab.e=function(){_ab.e.initializeBase(this)};_ab.e.prototype={L:function(n){var t=new _dg.cY(this.M);n.ez(t,this.K,this.J)},cU:function(n,t,i){t()}};_ab.b=function(n,t,i,r,u,f,e,o,s,h,c,l){this.F=Function.createDelegate(this,this.bc);this.z=Function.createDelegate(this,this.bf);this.x=Function.createDelegate(this,this.bd);this.y=Function.createDelegate(this,this.be);this.A=Function.createDelegate(this,this.bg);_ab.b.initializeBase(this);_j.s.b(o,"primaryViewModel");this.b=i;this.h=f;this.e=n;this.c=_a.fU.a(n.bD.AdMarket,n.t(),i.a().d().SupportedMarkets,i.a().d().CountryDefaultMapMarkets);this.P=this.c.split("-")[0];this.O=this.c.split("-")[1];this.l=u;this.a=o;this.v=e;this.bj();this.h.by(this.c);this.f("AdsInitialized",null,null,null,null);this.m=h;this.G=c;this.d=r;this.w=l;this.i=[];this.E=t;if(this.v.b("overrideadssdkbaseurl")){this.j=e.a.overrideadssdkbaseurl;this.n=this.j+"adbar.js"}else{this.n=i.a().d().OwaAdBarScript?i.a().d().OwaAdBarScript:"https://r1.res.office365.com/adbar/4.2/adbar.js";this.j=i.a().d().OwaAdBarBaseUrl?i.a().d().OwaAdBarBaseUrl:"https://r1.res.office365.com/adbar/4.2/"}this.q=this.v.b("overrideastsdkurl")?e.a.overrideastsdkurl:i.a().d().AstScriptUrl?i.a().d().AstScriptUrl:"https://acdn.adnxs.com/ast/ast.js";var a=this;s.a(function(n){a.g=n;a.p=a.T()&&!a.Z();a.u();if(a.p){a.d.b(_a.bb,a.A);a.d.b(_a.cw,a.y);a.d.b(_a.dg,a.x);a.d.b(_y.T,a.z);a.bb()}a.Q()})};_ab.b.prototype={w:null,e:null,d:null,b:null,h:null,l:null,m:null,G:null,a:null,c:null,P:null,O:null,v:null,n:null,j:null,q:null,p:!1,t:!1,s:!1,E:null,o:null,g:null,k:!1,i:null,C:!1,N:function(n){if(this.t!==n){this.t=n;this.eB("ShowAdBlockMessage")}return n},H:function(){return this.a.v()===2},B:null,J:function(){return!this.H()&&this.b.a().dU().Enabled},S:function(){var n=this.b.a().dU().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");return String.format(n,encodeURIComponent(this.l.bD.EncryptedUserPuid),"PROD_OL-Web_InApp_BannerAd_Premium")},R:function(){return new _j.g(this.F,_a.a.cP)},f:function(n,t,i,r,u){var f=new _a.l;f.a("pg",this.a.e?this.a.e.b:-1);f.b("cm",this.c);f.b("r",t);f.b("am",i);f.b("p",r);f.b("ipg",u);f.a("w",window.innerWidth);f.a("h",window.innerHeight);_a.c.c(_a.a.cP,n,f.toString(),0)},bh:function(){var n=!1;var t=this.a.e;this.a.bp();if(this.a.e&&window.wLive&&window.wLive.adbar){if(!this.C){this.K();n=!0}window.wLive.adbar.resize(this.L())}if(this.a.e!==t){this.eF("AdBottom","ShowUpsell");this.u();n||this.d.a(_a.bb,new _a.bb("Resize"))}},u:function(){var n=null;this.p?this.a.a()&&this.a.a().a?n="ModuleNotMail":this.a.e?this.i.length&&(n=this.i[0]):n="WindowTooSmall":n="AdsNotEnabled";var t=!n;if(!t){this.h.m(n,this.c);this.f("AdsNotShown",n,null,null,null)}t&&this.J()&&this.f("AdsShowUpsell",null,null,null,null);this.a.bn(t)},bb:function(){this.N(!0);var n=this;this.E.a(this.n,function(){if(window.wLive&&window.wLive.adbar){n.N(!1);n.a.e&&n.K();var t=window.innerWidth.toString()+"x"+window.innerHeight.toString();n.h.bz(t,n.c);n.f("AdsLoaded",null,null,null,null)}})},L:function(){var n={};n.Height=this.a.bg();n.Width=this.a.e.g();n.AdSizes=this.a.e.a;n.AdPageGroup=this.a.e.b?_ab.b.a+this.a.e.b:null;return n},V:function(){var n=this.L();n.BaseUrl=this.j;n.Market=this.c;n.ContainerID="owaadbar";n.AstUrl=this.q;n.CallbackEventName="AdCallbackOwa";var r=this;n.Visibility=function(){return r.a.n&&r.s};var i={};var e=this;i.adErrorEventHandler=function(){};var o=this;i.hide=function(){};n.PublisherObject=i;var t={};var u=this;t.addEventListener=function(n,t){n==="contextChange"&&(u.o=t)};var f=this;t.removeEventListener=function(){};n.EventManager=t;return n},eE:function(){this.d.c(_a.bb,this.A);this.d.c(_a.cw,this.y);this.d.c(_a.dg,this.x);this.d.c(_y.T,this.z);_a.fO.prototype.eE.call(this)},K:function(){this.C=!0;var n=this.V();window.wLive.adbar.init(n);window.wLive.adbar.show()},be:function(n){this.bi(n);this.u()},bd:function(n){if(n.a){this.h.bx();this.f("AdsBeingCovered",null,null,null,null)}this.s=n.a},bg:function(n){if(this.a.n&&!this.s&&this.o){var t=this;_j.m.a().c(_a.a.cP,"AdsRefresh",function(){t.h.bw(t.c,n.a);t.f("AdsRefresh",n.a,null,null,null);var i=t.a.e.i(n.a==="MCompose");t.o(n.a,null,t.b.a().ih().Enabled&&i?_ab.b.a+i:null)})}},ba:function(){if(this.b.a().d()&&this.b.a().d().SupportedMarkets){var t=this.b.a().d().SupportedMarkets;var n=this.c.toUpperCase();return Array.contains(t,n)}return!0},bi:function(n){n.b?Array.remove(this.i,n.a):Array.contains(this.i,n.a)||Array.add(this.i,n.a)},Y:function(n){if(n&&n.ConsumerSubscriptions)for(var t=0;t<n.ConsumerSubscriptions.length;t++){var i=n.ConsumerSubscriptions[t];if(i==="GA-O365HOMEPREM-XX-SUB"){this.k=!0;this.h.m("NotLoadedByUseHasO365SubscriptionTest",this.c);this.f("AdBar365User",null,null,null,null);return!1}}return!1},X:function(){return this.b.a().n().Enabled&&!!this.b.a().n().SupportedMarkets&&Array.contains(this.b.a().n().SupportedMarkets,this.c.toUpperCase())&&this.b.a().ig().Enabled},Z:function(){var n=this.b.a().eG().Enabled;if(n)if(this.w.h()){this.M("NotLoadedByEdgeOffer");this.d.d(_db.bJ,new _db.bJ);return!0}else this.w.z()&&this.d.d(_db.bK,new _db.bK);return!1},bf:function(n){this.u();this.a.a().a||this.d.a(_a.bb,new _a.bb("Resize"))},Q:function(){if(this.W()){var n=new _ab.e;var i=this;n.c(function(t){var r=n.O;var i="";r.Subscriptions&&(i=r.Subscriptions.join(","));_j.e.a(_a.a.A,"fetchUserSubscriptionAction success subscription offerid are: {0}",i)});var t=this;n.e(function(n){_j.e.c(_a.a.A,"fetchUserSubscriptionAction failed for user",t.e.c().bD.UserPuid)});this.m.a(n)}},W:function(){if(!this.b.a().eM().Enabled||!this.g)return!1;if(this.g.ConsumerSubscriptions)for(var n=0;n<this.g.ConsumerSubscriptions.length;n++){var u=this.g.ConsumerSubscriptions[n];if(u==="GA-O365HOMEPREM-XX-SUB"){var r=_a.d.b(this.g.ConsumerSubscriptionExpireDates[n]);if(r.b(_a.d.a())>0)return!1}}var i=this.b.a().eM().DaysBeforeNextFetch;var t=null;this.g.ConsumerSubscriptionLastFetchDate&&(t=_a.d.b(this.g.ConsumerSubscriptionLastFetchDate));return!i||!t||t.c(i).b(_a.d.get_utcNow())<0},U:function(){var n=null;this.b.a().d().Enabled?this.Y(this.g)?n="o365User":this.l.bD.IsPremiumConsumerMailbox?n=this.k?"AdPaidUserO365":"AdPaidUser":this.ba()?this.e.bD.IsConsumerChild?n="ChildAccount":this.X()&&(n="NativeAdsOn"):n="NonSupportedMarket":n="mainFlightOff";var t=!n;t||this.M(n);return t},T:function(){var t=!1;var n=this.U();var e=(32768&this.e.a().v())!=32768;if(n!==e){if(n){var f;(f=this.e.a()).x(f.v()&-32769)}else{var u;(u=this.e.a()).x(u.v()|32768)}t=!0}var o=(1048576&this.e.a().v())!=1048576;if(this.k!==o){if(this.k){var i;(i=this.e.a()).x(i.v()&-1048577)}else{var r;(r=this.e.a()).x(r.v()|1048576)}t=!0}t&&_h.f.a(this.e.a().u,this.m);return n},bj:function(){var t=String.format("http://windows.microsoft.com/{0}/outlook/ad-free-outlook",this.c);if(this.b.a().cm().Enabled){var n=this.b.a().cm().UpsellUrlFormat;n||(n="https://aka.ms/l2?WT.mc_id={1}&ep={0}");t=String.format(n,encodeURIComponent(this.l.bD.EncryptedUserPuid),"PROD_OL-Web_InApp_AdBarBlock_Premium")}this.B=String.format(_nbs.a.HV,t)},M:function(n){this.h.m(n,this.c);this.f("AdsbarNotEnabled",n,null,null,null)},bc:function(){this.f("AdsUpsellClicked",null,null,null,null)}};_ab.d=function(n,t,i,r,u,f,e,o,s,h,c){this.l=n;this.h=t;this.e=i;this.d=r;this.i=u;this.f=f;this.j=e;this.g=o;this.b=s;this.c=h;this.k=c};_ab.d.prototype={k:null,l:null,d:null,e:null,f:null,i:null,b:null,c:null,j:null,h:null,g:null,a:function(n){return new _ab.b(this.l,this.h,this.e,this.d,this.i,this.f,this.j,n,this.g,this.b,this.c,this.k)}};_ab.c=function(n,t,i,r){this.i=Function.createDelegate(this,this.l);this.c=Function.createDelegate(this,this.k);this.j=Function.createDelegate(this,this.m);this.d=Function.createDelegate(this,this.n);_ab.c.initializeBase(this,[n]);this.b=t;this.f=i;this.h=_g.a.a().bD.AdMarket?_g.a.a().bD.AdMarket:_g.a.a().t().toLowerCase();this.e=r};_ab.c.prototype={b:null,f:null,h:null,e:null,a:null,P:function(){_j.c.prototype.P.call(this);this.b.i(this.d);_j.k.b(this.z,"AdCallbackOwa",this.j)},H:function(){_j.c.prototype.H.call(this);this.a=this.B.a("AdBlockHtmlLabel");this.a&&this.a.gd(this.c);this.g()},bH:function(){this.b&&this.b.j(this.d);this.z&&_j.k.c(this.z,"AdCallbackOwa");this.a&&this.a.kD(this.c);_j.c.prototype.bH.call(this)},k:function(n){for(var i=_j.A.e(n.z.childNodes,"a[target]"),t=0;t<i.length;t++)_j.k.b(i[t],"click",this.i)},l:function(n){var t=new _a.l;t.c("PU",this.e.a().cm().Enabled);t.b("M",this.h);_a.c.c(_a.a.cP,"ClickAdBlockFreeLink",t.toString(),0)},n:function(){var n=this.V();n&&n.bh();this.g()},m:function(n){this.g();var t=n.s;this.f.bv(t.UserMarket,t.ContextRefreshName,t.Provider);var i=this.V();i&&i.f("AdsImpressed",t.ContextRefreshName,t.UserMarket,t.Provider,t.PageGroup)},g:function(){var t="";var n=this.V();n&&n.a.v()===2&&(t=window.innerWidth+"px");this.X.z.style.width=t}};_ab.a=function(){};_ab.a.$$cctor=function(){_ab.a._I()};_ab.a.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_Adsbar_templates_cs_7'> <span class='__Microsoft_Owa_Adsbar_templates_cs_4 ms-fcl-nsa'> </span> <span class='__Microsoft_Owa_Adsbar_templates_cs_5 ms-fwt-r ms-font-color-black'></span> </div> </div><div> <div class='__Microsoft_Owa_Adsbar_templates_cs_2'></div> <a class='__Microsoft_Owa_Adsbar_templates_cs_8 ms-font-color-themePrimary'></a> </div>";_j.i.a().appendChild(n);return n};_ab.a.k=function(n){return n.B};_ab.a.l=function(n){return n.H()};_ab.a.m=function(n){return n.t};_ab.a.p=function(n){return n.S()};_ab.a.n=function(n){return n.J()};_ab.a.o=function(n){return n.R()};_ab.a.h=function(n,t){n.a(t)};_ab.a.q=function(n,t){n.a(t)};_ab.a.i=function(n,t){n.b(t)};_ab.a.j=function(n,t){n.K(t)};_ab.a.f=function(n,t){n.T(t)};_ab.a.g=function(n,t){n.j(t)};_ab.a.d=function(){_ab.a.b||(_ab.a.b=new _fc.k);return _ab.a.b};_ab.a._I=function(){var t="AdsbarPanelView._tid1";new _j.d(t,function(){_ab.a.a[t]===undefined&&(_ab.a.a[t]=[[[-1,4,null,null,null,"Id",null,_ab.a.h,0,null,null,null,_fm.a.U]],[[-1,0,["AdBlockUseAdFreeMessage"],[_ab.a.k],null,"Html",null,_ab.a.q,1,null,null,null]]]);var n=_ab.a.c.childNodes[0].cloneNode(!0);var i=new _b.o(_j.a.a(n,[0,1]),_j.b.Instance.a(_a.f));var r=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,i]).l({AdBlockHtmlLabel:i})},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker),_j.b.Instance.a(_a.f))},!1,!0,!1,0,_ab.a.a);var n="AdsbarPanelView";new _j.d(n,function(){_ab.a.a[n]===undefined&&(_ab.a.a[n]=[[[-1,5,["AdBottom"],[_ab.a.l],null,"__Microsoft_Owa_Adsbar_templates_cs_6",null,null,0,null,null,null],[-1,5,["ShowAdBlockMessage"],[_ab.a.m],null,"__Microsoft_Owa_Adsbar_templates_cs_3",null,null,0,_ab.a.d(),null,null]],[[-1,4,null,null,null,"Text",null,_ab.a.g,0,null,null,null,_nbs.a.it],[-1,0,["UpsellLink"],[_ab.a.p],null,"Href",null,_ab.a.i,1,null,null,null],[-1,0,["ShowUpsell"],[_ab.a.n],null,"IsHidden",null,_ab.a.j,1,_ab.a.d(),null,!0],[-1,0,["UpsellClickCommand"],[_ab.a.o],null,"ClickCommand",null,_ab.a.f,1,null,null,null]]]);var i=_ab.a.c.childNodes[1].cloneNode(!0);var r=new _fc.e(i.children[1]);r.a("_blank");var t=new _ab.c(i.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker),_j.b.Instance.a(_a.f));t.O("owaadbar");t.y("AdsbarPanelView._tid1");return new _j.a(i,[t,r])},"",_ab.b,_ab.c,function(n){return new _ab.c(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker),_j.b.Instance.a(_a.f))},!1,!1,!1,0,_ab.a.a)};AdsbarComponent.registerClass("AdsbarComponent",null,_a.iz,_j.cd);_ab.e.registerClass("_ab.e",_h.ff);_ab.b.registerClass("_ab.b",_a.bs,IAdsbarViewModel,_j.bq,Sys.IDisposable);_ab.c.registerClass("_ab.c",_j.c);AdsbarComponent.$$cctor();_ab.b.a="WAB";_ab.a.c=_ab.a.e();_ab.a.b=null;_ab.a.a={};_ab.a.$$cctor();
window.scriptsLoaded['microsoft.owa.adsbar.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.adsbar.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
