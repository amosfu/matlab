try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.W=function(){this.a={}};_at.W.prototype={e:function(n){return this.a[_g.q.toString(n).toLowerCase()]},b:function(n,t){this.a[_g.q.toString(n).toLowerCase()]=t;return t},d:function(n){return _g.q.toString(n).toLowerCase()in this.a},c:function(n){var u=n.toLowerCase();var i=this.a;for(var t in i){var r={key:t,value:i[t]};if(r.key===u)return!0}return!1},f:function(){return _ff.j.a(this.a)}};_at.bP=function(n,t,i,r,u,f){_at.bP.initializeBase(this);this.i=n;this.l=t;this.j=i;this.k=r;this.g=u;this.d=f};_at.bP.prototype={l:null,j:null,k:null,i:null,p:null,g:!1,d:null,L:function(n){var t=new _gg.oV(this.M);n.bh(this.i,this.l,this.j,this.k,t,this.K,this.J,this.g,this.d)},cU:function(n,t,i){try{_a.b.c(n,"result");this.p=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.t.a().a(AttachmentsComponent)};AttachmentsComponent.prototype={b:function(n,t,i){if(t.a()){var a=this;n.b(_at.B,function(){var t=_bc.k.isInstanceOfType(_g.k.a)?_g.k.a:null;return new _at.d(n.a(_a.B),t?t.d().j():null,t?t.j():null)}).a()}else{var l=this;n.b(_at.B,function(){return new _at.bJ}).a()}var c=this;n.b(_at.j,function(){return _at.j.a()}).b(_at.I).b(IAttachmentPropertyChecker).a();var p=this;n.b(_at.J,function(){return _at.K.a?new _at.K:null}).a();var y=this;n.b(_a.eQ,function(){return i.d()}).a();var r=_at.s.b(i);var v=this;n.b(_at.C,function(){return new _at.C(n.a(IInferenceTracker),n.a(_j.o),n.a(_no.c),n.a(_a.s),n.a(_a.f),n.d(ILightBoxViewModelFactory),n.c(ISmimeCommandFactory),n.a(_a.bp),r?null:n.a(_at.z),n.a(_a.B),n.c(IImportCalendarEventViewModelFactory),n.a(_j.j),n.a(_at.p),n.a(_at.J),n.a(_a.eQ),n.a(_y.F))}).a();var f=this;n.b(IAttachmentViewModelFactory,function(){return new _at.bG(n.a(_y.a),n.a(_at.B),n.d(_y.fK),n.d(IItemStoreGetterFactory),n.a(IUriFileAttachmentViewModelFactory),n.a(_at.I),r?n.a(IDownloadAuthenticatorFactory):null,n.a(_at.C))}).a();var u=this;n.b(_at.bj,function(){return new _at.bj(n.a(_at.I),r?n.a(_at.s):null,n.a(_at.C))}).b(IUriFileAttachmentViewModelFactory).a();var e=this;n.b(_at.s,function(){return new _at.s(n.a(_a.f),n.a(_g.a).n().bD.DownloadTokenRefreshMinutes,n.a(_g.a).n().bD.DownloadUrlBase,n.a(_g.a).c().bD.UserEmailAddress,n.a(_g.a).n().bD.FirstDownloadToken,i.c(),n.a(_a.s))}).b(IDownloadAuthenticatorFactory).a();var h=this;n.b(_at.z,function(){return new _at.z(n.a(_a.f),n.a(_g.a).n().bD.DownloadTokenRefreshMinutes,n.a(_g.a).n().bD.DownloadUrlBase,n.a(_g.a).c().bD.UserEmailAddress,n.a(_g.a).n().bD.FirstDownloadToken,i.c(),n.a(_a.s),!1)}).b(IDownloadAuthenticator).a();var s=this;n.b(_at.p,function(){return new _at.p(n.a(_a.f),i.c())}).a();var o=this;n.b(_at.A,function(){return new _at.A}).b(IFileReader)},a:function(){return null}};_at.i=function(){};_at.i.c=function(n){var t=null;n&&n.d()&&(n.d().b()===2||!n.d().b())&&(t=n.c());return t};_at.i.a=function(n,t,i){return t?n.h().ReferenceAttachmentsEnabled:i?!0:n.h().ClassicAttachmentsEnabled};_at.i.e=function(n){try{if(n.indexOf("safelinks.protection.outlook.com")>0){var i=new _a.Q(n);var t=_a.w.g(i.f);if("url"in t)return decodeURIComponent(t.url)}}catch(r){return n}return n};_at.i.g=function(n){switch(n){case 6:case 5:return!0;default:return!1}};_at.i.f=function(n){if(_j.h.a(n))return n;var t=n.lastIndexOf("/");return t>=1?n.substr(0,t):n};_at.i.d=function(n){return!!_at.i.b&&n.startsWith(_at.i.b)||n==="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.I=function(){};_at.I.registerInterface("_at.I");_at.J=function(){};_at.J.registerInterface("_at.J");_at.s=function(n,t,i,r,u,f,e){this.e=t;this.d=i;this.c=r;this.g=f;this.h=e;this.f=n;this.i=!!n&&n.a().bG().Enabled&&!_j.h.b(this.d)&&!_j.h.b(this.c)&&!_j.h.b(u);t<1&&(t=1);this.b=new _at.z(this.f,this.e,this.d,this.c,u,this.g,this.h,!1)};_at.s.b=function(n){return n.e().a().cT().Enabled};_at.s.a=function(n,t,i){if(!n)return t.i;var r=_at.i.c(i);return n.a(r)};_at.s.prototype={b:null,i:!1,d:null,e:0,c:null,g:!1,h:null,f:null,a:function(n){_j.h.b(n)&&(n=this.c);var t=this.b;if(t&&t.e===n)return t;t.q();this.b=new _at.z(this.f,this.e,this.d,n,null,this.g,this.h,!0);return this.b}};_at.bx=function(){_at.bx.initializeBase(this)};_at.bx.prototype={L:function(n){var t=new _gg.rD(this.M);t.explicitLogonUser=this.T;n.bG(t,this.K,this.J)},cU:function(n,t,i){_j.h.b(n)?i(Error.create("Download token is missing or empty.")):t()}};_at.z=function(n,t,i,r,u,f,e,o){this.n=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.o);this.d=i;this.e=r;this.g=u;this.h=f;this.k=e;this.l=o;this.j=n;this.i=!!n&&n.a().bG().Enabled&&!_j.h.b(this.d)&&!_j.h.b(this.e);t<1&&(t=1);if(this.i){this.o();this.f=_j.m.a().e(_at.z.a,"DownloadAuthenticator",this.m,6e4*t)}};_at.z.prototype={i:!1,d:null,e:null,h:!1,k:null,l:!1,j:null,f:null,g:null,q:function(){if(this.f){_j.m.a().b(this.f);this.f=null;return!0}return!1},o:function(){var n=new _at.bx;n.c(this.n);this.h||(n.T=this.e);this.k.a(n)},p:function(n){this.g=n.O},a:function(n,t,i,r){if(!n||!n.Id||n.Id.startsWith("smime-"))return null;i||(i=_g.C.a());var f=String.format(i,encodeURIComponent(n.Id));t&&(f+=_g.C.e());if(!this.i||!this.l&&!_j.h.a(r)){_j.h.a(r)||(f=String.format("{0}/{1}",r,f));return f}if(_j.h.a(this.d)){_j.e.c(_at.z.a,"Attachment download URL is not properly configured.");return f}var u;u=_a.bP.a()&&this.d.indexOf("@")!==-1?this.d+f+"&token="+this.g:this.d+this.e+"/"+f+"&token="+this.g;u=u+"&owa="+window.location.hostname;this.h&&(u=u+"&isc=1");return u},b:function(n,t,i,r){var u=this.a(n,t,i,r);u&&(u+="&isImagePreview=True");return u},c:function(n,t,i,r,u){var f=_at.p.c(this.j,n);return f?f.e(t,i,r,u):i}};_at.j=function(n,t){this.e=n||_at.j.g();this.g=t;this.f=this.g?this.e.DirectFileAccessOnPublicComputersEnabled:this.e.DirectFileAccessOnPrivateComputersEnabled;this.h=_at.j.d(this.e.BlockedFileTypes,this.e.ForceSaveFileTypes,this.e.AllowedFileTypes);this.i=_at.j.d(this.e.BlockedMimeTypes,this.e.ForceSaveMimeTypes,this.e.AllowedMimeTypes);this.j=_at.j.f(this.e.ActionForUnknownFileAndMIMETypes)};_at.j.a=function(){_at.j.b||(_at.j.b=new _at.j(_g.a.a().bD.AttachmentPolicy,_g.a.a().R()));return _at.j.b};_at.j.f=function(n){var t;try{t=_j.t.b(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.j.g=function(){var n=new _g.fi;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true}')};_at.j.h=function(n){return n===".one"||n===".onepkg"};_at.j.d=function(n,t,i){var r={};_at.j.c(r,i,3);_at.j.c(r,t,2);_at.j.c(r,n,1);return r};_at.j.c=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.j.e=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.j.prototype={g:!1,f:!1,j:0,e:null,h:null,i:null,b:function(){return this.e},c:function(){return this.e.WacEditableFileTypes?this.e.WacEditableFileTypes.length:0},a:function(n,t,i,r,u,f){!!i!==i&&(i=!0);n&&(n=n.toLowerCase());var o;o=this.k(n,t);var e=!1;var c=!1;var s=!1;if(o!==1&&i&&!r){var h=u&&f&&(t==="application/onenote"||_at.j.h(n));this.m(n,h)&&(e=!0);c=this.l(this.g,e);e&&(h?s=!0:this.e.WacEditableFileTypes&&n&&(s=_at.j.e(this.e.WacEditableFileTypes,n)))}e||this.f||(o=1);var l=u&&f&&_j.h.a(n)&&t==="application/onenote";return new _at.bw(this.f,o,e,c,s,l)},d:function(n,t){var i=this.a(n,t).a;return i===1||!i},k:function(n,t){var r=this.h[n]||0;if(r===1)return 1;var i=this.i[t]||0;return i===1?1:r===2||i===2?2:r===3||i===3?3:this.j},m:function(n,t){var i=this.g?this.e.WacViewingOnPublicComputersEnabled:this.e.WacViewingOnPrivateComputersEnabled;return i&&(t||this.n(n))},l:function(n,t){return t?n?this.e.ForceWacViewingFirstOnPublicComputers:this.e.ForceWacViewingFirstOnPrivateComputers:!1},n:function(n){return _at.j.e(this.e.WacViewableFileTypes,n)}};_at.bw=function(n,t,i,r,u,f){!n&&!i;this.e=n;this.a=t;this.b=i;this.f=r;this.d=u;this.g=f};_at.bw.prototype={a:0,e:!1,f:!1,b:!1,d:!1,g:!1,c:function(){return!this.g&&this.a!==1&&this.e},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, ForceBrowserView: {3}, WacEdit: {4}",this.a,this.e,this.b,this.f,this.d)}};_at.Q=function(){};_at.Q.a=function(n,t,i){n.o(function(n){var u=n;var r=u.g();r.a().b()>0&&_at.Q.b(r.a().a(0),t)&&r.a().a(0).be().n(function(n){var t=n;(!t.a()||_dg.c.isInstanceOfType(t))&&i(r.a().a(0),t)})})};_at.Q.b=function(n,t){return!!n.be()&&!n.bD.IsDraft&&!(t&&_g.b.a.doesIdEqualName(n.bD.ParentFolderId,"deleteditems"))};_at.A=function(){this.g=new FileReader};_at.A.prototype={g:null,h:null,b:function(){return this.g.error},d:function(){return this.h},c:function(){return this.g.result},f:function(n){this.g.onloadend=n;return n},e:function(n){if(_db.Z.isInstanceOfType(n)){var i=n;this.g.readAsDataURL(i.c)}else if(_h.bq.isInstanceOfType(n)){var t=n;this.g.readAsDataURL(t.c)}},a:function(n,t,i,r,u){var f=this;this.g.onloadend=function(){if(!f.g.error&&f.g.result){var h=f.g.result.indexOf(",");var l=f.g.result.substring(h+1,f.g.result.length);var c=null;var e=0,o=0;if(u&&f.g.result.length>10&&f.g.result.substring(0,10)==="data:image"){var s=document.createElement("canvas");var a=s.getContext("2d");var n=new Image;n.onload=function(){if(n.height<n.width){o=50;n.height&&(e=o*n.width/n.height)}else{e=50;n.width&&(o=e*n.height/n.width)}_j.e.a(r,"Attachments canvas width={0}, height={1}",e,o);if(e&&o){s.width=e;s.height=o;try{a.drawImage(n,0,0,e,o);c=s.toDataURL("image/jpeg",1)}catch(i){_j.e.b(r,"Failed to get thumbnail with error {0}, ",i.message)}}f.i(f.g.result,l,h,t,c,e,o,r)};n.onerror=function(){_j.e.b(r,"Failed to load thumbnail into image object to get client thumbnail");f.i(f.g.result,l,h,t,c,e,o,r)};n.src=f.g.result}else f.i(f.g.result,l,h,t,c,e,o,r)}else{_j.e.b(r,"File reader failed with error code {0}",f.g.error);i()}};try{this.e(n)}catch(e){this.h=e;_a.o.a().I&&e.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(r,"Firefox: failed to read an attachment. Exception: {0}",e.message):_j.e.b(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+e.message);i()}},i:function(n,t,i,r,u,f,e,o){_j.e.a(o,"No error - Reading the file.");n.substring(0,i).indexOf("base64")!==-1?r(t,u,f,e):r(_a.bh.a(t),u,f,e)}};_at.bb=function(){};_at.bb.prototype={a:function(){return new _at.A}};_at.K=function(){};_at.K.b=function(){try{var n="dummyKey";var t="dummyValue";sessionStorage.setItem(n,t);sessionStorage.removeItem(n);return!0}catch(i){return!1}};_at.K.prototype={a:function(n){return sessionStorage.getItem(n)},b:function(n,t){sessionStorage.setItem(n,t)},c:function(n){sessionStorage.removeItem(n)}};_at.q=function(){this.b={}};_at.q.a=function(){_at.q.b||(_at.q.b=new _at.q);return _at.q.b};_at.q.prototype={a:function(n,t){this.b[n]=new _at.q.c(t)},c:function(n){if(n in this.b){var t=this.b[n];if(t.c())delete this.b[n];else return t.a}return null}};_at.q.c=function(n){this.a=n;this.b=Date.now()+36e5};_at.q.c.prototype={b:0,a:null,c:function(){return this.b<Date.now()}};_at.h=function(){};_at.h.g=function(){return _at.h.c("SharepointGroupProvider")};_at.h.c=function(n){if(n in _at.h.a){var t=_at.h.a[n];if(t&&t.AccessTokenExpiry){var i=_a.d.b(t.AccessTokenExpiry);return!!i&&_a.d.get_utcNow().o(1).b(i)<0}}return!1};_at.h.b=function(n,t,i,r,u){var e=r?"SharepointGroupProvider":_g.q.toString(n);if(_at.h.c(e)){var f=_at.h.a[e];var o=_a.d.b(f.AccessTokenExpiry);t&&t(f.AccessToken);_a.d.get_utcNow().o(30).b(o)>0&&_at.h.e(n,null,null,r,u);return}_at.h.e(n,t,i,r,u)};_at.h.e=function(n,t,i,r,u){var e;var o=(e=new _dg.cu,e.DataProviderType=n,e.IsGroupRequest=r,e);var f=_at.h.f();f.onreadystatechange=function(){if(f.readyState===4){var o=Sys.Serialization.JavaScriptSerializer.deserialize(f.responseText);var e=r?"SharepointGroupProvider":_g.q.toString(n);_at.h.h(o,e,t,i,u)}};f.open("GET",_g.C.p(),!0);f.setRequestHeader("X-OWA-UrlPostData",encodeURI(Sys.Serialization.JavaScriptSerializer.serialize(o)));_at.h.i(f);f.send(null)};_at.h.i=function(n){n.setRequestHeader("X-OWA-Action","GetAccessTokenforDataProvider");n.setRequestHeader(_a.w.c(),_a.w.e())};_at.h.h=function(n,t,i,r,u){if(n.TokenResultCode||_j.h.a(n.AccessToken)){var f=String.format("Access token request failed for token key {0} with response code {1}",t,n.TokenResultCode.toString());_j.e.b(_a.a.c,f);if(n.TokenResultCode===3&&u){_j.e.b(_a.a.c,"Invoking reauth callback. User will need to re-authenticate.");u()}else r&&r(Error.create(f))}else{_at.h.a[t]=n;i&&i(n.AccessToken)}};_at.h.f=function(){return _at.h.d?_at.h.d():new XMLHttpRequest};_at.o=function(){};_at.o.e=function(n,t,i,r){var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=t?n.thumbnailLink:n.webContentLink;i(e)}else if(r){var f=Error.create(String.format("XHR GetContentUrl for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};var f="https://www.googleapis.com/drive/v3/files"+(t?"/{0}?fields=thumbnailLink":"/{0}?fields=webContentLink");f=String.format(f,n);u.open("GET",f,!0);_at.o.a(u,null,r,null)};_at.o.g=function(n,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4)if(r.status===200)t(Sys.Serialization.JavaScriptSerializer.deserialize(r.responseText));else if(i){var n=Error.create(String.format("XHR GetMimeType for GDrive failed with statusCode: {0}, response body: {1}",r.status,r.responseText));i(n)}};var u=String.format("https://www.googleapis.com/drive/v3/files/{0}?fields={1}",n,"mimeType");r.open("GET",u,!0);_at.o.a(r,null,i,null)};_at.o.h=function(n,t,i,r){var f="name";var e="";switch(t.Paging.Sort.SortColumn){case 2:f="modifiedTime";break;case 1:f="quotaBytesUsed";break}e=t.Paging.Sort.SortOrder?"desc":"asc";var o=t.Paging.Location;var s=String.format("{0}&orderBy=folder,{1} {2}&q=mimeType!='application/octet-stream' and trashed=false and '{3}' in parents","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",f,e,_j.h.a(o)?"root":o);var h=String.format("{0}?{1}","https://www.googleapis.com/drive/v3/files",s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var o=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.o.c(o,t.AttachmentDataProviderId);i(n,e)}else{var f=Error.create(String.format("XHR GetItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};u.open("GET",h,!0);_at.o.a(u,null,r,function(){var t;var r=(t=new _gg.dZ,t.ResultCode=2,t);i(n,r)})};_at.o.c=function(n,t){var r=_at.o.b(n,t);var i;return i=new _gg.dZ,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.o.i=function(n,t,i,r){var e=t.Paging.Location;var o=t.Query;var f=_j.h.c("{0}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '{1}'","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",o);_j.h.a(e)||(f=f+_j.h.c(" and '{0}' in parents",e));var s=_j.h.c("{0}?{1}","https://www.googleapis.com/drive/v3/files",f);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var o=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.o.d(o,t.AttachmentDataProviderId);i(n,e)}else{var f=Error.create(_j.h.c("XHR SearchItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};u.open("GET",s,!0);_at.o.a(u,null,r,null)};_at.o.d=function(n,t){var r=_at.o.b(n,t);var i;return i=new _gg.jI,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.o.f=function(n){var t=n.indexOf("/d/");return n.substring(t+3,n.indexOf("/",t+3))};_at.o.a=function(n,t,i,r){_at.h.b(5,function(i){_at.o.j(n,i);n.send(t)},i,!1,r)};_at.o.j=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.o.b=function(n,t){for(var e=new Array(n.files.length),u=0;u<n.files.length;u++){var r=n.files[u];var f,i;var o=(i=new _gg.H,i.Name=r.name,i.Size=parseInt(r.size),i.Thumbnail=(f=new _gg.fV,f.Url=r.thumbnailLink,f),i.Modified=r.modifiedTime,i.MimeType=r.mimeType,i.Location=r.id,i.Id=r.id,i.AttachmentProviderId=t,i.ProviderType=5,i.Type=r.mimeType==="application/vnd.google-apps.folder"?1:0,i);e[u]=o}return e};_at.bQ=function(){};_at.bQ.prototype={files:null};_at.bR=function(){};_at.bR.prototype={id:null,name:null,mimeType:null,thumbnailLink:null,webContentLink:null,modifiedTime:null,size:null};_at.f=function(){};_at.f.m=function(n,t,i,r,u,f){i?_at.f.n(n,t,!0,r,u,f):f(Error.create("Can't get file metadata for non-sharing link"))};_at.f.n=function(n,t,i,r,u,f){var o=null;if(i){var s=_at.f.o(t);o=String.format("{0}/{1}/u!{2}/root?expand=thumbnails(select=small,large)",n,"_api/v2.0/shares",s)}else o=String.format("{0}/{1}:/{2}?expand=thumbnails(select=small,large)",n,"_api/v2.0/drive/root",t);var e=_at.f.a();e.onreadystatechange=function(){if(e.readyState===4)if(e.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(e.responseText);var r=n["@content.downloadUrl"];var o=_at.f.f(n,0);var t=_at.f.f(n,1);u(r,o,t)}else if(f){var i=Error.create(String.format("XHR GetFileMetadata failed with statusCode: {0}, response body: {1}",e.status,e.responseText));f(i)}};e.open("GET",o,!0);_at.f.c(e,null,f,r)};_at.f.j=function(n,t,i,r,u,f,e,o){var h=String.format("{0}/content?{1}",_at.f.e(n,t,i),"@name.conflictBehavior=rename");var s=_at.f.a();s.onreadystatechange=function(){if(s.readyState===4)if(s.status===200||s.status===201){var t=Sys.Serialization.JavaScriptSerializer.deserialize(s.responseText);f(t,!0)}else{var n=Error.create(String.format("XHR UploadAsSingleSlice failed with statusCode: {0}, response body: {1}",s.status,s.responseText));e(n)}};u&&_at.f.g(u,s);s.open("PUT",h,!0);_at.f.i(s,r,e,o)};_at.f.d=function(n,t,i,r,u,f){var o=String.format("{0}/upload.createSession",_at.f.e(n,t,i));var s='{ "item": {"@name.conflictBehavior": "rename"} }';var e=_at.f.a();e.open("POST",o,!0);e.setRequestHeader("Content-Type","application/json");e.onreadystatechange=function(){if(e.readyState===4)if(e.status===200){var i=Sys.Serialization.JavaScriptSerializer.deserialize(e.responseText);var t=i.uploadUrl;r(t)}else{var n=Error.create(String.format("CreateAttachment XHR failed with statusCode: {0}, response body: {1}",e.status,e.responseText));u(n)}};_at.f.c(e,s,u,f)};_at.f.k=function(n,t,i,r,u,f,e,o,s){var h=_at.f.a();h.onreadystatechange=function(){if(h.readyState===4)if(h.status===200||h.status===201){var t=Sys.Serialization.JavaScriptSerializer.deserialize(h.responseText);e(t,!0)}else if(h.status===202)e(null,!1);else{var n=Error.create(String.format("XHR UploadSlice failed with statusCode: {0}, response body: {1}",h.status,h.responseText));o(n)}};f&&_at.f.g(f,h);h.open("PUT",n,!0);var c=i*r;var l=Math.min(c+r,u);h.setRequestHeader("Content-Range",String.format("bytes {0}-{1}/{2}",c,Math.max(0,l-1),u));_at.f.i(h,t,o,s)};_at.f.l=function(n,t){var i=_at.f.a();i.open("DELETE",n);_at.f.c(i,null,null,t)};_at.f.f=function(n,t){var i=n.thumbnails;if(!i||!i.length)return null;var r=t?i[0].large:i[0].small;return r?r.url:null};_at.f.o=function(n){return _a.bh.a(n).replace("+","-").replace("/","_").replace("=","")};_at.f.i=function(n,t,i,r){_at.h.b(0,function(i){_at.f.h(n,i);_at.f.p(t,n)},i,r,null)};_at.f.c=function(n,t,i,r){_at.h.b(0,function(i){_at.f.h(n,i);n.send(t)},i,r,null)};_at.f.h=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.f.g=function(n,t){t.upload.onprogress=n};_at.f.p=function(n,t){t.send(n)};_at.f.e=function(n,t,i){var r=null;r=_j.h.a(t)?String.format("{0}/{1}:/{2}:",n,"_api/v2.0/drive/root",i):String.format("{0}/{1}:/{2}/{3}:",n,"_api/v2.0/drive/root",t,i);return r};_at.f.a=function(){return _at.f.b?_at.f.b():new XMLHttpRequest};_at.f.t=function(){};_at.f.t.prototype={name:null,webUrl:null,size:0,id:null,file:null,folder:null,parentReference:null,thumbnails:null,lastModifiedDateTime:null};_at.f.r=function(){};_at.f.r.prototype={childCount:0};_at.f.q=function(){};_at.f.q.prototype={mimeType:null};_at.f.w=function(){};_at.f.w.prototype={id:null,small:null,medium:null,large:null};_at.f.v=function(){};_at.f.v.prototype={height:null,width:null,url:null};_at.f.s=function(){};_at.f.s.prototype={value:null};_at.f.u=function(){};_at.f.u.prototype={id:null,path:null};_at.x=function(n){_at.x.initializeBase(this);this.g=n};_at.x.b=function(){_at.x.a={}};_at.x.prototype={d:null,g:0,L:function(n){var i=new _gg.ru(this.M);var t=new _gg.hc;t.ClientVersion=this.g;n.bA(t,i,this.K,this.J)},cU:function(n,t,i){try{this.d=new Array(n.length);for(var r=0;r<n.length;r++){var u=n[r].Id;_at.x.a[u]||(_at.x.a[u]=_a.m.d(_gg.t,n[r],_gg.t));this.d[r]=_at.x.a[u]}t()}catch(f){i(f)}}};_at.bk=function(n){_at.bk.initializeBase(this);this.d=n};_at.bk.prototype={d:null,L:function(n){var t=new _gg.nY(this.M);n.Y(this.d,t,this.K,this.J)},cU:function(n,t,i){n?t():i(null)}};_at.bl=function(n){_at.bl.initializeBase(this);this.d=new _gg.fX;this.d.cancellationId=n};_at.bl.prototype={d:null,L:function(n){var t=new _gg.nZ(this.M);n.Z(this.d,t,this.K,this.J)},cU:function(n,t,i){n?t():i(null)}};_at.bm=function(n){_at.bm.initializeBase(this);this.d=new _gg.fY;this.d.cancellationId=n};_at.bm.prototype={d:null,L:function(n){var t=new _gg.oa(this.M);n.ba(this.d,t,this.K,this.J)},cU:function(n,t,i){n?t():i(null)}};_at.bn=function(n){_at.bn.initializeBase(this);this.d=n};_at.bn.prototype={d:null,L:function(n){var t=new _gg.ob(this.M);n.dy(this.d,t,this.K,this.J)},cU:function(n,t,i){n?t():i(null)}};_at.bo=function(n,t){_at.bo.initializeBase(this);this.d=new _gg.gd;this.d.ewsAttachmentId=n;this.d.itemId=t};_at.bo.prototype={d:null,g:null,L:function(n){var t=new _gg.oF(this.M);n.dD(this.d,t,this.K,this.J)},cU:function(n,t,i){try{_a.b.a(n,"result");if(n.ErrorMessage)throw Error.create(n.ErrorMessage);this.g=n.ContentId;t()}catch(r){i(r)}}};_at.bp=function(n,t,i,r){_at.bp.initializeBase(this);this.g=new _gg.ge;this.g.subscriptionId=i;this.g.ewsAttachmentId=n;this.g.itemId=t;this.g.channelId=_no.a.a;this.g.cancellationId=r;this.d=n.Id};_at.bp.prototype={g:null,d:null,L:function(n){var t=new _gg.oM(this.M);n.bd(this.g,t,this.K,this.J)},cU:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.bq=function(n,t,i,r,u,f,e){_at.bq.initializeBase(this);this.d=new _gg.gf;this.d.attachmentDataProviderId=t;this.d.ewsAttachmentId=n.Id;this.d.emailId=i;this.d.subscriptionId=r;this.d.channelId=_no.a.a;this.d.cancellationId=e;this.d.fullPathLocation=u;this.d.PermissionLevel=f;this.g=n.Id};_at.bq.prototype={d:null,g:null,L:function(n){var t=new _gg.oN(this.M);n.be(this.d,t,this.K,this.J)},cU:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.l=function(n,t,i,r,u,f,e,o,s,h){_at.l.initializeBase(this);this.l=n;this.g=t;this.r=i;this.t=r;this.s=s;this.k=h;this.q=u;this.v=f;this.u=e;this.w=o};_at.l.b=function(){var n=new XMLHttpRequest;return n.upload&&n.upload.onprogress!==undefined};_at.l.d=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_j.e.c(_at.l.a,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.h(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.f(e.Size||0);t.j(e.ContentType);t.a()&&t.o(e.ContentId);u(o)}}else{_j.e.c(_at.l.a,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_j.e.c(_at.l.a,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_j.e.c(_at.l.a,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.l.c=function(n,t,i,r){if(!n.IsCancelled){n.Attachments.length>0&&t.h(n.Attachments[0].AttachmentId);if(r){t.a()&&t.o(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.f(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}}};_at.l.prototype={v:!1,l:0,g:null,r:null,d:null,t:null,s:0,k:0,q:null,j:null,i:null,u:null,w:!1,bl:function(){if(this.H||!this.R||!this.R.response){_j.e.a(_at.l.a,"No success response because there's an error, or action is not complete.  Error: {0}",this.H);return null}return this.R.response.result},bc:function(){return this.u&&_at.l.b()?this.bm():_h.co.prototype.bc.call(this)},bg:function(){var n=null;!_j.h.a(this.q)&&this.v?n=this.q:this.d.Body&&this.d.Body.ParentItemId&&_a.cb.a(this.d.Body.ParentItemId.Id)&&(n=_g.a.a().c().bD.DefaultPublicFolderMailbox);return n},bm:function(){var n=new XMLHttpRequest;var t=this;n.onreadystatechange=function(){if(n.readyState===4)if(n.status===200){var r=Sys.Serialization.JavaScriptSerializer.deserialize(n.responseText);t.bh(t.R,r)}else{var i=Error.create(String.format('CreateAttachment XHR failed with statusCode: "{0}", response body: "{1}"',n.status,n.responseText));t.bb(i)}};var r=this;var u=function(n){var t=Math.round(n.loaded*100/n.total);r.u(t)};n.upload.onprogress=u;n.open("POST",_g.C.n(),!0);this.d=this.G();this.bn(n);var i=Sys.Serialization.JavaScriptSerializer.serialize(this.d);if(_dg.d.isInstanceOfType(this.g)&&this.w){n.setRequestHeader("X-OWA-UrlPostData",encodeURI(i));n.send(this.g.c)}else n.send(i);return 1},bn:function(n){n.setRequestHeader("X-OWA-Action","CreateAttachmentFromLocalFile");n.setRequestHeader(_a.w.c(),_a.w.e());var t=this.bg();_j.h.a(t)||n.setRequestHeader("X-OWA-ExplicitLogonUser",t)},L:function(n){this.d=this.G();if(this.t){this.j=new _gg.oU(this.M);this.j.explicitLogonUser=this.bg();this.j.clientStoreItem=this.l;this.j.isQueued=!1;this.j.palContext=new _g.eT(!1);n.bg(this.d,this.j,this.K,this.J)}else{this.i=new _gg.lQ(this.M);this.i.explicitLogonUser=this.bg();this.i.clientStoreItem=this.l;this.i.isQueued=!1;this.i.palContext=new _g.eT(!1);n.d(this.d,this.i,this.K,this.J)}},cJ:function(n){this.bj(n)},bj:function(n){_at.l.c(n,this.g,this.r,this.k<=this.s+1)},G:function(){var i=new _g.f(this.r.Id);i.ChangeKey=this.r.ChangeKey;var t=this.g.v();var n=new _gg.dI(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.t;if(this.k!==1){n.SliceNumber=this.s;n.TotalSlices=this.k}return new _gg.dH(this.N(),n)}};_at.br=function(n,t,i,r,u,f){_at.br.initializeBase(this,[n,t,i,r,u,f,null,!1,0,1]);var e=t.c;this.bi=e};_at.br.prototype={bi:null,L:function(n){var u=this.G();var t=new _gg.lQ(this.M);this.v&&(t.explicitLogonUser=this.q);t.clientStoreItem=this.l;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.eT(!0);t.dataFile=this.bi.g();n.d(u,t,this.K,this.J)},cJ:function(n){this.bj(n)}};_at.O=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_at.O.initializeBase(this);this.q=n;this.g=t;this.r=i;this.d=u;this.u=f;this.i=r;this.j=e;this.k=o;this.w=s;this.t=h;this.p=c;this.v=l;this.s=a};_at.O.prototype={q:null,g:null,r:null,d:null,u:null,i:null,j:null,k:null,w:null,t:null,p:!1,v:!1,s:null,l:null,L:function(n){var t=new _gg.pj(this.M);this.v&&(t.explicitLogonUser=this.d);_j.h.a(this.d)||(t.actionName="CreateReferenceAttachmentFromAttachmentDataProviderInGroupAction");n.bk(this.q,this.g,this.r,this.i,this.j,this.u,t,this.K,this.J,this.k,this.w,this.t,this.p,this.s)},cU:function(n,t,i){try{_a.b.a(n,"result");this.l=n;t()}catch(r){i(r)}}};_at.bs=function(n,t,i){_at.bs.initializeBase(this);this.j=n;this.g=t;this.d=i;this.i=t.bD.AttachmentId||t.bD.TemporaryId};_at.bs.prototype={j:0,g:null,i:null,d:null,cJ:function(n){this.d.Id=n.RootItemId.RootItemId;this.d.ChangeKey=n.RootItemId.RootItemChangeKey;this.g.bD.TemporaryId&&this.g.h(this.g.bD.TemporaryId)},L:function(n){var r=new _gg.dM;r.ClientSupportsIrm=!0;var i=new _gg.pz(this.M);i.itemContexts=new Array(1);var t=new _gg.EA;t.clientStoreItem=this.j;t.parentItemId=new _g.f(this.d.Id);t.parentItemId.ChangeKey=this.d.ChangeKey;r.AttachmentIds=[new _g.bk(this.i.Id)];var u=new _gg.gq(this.N());u.Body=r;i.itemContexts[0]=t;n.s(u,i,this.K,this.J)}};_at.bt=function(n){_at.bt.initializeBase(this);this.g=n};_at.bt.prototype={g:null,d:null,L:function(n){var t=new _gg.ro(this.M);n.bz(this.g,t,this.K,this.J)},cU:function(n,t,i){if(_j.h.b(n))i(Error.create("AddIns is null or empty."));else{this.d=n;t()}}};_at.G=function(n,t,i){_at.G.initializeBase(this);this.g=n;this.i=t;this.T=i};_at.G.prototype={g:null,d:null,i:!1,N:function(){return this.X("Exchange2015")},L:function(n){var i=new _dg.de(this.M);i.explicitLogonUser=this.T;var t=new _gg.he(this.N());t.Body.AttachmentIds=[new _g.bk(this.g)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.b.Y();if(this.i){t.Header.ManagementRole=new _g.cS;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.bB(t,i,this.K,this.J)},cJ:function(n){var t=null;var u=n.Attachments.length;u!==1&&(t="GetAttachment response length = "+u);var r=n.Attachments[0];r||(t="GetAttachment response contained null attachment");var i=_a.m.d(_dg.i,r);this.d=i.l();this.d||(t="GetAttachment response contained null item");t?_j.e.b(_a.a.c,t):_j.e.a(_a.a.c,"GetAttachment succeeded for '{0}' on '{1}'",i.bD.Name,this.d.bD.Subject)}};_at.bu=function(n,t,i){_at.bu.initializeBase(this);this.g=n;this.d=t;this.j=i;this.i=t.bD.AttachmentId||t.bD.TemporaryId;if(!_dg.d.isInstanceOfType(t)&&!_dg.i.isInstanceOfType(t)&&!_g.B.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.bu.prototype={g:null,d:null,i:null,j:null,bc:function(){if(_dg.d.isInstanceOfType(this.d)){var n=this.d;if(_a.ft.isInstanceOfType(n.c)&&!n.u){var u=n.c;var r=new _at.bb;var f=r.a();var t=this,i=this;f.a(u,function(i,r,u,f){n.l(t.k(i));t.Y(null)},function(){var t=String.format("Unable to read content of file {0}.",n.bD.Name);_j.e.b(i.g,t);i.Y(Error.create(t))},this.g,!1);return 1}else if(n.u&&n.bD.Content&&n.bD.Content.length>0){this.Y(null);return 1}else return this.l()}else return _dg.i.isInstanceOfType(this.d)?this.l():_h.co.prototype.bc.call(this)},cU:function(n,t,i){var r=this.d;if(_j.h.a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.bD.ItemId.Id)));else{r.t(this.k(n));t()}},L:function(n){var t=new _g.f(this.d.bD.ItemId.Id);n.cb(t,null,this.K,this.J)},l:function(){var t=new XMLHttpRequest;var r=_dg.i.isInstanceOfType(this.d)?_g.C.a():_g.C.h();var i=String.format(r,encodeURIComponent(this.i.Id));_j.h.a(this.j)||(i=String.format("{0}/{1}",this.j,i));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.k(t.responseText);_dg.d.isInstanceOfType(n.d)?n.d.l(r):_dg.i.isInstanceOfType(n.d)&&n.d.t(r);n.Y(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.i.Id,t.responseText,t.statusText);_j.e.c(n.g,i);n.Y(Error.create(i))}};t.open("GET",i,!0);_a.p.H(t);t.send(null);return 1},k:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};_at.k=function(n){_at.k.initializeBase(this);this.d=n};_at.k.e=function(n){var t=_at.k.c(n);return t?t.FolderName:null};_at.k.d=function(n){var t=_at.k.c(n);return t?t.FolderId:null};_at.k.f=function(){return _at.k.b>=2?!0:!1};_at.k.c=function(n){if(_j.h.a(n)){_j.e.a(_a.a.c,"An invalid key was passed in as an argument.");return null}if(!_at.k.a||!(n in _at.k.a)){_j.e.a(_a.a.c,String.format("No response objects were cached with the given key: {0}",n));return null}return _at.k.a[n]};_at.k.prototype={d:null,i:null,g:null,L:function(n){var t=new _gg.rC(this.M);t.explicitLogonUser=this.d;n.bF(t,this.K,this.J);this.d||_at.k.b++},cU:function(n,t,i){if(!n){i(Error.create("Failed to get valid properties of the default upload folder."));return}var r=this.d||"PersonalOneDriveKey";_at.k.a||(_at.k.a={});this.g=n.FolderName;this.i=n.FolderId;_at.k.a[r]=n;t()}};_at.bv=function(n,t,i,r,u,f,e){_at.bv.initializeBase(this,[n,t,i,r,u,f]);this.g="GetSuiteExtensionsAttachmentInfo";this.r=_j.h.b(e)?null:e};_at.bv.prototype={r:null,L:function(n){var t=new _gg.rE(this.M);this.k&&(t.explicitLogonUser=this.k);this.g+=this.p?"Cloudy":"Classic";this.g+=this.i?"Edit":"Preview";t.actionName=this.g;this.l&&(t.isDiscovery=!0);n.eL(this.j,this.i,this.q,t,this.K,this.J,this.r)},cU:function(n,t,i){this.d=n;if(this.d)if(this.d.Status){var u=Error.create("GetAttachmentInfo was not successful.");i(u)}else{this.i||_at.q.a().a(this.j,this.d);t()}else{var r=new _dg.bn;r.Status=1;r.WacUrl="";this.d=r;i(Error.create("Server unavailable."))}}};_at.bS=function(n,t,i,r,u,f){_at.bS.initializeBase(this);this.j=n;this.i=t;this.q=i;this.p=r;this.k=u;this.l=f};_at.bS.prototype={d:null,g:"GetAttachmentInfo",j:null,i:!1,q:null,p:!1,k:null,l:!1};_at.Z=function(n,t,i,r,u,f){_at.Z.initializeBase(this,[n,t,i,r,u,f]);this.g="GetWacAttachmentInfo"};_at.Z.prototype={L:function(n){var t=new _gg.vw(this.M);this.k&&(t.explicitLogonUser=this.k);this.g+=this.p?"Cloudy":"Classic";this.g+=this.i?"Edit":"Preview";t.actionName=this.g;this.l&&(t.isDiscovery=!0);n.cz(this.j,this.i,this.q,t,this.K,this.J,null)},cU:function(n,t,i){this.d=n;if(this.d)if(this.d.Status){this.i||this.d.Status!==9||_at.q.a().a(this.j,this.d);var u=Error.create("GetWacAttachmentInfo was not successful. The status is "+this.d.Status.toString());i(u)}else{this.i||_at.q.a().a(this.j,this.d);t()}else{var r=new _dg.bn;r.Status=1;r.WacUrl="";this.d=r;i(Error.create("Server unavailable."))}}};_at.H=function(n,t,i,r,u,f,e,o){_at.H.initializeBase(this,[_at.i.e(n),t,i,r,f,e]);this.s=n;this.g="GetWacInfoAction";this.r=o};_at.H.prototype={s:null,r:null,L:function(n){var i=new _gg.vy(this.M);this.k&&(i.explicitLogonUser=this.k);this.g+=this.p?"Cloudy":"Classic";this.g+=this.i?"Edit":"Preview";_j.h.a(this.r)||(this.g+=this.r);i.actionName=this.g;this.l&&(i.isDiscovery=!0);var t=new _gg.iv;t.Url=this.j;t.IsEdit=this.i;t.ProviderType=0;n.gx(t,i,this.K,this.J)},cU:function(n,t,i){this.d=n;if(this.d)if(this.d.Status){this.i||this.d.Status!==9||_at.q.a().a(this.j,this.d);var u=Error.create("GetWacInfo was not successful. The status is "+this.d.Status.toString());i(u)}else{this.i||_at.q.a().a(this.j,this.d);t()}else{var r=new _dg.bn;r.Status=1;r.WacUrl="";this.d=r;i(Error.create("Server unavailable."))}}};_at.P=function(n,t,i,r,u){_at.P.initializeBase(this);this.d=new _gg.jD;this.d.subscriptionId=i;this.d.ewsAttachmentId=n;this.d.channelId=_no.a.a;this.d.itemId=t;this.d.groupSmtpAddress=r;this.g=u};_at.P.prototype={d:null,g:null,L:function(n){var t=new _gg.zI(this.M);t.actionName="SaveAttachmentsToCloud";if(!_j.h.a(this.d.groupSmtpAddress)){t.explicitLogonUser=this.d.groupSmtpAddress;t.actionName+="_Group"}_j.h.a(this.g)||(t.actionName+=this.g);n.cN(this.d,t,this.K,this.J)},cU:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.ba=function(n,t,i,r){_at.ba.initializeBase(this);this.i=n;this.j=t;this.g=i;this.l=r};_at.ba.prototype={i:null,j:0,k:!1,g:null,l:!1,p:null,d:!1,L:function(n){var i=new _gg.At(this.M);var t=new _gg.eW;t.AttachmentIds=this.i;t.PermissionLevel=this.j;t.NewAttachLongPathNames=this.g;t.SetToOriginalPermissionLevel=this.l;n.cT(t,i,this.K,this.J)},cU:function(n,t,i){this.k=!0;if(n&&n.OperationSucceeded){this.p=n;t()}else i(Error.create("Error setting attachment permissions"))}};_at.bT=function(){};_at.bT.prototype={changePermission:0,convertLocalToRef:1,convertRefToLocal:2,copyLinkToClipboard:3,download:4,importIcsAttachment:5,moveAttachmentToInline:6,openInNewTab:7,preview:8,saveToCloud:9,viewInProvider:10,openInASeparateWindow:11,openInClient:12};_at.bT.registerEnum("_at.bT",!1);_at.bX=function(){};_at.bX.registerInterface("_at.bX");_at.bf=function(){};_at.bf.registerInterface("_at.bf");_at.ca=function(){};_at.ca.registerInterface("_at.ca");_at.bL=function(){};_at.bL.prototype={wacPreview:0,documentPreview:1};_at.bL.registerEnum("_at.bL",!1);_at.bZ=function(){};_at.bZ.registerInterface("_at.bZ");_at.bg=function(){};_at.bg.registerInterface("_at.bg");_at.bh=function(){};_at.bh.registerInterface("_at.bh");_at.m=function(){};_at.m.registerInterface("_at.m");_at.be=function(){};_at.be.registerInterface("_at.be");var ILightBoxViewModelFactory=function(){};ILightBoxViewModelFactory.registerInterface("ILightBoxViewModelFactory");_at.B=function(){};_at.B.registerInterface("_at.B");_at.bY=function(){};_at.bY.registerInterface("_at.bY");_at.p=function(n,t){this.d=new _at.W;this.b=new _at.W;this.f=t;this.e=n};_at.p.c=function(n,t){var i;var u,r;return(r=_at.p.b(t,u={val:i}),i=u.val,r)?_at.p.a(n,i):null};_at.p.a=function(n,t){switch(t){case 0:return new _at.v(n,_u.n.Eq);case 1:return new _at.E(n,_u.n.Kx);case 2:return new _at.T(n,_u.n.Os);case 3:return new _at.S(n,_u.n.DW);case 5:return new _at.u(n,_u.n.Fg);case 4:return new _at.U(n,_u.n.Kx);case 6:return new _at.bH(n,_u.n.Ng);case 7:return new _at.M(n,_u.n.DW);case 8:return new _at.M(n,_u.n.D);default:_j.e.b(_a.a.c,"TryParseDataProviderType: unimplemented data provider type: {0}",t);return null}};_at.p.b=function(n,t){try{t.val=_j.t.b(_g.q,n);return!0}catch(i){t.val=null;_j.e.b(_a.a.c,"TryParseDataProviderType: unknown data provider type: {0}",n);return!1}};_at.p.prototype={f:!1,e:null,h:function(){return this.b.f()>0},i:function(n){this.b!==n&&(this.b=n);return n},a:function(){return this.f?this.c(1):this.c(0)},g:function(n){var t;var r,i;return(i=_at.p.b(n,r={val:t}),t=r.val,i)?this.c(t):null},c:function(n){if(this.d.d(n))return this.d.e(n);var t=_at.p.a(this.e,n);t&&this.d.b(n,t);return t}};_at.C=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.k=n;this.f=t;this.m=i;this.g=r;this.c=u;this.d=f;this.p=e;this.l=o;this.i=s;this.a=h;this.h=c;this.j=l;this.e=a;this.o=v;this.n=y;this.b=p};_at.C.prototype={k:null,f:null,m:null,g:null,c:null,d:null,p:null,l:null,i:null,a:null,h:null,j:null,e:null,o:null,n:null,b:null};_at.D=function(n,t,i,r,u){this.b=_j.h.a(n)?"#":n;this.d=t;this.a=i;this.c=r;this.f=u;this.e=u?_nbs.a.UT:_nbs.a.KC;_j.e.a(_a.a.c,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.c,this.d,this.e,this.b)};_at.D.c=function(n,t,i){_a.b.a(n,"viewModel");_a.b.a(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.D.b(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.D.a(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.b.isInstanceOfType(n)){var a=n;a.bI.a()&&(r=!0)}return new _at.D(f,r,u,!1,t)};_at.D.a=function(n,t,i,r){var u=!1;if(_at.b.isInstanceOfType(n)){var f=n;u=f.bI.a()}if(!n.bn.e||u||n.bn.f||n.bj.bD.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.bS;return}switch(n.bn.a){case 3:i.val=!1;t.val=n.bv;r.val=n.gw;break;case 2:i.val=!0;r.val=n.bS;t.val=n.bv;break;case 1:i.val=!0;t.val="#";r.val=n.bS;break;case 0:default:i.val=!0;t.val="#";r.val=n.bS;break}};_at.D.b=function(n,t,i,r){if(n.bj.bD.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.bS;return}switch(n.bp()){case 5:i.val=!0;t.val="#";r.val=n.eq;break;case 3:i.val=!0;t.val="#";r.val=n.cW;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.bn.a===3?new _j.g(function(){n.bk&&n.bk.cr(n)},_a.a.c):n.bS;break;default:_at.D.a(n,t,i,r);break}};_at.D.prototype={d:!1,b:null,a:null,e:null,c:!1,f:!1};_at.w=function(n,t,i,r,u){this.c=n;this.e=t;this.d=i;this.b=r;this.a=u};_at.w.prototype={c:null,a:!1,e:null,d:0,b:0};_at.bF=function(n,t,i,r,u){_at.bF.initializeBase(this,[1,"AttachmentUploadDatapoint"]);this.a.S=n;this.a.T=t.toString();this.a.E=i;this.a.X=r;this.a.Z=u.toString()};_at.R=function(n){_at.R.initializeBase(this);this.e=n;var t=this;this.d=new _j.g(function(){t.a(!1)},_a.a.c)};_at.R.prototype={b:!1,e:!1,d:null,c:function(){return this.b},a:function(n){if(this.b===n)return n;this.b=n;this.eB("IsShown");return n},o:function(){return 600},p:function(){return 300},h:function(){return!0}};_at.a=function(n,t,i,r,u,f,e,o,s,h,c){this.ha=Function.createDelegate(this,this.jn);this.hb=Function.createDelegate(this,this.jo);this.hp=Function.createDelegate(this,this.kt);this.hq=Function.createDelegate(this,this.ku);this.hn=Function.createDelegate(this,this.kr);this.ho=Function.createDelegate(this,this.ks);this.fl=Function.createDelegate(this,this.jv);this.fo=Function.createDelegate(this,this.kw);this.hj=Function.createDelegate(this,this.kd);this.hk=Function.createDelegate(this,this.ke);this.hi=Function.createDelegate(this,this.jw);this.fm=Function.createDelegate(this,this.jx);this.gT=Function.createDelegate(this,this.jg);this.gU=Function.createDelegate(this,this.hJ);this.fk=Function.createDelegate(this,this.hK);this.dH=Function.createDelegate(this,this.ig);this.dF=Function.createDelegate(this,this.cm);this.dG=Function.createDelegate(this,this.dS);this.hl=Function.createDelegate(this,this.ko);this.hf=Function.createDelegate(this,this.js);this.hg=Function.createDelegate(this,this.jt);this.hs=Function.createDelegate(this,this.kx);this.ht=Function.createDelegate(this,this.ky);this.fn=Function.createDelegate(this,this.kf);this.hd=Function.createDelegate(this,this.hL);this.hr=Function.createDelegate(this,this.kv);this.he=Function.createDelegate(this,this.jr);this.fj=Function.createDelegate(this,this.fy);this.hE=Function.createDelegate(this,this.lv);this.gW=Function.createDelegate(this,this.jl);this.hD=Function.createDelegate(this,this.ld);this.hm=Function.createDelegate(this,this.kq);this.hz=Function.createDelegate(this,this.io);this.hw=Function.createDelegate(this,this.kB);this.hv=Function.createDelegate(this,this.kA);this.hF=Function.createDelegate(this,this.lx);this.hc=Function.createDelegate(this,this.jp);this.gS=Function.createDelegate(this,this.jf);this.hy=Function.createDelegate(this,this.kD);this.gV=Function.createDelegate(this,this.jh);this.gZ=Function.createDelegate(this,this.N);this.gY=Function.createDelegate(this,this.jm);this.hB=Function.createDelegate(this,this.it);this.hh=Function.createDelegate(this,this.ju);this.hA=Function.createDelegate(this,this.iq);this.hx=Function.createDelegate(this,this.ep);this.hC=Function.createDelegate(this,this.kV);this.hu=Function.createDelegate(this,this.kz);this.dX=new _at.bb;_at.a.initializeBase(this);this.bQ=c.k;this.iv=c.n;this.bm=c.c;this.en=c.d;this.fC=f;this.gj=e;this.cV=o;this.fw=c.h;this.df=c.j;this.bN=c.e;this.dv=c.o;c.b&&c.b.a&&(this.gA=c.b.a.bD.SPO_RootSiteUrl);this.eh=n.bD.ContentType==="image/gif";if(this.bm){this.eg=this.bm.a().b().Enabled;this.fX=this.bm.a().dj().Enabled;this.ej=this.bm.a().bW().Enabled;this.dn=this.bm.a().O().Enabled;this.fZ=this.bm.a().cg().Enabled;this.gd=this.bm.a().fy().Enabled;this.fV=this.bm.a().C().Enabled;this.cQ=this.bm.a().P().Enabled;this.dm=this.bm.a().bv().Enabled}n||_j.e.c(_at.a.a,"Attachment is null in AttachmentViewModel ctor");this.gp(n);this.bz=t;this.bo=c.f;this.cS=c.l;this.bJ=c.g;this.cU=c.m;this.cT=c.a;this.cC=!1;this.dy=!1;_dg.d.isInstanceOfType(n)&&(this.bO=n.bD.Content);this.bw=i;this.bK=r;this.bU=h;this.bx=s;this.gq(!this.bw);this.iw(_a.bf.a(n.bD.Name));this.bG=_at.i.c(u);this.iB(this.bx.a(this.bs,this.bj.bD.ContentType,!0,this.cM(),!!this.bl(),this.dm));this.bj&&this.bj.bD.AttachmentId&&this.eu(this.bn.b);this.cH();this.dB();this.eT();this.gG();this.cZ();this.bS=new _j.g(this.hu,_at.a.a);var l=this;this.dV=new _j.g(function(){l.de(0)},_at.a.a);this.gw=new _j.g(this.hC,_at.a.a);this.eq=new _j.g(this.hx,_at.a.a);this.cW=new _j.g(this.hA,_at.a.a);this.dW=new _j.g(this.hh,_at.a.a);this.gn=new _j.g(this.hB,_at.a.a);this.fD=new _j.g(this.gY,_at.a.a);this.fE=new _j.g(this.gZ,_at.a.a);this.fA=new _j.g(this.gV,_at.a.a);this.ge=new _j.g(this.hy,_at.a.a);this.fv=new _j.g(this.gS,_at.a.a);this.fF=new _j.g(this.hc,_at.a.a);this.eW=new _j.g(this.hF,_at.a.a);this.gk=new _ff.p(this.hv,_at.a.a);this.gl=new _j.g(this.hw,_at.a.a);this.gm=new _j.g(this.hz,_at.a.a);this.gf=new _j.g(this.hm,_at.a.a);if(this.bm&&this.bm.a().bu().Enabled){this.gD=new _j.g(this.hD,_at.a.a);this.dP=new _j.g(this.gW,_at.a.a)}if(_dg.c.isInstanceOfType(n)&&!i){this.bL=new _at.bK(this.bm);this.bL.c(this.cq(),this.w())}this.kO(u);this.bm&&this.bm.a().eV().Enabled&&this.hM();this.da=new _y.bH;this.gz=c.p;this.fr();this.bw||this.fT(null);this.ij()&&this.ik()};_at.a.o=function(){return"AttachmentViewModelSaveToCloudNotification"+(_a.d.a().h()+_ff.o.a(0,1e6)).toString()};_at.a.m=function(n,t){if(n.bD.IsSmimeDecoded){t.val=6;return!1}var r=!1;var i=_a.bf.a(n.bD.Name);i&&(r=_at.a.c.g(i.toLowerCase()));if(!r){t.val=6;return!1}var u=_dg.c.isInstanceOfType(n);_j.e.a(_at.a.a,"Attachment Type: {0}",u?"Cloudy":"Local");t.val=7;return!0};_at.a.n=function(n,t){if(n.bD.IsSmimeDecoded||_dg.c.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bf.a(n.bD.Name);i&&(r=_at.a.g.g(i.toLowerCase()));if(!r){t.val=6;return!1}t.val=8;return!0};_at.a.l=function(n,t){if(n.bD.IsSmimeDecoded){t.val=6;return!1}if(_dg.c.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bf.a(n.bD.Name);i&&(r=_at.a.f.g(i.toLowerCase()));if(!r){t.val=6;return!1}_j.e.a(_at.a.a,"Attachment Type: Local");t.val=9;return!0};_at.a.prototype={bm:null,eh:!1,fX:!1,ej:!1,dn:!1,fZ:!1,gd:!1,fV:!1,dm:!1,bG:null,cS:null,fw:null,bS:null,dV:null,gw:null,eq:null,cW:null,dW:null,gn:null,fv:null,fD:null,fE:null,fA:null,dU:null,gh:null,gi:null,ge:null,fF:null,eW:null,gk:null,gl:null,gm:null,gf:null,da:null,bw:!1,bK:!1,eg:!1,bz:null,bo:null,cT:null,bM:null,en:null,bQ:null,bJ:null,cU:null,df:null,bj:null,bv:null,eO:null,bu:0,bP:0,bA:0,bB:0,el:!1,bZ:!1,fB:!1,dL:!1,gI:!1,il:!1,bn:null,bk:null,gc:!1,cF:!1,eA:null,ez:null,cw:0,cn:null,cJ:0,eV:null,cO:null,ed:null,dN:!1,dO:!1,cj:null,dt:!1,by:!1,ck:!1,ci:0,fx:null,dk:!1,ek:!1,cC:!1,dy:!1,bs:null,cX:null,bY:null,cu:!1,ey:!1,dj:null,dc:null,dl:!1,bO:null,em:null,cI:null,bD:null,cs:null,es:null,dQ:null,dR:null,cD:!1,dT:null,fG:null,bq:null,cd:!1,ef:!1,fC:null,cV:null,dA:null,gz:null,cP:!1,bR:!1,dM:null,cx:null,bE:0,bT:1,dz:0,bH:null,bU:null,bN:null,dv:null,bx:null,ds:!1,er:null,dr:null,dq:null,bX:0,bW:0,eP:null,cr:null,db:null,gA:null,bC:null,gj:null,eX:null,gC:!1,cY:!1,cg:!1,gD:null,dP:null,ce:0,bL:null,iv:null,br:null,cQ:!1,cR:null,cf:function(n){if(this.ce!==n&&this.bV()){this.ce=n;this.eB("ProgressBarValue");this.eB("ShowProgressBar");this.ce||this.eU()}return n},kb:function(){return!!this.ce},gB:function(){_j.e.a(_at.a.a,"Starting attachment upload.");var t=this,n=this;_g.k.a.E("CreateAttachment",this.hE,this.jq(),function(n){_j.e.a(_at.a.a,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_j.e.b(_at.a.a,"Enqueueing upload attachment failed: {0}",t.message);n.ch(1,_at.n.a(t),!0);n.dK(null)})},fs:!1,fp:null,fq:!1,dI:null,M:function(n){this.eG("OnUploadCompleteEvent",n)},A:function(n){this.eH("OnUploadCompleteEvent",n)},jd:function(n){this.eG("OnUploadFailedEvent",n)},Z:function(n){this.eH("OnUploadFailedEvent",n)},J:function(n){this.eG("OnDeleteCompleteEvent",n)},X:function(n){this.eH("OnDeleteCompleteEvent",n)},K:function(n){this.eG("OnDownloadCompleteEvent",n)},Y:function(n){this.eH("OnDownloadCompleteEvent",n)},H:function(n){this.eG("OnCancelCompleteEvent",n)},kG:function(n){this.eH("OnCancelCompleteEvent",n)},L:function(n){this.eG("OnSetSharingSettings",n)},z:function(n){this.eH("OnSetSharingSettings",n)},ct:function(n){if(n!==this.eP){this.eP=n;this.cY=!1;this.eI(["ThumbnailInfo","IsThumbnailImage","ShowDefaultImage","IsSuiteExtensionIconSupported","ShouldShowThumbnailPlaceholder"])}return n},ca:function(n){if(this.bu!==n){this.bu=n;this.eI(["ShouldShowSaveToCloudLabel","SaveFileToCloudStatus","SaveToCloudLabel","ShouldShowSaveToCloudCompletedClickableLabel","SaveToCloudCompletedClickableLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},gr:function(n){if(this.bP!==n){this.bP=n;this.eI(["ShouldShowAddToCalendarLabel","AddToCalendarLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},jW:function(){return this.bZ&&!!this.bu&&this.bu!==1&&!this.ia()},ia:function(){return this.cQ&&this.bu===3},jP:function(){return this.bP===2||this.bP===1},jK:function(){if(!this.bl()||!this.b())return"";switch(this.m()){case 3:return _nbs.a.jt;case 4:return _nbs.a.ux;case 6:return _nbs.a.Np;case 5:return _nbs.a.Za;case 1:return this.b().t();case 2:return this.b().g();default:return""}},hV:function(){switch(this.bu){case 1:return _j.h.a(this.bG)?String.format(_nbs.a.sn,this.bk.i()):_nbs.a.GH;case 2:return _j.h.a(this.bG)?String.format(_nbs.a.JO,this.bk.i(),this.bk.g()):String.format(_nbs.a.nE,this.bk.g());case 3:return String.format(_nbs.a.hF,this.bk.g());case 4:return String.format(_nbs.a.XZ,this.bk.g());case 5:return _nbs.a.tB;default:return null}},jL:function(){return String.format(_nbs.a.uW,this.bk.i())},jy:function(){if(this.bP===2)return _nbs.a.EF;else if(this.bP===1)return _nbs.a.Ma;return null},jO:function(){return this.bu===2||this.bP===1||this.dg()},jN:function(){if(this.bV())return!1;var n=!1;(this.cC||this.bj&&!this.bj.bD.AttachmentId)&&(n=!0);if(n!==this.dy){this.dy=n;this.eU()}return this.dy},dg:function(){return this.bA===2||this.bA===4||this.bB===2||this.bB===4},bV:function(){var n=new XMLHttpRequest;if(_at.l.b()&&this.bm)return _dg.c.isInstanceOfType(this.bj)?this.bm.a().cH().Enabled:this.bm.a().fl().Enabled;else{_j.e.a(_at.a.a,"AttachmentViewModel.IsProgressBarEnabled: Unable to find Progress support in XHR");return!1}},hM:function(){var t=this;var r=function(){return t.bU.a(t.bj.bD.AttachmentId,t.bK,_g.C.a(),t.bG)};if(_dg.d.isInstanceOfType(this.bj)){var n=_a.bf.a(this.bj.bD.Name).toLowerCase();if(this.bj.bD.IsSmimeDecoded)this.br=new _at.bc;else if(this.ga(this.bj.bD.Name))this.br=new _at.bz;else if(this.bn.b)this.br=new _at.bE;else if(this.bm.a().bx().Enabled&&SuiteExtensions.ControlFactory.CreateControl(n,1)){var i=!!SuiteExtensions.ControlFactory.CreateControl(n,0);this.br=new _at.bC(i)}else this.br=this.cB()?new _at.bB:this.ei()?new _at.bA:_at.a.c.g(n)?new _at.by:_at.a.g.g(n)?new _at.bD:_at.a.f.g(n)?new _at.bd:new _at.bc}else _dg.c.isInstanceOfType(this.bj)?this.br=null:(_dg.i.isInstanceOfType(this.bj)||_g.B.isInstanceOfType(this.bj))&&(this.br=new _at.bd);this.br&&this.br.o(this.bo,this.bz.a(),this.bm,this.bK,this.bw,r,this.bk)},eS:function(n){this.cC=n;this.eB("ShouldShowActivityIndicator")},iF:function(){this.eI(["ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","ShouldSizeBeHidden","ShowDeleteButton","ShowCancelButton","IsConvertAttachmentInProgress"]);this.cZ();this.hM()},o:function(n){if(this.bA!==n){this.bA=n;this.gG();this.eF("ShouldShowConvertLocalToRefAttachmentLabel","ConvertLocalToRefAttachmentLabel");this.iF()}return n},i:function(n){if(this.bB!==n){this.bB=n;this.eF("ShouldShowConvertRefToLocalAttachmentLabel","ConvertRefToLocalAttachmentLabel");this.iF()}return n},hP:function(){if(this.bA){if(this.bA===3)return String.format(_nbs.a.XZ,this.bk.g());else if(this.bA===2)return String.format(_nbs.a.EK,this.bk.i(),this.bk.g());else if(this.bA===4)return _nbs.a.GT}else return null;return String.format(_nbs.a.aE,this.bk.i())},hQ:function(){if(this.bB){if(this.bB===3)return _u.n.JN;else if(this.bB===2)return _u.n.Rf;else if(this.bB===4)return _nbs.a.GT}else return null;return _u.n.Mj},jT:function(){return this.ea()&&!!this.bA&&this.bA!==1},jU:function(){return this.eb()&&!!this.bB&&this.bB!==1},ea:function(){return!!this.bk&&!this.bk.e()&&!_dg.c.isInstanceOfType(this.bj)&&this.bp()!==4&&!this.bj.a()&&this.bk.y()&&!this.bk.c()&&!_j.h.a(this.bk.i())&&!!this.bx.e&&this.bx.e.ReferenceAttachmentsEnabled&&!this.dZ()},eb:function(){return!!this.bk&&!!this.bx.e&&this.bx.e.ClassicAttachmentsEnabled&&!this.bk.e()&&_dg.c.isInstanceOfType(this.bj)&&!this.bj.l()&&this.bp()!==4&&this.bk.y()&&!this.bk.c()&&!_j.h.a(this.bk.i())&&!this.km()&&!this.dZ()&&!this.G()&&!!this.b()},bh:function(){this.dQ=_a.c.b(_a.a.c,"ConvertLocalAttachmentToReferenceAttachment")},bi:function(){this.dR=_a.c.b(_a.a.c,"ConvertRefToLocalAttachment")},P:function(){_a.c.a(this.dQ);this.dQ=null},Q:function(){_a.c.a(this.dR);this.dR=null},v:function(n,t){if(!this.bL){_j.e.b(_a.a.c,"Cannot add sharing link. The handler is null.");return}this.bL.c(n,t)},hG:function(n,t){if(!this.bL){_j.e.b(_a.a.c,"Cannot add sharing capability. The handler is null.");return}this.bL.d(n,t)},h:function(n){if(!this.bL){_j.e.b(_a.a.c,"Cannot get sharing link. The handler is null.");return null}return this.bL.h(n,this.bl().bD.ProviderType)},s:function(n){if(!this.bL){_j.e.b(_a.a.c,"Cannot get sharing capability. The handler is null.");return!1}return this.bL.g(n)},jJ:function(){this.bZ&&this.bu&&this.bu!==1&&(this.ds=!0);return this.ds},gt:function(n){if(n!==this.ds){this.ds=n;this.eB("IsViewHovered")}return n},ba:function(n){this.cI=n;return n},bp:function(){this.cw||(this.cw=this.ec());return this.cw},a:function(){return this.bj},gp:function(n){var t=this.bj;if(t!==n){t&&t.D(this.fj);this.bj=n;var i=!n;if(!i){n.I(this.fj);_j.e.a(_a.a.c,"Attachment: {0}",n.bD.Name)}this.id(i?null:n.bD.AttachmentId);this.eI(["Attachment","ReferenceAttachment","ReferenceAttachmentUrlHostName"]);this.cZ();this.eU();this.eB("ShouldShowActivityIndicator")}return n},m:function(){return this.bl()?this.bl().t():0},p:function(n){this.bl()&&this.bl().t()!==n&&this.bl().F(n);this.cZ();this.cG();return n},fP:function(){return this.bl()?this.bl().C():0},w:function(){return this.bl()?this.bl().bD.AttachLongPathName:null},B:function(n){this.bl()&&this.bl().bD.AttachLongPathName!==n&&this.bl().E(n);return n},kH:function(n){this.dO=n;this.dO&&(this.dN=!0);return n},bl:function(){return _dg.c.isInstanceOfType(this.bj)?this.bj:null},jz:function(){var n=null;if(this.bl())n=this.hU();else{var t=new _b.V;n=t.a(this.bj.b(),null)}return String.format("{0} {1}",this.bj.bD.Name,n)},hU:function(){if(this.bl()&&!_j.h.b(this.bC)){var t=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$");var n=t.exec(this.bC);return n&&n.length>1?n[1].toLowerCase():this.bC}return""},b:function(){return this.bl()&&!_j.h.a(this.bl().bD.ProviderType)?this.bN.g(this.bl().bD.ProviderType):null},ft:null,q:function(){return this.ft},bt:function(){return this.bj&&this.bj.bD.AttachmentId?this.bj.bD.AttachmentId.Id:null},cL:function(){if(!this.bl())return!1;if(this.bl().bD.ProviderType===_g.q.toString(5))return!!this.bl().bD.ContentType&&_db.l.f.g(this.bl().bD.ContentType.toLowerCase());else{var n=_a.bf.a(this.bl().bD.Name);return _j.h.a(n)?!1:_db.l.d.g(n.toLowerCase())}},cB:function(){return this.bp()===1||this.bp()===2||this.cL()},jI:function(){return this.cL()&&this.bo.c()},hX:function(){return _dg.d.isInstanceOfType(this.bj)&&!this.bj.a()&&this.jG()},dw:function(n){this.gc=n;this.eB("IsSelected");return n},hR:function(){if(this.br)return this.br.c()===6;if(this.bn.b||!this.bm||!this.bm.a().bx().Enabled)return!1;if(this.bj&&!(this.dr!=null)){var n=_a.bf.a(this.bj.bD.Name).replace(".","");this.dr=!!SuiteExtensions.ControlFactory.CreateControl(n,1)}return this.dr!=null?this.dr:!1},fM:function(){if(this.br)return this.br.k();if(this.bn.b||this.di()||!this.bm||!this.bm.a().bx().Enabled)return!1;if(this.bj&&!(this.dq!=null)){var n=_a.bf.a(this.bj.bD.Name).replace(".","");this.dq=!!SuiteExtensions.ControlFactory.CreateControl(n,0)}return this.dq!=null?this.dq:!1},jF:function(){return this.b()?this.b().h():!1},cE:function(n){if(this.bv!==n){this.bv=n;_j.e.a(_at.a.a,"Attachment download URL: {0}",this.bv);this.eB("DownloadUrl")}return n},bf:function(n){if(this.el!==n){this.el=n;this.eB("IsTriggeredPolicyTip")}return n},gq:function(n){this.fB=n;this.eF("CanDelete","ShowDeleteButton");return n},dJ:!1,C:function(n){this.dJ=n;return n},bb:function(n){this.dL=n;this.eF("AttachmentWellPendingRefresh","ShowDeleteButton");return n},ka:function(){return(this.fB||this.dL)&&!this.dg()},jY:function(){return this.bA===2&&this.bA!==4||this.bB===2&&this.bB!==4},gv:function(n){this.bw||this.dY()||this.gq(!n);this.gI=n;this.eB("UploadInProgress");return n},eu:function(n){this.il=n;this.eB("OpenDocumentInBrowserLinkVisible");return n},iB:function(n){this.bn=n;this.cw=this.ec();this.dx();return n},W:function(){return this.bk},kO:function(n){if(n!==this.bk){this.bk=n;this.bk&&this.kh();this.eB("ParentWell")}return n},c:function(){return this.cF},ev:function(n){if(this.cF!==n){this.cF=n;this.bk&&this.bk.bR(this);this.eB("ShouldBeHidden")}return n},gu:function(n){if(this.dt!==n){this.dt=n;this.eB("PendingNonHtml5Upload")}return n},fR:function(){this.bZ&&this.bu&&this.bu!==1&&(this.cu=!0);this.ea()&&this.bA&&this.bA!==1&&(this.cu=!0);this.eb()&&this.bB&&this.bB!==1&&(this.cu=!0);this.bP&&(this.cu=!0);return this.cu},kQ:function(n){if(this.cu!==n){this.cu=n;this.eB("ShouldSizeBeHidden")}return n},jV:function(){return this.bA===3||this.bB===3||this.bu===4||this.bP===3},jR:function(){return this.bu===3||this.bP===2},hW:function(){return this.bP===1||this.bZ&&this.bu===2||(this.ea()||this.eb())&&this.dg()||this.cC||!this.bj||!this.bj.bD.AttachmentId||!this.co()||!this.co().p.x.length},kP:function(n){if(this.bC!==n){this.bC=n;this.eB("ReferenceAttachmentOpenUrl")}return n},cp:function(){return!1},hT:function(){return!1},iC:function(n){if(this.ey!==n){this.ey=n;this.eB("ShowPermissionsTextInCompose")}return n},iw:function(n){if(this.bs!==n){this.bs=n;this.eB("FileExtension")}return n},kS:function(n){this.eA=n;this.eB("SubmitUploadFormCommand");return n},kR:function(n){this.ez=n;this.eB("SubmitUploadAndShareFormCommand");return n},n:function(){this.eO||(this.eO=_at.a.o());return this.eO},V:function(){return this.bS},x:function(){return this.dU},kL:function(n){this.cn=n;_j.e.b(_at.a.a,"Attachment form upload error: {0}",this.cn);this.eB("FormUploadError");return n},kK:function(n){this.cJ=n;_j.e.b(_at.a.a,"Attachment form upload error code: {0}",this.cJ);this.eB("FormUploadAttachmentError");return n},iD:function(n){this.eV=n;this.eB("UploadSuccessResponse");return n},fO:function(){return!1},l:function(){return this.by},R:function(){return this.ci},j:function(){return this.bY},g:function(n){this.bY=n;return n},fJ:function(){var n;n=this.eh?this.fS(_at.a.d,this.bj.bD.AttachmentId,_g.C.a()):this.fS(_at.a.d,this.bj.bD.AttachmentId,_g.C.f());_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},hS:function(){return this.bl()&&this.bC?this.bC:null},U:function(){var n=this.bU.a(this.bj.bD.AttachmentId,this.bK,_g.C.a(),this.bG);_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},fN:function(){var n=this.bU.a(this.bj.bD.AttachmentId,this.bK,_g.C.a(),this.bG);_j.e.a(_at.a.a,"Media URL: {0}",n);return n},cA:function(){return this.fS(_at.a.h,this.bj.bD.AttachmentId,_g.C.d())},kT:function(n){if(this.cY!==n){this.cY=n;this.eF("ThumbnailLoadSucceeded","ShouldShowThumbnailPlaceholder")}return n},jX:function(){return this.di()&&!this.cY},di:function(){var n=this.cL()&&!!this.b()&&(!_j.h.a(this.bl().bD.AttachmentThumbnailUrl)||this.b().k());return n||this.ic()?this.bn.a===3:!1},jZ:function(){return!this.di()&&!this.fM()},jE:function(){if(this.dj)return this.dj;var n;n=this.br?this.br.a()===1:_a.g.b&&this.bp()===5?!1:this.cy()?this.bp()===5||!this.cc()&&(!this.bK||this.bK&&this.bp()!==3):this.bp()===5||this.bz.a()==="Mouse"&&this.bp()!==3;_j.e.a(_at.a.a,"IconLinkViewModel preview = {0}",n);this.dj=_at.D.c(this,n,this.bz);return this.dj},co:function(){if(!this.dc){var n=new Array(0);this.dc=new _fm.e(n)}return this.dc},kI:function(n){this.dc=n;this.eB("ContextMenu");return n},S:function(){return this.bM},iz:function(n){if(this.dl!==n){this.dl=n;this.dB()}return n},y:function(){return this.dk},iy:function(n){if(this.dk!==n){this.dk=n;this.eB("IsDeleted")}return n},jD:function(){if(this.bl())if(_j.h.b(this.bC)){if(this.bl().bD.AttachLongPathName)return this.bj.bD.Name+"\n \n"+this.bl().bD.AttachLongPathName}else return this.bj.bD.Name+"\n \n"+this.bC;return this.bj.bD.Name},kM:function(n){this.bR!==n&&(this.bR=n);return n},gs:function(n){if(this.cP!==n){this.cP=n;this.eB("IsCancelling")}return n},fI:function(){_a.b.d(this.bp()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.bj.y()},T:function(){return this.bO},bc:function(n){this.bO=n;return n},fK:function(){return!!this.bm&&this.bm.a().dv().Enabled},jH:function(){return!!this.bm&&!!this.bx&&!!this.bx.e&&this.bm.a().U().Enabled&&this.bx.e.AttachmentDataProviderAvailable},cy:function(){return this.bl()&&!this.b()?!1:this.bn.a===2?!1:this.fK()?this.bo.e()?!1:this.cM()?!1:this.br?this.br.b():this.jI()?!1:this.dp()&&!this.fY()?!1:this.kj()||this.fW()||this.ei()||this.hR()||this.bp()===1||this.bp()===2||this.bp()===7||this.bp()===10||this.bp()===8||this.ki():!1},cc:function(){return this.bo.e()||!this.bw&&this.bz.a()==="TouchWide"||!!this.bm&&this.bm.a().fz().Enabled},k:function(){return this.cD},t:function(n){this.cD=n;n&&this.eu(!1);return n},iA:function(n){if(this.cd!==n){this.cd=n;this.eB("IsOpenedInLightBox")}return n},dZ:function(){_j.e.a(_a.a.a,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.bk,this.cd,this.bk.e(),this.bn.d,this.bj?this.bj.bD.Name:"null",this.cd&&!this.bk.e()&&this.bn.d);return this.bk?this.cd&&!this.bk.e()&&this.bn.d&&this.ef:!1},ix:function(n){if(this.ef!==n){this.ef=n;this.eB("IsComposedInLightBox");this.dZ()&&this.gq(!1);this.bk.e()||this.cG()}return n},bF:function(){!this.dM&&this.dY()&&(this.dM=(+new Date).toString());return this.dM},kU:function(n){if(this.eX!==n){this.eX=n;this.eB("WacStaticAssetsPreloadUrl")}return n},jS:function(){return this.dh()&&!this.hW()},f:function(){return this.bX},be:function(n){this.bX=n;return n},e:function(){return this.bW},bd:function(n){this.bW=n;return n},iE:function(n){if(this.cQ&&!_j.h.a(n)){this.bj.K(n);this.cG()}},dY:function(){var n=!!this.bm&&this.bm.a().dv().Enabled;return!n||this.bo.c()||this.bo.t()?!1:!this.bk.c()||!!this.cS&&this.cS.a(this.bk.c(),"AttachmentUploadCancellation")},cK:function(){var n=!!this.bj.bD.AttachmentId;var i=n?this.bj.bD.AttachmentId.Id:null;var t=i?_bc.f.b(i):!1;var r=this.bn.c();_j.e.a(_at.a.a,"UpdateUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.bn.toString());return n&&r&&!t&&!this.bj.p()},cN:function(){return!this.bk.d()||this.bk.d().m()!==1},dh:function(){return this.bn.a===2&&this.bz.a()==="Mouse"},jC:function(){return!_dg.c.isInstanceOfType(this.bj)&&!_j.h.a(this.bj.bD.AttachmentOriginalUrl)},jB:function(){return this.bl()?this.b()?this.b().b(this.cq()):[7]:_at.a.i},ic:function(){return!_a.g.b&&!!this.bm&&this.bm.a().eK().Enabled&&this.cB()&&!this.bl()&&this.bj.b()<10485760&&!this.bj.a()},jM:function(){return!!this.bm&&this.bm.a().C().Enabled&&!!this.dv&&!this.eg},ib:function(){return!!this.bm&&this.bm.a().C().Enabled&&this.eg&&!_a.g.b&&!this.bl()},kh:function(){this.bM=this.bk.W();this.kN(this.jk());this.dB();this.cZ();if(!!this.bk){this.dU=new _j.g(this.he,_at.a.a);this.gh=new _j.g(this.hr,_at.a.a);this.gi=new _j.g(this.hd,_at.a.a)}this.cG();this.ip()},kN:function(n){if(n!==this.bZ){this.bZ=this.bk.ce(n);this.bj.a()&&!this.bl()?this.bu=6:this.bZ&&!_j.h.a(this.bj.bD.AttachmentOriginalUrl)&&(this.bu=3)}return n},jA:function(){_j.e.a(_at.a.a,"Attachment class: {0}",this.cw);var n;switch(this.bp()){case 0:case 11:case 9:n=!0;break;case 5:_j.e.a(_at.a.a,"Embedded item class: {0}",this.fI());switch(this.fI()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_j.e.a(_at.a.a,"Can open: {0}",n);return n},jQ:function(){return this.bk.ba()&&this.bl()&&this.bl().l()?!1:!!this.b()&&Array.contains(this.b().b(this.cq()),0)&&this.jH()&&!!this.bl()&&!this.bw},fQ:function(){return this.br?this.br.d():this.b()?this.b().o()?this.dp()&&!this.fY()?!1:!0:!1:!0},hZ:function(){return!this.bl()||!!this.b()&&Array.contains(this.b().b(this.cq()),4)&&!this.bl().l()&&!this.G()},hY:function(){if(this.dp()&&!this.fY())return!0;var n=!!this.b()&&(this.b().l()||!this.bN.b.c(this.bl().bD.ProviderType));!n&&this.cz()&&(n=!this.bj.bD.ContentType||!this.cz().g(this.bj.bD.ContentType));return n},cz:function(){return this.b()?this.b().u(this.bo):null},G:function(){return this.dm?!!this.bl()&&!this.bl().l()&&_j.h.a(this.bs)&&(_j.h.b(this.bl().bD.ContentType)||this.bl().bD.ContentType==="application/onenote"||this.bl().bD.ContentType==="image/png"):!!this.bl()&&!this.bl().l()&&_j.h.a(this.bs)&&(!this.cz()||!this.cz().g(this.bj.bD.ContentType))},cM:function(){return!!this.bj&&(this.bj.bD.IsSmimeDecoded||this.bj.p())},jG:function(){return!!this.bm&&this.bm.a().eK().Enabled},dB:function(){this.bk?this.ev(this.dl||this.bj.a()&&this.bk.bI()&&!_dg.c.isInstanceOfType(this.bj)):this.ev(this.dl||this.bj.a());this.ev(this.cF||this.bj.n)},km:function(){return this.bj&&!_j.h.a(this.bj.bD.Name)?this.bj.bD.Name.endsWith(".one")||this.bj.bD.Name.endsWith(".onepkg"):!1},kv:function(){_j.e.a(_at.a.a,"File selected.");this.iz(!1);this.bk&&this.bk.bV(this)},it:function(){if(this.bZ){_j.e.a(_at.a.a,"Saving attachment with Id:{0} to Cloud.",this.bt());this.es=_a.c.b(_a.a.c,"SaveSingleAttachmentToCloud");this.ca(2);_db.l.b(this.cU,this.n(),this.fn,"AttachmentViewModel",String.format("NotificationHandler is NULL for AttachmentID:{0}",this.cj));var n=new _at.P(this.bt(),null,this.n(),this.bG,null);n.c(this.ht);n.e(this.hs);this.bJ.a(n);_a.c.c(_a.a.c,"AttachmentContextMenu.SaveToCloud")}},lu:function(){_j.e.a(_at.a.a,"submitting upload to server");this.by=!1;if(_dg.d.isInstanceOfType(this.bj)){var n=this.bj;this.gH(n)}else(_g.B.isInstanceOfType(this.bj)||_dg.i.isInstanceOfType(this.bj)||_dg.c.isInstanceOfType(this.bj))&&this.gB()},lb:function(){_j.e.a(_at.a.a,"submitting delete to server");this.by=!1;if(!this.bk.b()){this.cb(_nbs.a.Jx);this.ii(null,"ParentItemId is null");return}var n=new _at.bs(2,this.bj,this.bk.b());n.e(this.hg);n.a(this.hf);_a.g.a.a(n)},kc:function(){var i=this.bj;var r=i.c;var n=this.dX.a();var t=this;n.f(function(){if(n.b())_j.e.b(_at.a.a,"HTML5 file reader attach failed with error code {0}",n.b());else{var r=n.c().indexOf(",");var i=n.c().substring(r+1,n.c().length);t.bO=n.c().substring(0,r).indexOf("base64")!==-1?i:_a.bh.a(i);t.eK("OnUploadCompleteEvent",t)}});try{n.e(r)}catch(u){this.bo.f()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(_at.a.a,"Firefox: failed to read an attachment. Exception: {0}",u.message):_j.e.d(_at.a.a,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},kF:function(){this.bO=null;this.eK("OnDeleteCompleteEvent",this);if(this.bq){this.bq.j=this.dd(1);_a.c.a(this.bq);this.bq=null}},le:function(){this.cs=_a.c.b(_a.a.c,"AttachmentUploadQueue")},eQ:function(n){if(this.cs){this.cs.k=n;this.cs.j=this.hN(!1);_a.c.a(this.cs);this.cs=null}},lf:function(){this.eQ("");this.gE();this.cI&&(this.bD=_a.c.b(_a.a.c,this.cI))},gE:function(){if(this.bD){var n="";this.by&&(n=this.fx);var t=n.match(new RegExp("[a-zA-Z]+Exception"));if(t&&t.length>0){this.bD.k=t[0];this.bD.m=n}else if(this.ci){this.bD.k=_y.bf.toString(this.ci);this.bD.m=n}else this.bD.k=n;this.bD.j=this.hN(!0);_a.c.a(this.bD);var r=this.bD.o.j&1024?+new Date:this.bD.o.k;var i=new _at.bF(this.bD.e(),r-this.bD.o.l,n,this.bs,this.bj.b());_a.A.b.a(i);this.bD=null}},O:function(){_j.e.a(_at.a.a,"Getting attachment content from server");this.by=!1;var n=new _at.bu(_at.a.a,this.bj,this.bG);var i=this;n.a(function(){i.eK("OnDownloadCompleteEvent",i);i.eu(!1)});var t=this;n.e(function(){_j.e.b(_at.a.a,"Download failed with error: {0}",n.H.message);t.by=!0;t.cD||t.dS(n)});_a.g.a.a(n)},jv:function(n,t){n&&this.de(3)},kW:function(n){var i=n.a();if(_g.B.isInstanceOfType(i)&&!i.bD.AttachmentId)this.cR=i;else{var t=new _g.B;t.z(i.bD.AttachmentId.Id);t.e(i.bD.Name);t.g(!1);t.y(n.b());_dg.i.isInstanceOfType(i)?t.l(!0):_dg.d.isInstanceOfType(i)?t.l(!1):_g.B.isInstanceOfType(i)&&t.l(i.bD.IsAttachmentItemAttachment);t.I(this.hl);this.cR=t}},ei:function(){return this.bp()===6&&!!this.bs&&_at.a.k.g(this.bs.toLowerCase())},ee:function(n){if(this.cR){_j.e.a(_at.a.a,"Uploading id attachment.");this.iI(this.cR)}else if(_g.B.isInstanceOfType(this.bj)||_dg.i.isInstanceOfType(this.bj)){_j.e.a(_at.a.a,"Uploading item or id attachment.");this.iI(this.bj)}else if(_dg.d.isInstanceOfType(this.bj)){var t=this.bj;if(this.bO){_j.e.a(_at.a.a,"Uploading file attachment with pasted image from clipboard.");this.et(this.bO)}else if(t.bD.Content){_j.e.a(_at.a.a,"Uploading file attachment with content.");this.et(null)}else if(t.a()&&_a.cA.isInstanceOfType(this.bj.c)&&_at.b.isInstanceOfType(this)){_j.e.a(_at.a.a,"Uploading inline PAL image with content.");this.iK()}else if(this.bo.q()){_j.e.a(_at.a.a,"Uploading HTML5 file attachment.");this.bH=t.c;this.iH()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 file attachment.");this.gJ()}}else if(_dg.c.isInstanceOfType(this.bj)){this.ek=!0;if(this.bo.q()){_j.e.a(_at.a.a,"Uploading HTML5 reference attachment.");var i=this.bj;this.bH=i.c;this.iH()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 reference attachment.");this.gJ()}}else{_j.e.c(_at.a.a,"Unsupported upload type.");n(null)}},ec:function(){if(this.br)return this.bn.a===1?4:this.br.j();var n=0;if(_dg.d.isInstanceOfType(this.bj))if(this.bn.a===1)n=4;else if(this.fW())n=10;else if(this.bn.b)n=3;else{var e,f;if(f=_db.l.e(this.bj,e={val:n}),n=e.val,!f){var s,o,i,t;if((o=_at.a.m(this.bj,s={val:n}),n=s.val,!o)&&(t=_at.a.n(this.bj,i={val:n}),n=i.val,!t)){var u,r;(r=_at.a.l(this.bj,u={val:n}),n=u.val,r)||(n=6)}}}else n=_dg.i.isInstanceOfType(this.bj)?5:_g.B.isInstanceOfType(this.bj)?11:4;return n},cH:function(){if(!this.bU){_j.e.c(_a.a.c,"DownloadAuthenticator is NULL.");return}if(this.cK()){this.cE(this.bU.a(this.bj.bD.AttachmentId,this.bK,null,this.bG));this.fu()&&this.cE(this.bv+"&isDocumentPreview=True")}else this.cE(null)},dS:function(n){this.ch(1,_at.n.c(n),!0)},hK:function(n){this.bE<this.bT-1&&!this.bR&&this.iJ()},ch:function(n,t,i){this.by=!0;this.eS(!1);if(this.bR)_j.e.a(_at.a.a,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.bF(),n,t);else{_j.e.b(_at.a.a,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.bF(),n,t);this.ci=n;this.fx=t;if(this.bk&&this.bk.o(this.bM)){this.bk.k(this,!1);this.dJ&&this.bk.E()}}this.eK("OnUploadFailedEvent",this)},cm:function(n){if(_at.l.isInstanceOfType(n)){var t=n;if(t.s<t.k-1)return}this.cf(100);var i=this;_j.m.a().a(_at.a.a,"CreateAttachmentActionCompleted",function(){i.cf(0)},500);this.dK(n)},eT:function(){this.gu(!this.bw&&this.bo.t()&&!this.bj.bD.AttachmentId&&!_g.B.isInstanceOfType(this.bj))},fy:function(n,t){if(t==="Thumbnail"){this.dx();return}t==="ProviderType"&&this.eI(["PermissionsTextInCompose","ReferenceAttachmentUrlHostName","DataProviderInfo"]);if(t==="ContentType"||t==="Name"||t==="AttachmentId"||t==="ProviderType"||t==="AttachLongPathName"){t==="Name"&&this.iw(_a.bf.a(this.bj.bD.Name));if(t==="ContentType"||t==="Name"){this.iB(_at.j.a().a(this.bs,this.bj.bD.ContentType,!0,this.cM(),!!this.bl(),this.dm));this.dB()}if(t==="AttachmentId"){this.id(this.bj.bD.AttachmentId);this.eT();this.eU();this.dx()}this.ij()&&(!_j.h.a(this.bj.bD.ContentType)&&t===this.bj.bD.ContentType||this.bl()&&!_j.h.a(this.bl().bD.AttachLongPathName)&&t===this.bl().bD.AttachLongPathName)&&this.ik();this.cH();this.cG()}},ko:function(n,t){t==="AttachmentId"&&this.bj.h(this.cR.bD.AttachmentId)},et:function(n){var f=this.bj;if(n){f.l(n);if(this.bE===this.bT-1&&this.bj.a()){var i=0;var t=0;var u,r;_at.g.c(this.bj.bD.ContentType,n,u={val:i},r={val:t}),i=u.val,t=r.val;this.bX=i;this.bW=t;this.bY=this.bk.z(this.bj.bD.Name,this.bX,this.bW)}}this.iu(f,!1)},go:function(n){var t=this.bj;if(n){t.c=n;t.l("")}this.iu(t,!0)},gJ:function(){this.eA.a()},hL:function(){_j.h.a(this.cn)||this.ch(this.cJ,this.cn,!1);this.dK(null)},cb:function(n){this.df.a(_a.u,new _a.u([n],1,null,0,!1,_nbs.a.T,null,null,this.cV,null))},gH:function(n){this.gB()},iK:function(){_j.e.a(_at.a.a,"Submitting action for PAL attachment upload.");var n=new _at.br(2,this.bj,this.bk.b(),this.bF(),this.bk.c(),this.cN());n.e(this.dG);n.a(this.dF);_a.g.a.a(n)},fH:function(n){_j.e.a(_at.a.a,"Not a PAL file attachment.")},eo:function(n,t){this.fU(n,t)},gg:function(n,t){this.cj=t;this.ip();_j.e.a(_at.a.a,"Attachment ID: {0}",this.cj?this.cj.Id:"null")},cq:function(){return this.dn&&this.bw?this.fP():this.m()},fU:function(n,t){_j.e.b(_at.a.a,"Opening attachment with URL {0}",n);this.bQ&&this.bk&&this.bk.b()&&this.bQ.c(this.bk.b(),"Downloaded",this.bs,!!this.bl());if(this.bo.c())if(this.cT.b(this.cT.d())&&this.cT.d().b().a()){_j.e.a(_at.a.a,"Launch URL from nativeBridge");this.cT.d().a(n)}else{_j.e.a(_at.a.a,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var r=document.createElement("a");r.href=n;var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!1,!1,window.self,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);r.dispatchEvent(i)}else t?this.da.a(n,"_self"):this.da.a(n,"_blank")},cG:function(){for(var n=new _fm.e(new Array(0)),i=this.jB(),t=0;t<i.length;t++)switch(i[t]){case 0:this.lg(n);break;case 1:this.lh(n);break;case 2:this.li(n);break;case 3:this.lj(n);break;case 4:this.lk(n);break;case 5:this.ll(n);break;case 6:this.lm(n);break;case 7:this.lo(n);break;case 8:this.lq(n);break;case 9:this.lr(n);break;case 10:this.ls(n);break;case 11:this.ln(n);break;case 12:this.lp(n);break}this.bm&&this.bm.a().bu().Enabled&&n.J(this.dP);this.kI(n)},je:function(n){!this.bo.c()&&this.hZ()&&n.p.a(new _fm.c(_nbs.a.KC,null,this.dV))},kC:function(n){this.bo.c()?n.p.a(new _fm.c(_nbs.a.WE,null,this.dV)):this.bl()&&n.p.a(new _fm.c(_nbs.a.UT,null,this.gm))},kD:function(){this.bk.bX(this);_a.c.c(_a.a.c,"AttachmentContextMenu.ManagePermission")},iu:function(n,t){_j.e.a(_at.a.a,"Submitting server action for file attachment with content.");var r=null;if(this.bV()){r=this.dH;this.bE||this.cf(10)}var i=new _at.l(2,n,this.bk.b(),this.bF(),this.bk.c(),this.cN(),r,t,this.bE,this.bT);i.e(this.dG);i.c(this.fk);i.a(this.dF);_a.g.a.a(i)},ig:function(n){var r=65;if(this.bH){var i=this.bH.b();var t=this.bE*14680064;var e=this.bE<this.bT-1?14680064:i-t;var f=e*n/100;var u=(t+f)*r/i;n===100&&this.bE===this.bT-1?this.kZ():this.cf(10+u)}else this.cf(10+r*n/100)},kZ:function(){var n=this;var t=_j.m.a().e(_at.a.a,"HandleUploadProgress.ShowFakeProgress",function(){n.ce>0&&n.ce<95&&n.cf(n.ce+1)},500);var i=this;_j.m.a().a(_at.a.a,"HandleUploadProgress.CancelFakeProgressTask",function(){_j.m.a().b(t)},1e4)},bg:function(n){this.er=n;return n},jr:function(){if(!this.bw&&!this.ie(0)){_j.e.a(_at.a.a,"Deleting attachment.");this.bq=_a.c.b(_a.a.c,"AttachmentDeleteAttachment");this.iy(!0);var n="";var i=!!this.bj.bD.AttachmentId&&!!this.bj.bD.AttachmentId.Id&&!this.bj.bD.AttachmentId.Id.startsWith("smime-")&&!this.cC;if(i){_j.e.a(_at.a.a,"Deleting attachment from server.");this.bk.k(this,!1);this.bk.ca(this)}else if(this.gI)if(this.dY())this.fz();else{_j.e.c(_at.a.a,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");this.bq.k=n="DeleteInProcess"}else{if(_dg.d.isInstanceOfType(this.bj)){var t=this.bj;this.fH(t)}else _j.e.a(_at.a.a,"Not a file attachment.");this.bk.k(this,!0);n="DeletedWhileInQueue"}if(this.bq){this.bq.j=this.dd(0);_a.c.a(this.bq);this.bq=null}this.cs&&this.eQ(n)}},fz:function(){if(!this.cP){_j.e.a(_at.a.a,"Cancel attachment with cancellationId {0}",this.bF());this.ck=!1;this.gs(!0);var n=new _at.bk(this.bF());n.c(this.gU);n.e(this.gT);_a.g.a.a(n)}},lv:function(n,t,i){this.gv(!0);if(this.dk){_j.e.a(_at.a.a,"Attachment skipped because it's been deleted while it was pending.",this.bj.bD.Name);t(null);return}var u=n;var r=u.Body.ParentItemId;this.bk.b().Id=r.Id;this.bk.b().ChangeKey=r.ChangeKey;this.cX=t;this.ee(t)},iH:function(){this.dT=this.dX.a();this.bV()&&this.cf(3);if(this.bo.q()&&this.bF()){this.bE=-1;this.dz=_dg.c.isInstanceOfType(this.bj)?10485760:14680064;this.bT=Math.ceil(this.bH.b()/this.dz);_dg.c.isInstanceOfType(this.bj)||this.eS(!0);this.iJ()}else if(this.bV()&&!this.bj.a()){_j.m.a().d(_at.a.a,"AttachmentViewModel.UploadHtml5Attachment",this.fm);this.go(this.bH)}else this.iL(this.hX(),this.bH)},iJ:function(){var t=this.hX();if(!this.bk||!this.bk.j()){_j.e.a(_at.a.a,"The attachment upload seems to have been stopped. Aborting further uploads.");return}if(t&&(this.bT>1||this.bV())){_j.m.a().d(_at.a.a,"AttachmentViewModel.UploadNextSlice",this.fm);t=!1}var n=this.bH;this.bE++;var r=this.dz*this.bE;var u=Math.min(r+this.dz,n.c.size);var i=n.c.slice(r,u,n.c.type);this.bV()&&!this.bj.a()?this.go(i):this.iL(t,new _db.Z(i))},iL:function(n,t){var i=this;this.dT.a(t,function(n,t,r,u){t&&i.ct(new _at.w(t,null,r,u,!1));i.et(n)},this.hi,_at.a.a,n)},jx:function(){this.fG=this.dX.a();if(this.bH.b()<=10485760){var n=this,t=this;this.fG.a(this.bH,function(t,i,r,u){i&&n.ct(new _at.w(i,null,r,u,!1))},function(){},_at.a.a,!0)}},jw:function(){this.ch(2,_at.n.f(this.dT),!1);this.dK(null)},iI:function(n){_j.e.a(_at.a.a,"Submitting action for item or id attachment.");var i=null;if(this.bV()){i=this.dH;this.cf(10)}var t=new _at.l(2,n,this.bk.b(),this.bF(),this.bk.c(),this.cN(),this.dH,!1,0,1);t.e(this.dG);t.a(this.dF);_a.g.a.a(t)},jq:function(){var t=this.bk.b();var n=new _g.f(t.Id);n.ChangeKey=t.ChangeKey;var i=new _gg.dI(n);return new _gg.dH(null,i)},dK:function(n){var f=this.by?_y.bf.toString(this.ci):"";_j.e.a(_at.a.a,"Attachment create completed. Status: {0} CancellationId: {1}",f,this.bF());this.eS(!1);if(!this.bR){if(this.cX){n&&_at.l.isInstanceOfType(n)&&this.iD(n.bl());this.cX(this.eV)}this.gv(!1);this.eu(!this.by&&this.bn.b);if(_dg.i.isInstanceOfType(this.bj)){this.bk.k(this,!1);this.gp(n.g);this.cH();this.bk.v(this)}if(this.kX()){_j.e.a(_at.a.a,"Incrementing parent well size.");(!n||this.bk.o(this.bM))&&this.bk.bT(this.bj.b());this.gG()}if(_dg.c.isInstanceOfType(this.bj)){var u=this.bl().c;if(_y.E.isInstanceOfType(u)){var r=u;this.ft=r.c();!_j.h.a(r.h())&&this.cL()&&this.ct(new _at.w(r.h(),null,200,150,!0))}if(n&&_at.O.isInstanceOfType(n)){var t=n.O;if(t&&t.ResponseMessages&&t.ResponseMessages.Items&&t.ResponseMessages.Items.length>0){var i=t.ResponseMessages.Items[0];i&&i.Attachments&&i.Attachments.length>0&&this.bj.j(i.Attachments[0].ContentType)}}}this.cG()}this.eK("OnUploadCompleteEvent",this)},fT:function(n){if(this.bm&&this.bm.a().dE().Enabled&&this.bl()&&this.bl().bD.ProviderType&&!_j.h.a(this.bl().bD.AttachLongPathName)){if(n){_j.e.a(_a.a.c,"We already possess the sharing information of the file for the user, so do not dispatch another Action.");this.iG(n);return}if(this.b().j())this.lc();else if(this.b().d()){this.hG(4,!0);this.hG(3,!0)}}},lc:function(){if(!this.cO&&!_db.l.a(this.m())){this.ed=_a.c.b(_a.a.c,"AttachmentsGetSharingInfoAction");this.cO=new _db.K(this.bl().bD.AttachLongPathName);this.cO.c(this.hk);this.cO.e(this.hj);this.bJ.a(this.cO)}},ke:function(n){_j.e.a(_a.a.c,"GetSharingInfoAction succeeded for attachment id {0}.",this.bt());_a.c.a(this.ed);if(_db.K.isInstanceOfType(n)){var t=n;this.iG(t.g)}},iG:function(n){if(n&&this.bk&&this.bk.a().w(this)&&!_j.h.a(this.bt())){n.CanShareInternally||this.kH(!0);n.CanShareExternally||(this.dN=!0);this.bk&&this.bk.P(!0);if(this.bL&&(this.dn||this.fZ)){this.bL.i(n);this.eJ("OnSetSharingSettings")}}},kd:function(n){_a.c.a(this.ed);_j.e.a(_a.a.c,"GetSharingInfoAction failed for attachment Id: {0}",this.bt())},kX:function(){if(this.by||this.bR)return!1;if(this.bo.t()||_g.B.isInstanceOfType(this.bj)||_dg.c.isInstanceOfType(this.bj))return!0;if(_dg.d.isInstanceOfType(this.bj)){var n=this.bj.c;if(_y.cw.isInstanceOfType(n))return!0;if(_y.E.isInstanceOfType(n))return n.j()}return!1},hJ:function(n){_j.e.a(_at.a.a,"Cancel attachment succeeded with cancellationId {0}",this.bF());this.gv(!1);this.bk&&this.bk.o(this.bM)&&this.bk.k(this,!1);this.hH(n)},jg:function(n){_j.e.b(_at.a.a,"cancel failed with error: {0} and cancellationId: {1}",n&&n.H?n.H.message:"N/A",this.bF());this.ck=!0;this.hH(n)},hH:function(n){this.cX&&this.cX(null);this.gs(!1);this.kM(!this.ck);this.bR&&this.cC&&this.eS(!1);this.eK("OnCancelCompleteEvent",this);if(this.bq){this.bq.k=this.ck&&n?n.Q():null;this.bq.j=this.dd(2);this.bq.l=n?n.P():null;_a.c.a(this.bq);this.bq=null}},jt:function(n){this.ii(n,"")},ii:function(n,t){_j.e.b(_at.a.a,"delete failed with error: {0}",n?n.H.message:t);this.by=!0;this.iy(!1);this.bk.o(this.bM)&&!this.cD&&this.bk.v(this);if(this.bq){this.bq.k=n?n.Q():t;this.bq.j=this.dd(1);this.bq.l=n?n.P():null;_a.c.a(this.bq);this.bq=null}},js:function(n){this.eK("OnDeleteCompleteEvent",this);if(this.bq){this.bq.j=this.dd(1);this.bq.l=n?n.P():null;_a.c.a(this.bq);this.bq=null}},kV:function(){_y.cc.a=this.bz.a()==="Mouse"&&this.bz.c()&&!this.cp();this.bQ&&this.bk&&this.bk.b()&&this.bQ.c(this.bk.b(),"Downloaded",this.bs,!!this.bl())},kz:function(){if((this.bw||this.bj.bD.AttachmentId)&&!this.ie(1)){if(this.dn&&_db.l.a(this.cq())&&this.co().p&&this.co().p.x.length>0){var n=this.co().p.x[0];n.k.a();return}if(this.fQ()&&this.cy()&&!this.cc()&&!this.hY())this.iq();else if((_dg.i.isInstanceOfType(this.bj)||_g.B.isInstanceOfType(this.bj)||this.bp()===9)&&this.bz.a()!=="TouchNarrow")this.ep();else if(this.bl()&&(this.hY()||this.bl().l()||this.G()))this.io();else if(this.dh())return;else this.de(2)}},ie:function(n){if(this.dL&&this.er){_j.e.a(_at.a.a,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.bb(!1);this.er(this.bj,n);return!0}return!1},de:function(n){this.fK()&&(_y.cc.a=this.bz.a()==="Mouse"&&this.bz.c()&&!this.cp());var i=this.bw&&!this.bl();var t=this.bv?this.bv.replace("&isDocumentPreview=True","&isDocumentPreview=False"):null;if(this.bj.bD.AttachmentId)if(_a.g.b){_j.e.a(_at.a.a,"GenericMailMode, always download the attachment.");this.du(t,i)}else if(_dg.d.isInstanceOfType(this.bj))this.du(t,i);else if(_g.B.isInstanceOfType(this.bj)){var r=this.bj;r.bD.ItemId?this.ep():r.bD.IsAttachmentItemAttachment?this.ep():this.du(t,i)}else this.du(t,i);this.kp(n)},kp:function(n){var t="";switch(n){case 2:t="AttachmentView.Download";break;case 0:t="AttachmentContextMenu.Download";break;case 4:t="AttachmentHubListItemContextMenu.Download";break;case 1:t="AttachmentWellBarButton.Download";break;case 3:t="AttachmentPreview.Download";break;default:_j.e.c(_at.a.a,"Unhandled AttachmentDownloadSource:{0}",n);break}_a.c.c(_a.a.c,t)},ep:function(){if(!this.jA()){_j.e.a(_at.a.a,"Unsupported item.");this.cb(_nbs.a.CS);return}this.bQ&&this.bk&&this.bk.b()&&this.bQ.c(this.bk.b(),"Downloaded",this.bs,!!this.bl());if(this.bj.p()){var n=this;this.hO(function(t){t.a();n.im()})}else this.im()},jf:function(){this.db=_a.c.b(_at.a.a,"AddIcsToCalendarFromDropDownMenu",!0);if(this.cr)this.ih();else{var n=this;this.fw.a(function(t){n.cr=t.a();n.ih()})}_a.c.c(_a.a.c,"AttachmentContextMenu.ImportIcsAttachment")},ih:function(){this.cr.e(this.bj.bD.Name);this.cr.a(this.bj.bD.AttachmentId.Id);this.cr.b(this.fo);this.gr(1);this.cr.c()},kw:function(n){if(_j.h.a(n)){this.gr(2);_a.c.a(this.db)}else{this.gr(3);this.db.m=n;_a.c.a(this.db)}this.cr.d(this.fo)},im:function(){var n={};n.AttachmentItemID=this.bj.bD.AttachmentId.Id;this.bK&&(n.IsDiscovery="1");_j.e.a(_at.a.a,"Opening item attachment in pop-out window.");this.bz.p(_y.eQ,null,n,_bc.d.a())},du:function(n,t){this.lt();this.bj?this.bj.bD.AttachmentId?_j.e.a(_at.a.a,"SafeOpenAttachment: Name={0}, ID={1}",this.bj.bD.Name,this.bj.bD.AttachmentId.Id):_j.e.b(_at.a.a,"SafeOpenAttachment: AttachmentId is null"):_j.e.b(_at.a.a,"SafeOpenAttachment: Attachment is null");_j.e.a(_at.a.a,"SafeOpenAttachment: Policy={0}",this.bn.toString());if(this.bn.f){_j.e.a(_at.a.a,"Attachment policy forces browser viewing.");this.bz.a()==="Mouse"?this.cb(_nbs.a.Zf):this.cb(_nbs.a.mN);return}if(!this.bn.e){this.cb(_nbs.a.Tl);return}if(this.bn.a===1){this.cb(_nbs.a.Wz);return}if(this.cM()){var i=this;this.hO(function(n){i.bQ&&i.bk&&i.bk.b()&&i.bQ.c(i.bk.b(),"Downloaded",i.bs,!!i.bl());n.c()});return}if(this.bn.a===2&&this.bz.a()!=="Mouse"){this.la();return}this.bj&&this.cK()&&!_j.h.a(n)&&this.eo(n,t)},la:function(){_j.e.a(_at.a.a,"Attachment policy forces save, but device doesn't support download.");this.cb(_nbs.a.HN)},iq:function(){this.is(!1);_a.c.c(_a.a.c,"Attachment.Preview")},ju:function(){this.is(!0);_a.c.c(_a.a.c,"AttachmentPreview.Edit")},is:function(n){if(this.bj){if(!this.bk||!this.bk.b()){_j.e.a(_at.a.a,"this.parentWell.ParentItemId is null - compose form is not upgraded.");this.cb(_nbs.a.hL);return}this.bQ&&this.bQ.c(this.bk.b(),"Previewed",this.bs,!!this.bl());if(this.kk(this.bj.bD.Name)&&this.bj.b()>10485760){this.df.a(_a.u,new _a.u([_nbs.a.lo],1,this.fl,1,!1,_nbs.a.KC,_nbs.a.o,_nbs.a.Md,this.cV,null));return}if(this.cw===8&&this.bj.b()>1048576){this.df.a(_a.u,new _a.u([_nbs.a.OB],1,this.fl,1,!1,_nbs.a.KC,_nbs.a.o,_nbs.a.Md,this.cV,null));return}this.kE(n)}},kE:function(n){if(this.en)if(this.em)this.ir(n);else{var t=this;this.en.a(function(i){t.em=i;t.ir(n)})}},ir:function(n){if(!this.eN){var t=this.bk.d();var r=!0;var u=null;if(t){t.b()===2&&(u=this.bk.d().c().bD.FolderId.a.Mailbox.EmailAddress);r=!!t.a()&&t.a().eV()}var i=this.em.a(this.cV,this.gj,this.fC,u,this.bK,r,!1,null,!1,null);i.e(this,n);if(t){t.d()&&t.d().c(this.bt())&&t.k(t.d().b[this.bt()].bD.ItemId);i.b(t.b(),t.c(),t.h()||this.bk.b(),!1,!1)}i.a(r)}},ky:function(n){_j.e.a(_at.a.a,"Save to cloud action succeeded with Id:{0}.",this.bt());if(!this.cQ||!_j.h.a(this.bG)){this.ca(3);this.gF()}},kx:function(n){_j.e.a(_at.a.a,"Failed to save attachment with Id:{0} to Cloud.",this.bt());this.ca(4);this.gF()},kf:function(n){var t=n;if(t)if(t.ResultCode){_j.e.b(_a.a.c,String.format("Saving attachmentID: {0} failed with ResultCode: {1}. Exception: {2}",this.bt(),t.ResultCode,t.Exception));this.ca(4)}else{this.ca(3);this.iE(t.Item.Location);this.cQ&&this.bk.cn(!1)}else _j.e.b(_a.a.c,String.format("Received NULL payload while saving attachment: {0} to cloud",this.bt()));this.gF()},gF:function(){_a.c.a(this.es);this.es=null;_db.l.c(this.cU,this.n(),this.fn)},jm:function(){if(this.bk){this.cx=(_a.d.a().h()+_ff.o.a(0,1e6)).toString();this.bk.T(this,this.cx)}_a.c.c(_a.a.c,"AttachmentContextMenu.ConvertLocalToRef")},N:function(){if(this.bk&&this.bj&&this.bl()&&!_j.h.a(this.bl().bD.AttachLongPathName)){this.cx=(_a.d.a().h()+_ff.o.a(0,1e6)).toString();this.bk.bC(this,this.bl().bD.AttachLongPathName,this.cx)}_a.c.c(_a.a.c,"AttachmentContextMenu.ConvertRefToLocal")},jh:function(){this.bl()?this.jj():this.ji()},ji:function(){if(this.bt()){_j.e.a(_a.a.c,"Canceling convert local to reference attachment. Attachment Id: {0}.",this.bt());var n=new _at.bl(this.cx);n.c(this.ho);n.e(this.hn);this.bJ.a(n);this.o(4);this.eB("ShowCancelButton")}},ks:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action succeeded for attachment id {0}.",this.bt())},kr:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action failed for attachment id {0}.",this.bt())},jj:function(){if(this.bt()){_j.e.a(_at.a.a,"Canceling convert reference to local attachment. Attachment Id:{0}.",this.bt());var n=new _at.bm(this.cx);n.c(this.hq);n.e(this.hp);this.bJ.a(n);this.i(4);this.eB("ShowCancelButton")}},ku:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action succeeded for attachment id {0}.",this.bt())},kt:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action failed for attachment id {0}.",this.bt())},jp:function(){window.clipboardData?window.clipboardData.setData("Text",this.bC):prompt(_nbs.a.DB,this.bC);_a.c.c(_a.a.c,"AttachmentContextMenu.CopyLinkToClipboard")},lx:function(){var n=null;_dg.c.isInstanceOfType(this.bj)?n=_at.i.f(this.bC):this.bN&&this.bN.a()&&(n=this.bN.a().M(this.bj.bD.AttachmentOriginalUrl));if(_j.h.a(n)){_j.e.b(_a.a.c,"In order to view in provider, path name must be valid.");return}this.fU(n,!1);_a.c.c(_a.a.c,"AttachmentContextMenu.ViewInProvider")},kA:function(n){n.d();n.c();var t=this.bj.bD.AttachmentOriginalUrl;var i=this.bj.bD.AttachmentOriginalUrl.indexOf("?");i===-1&&(t+="?web=1");this.fU(t,!1)},kB:function(){if(this.bl()&&!_j.h.a(this.bl().bD.AttachLongPathName)&&this.bs in this.b().a()){var n=this.b().a()[this.bs].c(this.w());this.eo(n,!1)}},id:function(n){var t=this.cj;t!==n&&this.gg(t,n)},gG:function(){this.kQ(this.dt||!!this.bj&&!this.bj.b())},cZ:function(){if(this.bl())if(!this.bj.bD.AttachmentId||this.bA===3||this.bB===3||this.dg())this.iC(!1);else{this.iC(!!this.m());this.eB("PermissionsTextInCompose")}},lt:function(){if(!this.cM()&&this.fO()){var n=_g.k.a.q(this.bj.bD.AttachmentId);this.bj.bD.AttachmentId.Id!==n.Id&&this.bj.h(n)}},hN:function(n){var t=new _a.l;if(this.bl()){var i=this.bl().y?this.bl().y:this.bl().c?this.bl().c.b():0;t.a("S",i)}else t.a("S",this.bj.b());t.a("W",this.bk.c()?1:0);t.a("C",this.bR?1:0);t.b("E",this.bs);if(n){_j.h.a(this.dI)||t.b("DP",this.dI);t.c("H",this.fs);t.b("P",this.fp);t.c("O",this.fq);this.bl()&&t.a("SL",this.cq())}return t.toString()},dd:function(n){var t=new _a.l;t.a("S",this.bj.b());var i="A";_at.F.isInstanceOfType(this)?i="C":this.bp()===5?i="T":this.bj.a()&&(i="I");t.b("T",i);t.a("O",n);t.a("W",this.bk.c()?1:0);this.cI&&t.b("Q",this.cI);t.b("E",this.bs);return t.toString()},eU:function(){this.eF("ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick")},hO:function(n){if(this.cM()){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.gz.a(function(i){if(!t.dA){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.dA=i.d();t.dA.b(t.bj)}_j.e.a(_a.a.k,"[AttachmentViewModel] Executing smime operation.");n(t.dA)})}},jk:function(){var n=!!this.bk.d()&&this.bk.d().b()===2;return this.bx.e.SaveAttachmentsToCloudEnabled&&!this.bk.ba()&&this.bn.c()&&this.bk.y()&&!_dg.c.isInstanceOfType(this.bj)&&!this.bj.a()&&this.bk.e()&&(!_j.h.a(this.bk.i())||n)},dx:function(){if(this.bj){if(this.cL()){_j.h.a(this.bj.bD.AttachmentThumbnailUrl)||this.ct(new _at.w(this.bj.bD.AttachmentThumbnailUrl,null,200,150,!0));return}if(this.ic()){if(!this.bj.bD.AttachmentId)return;if(!this.jM()){this.ct(new _at.w(this.cA(),null,0,0,!1));return}this.lw()}}},lw:function(){var u=this.bj.bD.AttachmentId.Id;var o=_a.d.a();var f=this.dv.a(u);if(!_j.h.a(f)){this.ct(new _at.w(f,null,0,0,!1));return}var r=document.createElement("canvas");var e=r.getContext("2d");var n=new Image;n.crossOrigin="Anonymous";var t=this;n.onload=function(){if(t&&!t.eN){var f=n.width,o=n.height;r.width=f;r.height=o;var i=null;try{if(f>0&&o>0){e.drawImage(n,0,0,f,o);i=r.toDataURL("image/jpeg",.5)}}catch(h){_j.e.b(_at.a.a,"Failed to get thumbnail via canvas error={0}",h.message)}t.bj&&t.ct(new _at.w(i?i:t.cA(),null,f,o,!1));if(i)try{t.dv.b(u,i)}catch(s){_j.e.b(_at.a.a,"Failed to save thumbnailinfo into session storage, error={0}",s.message)}}};var i=this;n.onerror=function(){i&&!i.eN&&i.bj&&i.ct(new _at.w(i.cA(),null,0,0,!1))};n.src=this.cA()},ik:function(){if(this.bl()&&!_j.h.a(this.bl().bD.AttachLongPathName)&&!_j.h.a(this.bj.bD.ContentType)&&(this.cB()||this.bj.bD.ContentType==="application/pdf")){var t=this.bj.bD.ContentType==="application/pdf"?!1:!0;var i=_at.o.f(this.bl().bD.AttachLongPathName);if(!_j.h.a(i)){var n=this;_at.o.e(i,t,function(i){if(t){n.bl().z(i+"2");n.bl().B(i);n.dx()}else{i=i.substring(0,i.length-8);n.cE(i+"open")}},null)}}},ip:function(){if(this.cj&&this.fK()&&this.bn&&this.bn.b&&!_dg.i.isInstanceOfType(this.bj)&&this.fQ()&&!_db.l.a(this.cq())){if(this.bj&&this.bj.bD.Name&&!_dg.c.isInstanceOfType(this.bj)&&this.bx&&this.bx.e&&this.bx.e.WacPreloadMappings&&this.bx.e.WacPreloadMappings.length>0){if(!_at.a.b){_at.a.b={};for(var t=0;t<this.bx.e.WacPreloadMappings.length;t++)_at.a.b[this.bx.e.WacPreloadMappings[t][0]]=this.bx.e.WacPreloadMappings[t][1]}var i=_a.bf.a(this.bj.bD.Name);if(i in _at.a.b){var o=_at.a.b[i];delete _at.a.b[i];this.kU(o)}}var e=this.cj.Id;var f=this;var r=function(n){if(n&&n.Status===9){f.gC=!0;f.cG()}};var u=_at.q.a().c(e);if(u){r(u);return}var n=this;_j.m.a().c(_a.a.c,"AttachmentViewModel.PreloadWacAttachmentInfo",function(){if(n.bk&&n.bk.d()){var t=new _at.Z(e,!1,null,!!n.bl(),n.bk.c(),n.bK);t.e(function(n){r(t.d)});n.bJ.a(t)}})}},fS:function(n,t,i){var r=t.Id+_a.d.bH(_a.d.a());if(!this.ib()||!n.c(r)){var u=this.bU.a(t,this.bK,i,this.bG);if(!this.ib())return u;n.a(r,u)}return n.b[r]},kg:function(){try{var t=new ActiveXObject("AcroPDF.PDF");return!0}catch(n){return!1}},kY:function(){return this.bo.d().a()===1&&(!this.ga(this.bj.bD.Name)||this.kg())},kk:function(n){var t=_a.bf.a(n).toLowerCase();switch(t){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},ki:function(){return(this.bp()===5||this.bp()===9)&&this.fX&&!this.kl()},kj:function(){return!this.gC&&this.bn.b&&!(this.ga(this.bj.bD.Name)&&(this.bl()||this.bz.a()==="TouchNarrow"))&&!(this.bo.c()&&this.bz.a()==="TouchNarrow")&&!this.cz()&&(!this.kn(this.bj.bD.Name)||this.gd)},fW:function(){if(this.bo&&this.bo.d()&&(this.bo.d().a()===2||this.bo.d().a()===6||this.bo.d().a()===4||this.kY())){var n=_at.a.e.g(this.bs.toLowerCase());return this.cz()?!!this.bj.bD.ContentType&&this.cz().g(this.bj.bD.ContentType):n}return!1},fu:function(){return this.bo&&this.bo.d()&&(this.bo.d().a()===2||this.bo.d().a()===6||this.bo.d().a()===4||this.bo.d().a()===1)?_at.a.e.g(this.bs.toLowerCase()):!1},ga:function(n){return _a.bf.a(n).toLowerCase()===".pdf"},kl:function(){return!!this.bk&&!!this.bk.d()&&!!this.bk.d().a()&&this.bk.d().a().eV()},kn:function(n){switch(_a.bf.a(n).toLowerCase()){case".vsd":case".vdx":case".vss":case".vsx":case".vst":case".vtx":return!0;default:return!1}},io:function(){this.du(this.bC,!1);_a.c.c(_a.a.c,"AttachmentContextMenu.OpenInNewTab")},kq:function(){var n=new _at.bo(this.bj.bD.AttachmentId,this.bk.b().Id);n.c(this.hb);n.e(this.ha);this.bX=320;this.bW=220;if(_dg.d.isInstanceOfType(this.bj)&&this.bj.bD.Content){var i,t;_at.g.c(this.bj.bD.ContentType,this.bj.bD.Content,i={val:this.bX},t={val:this.bW}),this.bX=i.val,this.bW=t.val}this.bY=this.bk.z(this.bj.bD.Name,this.bX,this.bW);this.bJ.a(n);_a.c.c(_a.a.c,"AttachmentContextMenu.MoveAttachmentToInline")},jn:function(n){_j.e.b(_at.a.a,"AttachmentViewModel: ConvertToInlineAttachmentFailed. Deleting placeholder image");this.bk.bE(this.bY)},jo:function(n){var t=n.g;this.bj.g(!0);this.bj.o(t);this.bk.k(this,!1);this.bk.cd(this.bY,this.bv,t,this.bj.b(),this.bj.bD.ContentType)},lg:function(n){this.jQ()&&n.p.a(new _fm.c(this.b().c(),null,this.ge))},li:function(n){if(this.eb()){this.i(1);n.p.a(new _fm.c(this.hQ(),null,this.fE))}},lh:function(n){if(this.ea()){this.o(1);n.p.a(new _fm.c(this.hP(),null,this.fD))}},lk:function(n){this.dp()||(this.bn.c()&&this.bn.a!==2&&!this.cc()||this.dh()||this.cc())&&this.je(n)},lo:function(n){(this.bn.c()&&this.bn.a!==2&&!this.cc()||this.dh()||this.cc())&&this.kC(n)},lq:function(n){(this.bp()===4||this.bn.a===2||this.cc())&&(this.dh()||!this.cc())||this.cy()&&this.fQ()&&n.p.a(new _fm.c(_nbs.a.Lv,null,this.cW))},lr:function(n){if(this.bZ&&!this.jC()){this.bu=1;n.p.a(new _fm.c(this.hV(),null,this.gn))}},ls:function(n){if(!this.dp())if(this.bl())n.p.a(new _fm.c(this.b().r(),null,this.eW));else if(!_j.h.a(this.bj.bD.AttachmentOriginalUrl)){if(!this.bN||!this.bN.a()){_j.e.b(_a.a.c,"DefaultDataProviderInfo must be available when the attachment has been saved to cloud.");return}n.p.a(new _fm.c(this.bN.a().r(),null,this.eW));return}},lp:function(n){if(this.fV&&this.bs in this.b().a()&&this.bo.A()){var t=String.format(_nbs.a.oa,this.b().a()[this.bs].b);n.p.a(new _fm.c(t,null,this.gl))}},lj:function(n){this.bl()&&n.p.a(new _fm.c(_nbs.a.Dn,null,this.fF))},ll:function(n){this.ei()&&n.p.a(new _fm.c(_nbs.a.JD,null,this.fv))},lm:function(n){this.bk&&this.bk.e()||!this.cB()||this.cL()||n.p.a(new _fm.c(_nbs.a.Ht,null,this.gf))},ln:function(n){this.cy()&&(_dg.i.isInstanceOfType(this.bj)||this.bp()===9)&&this.bz.a()!=="TouchNarrow"&&n.p.a(new _fm.c(_u.n.LP,null,this.eq))},dp:function(){if(!this.bl()||_j.h.a(this.bl().bD.AttachLongPathName))return!1;try{var n=new _a.Q(this.bl().bD.AttachLongPathName);var t=n.a;if(t.indexOf("safelinks.protection.outlook.com")>0||n.f.toLowerCase().indexOf(_at.a.j)>0)return!0}catch(i){}return!1},fY:function(){return this.bl()?this.bl().bD.ProviderType?this.bl().bD.ProviderType!==_g.q.toString(1)?!1:this.cB()?!0:!1:!1:!1},ij:function(){return _dg.c.isInstanceOfType(this.bj)&&!!this.bl()&&this.bl().bD.ProviderType===_g.q.toString(5)},cl:null,kJ:function(n){if(this.cl!==n){this.cl&&this.cl.d(!1);this.cl=n;this.cl&&this.cl.d(!0);this.eB("ContextMenuSelectedItem")}return n},ew:function(n){if(this.cg!==n){this.cg=n;this.eB("ShowConversationAttachmentContextMenu")}return n},ld:function(){this.ew(!this.cg);this.cg&&this.co().n(null)},jl:function(){this.ew(!1)}};_at.bG=function(n,t,i,r,u,f,e,o){this.n=_at.a;_a.b.a(n,"owaShell");_a.b.a(t,"palDownloadManager");_a.b.a(o,"attachmentDependencies");_a.b.a(o.f,"userAgent");_a.b.a(o.a,"nativeBridge");_a.b.a(r,"itemStoreGetterFactory");this.c=n;this.i=t;this.b=i;this.g=e;this.a=o;this.h=r;this.j=u;this.f=f};_at.bG.prototype={c:null,a:null,i:null,h:null,b:null,e:null,j:null,g:null,n:null,f:null,k:function(n,t,i,r,u,f,e){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.Create passing null as attachment");if(this.m()&&(_dg.c.isInstanceOfType(n)||_dg.d.isInstanceOfType(n)&&_y.E.isInstanceOfType(n.c))){if(!this.e&&this.b){var s=this;this.b.a(function(n){s.e=n})}_a.b.b(this.e,"attachmentProviderItemViewModelFactory");return this.e.a(n,this.c,t,i,r,u,f,e)}else if(_dg.d.isInstanceOfType(n)&&_y.cw.isInstanceOfType(n.c)){_a.b.b(this.j,"uriFileAttachmentViewModelFactory");return this.j.a(n,this.c,t,i,r,u,f,e)}else{var o=_at.s.a(this.g,this.a,r);return new _at.b(n,this.c,t,i,r,this.i,this.h,u,f,e,this.f,o,this.a)}},d:function(n,t,i,r,u,f,e,o){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.CreateAsync passing null as attachment");if(this.m()&&this.b&&(_dg.c.isInstanceOfType(n)||_dg.d.isInstanceOfType(n)&&_y.E.isInstanceOfType(n.c))){var c=this;var l=function(s){var h=s.a(n,c.c,t,i,r,f,e,o);u(h)};this.b.a(l)}else{this.b||_j.e.c(_a.a.c,"attachmentProviderItemViewModelFactoryLazy is null");_dg.c.isInstanceOfType(n)&&_j.e.b(_a.a.c,"We shall not construct PALAttachmentViewModel for ReferenceAttachment.");var s=_at.s.a(this.g,this.a,r);var h=new _at.b(n,this.c,t,i,r,this.i,this.h,f,e,o,this.f,s,this.a);u(h)}},p:function(n,t,i,r,u,f,e,o,s){if(this.b&&_dg.c.isInstanceOfType(t)){var c=this;var h=function(h){var l=h.b(t,c.c,i,r,u,n,e,o,s);f(l)};this.b.a(h)}},o:function(n,t,i,r,u,f,e,o){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.l(n,0,new Array(0),t,i,r,u,f,e,o)},l:function(n,t,i,r,u,f,e,o,s,h){var c=this;this.d(n[t],r,u,f,function(l){Array.add(i,l);t<n.length-1?c.l(n,t+1,i,r,u,f,e,o,s,h):e(i)},o,s,h)},m:function(){return this.a.c?this.a.c.a().U().Enabled:!1}};_at.L=function(n){this.a=n};_at.L.prototype={a:null};_at.S=function(n,t){_at.S.initializeBase(this,[n,t])};_at.S.prototype={o:function(){return!1},l:function(){return!0},r:function(){return""},t:function(){return _nbs.a.jt},g:function(){return""},z:function(){return""},y:function(){return _nbs.a.bc},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){return t},b:function(n){return _at.S.a}};_at.bH=function(n,t){_at.bH.initializeBase(this,[n,t])};_at.bH.prototype={l:function(){return!1},b:function(n){return null},e:function(n,t,i,r){return null},o:function(){return!0},F:function(){return!0},r:function(){return""},t:function(){return""},g:function(){return""},z:function(){return""},y:function(){return""},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""}};_at.T=function(n,t){_at.T.initializeBase(this,[n,t])};_at.T.prototype={o:function(){return!1},l:function(){return!0},r:function(){return""},t:function(){return _nbs.a.jt},g:function(){return""},z:function(){return""},y:function(){return _nbs.a.bc},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){var f=t.lastIndexOf("?");var u=t.substring(0,f);return u+"?dl=1"},b:function(n){return _at.T.a}};_at.u=function(n,t){_at.u.initializeBase(this,[n,t]);this.Q()};_at.u.prototype={C:null,o:function(){return!0},m:function(){return!1},n:function(){return!0},l:function(){return!1},h:function(){return!0},d:function(){return!0},r:function(){return""},t:function(){return _nbs.a.jt},g:function(){return _nbs.a.ux},z:function(){return""},y:function(){return _nbs.a.Pp},i:function(){return _nbs.a.br},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return _nbs.a.NY},k:function(){return!0},D:function(){return new _db.y(null,11031,null)},v:function(n){n=n.toLowerCase();var t=_nbs.a.UT;n in this.C&&(t=String.format(_nbs.a.oa,this.C[n]));return t},e:function(n,t,i,r){return t.replace("&rm=embedded","").replace("?rm=embedded","")},b:function(n){return _at.u.c},u:function(n){return n.h()?_at.u.b:_at.u.a},L:function(){return _at.u.d},Q:function(){this.C={"application/vnd.google-apps.document":_nbs.a.ox,"application/vnd.google-apps.spreadsheet":_nbs.a.Wd,"application/vnd.google-apps.presentation":_nbs.a.VL}}};_at.U=function(n,t){_at.U.initializeBase(this,[n,t])};_at.U.prototype={o:function(){return!0},G:function(){return!0},J:function(){return!0},I:function(){return!0},H:function(){return!1},l:function(){return!0},r:function(){return""},t:function(){return""},g:function(){return""},z:function(){return""},y:function(){return _nbs.a.Kx},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.C.g(),n,t)},b:function(n){return _at.U.a}};_at.E=function(n,t){_at.E.initializeBase(this,[n,t])};_at.E.prototype={o:function(){return this.C()},l:function(){return!this.C()},r:function(){return String.format(_nbs.a.OK,_nbs.a.cf)},t:function(){return _nbs.a.jt},g:function(){return _nbs.a.ux},z:function(){return _nbs.a.iP},y:function(){return _nbs.a.Gv},i:function(){return _nbs.a.j},f:function(){return _nbs.a.Tj},q:function(){return _nbs.a.ux},s:function(){return _nbs.a.jt},c:function(){return _nbs.a.NY},k:function(){return!0},e:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.C.g(),n,t)},b:function(n){return this.C()?_at.E.a:_at.E.b},C:function(){return _g.a.a().B}};_at.v=function(n,t){_at.v.initializeBase(this,[n,t])};_at.v.prototype={a:function(){this.C();return _at.v.a},b:function(n){switch(n){case 4:case 3:return _at.v.c;case 6:case 5:return _at.v.d;default:return _at.v.b}},x:function(){return _nbs.a.cf},p:function(){return!0},d:function(){return!0},o:function(){return!0},E:function(){return!0},j:function(){return!0},l:function(){return!1},r:function(){return String.format(_nbs.a.OK,_nbs.a.cf)},t:function(){return _nbs.a.GQ},g:function(){return _nbs.a.nj},z:function(){return _nbs.a.NH},y:function(){return _nbs.a.JQ},i:function(){return _nbs.a.iv},f:function(){return _nbs.a.jb},q:function(){return _nbs.a.CG},s:function(){return _nbs.a.tF},c:function(){return _nbs.a.NY},w:function(n){switch(n){case 2:case 1:case 6:case 5:return!0;default:return!1}},k:function(){return!!this.B&&this.B.a().dY().Enabled},e:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);var u=null;u=this.B&&this.B.a().O().Enabled?String.format(_g.C.r(),n,t,r):String.format(_g.C.g(),n,t);return _j.h.a(i)?u:String.format("{0}/{1}",i,u)},K:function(n,t,i,r){var f=new _a.Q(n.bD.AttachLongPathName);var u=n.t()?n.t():n.C();var e=_db.l.a(u);var h=!_j.h.a(i)&&new _a.Q(i).a===f.a;if(e){var s=this;_at.f.m(String.format("{0}://{1}",f.c,f.a),n.bD.AttachLongPathName,e,h,r,function(i){_j.e.d(_a.a.c,i,"Error getting download url for ref. attachment.");var f=s.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,u);r(f,null,null)})}else{_j.e.a(_a.a.c,"Avoiding client side metadata call for non-sharing link scenario.");var o=this.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,u);r(o,null,null)}},M:function(n){return _at.i.f(n)},C:function(){if(!_at.v.a){var i=new _at.V(_nbs.a.Ig,"ms-word:ofv|u|");var t=new _at.V(_nbs.a.lO,"ms-PowerPoint:ofv|u|");var n=new _at.V(_nbs.a.YI,"ms-excel:ofv|u|");_at.v.a={".docx":i,".doc":i,".pptx":t,".ppt":t,".xlsx":n,".xls":n}}}};_at.M=function(n,t){_at.M.initializeBase(this,[n,t])};_at.M.prototype={o:function(){return!1},l:function(){return!0},r:function(){return""},t:function(){return _nbs.a.jt},g:function(){return""},z:function(){return""},y:function(){return _nbs.a.bc},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){return""},b:function(n){return _at.M.a}};_at.bW=function(){};_at.bW.prototype={b:null};_at.V=function(n,t){_at.V.initializeBase(this);this.b=n;this.a=t};_at.V.prototype={a:null,c:function(n){var i=n.indexOf("?d=");var t;t=i!==-1?this.a+n.substr(0,i):this.a+n;return t}};_at.n=function(){};_at.n.c=function(n){var r;if(n){if(_h.bC.isInstanceOfType(n)&&(r=n.b())){var i=r.responseCode;if(i&&i!=="NoError")return i;var t=r.response;if(t){var f=t.fault;if(f){var u=_at.n.d(f);if(u)return u}if(t.statusCode)return"HTTP_"+t.statusCode}}if(n.H)return _at.n.a(n.H)}return"UnknownError_Action"};_at.n.a=function(n){if(n){var t;if((t=n.responseCode)&&t!=="NoError")return t.toString();if(t=n.StackTrace)return _at.n.e(t.toString());if(t=n.ErrorCode)return"HTTP_"+t;if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.n.d=function(n){if(n){if(n.ResponseCode&&n.ResponseCode!=="NoError")return n.ResponseCode;if(n.StackTrace)return _at.n.e(n.StackTrace);if(n.ErrorCode)return"HTTP_"+n.ErrorCode}return null};_at.n.e=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.n.f=function(n){var i=n.b();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.n.b.length?_at.n.b[t]:_at.n.a(i)}return n.d()?_at.n.a(n.d()):"UnknownError_FileReader"};_at.F=function(n,t,i,r,u,f,e,o,s,h,c){this.eY=Function.createDelegate(this,this.lz);this.gK=Function.createDelegate(this,this.ly);_at.F.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.F.a=function(n){if(n){if(n.ResultCode===10)return 5;if(n.ResultCode===17)return 6;if(n.ResultCode===15)return 7}return 1};_at.F.prototype={fa:function(){_db.l.b(this.cU,this.n(),this.gK,this.gL(),"NULL NotificationHandler passed in from ExternalSourceAttachmentViewModel.")},iN:function(){_db.l.c(this.cU,this.n(),this.gK)},cm:function(n){this.iN();_at.a.prototype.cm.call(this,n)},lz:function(n){this.dS(n);this.cm(null)},ly:function(n){var i=null;var t=n;i=n?_j.h.a(t.Exception)?this.gM(t.Response):String.format("Exception from Server: "+t.Exception):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.ch(_at.F.a(t),i,!0)}else this.iM(t);this.cm(null)},iM:function(n){},gM:function(n){var i=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")i="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var t=n.ResponseMessages.Items[0];this.bj.f(t.Attachments[0].Size);_at.l.c(t,this.bj,this.bk.b(),!0);if(_dg.c.isInstanceOfType(this.bj)&&t.Attachments.length>=1&&t.ResponseCode==="NoError"){var u=t.Attachments[0];this.lB(u);this.fT(n.SharingInformation)}if(_dg.d.isInstanceOfType(this.bj)&&this.bj.a()){var r=t.Attachments[0];this.bj.o(r.ContentId);this.bj.j(r.ContentType)}}else i="The response message received is null";return i},lB:function(n){if(n.PermissionType){this.bj.F(n.PermissionType);this.cZ()}if(n.AttachLongPathName){this.bj.G(n.ProviderType);this.bj.E(n.AttachLongPathName);this.bj.O(n.ProviderEndpointUrl);this.bj.o(n.ContentId);this.bj.B(n.AttachmentThumbnailUrl);this.bj.z(n.AttachmentPreviewUrl)}this.bj.e(n.Name);this.lA()},lA:function(){this.bk.P(!0)}};_at.bU=function(n,t){this.A=t;this.B=n};_at.bU.prototype={B:null,A:null,x:function(){return this.A},p:function(){return!1},d:function(){return!1},F:function(){return!1},E:function(){return!1},h:function(){return!1},j:function(){return!1},G:function(){return!1},J:function(){return!1},I:function(){return!1},H:function(){return!0},D:function(){var n=this.B.a().bv().Enabled?11032:11030;return new _db.y(null,n,[this.x()])},P:function(){return String.format(_nbs.a.Of,this.A)},N:function(){return String.format(_nbs.a.QY,this.A)},O:function(){return String.format(_nbs.a.QQ,this.A)},a:function(){return null},k:function(){return!1},u:function(n){return null},L:function(){return null},w:function(n){return!1},m:function(){return this.o()},n:function(){return!1},v:function(n){return""},K:function(n,t,i,r){var u=this.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,0);r(u,null,null)},M:function(n){return n}};_at.g=function(){};_at.g.c=function(n,t,i,r){var u=_a.c.b(_a.a.c,"MailComposeImageSizeDecode");i.val=r.val=0;if(!t){u.k="EmptyContent";_a.c.a(u);return}if(n==="image/png")_at.g.o(t,i,r,u);else if(n==="image/jpeg")_at.g.n(t,i,r,u);else if(n==="image/gif")_at.g.m(t,i,r,u);else if(n==="image/bmp")_at.g.l(t,i,r,u);else{u.k="UnsupportedImage";u.m=String.format("Image type {0} is not supported.",n);_a.c.a(u)}};_at.g.k=function(n){var t=_a.bf.a(n);return _db.l.d.g(t.toLowerCase())};_at.g.o=function(n,t,i,r){var p=n.length>100?100:n.length;var w=n.substring(0,p);var s=_at.g.b(_a.bh.b(w));if(s.length>24){for(var h=0,f=0,y=new Array(8),u=0;u<8;u++)y[u]=s[u];if(_at.g.a(y,_at.g.j)){for(var o=16,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.g.d(v);f=_at.g.d(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a png image have to be > 0.");r.k="IllegalDimensions";r.m="png";h=f=0}}else{_j.e.b(_a.a.c,"The png image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="png"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="png"}_a.c.a(r)};_at.g.m=function(n,t,i,r){var p=n.length>20?20:n.length;var w=n.substring(0,p);var s=_at.g.b(_a.bh.b(w));if(s.length>10){for(var h=0,f=0,a=new Array(6),u=0;u<6;u++)a[u]=s[u];if(_at.g.a(a,_at.g.h)||_at.g.a(a,_at.g.i)){for(var o=6,e=2,y=new Array(e),l=0;l<e;l+=1){y[l]=s[o];o+=1}for(var v=new Array(e),c=0;c<e;c+=1){v[c]=s[o];o+=1}h=_at.g.e(y);f=_at.g.e(v);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a gif image have to be > 0.");r.k="InvalidDimensions";r.m="gif";h=f=0}}else{_j.e.b(_a.a.c,"The gif image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="gif"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="gif"}_a.c.a(r)};_at.g.l=function(n,t,i,r){var p=n.length>50?50:n.length;var w=n.substring(0,p);var s=_at.g.b(_a.bh.b(w));if(s.length>26){for(var h=0,f=0,y=new Array(2),u=0;u<2;u++)y[u]=s[u];if(_at.g.a(y,_at.g.g)){for(var o=18,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.g.f(v);f=_at.g.f(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a bmp image have to be > 0.");r.k="InvalidDimensions";r.m="bmp";h=f=0}}else{_j.e.b(_a.a.c,"The bmp image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="bmp"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="bmp"}_a.c.a(r)};_at.g.n=function(n,t,i,r){for(var f=_at.g.b(_a.bh.b(n)),c=f.length,l=!1,a=!1,u=0,o=0,s=0;!l&&!a&&u+1<c;){u+=1;var h=f[u];u+=1;var e=0;switch(h){case 216:case 217:e=0;break;case 221:e=2;break;default:if(u+2<c){var y=f[u];u+=1;var v=f[u];u+=1;e=(y<<8|v)-2}else{_j.e.b(_a.a.c,"Malformed jpeg.");r.k="MalformedJpeg";_a.c.a(r);return}break}h===217&&(a=!0);if(e>0){if(h===192){if(u+4<c){o=f[u+3]<<8|f[u+4];s=f[u+1]<<8|f[u+2]}else{_j.e.b(_a.a.c,"Malformed segment in jpeg.");r.k="MalformedJpeg";_a.c.a(r);return}l=!0}u+=e}}if(o<=0||s<=0){if(l){_j.e.b(_a.a.c,"Width and height of a jpeg image have to be > 0.");r.k="InvalidDimensions";r.m="jpeg"}else{_j.e.b(_a.a.c,"Image dimension segment not found for jpeg image.");r.k="MissingDimension";r.m="jpeg"}o=s=0}t.val=o;i.val=s;_a.c.a(r)};_at.g.b=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;t++)r[t]=n.charCodeAt(t);return r};_at.g.d=function(n){for(var i=0,t=0;t<4;t++)i=(i<<8)-0+n[t];return i};_at.g.e=function(n){for(var i=0,t=1;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.g.f=function(n){for(var i=0,t=3;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.g.a=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(n[i]!==t[i])return!1;return!0};_at.bI=function(n){this.g=n;this.c={};this.a=new _j.q};_at.bI.prototype={g:null,c:null,a:null,b:function(n){_a.b.c(n,"attachmentId");return n in this.c},h:function(n){this.d(n);if(!this.b(n.a)){this.a.c(n);this.c[n.a]=""}},e:function(n,t){this.d(t);if(!this.b(t.a)){this.a.l(n,t);this.c[t.a]=""}},i:function(){if(this.a.d.length>0){var n=this.a.d[0];this.f(n);return n}else return null},f:function(n){this.d(n);if(this.b(n.a)){delete this.c[n.a];for(var i=-1,t=0;t<this.a.d.length;t++)if(this.a.d[t].a===n.a){i=t;break}i!==-1&&this.a.j(i)}},d:function(n){_a.b.a(n,"parameter");_a.b.a(n.a,"AttachmentId")}};_at.r=function(){};_at.r.e=function(n,t,i,r,u,f,e){_a.b.a(n,"initNativeBridge");_a.b.a(t,"initClientStore");_a.b.a(i,"initAttachmentInfoRecord");_a.b.c(r,"initMimeType");_a.b.c(u,"fileName");_a.b.a(f,"initOnOpenAttachmentSuccess");_a.b.a(e,"initOnOpenAttachmentError");if(_at.r.b){_j.e.a(_at.r.a,"Already opening an attachment so returning.");return}_j.e.a(_at.r.a,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.r.b=!0;n.d().f(i.DataID,r,u,function(n){_at.r.d(n,i,t,f,e)});t.l(i.AttachmentId,function(n){},null)};_at.r.c=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.a.lf;break;case 2:t=_nbs.a.BM;break;default:break}_j.e.a(_at.r.a,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.r.d=function(n,t,i,r,u){_at.r.b=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.g(t.AttachmentId);break;default:break}if(f){_j.e.b(_at.r.a,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_j.e.a(_at.r.a,"OnOpenDocument succeeded");r()}};_at.d=function(n,t,i){this.r=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.w);_a.b.a(n,"initNativeBridge");var r=t?t.j():null;this.l=n;this.q=i;this.k=n.q().a(r);this.v(t)};_at.d.prototype={k:!1,g:null,f:null,h:null,m:0,j:null,l:null,q:null,n:null,a:function(){if(!this.k&&_g.k.a){var n=_bc.k.isInstanceOfType(_g.k.a)?_g.k.a:null;this.k=this.l.q().a(n?n.h():null);this.v(n?n.d().j():null)}return this.k},d:function(n,t){_a.b.c(n,"attachmentId");_a.b.a(t,"callbacks");if(this.a()){this.j[n]=t;this.y(n,t)}else _j.e.a(_at.d.a,"PAL does not support download.")},b:function(n){_a.b.c(n,"attachmentId");this.a()&&n in this.j&&delete this.j[n]},c:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_a.b.a(n.e,"DownloadUrl");_j.e.a(_at.d.a,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.a()){if(!(n.a in this.j))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.C(n);if(_j.h.a(t)){if((!this.f||this.f.a!==n.a)&&!this.g.b(n.a)){_j.e.a(_at.d.a,"Starting download for {0}",n);if(n.h){this.g.e(0,n);if(this.f){this.u();this.g.e(1,this.h);this.i(this.h,2)}else{this.i(n,2);this.p()}}else{this.g.h(n);this.i(n,2);this.p()}}}else this.x(n,t)}},e:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_j.e.a(_at.d.a,"Cancel download for parameters {0}",n);if(this.a())if(this.g.b(n.a)){this.g.f(n);_j.e.a(_at.d.a,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.g.a.d.length);this.i(n,1)}else if(this.f&&this.f.a===n.a){_j.e.a(_at.d.a,"Current Download was canceled. {0}",this.f);this.u();this.i(this.h,1)}},z:function(n){var t=null;switch(n){case 0:break;case 7:break;case 8:break;case 9:t=_nbs.a.qc;break;case 2:t=_nbs.a.KR;break;default:break}return t},v:function(n){if(this.k){this.n=n;this.g=new _at.bI(_at.d.a);this.j={};this.h=null;this.f=null;this.m=0}},u:function(){_j.e.a(_at.d.a,"CancelCurrentDownload, canceling the current download");this.l.l().d();this.h=this.f;this.f=null},p:function(){_j.e.a(_at.d.a,"Inside StartDownloadInternal");if(this.h)_j.e.a(_at.d.a,"Still waiting for the canceled download to get canceled.");else if(this.f)_j.e.a(_at.d.a,"Still waiting for the current download to finish.");else{_j.e.a(_at.d.a,"StartDownloadInternal, pending items in queue {0}",this.g.a.d.length);this.f=this.g.i();this.m=0;if(this.f){_j.e.a(_at.d.a,"Starting download {0}",this.f);this.i(this.f,3);var n=this;this.q.c(this.n,this.l,this.t,function(t){_j.e.b(_at.d.a,"Scheduled cleanup failed due to error {0}",t);n.w()})}else _j.e.a(_at.d.a,"Download queue is empty.")}},w:function(){_j.e.a(_at.d.a,"Starting the download now for {0}",this.f);if(this.h){this.h=null;this.p()}else this.l.l().e(this.f.e,1,this.f.f,this.f.b,this.s,this.r)},B:function(n){if(this.f){this.m+=n;var t=this;this.o(this.f,function(n){n.E(t.m)})}},i:function(n,t){var i=this;this.o(n,function(n){n.d(t)})},x:function(n,t){var i=this;this.o(n,function(i){_j.e.b(_at.d.a,"Raising OnError event with error {0} for attachment {1}",t,n);i.F(t)})},o:function(n,t){var i=this.j[n.a];i&&t(i)},A:function(n,t,i){_j.e.a(_at.d.a,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.f);if(this.h)this.h=null;else if(n||t!==200){var f=this.z(n);_j.h.a(f)||this.x(this.f,f);this.i(this.f,1)}else{var r=this.f;var u=new AttachmentInfoRecord(this.f.a,i,this.f.d,_a.d.get_utcNow().h(),this.f.g,0,_a.d.w(_a.d.get_utcNow()),!0);var e=this,s=this;this.n.q(u,function(n){_j.e.a(_at.d.a,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_j.e.b(_at.d.a,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.i(r,4);var o=this;this.o(r,function(n){_j.e.a(_at.d.a,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.u(u)})}this.f=null;this.p()},C:function(n){var t=null;if(_bc.f.b(n.a)){_j.e.a(_at.d.a,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.a.LM}else if(_j.h.a(n.g)){_j.e.a(_at.d.a,"Attachment is a quick message {0}",n);t=_nbs.a.LM}else if(_j.h.a(n.b)){_j.e.a(_at.d.a,"Attachment does not have content type set. {0}",n);t=_nbs.a.KR}else if(_j.h.a(n.f)){_j.e.a(_at.d.a,"Attachment does not have a valid file name {0}.",n);t=_nbs.a.KR}else if(this.g.a.d.length===10){_j.e.a(_at.d.a,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.a.Po,10)}return t},y:function(n,t){if(this.f&&n===this.f.a){_j.e.a(_at.d.a,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.d(3)}else if(this.g.b(n)){_j.e.a(_at.d.a,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.d(2)}else{var r=this,i=this;this.n.p(n,function(i){if(i){_j.e.a(_at.d.a,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.d(4);t.u(i)}else{_j.e.a(_at.d.a,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.d(1)}},function(i){_j.e.b(_at.d.a,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.d(1)})}}};_at.N=function(){};_at.N.b=function(n){_a.b.a(n,"viewModel");_a.b.a(n.bv,"DownloadUrl should not be empty");var t=null;n.bk&&n.bk.b()&&(t=n.bk.b().Id);return _at.N.a(n.bj,n.bj.bD.Name,n.bj.bD.ContentType,n.bv,t,!1)};_at.N.a=function(n,t,i,r,u,f){_a.b.a(n,"attachment");_a.b.a(n.bD.AttachmentId,"attachmentId");_a.b.a(r,"downloadUrl");_a.b.a(r,"destinationFileName");var e=new _at.N;e.a=n.bD.AttachmentId.Id;e.d=n.b();e.c=t;e.f=_a.bf.a(e.c);e.b=i;e.e=_a.Q.a(r);e.g=u;e.h=f;_j.h.a(e.b)&&!_a.o.a().L&&(e.b="fakeMimeType");return e};_at.N.prototype={b:null,c:null,f:null,a:null,g:null,e:null,d:0,h:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.c,this.d,this.b,this.a)}};_at.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_at.b.initializeBase(this,[n,t,i,r,u,o,s,h,c,l,a]);_a.b.b(f,"palDownloadManager");_a.b.b(a.a,"nativeBridge");_a.b.b(e,"itemStoreGetter");this.bI=f;this.cv=a.a;this.dD=e;this.bj&&this.fe(null,this.bj.bD.AttachmentId)};_at.b.prototype={cv:null,bI:null,dD:null,dE:null,dC:0,eY:null,fa:function(n){this.dC=n;this.eB("PALAttachmentDownloadStatus");return n},fi:function(n){this.eY=n;this.eB("PALAttachmentCurrentDowloadedBytes");return n},fO:function(){return _at.a.prototype.fO.call(this)||_dg.d.isInstanceOfType(this.bj)&&_a.cA.isInstanceOfType(this.bj.c)},cy:function(){var n=_at.a.prototype.cy.call(this);if(n&&this.cv&&this.cv.b(this.cv.d())){var t=this.cv.h(_a.fn,2);_j.e.a(_at.b.a,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},hT:function(){return this.bo.c()&&this.bw},ff:function(){return this.cy()&&!this.cc()?!1:this.bI.a()&&this.bw},gL:function(){this.gK()},d:function(n){_j.e.a(_at.b.a,"Got attachment status {0}",n);this.fa(n)},E:function(n){this.fi(String.format(_nbs.a.Ey,this.fd(n,1),this.fd(this.bj.b(),0)))},F:function(n){_j.e.b(_at.b.a,"Unable to download attachment with name {0} and error is {1}",this.bj.bD.Name,n);this.cb(n)},u:function(n){_j.e.a(_at.b.a,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.dE=n},gH:function(n){_a.cA.isInstanceOfType(n.c)?n.a()?this.gB():this.iK():_at.a.prototype.gH.call(this,n)},fH:function(n){if(_a.cA.isInstanceOfType(n.c)){_j.e.a(_at.b.a,"Deleting file attachment via PAL.");var t=n.c;this.cv.i().a(t.c())}else _at.a.prototype.fH.call(this,n)},eo:function(n,t){if(this.bI.a()){_j.e.a(_at.b.a,"Will use PAL to open attachment.");this.fh()}else _at.a.prototype.eo.call(this,n,t)},gg:function(n,t){this.fe(n,t);_at.a.prototype.gg.call(this,n,t)},fh:function(){_j.e.a(_at.b.a,"OpenAttachmentUsingPAL, download status={0}",this.dC);if(!this.bk.o(this.bM)){_j.e.b(_at.b.a,"The context has changed from "+this.bM+" to "+this.bk.W()+", opening attachment using PAL has been skipped.");return}if(this.bk.bb()||!this.bw){_j.e.a(_at.b.a,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.bk.bb(),this.bw);return}this.gM();var t=_at.N.b(this);_j.e.a(_at.b.a,"PAL attachment download parameters: {0}",t.toString());switch(this.dC){case 0:case 1:this.E(0);_j.e.a(_at.b.a,"Starting PAL attachment download.");this.bI.c(t);break;case 3:case 2:_j.e.a(_at.b.a,"Canceling PAL attachment download.");this.bI.e(t);break;case 4:_j.e.a(_at.b.a,"PAL attachment download complete.");var n=this;this.dD.a(function(){var i=n.dD.b().a(_g.a.a().a().bD.TimeZone);_at.r.e(n.cv,i.j(),n.dE,t.b,t.c,function(){_j.e.a(_at.b.a,"Attachment opened successfully.")},function(t){_j.e.b(_at.b.a,"Attachment open failed with errorCode {0}",t);t===2&&n.fa(1);var i=_at.r.c(t);n.cb(i)})});break;default:break}},fe:function(n,t){if(this.bI)if(_dg.i.isInstanceOfType(this.bj)){_j.e.a(_at.b.a,"ItemAttachment for PAL status:Downloaded");this.fa(4)}else if(this.bI.a()){n&&n.Id&&this.bI.b(n.Id);t&&t.Id&&this.bI.d(t.Id,this)}},gK:function(){if(this.bI.a()&&this.bj&&this.bj.bD.AttachmentId&&!_dg.i.isInstanceOfType(this.bj)){_j.e.a(_at.b.a,"Unsubscribing for attachment with name {0} and id {1}",this.bj.bD.Name,this.bj.bD.AttachmentId);this.bI.b(this.bj.bD.AttachmentId.Id)}},fd:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.R.Hz}else if(n>=1048576){r/=1048576;i=_u.R.Ld}else if(n>=1024){r/=1024;i=_u.R.HD}else i=_u.R.n;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},gM:function(){if(this.bo.e()&&(_j.h.b(this.bj.bD.ContentType)||_at.b.d===this.bj.bD.ContentType.toLowerCase())){var t=_a.bf.a(this.bj.bD.Name);var n;if(_j.h.b(t))n=_at.b.d;else{n=_at.b.f[t.toLowerCase()];_j.h.a(n)&&(n=_at.b.d)}_j.e.a(_at.b.a,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.bj.bD.Name||"<NULL>",t||"<NULL>",this.bj.bD.ContentType||"<NULL>",n);this.bj.j(n)}}};_at.bJ=function(){};_at.bJ.prototype={a:function(){return!1},d:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},b:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},c:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},e:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};_at.bK=function(n){this.e=!!n&&n.a().cg().Enabled;this.f=!!n&&n.a().O().Enabled};_at.bK.prototype={e:!1,f:!1,a:null,b:null,c:function(n,t){if(!_j.h.a(t)){this.a||(this.a={});switch(n){case 4:case 3:case 5:case 6:case 2:case 1:this.a[n.toString()]=t;break;default:_j.e.b(_a.a.c,String.format("Cannot add sharing link for permission type: {0}",n));break}}},d:function(n,t){this.b||(this.b={});switch(n){case 4:case 3:case 5:case 6:this.b[n.toString()]=t;break;default:_j.e.b(_a.a.c,"Cannot create link of this type. Skip adding to dictionary");break}},h:function(n,t){var i=null;if(this.a)switch(n){case 4:case 3:case 5:case 6:n.toString()in this.a&&(i=this.a[n.toString()]);break;case 2:case 1:if(t&&t===_g.q.toString(0)&&"2"in this.a){i=this.a["2"];break}n.toString()in this.a&&(i=this.a[n.toString()]);break;default:break}return i},g:function(n){if(this.b)switch(n){case 4:case 3:case 5:case 6:return n.toString()in this.b?this.b[n.toString()]:!1;case 1:case 2:return!0;default:_j.e.b(_a.a.c,String.format("Cannot create link of permission type: {0}. Returning false.",n));return!1}return!1},i:function(n){if(this.e){_j.h.a(n.AnonymousEditLink)?this.d(4,n.CanCreateAnonymousEditLink):this.c(4,n.AnonymousEditLink);_j.h.a(n.AnonymousViewLink)?this.d(3,n.CanCreateAnonymousViewLink):this.c(3,n.AnonymousViewLink)}if(this.f){_j.h.a(n.OrganizationEditLink)?this.d(6,n.CanCreateOrganizationEditLink):this.c(6,n.OrganizationEditLink);_j.h.a(n.OrganizationViewLink)?this.d(5,n.CanCreateOrganizationViewLink):this.c(5,n.OrganizationViewLink)}}};_at.bi=function(n,t,i,r,u,f,e,o,s,h,c){_at.bi.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.bi.a=function(){return"UriFileAttachmentNotification"+(_a.d.a().h()+_ff.o.a(0,1e3)).toString()};_at.bi.prototype={d:null,n:function(){this.d||(this.d=_at.bi.a());return this.d},gL:function(){return"UriFileAttachmentViewModel"},dY:function(){return!1},ee:function(n){if(_dg.d.isInstanceOfType(this.bj)&&_y.cw.isInstanceOfType(this.bj.c)){_j.e.a(_a.a.h,"Uploading attachment from URL");var i=this.bj.c;this.fa();var t=new _at.bP(this.bk.b(),i.c(),i.a(),this.n(),this.bj.a(),this.bj.bD.ContentId);t.e(this.eY);this.bJ.a(t)}else{_j.e.c(_a.a.h,"Unsupported upload type detected in addFileAttachment");n(null)}},eT:function(){this.gu(!1)}};_at.bj=function(n,t,i){this.c=n;this.d=t;this.b=i};_at.bj.prototype={c:null,d:null,b:null,a:function(n,t,i,r,u,f,e,o){var s=_at.s.a(this.d,this.b,u);return new _at.bi(n,t,i,r,u,f,e,o,this.c,s,this.b)}};_at.bD=function(){_at.bD.initializeBase(this)};_at.bD.prototype={a:function(){return 1},c:function(){return 8},b:function(){return!0},d:function(){return!0}};_at.bV=function(){};_at.bV.prototype={n:null,f:0,g:null,l:!1,m:!1,i:null,e:null,j:function(){Error.invalidOperation("Not supported");return 6},a:function(){return 2},c:function(){return 0},b:function(){return!1},k:function(){return!1},d:function(){return!1},o:function(n,t,i,r,u,f,e){this.n=n;this.f=t;this.g=i;this.l=r;this.m=u;this.i=f;this.e=e}};_at.by=function(){_at.by.initializeBase(this)};_at.by.prototype={a:function(){return 1},c:function(){return 7},b:function(){return!0},d:function(){return!0}};_at.bz=function(){_at.bz.initializeBase(this)};_at.bz.prototype={j:function(){return 10},a:function(){return 1},c:function(){return 4},b:function(){return!0},d:function(){return!0}};_at.bC=function(n){_at.bC.initializeBase(this);this.h=n};_at.bC.prototype={h:!1,a:function(){return 1},c:function(){return 6},b:function(){return!0},k:function(){return this.h},d:function(){return!0}};_at.bE=function(){_at.bE.initializeBase(this)};_at.bE.prototype={a:function(){return 1},c:function(){return 5},b:function(){return!0},d:function(){return!0}};_at.bc=function(){_at.bc.initializeBase(this)};_at.bc.prototype={a:function(){return 2}};_at.bA=function(){_at.bA.initializeBase(this)};_at.bA.prototype={a:function(){return 1},c:function(){return 3},b:function(){return!0},d:function(){return!0}};_at.bB=function(){_at.bB.initializeBase(this)};_at.bB.prototype={a:function(){return 1},c:function(){return 1},b:function(){return!0},d:function(){return!0}};_at.bd=function(){_at.bd.initializeBase(this)};_at.bd.prototype={a:function(){return _a.g.b?2:1},c:function(){return 2},b:function(){return this.f==="TouchNarrow"?!1:this.e.e()?this.g.a().dj().Enabled&&!this.h():!1},d:function(){return!0},h:function(){return!!this.e&&!!this.e.d()&&!!this.e.d().a()&&this.e.d().a().eV()}};_at.y=function(n){this.n=Function.createDelegate(this,this.x);_at.y.initializeBase(this,[n])};_at.y.prototype={b:null,e:0,i:!1,c:!1,g:!1,q:function(n){if(this.c!==n){this.c=n;this.bv("ImageLoadSucceeded")}return n},p:function(n){if(n!==this.b){this.b=n;this.j()}return n},r:function(n){if(n!==this.e){this.e=n;this.j()}return n},f:function(n){_j.k.c(this.z,"error");this.a(_y.c.a.m(_y.e.a().c));this.v();this.i=!0},P:function(){_b.bh.prototype.P.call(this);_j.k.b(this.z,"load",this.n);this.j();this.u()},bw:function(){_j.k.c(this.z,"load");_j.i.prototype.bw.call(this)},x:function(n){this.q(!this.i);this.c&&!this.g&&this.w(this.z)},u:function(){var t=_a.c.b(_a.a.c,"AttachmentExternalImage");var n=new _a.l;n.c("L",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.j=n.toString();_a.c.a(t)},v:function(){var t=_a.c.b(_a.a.c,"AttachmentExternalImage");var n=new _a.l;n.c("E",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.j=n.toString();_a.c.a(t)},j:function(){this.b&&this.e&&this.a(this.b.c)},w:function(n){this.g=!1;var f=n;if(_at.y.a){f=window.document.createElement("img");f.src=n.src}var i=f.naturalHeight;i||(i=f.height);var r=f.naturalWidth;r||(r=f.width);i||(i=this.b.b);r||(r=this.b.d);if(!i||!r){_j.e.b(_a.a.c,"Stopping processing image since either imageHeight or width is 0");return}var y=0;var c=1;var w=0;var p=1;var t=this.b.e;if(t&&t.b()>=4)if(t.a(0)<t.a(2)&&t.a(1)<t.a(3)){_j.e.a(_a.a.c,"Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));var h=255;y=t.a(0)/h;w=t.a(1)/h;c=t.a(2)/h;p=t.a(3)/h}else _j.e.b(_a.a.c,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));else _j.e.b(_a.a.c,"Using default value as the salient regions");var g=r/i;var o;var s;var b,l;_at.X.a(this.e,b={val:s},l={val:o}),s=b.val,o=l.val;var nt=o/s;var e;var a=0,v=0;if(g>nt){e=s/i;a=this.o(e,r,o,(w+p)/2)}else{e=o/r;v=this.o(e,i,s,(y+c)/2)}var tt=Math.round(r*e);var it=Math.round(i*e);var k=a*-1;var d=v*-1;var u={};u.width=tt.toString()+"px";u.height=it.toString()+"px";u.top=d.toString()+"px";u[_fc.n.a()]=k.toString()+"px";this.z.style.cssText="width: "+u.width+"; "+"height"+": "+u.height+"; "+"top"+": "+u.top+"; "+_fc.n.a()+": "+u[_fc.n.a()]+"; "+"position"+": "+"absolute"+";";this.g=!0},o:function(n,t,i,r){var o=.5;var e=t*n;var u=(e-i)/e;var f;f=r-o>=u/2?Math.round(e*u):o-r>=u/2?0:Math.round((r-o+u/2)*e);return f}};_at.X=function(){};_at.X.a=function(n,t,i){switch(n){case 3:i.val=160;t.val=120;break;case 4:i.val=200;t.val=150;break;case 5:i.val=260;t.val=195;break;case 6:i.val=40;t.val=40;break;default:i.val=50;t.val=50;break}};_at.Y=function(n){_at.Y.initializeBase(this,[n])};_at.Y.prototype={G:function(){_j.i.prototype.G.call(this);var n=this.V();if(n&&n.bj&&n.fM()){var i=_a.bf.a(n.bj.bD.Name).replace(".","");var t=SuiteExtensions.ControlFactory.CreateControl(i,0);t.Render(this.z)}}};_at.c=function(n){this.s=Function.createDelegate(this,this.bp);this.r=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.bQ);this.v=Function.createDelegate(this,this.bR);this.t=Function.createDelegate(this,this.br);_at.c.initializeBase(this,[n]);this.a("about:blank");this.A(-1);_j.i.c(this.z,"load",this.t,"hiddenAttachmentUpload",!1)};_at.c.prototype={b:null,c:null,e:0,k:!1,n:null,m:0,p:null,h:!1,l:null,i:function(){return this.eD(_at.c.c)},bu:function(n){this.eC(_at.c.c,n);return n},j:function(){return this.eD(_at.c.e)},bL:function(n){this.eC(_at.c.e,n);return n},bD:function(n){n||(this.e=-1);this.eC(_at.c.g,n);return n},bf:function(){return this.eD(_at.c.d)},bA:function(n){this.eC(_at.c.d,n);return n},bh:function(){return this.eD(_at.c.b)},bM:function(n){this.eC(_at.c.b,n);return n},E:function(n){if(this.l===n)return n;this.l=n;this.bv("UploadAndShareAttachmentCommand");return n},bk:function(){return this.eD(_at.c.f)},bN:function(n){this.eC(_at.c.f,n);return n},y:function(n){this.n=n;this.bv("Error");return n},x:function(n){this.m=n;this.bv("AttachmentError");return n},B:function(n){this.p=n;this.bv("SuccessResponse");return n},Y:function(){_j.i.prototype.Y.call(this);this.eC(_at.c.b,new _j.g(this.v,_at.c.a));this.E(new _j.g(this.u,_at.c.a))},br:function(n){if(this.e){if(this.e===2){_j.e.a(_at.c.a,"Response received.");var t="";try{t=this.z.contentWindow.document.body.innerText}catch(u){if(!(_a.o.a().H&&u.number===-2146828218)){_j.e.d(_at.c.a,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.k)_j.h.a(t)&&this.o(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.l.d(t,this.i(),this.j(),_g.k.a,function(n){_j.e.a(_at.c.a,"HandleCreateAttachmentResponse completed.");r.o(n,null,0)},function(n,t){_j.e.a(_at.c.a,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.i().a()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.n.d(t)||_at.n.a(n);i.o(null,f,r)})}}}else{_j.e.a(_at.c.a,"Initializing.");this.e=1;this.bs();_j.m.a().a(_at.c.a,"ExecuteOpenFilePicker",this.r,0)}},o:function(n,t,i){this.B(n);this.y(t);this.x(i);this.e=3;this.bk().a();this.h=!1},bs:function(){var n=this.z;n.contentWindow.document.body.innerHTML="";this.b=n.contentWindow.document.createElement("form");this.b.method="POST";this.b.encType="multipart/form-data";this.b.encoding="multipart/form-data";this.bd(this.b);this.c=n.contentWindow.document.createElement("input");this.c.type="file";this.c.name="fileInput";_j.k.b(this.c,"change",this.s);this.b.appendChild(this.c)},bd:function(n){this.z.contentWindow.document.body.appendChild(n)},bp:function(n){if(!this.h){this.h=!0;var t=this.c.value;if(!_j.h.a(t)){this.i().e(this.bO(t));this.bf().a()}}},bO:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},be:function(){this.c.click()},bR:function(){this.k=!1;this.b.action=_g.C.i();this.w()},bQ:function(){this.k=!0;this.b.action=_g.C.l();this.f("subscriptionId",this.V().n());this.w()},w:function(){_j.e.a(_at.c.a,"Uploading attachment via form submit.");this.f("parentItemId",this.j().Id);this.f("parentChangeKey",this.j().ChangeKey);this.f("isInline",this.i().a().toString());this.f("cancellationId",this.V().bF());this.f(_a.w.c(),_a.w.e());this.b.submit();this.e=2},f:function(n,t){var i=this.b.ownerDocument.createElement("input");i.type="hidden";i.name=n;i.value=t;this.b.appendChild(i)}};_at.t=function(n,t,i,r,u,f){this.p=Function.createDelegate(this,this.E);this.q=Function.createDelegate(this,this.bd);this.r=Function.createDelegate(this,this.be);_at.t.initializeBase(this,[n]);this.a=r;this.l=f;this.l&&this.x(t,i,u);this.w()};_at.t.c=function(n,t){return t?n.getNamedItem("blockedimagesrc").value:n.getNamedItem("src").value};_at.t.a=function(n,t,i){var r=new _a.l;r.a("C",n);r.c("F",t);r.c("FS",i);_a.c.c(_a.a.c,"BingProxyForExternalImagesReliabilityCtqContext",r.toString(),0)};_at.t.d=function(n){return!n.search(_at.t.b)};_at.t.prototype={b:null,h:null,g:null,i:!1,l:!1,o:null,n:null,a:null,e:null,m:null,d:null,f:0,k:!1,c:null,j:function(n){this.k=n;this.d&&this.d.o(this.k);return n},bk:function(){if(this.a.attributes.hasOwnProperty("blockedimagesrc")){this.a.attributes.removeNamedItem("blockedimagesrc");this.g?this.u():this.a.src=this.h}},bH:function(){_j.k.c(this.a,"load");_j.k.c(this.a,"error");if(this.b){this.b.onreadystatechange=null;this.b.ontimeout=null;this.b=null}if(this.c){this.c.k="IncompleteLoad";this.c.m="Latency measurement incomplete; control disposed while proxy-loading image.";_a.c.a(this.c);this.c=null}this.a=null;this.e=null;this.m=null;this.o=null;this.d&&this.d.dispose();_j.c.prototype.bH.call(this)},H:function(){_j.c.prototype.H.call(this);this.z.style.display="inline-block";this.v();if(this.B){this.d=this.B.a("ImageContainerButton");this.d.o(this.k);if(_j.k.o(this.z,"a").length){this.d.z.parentNode.replaceChild(this.a,this.d.z);this.d.dispose();this.d=null}else this.d.z.appendChild(this.a)}},G:function(){_j.c.prototype.G.call(this);this.e[this.f]||this.j(!1)},x:function(n,t,i){this.y("InlineImageAttachment");this.e=n;this.f=t;this.n=i;this.m=this.e[this.f];this.o=new _j.g(this.r,_a.a.c);if(this.s()){this.e[this.f]=null;this.j(!1)}else this.j(!0)},w:function(){_j.k.b(this.a,"load",this.q);_j.k.b(this.a,"error",this.p);this.bh()},bh:function(){var n=this.a.attributes;var t=n.hasOwnProperty("blockedimagesrc");this.h=_at.t.c(n,t);!_at.i.d(this.h)&&n.hasOwnProperty("bingproxyimagesrc")&&this.bf(n,t)},bf:function(n,t){this.g=n.getNamedItem("bingproxyimagesrc").value;n.removeNamedItem("bingproxyimagesrc");_at.t.d(this.g)&&!t&&this.u()},u:function(){this.c=_a.c.b(_a.a.c,"BingProxyForExternalImagesLatencyCtqContext");this.a.src=this.g},t:function(n){this.b=new XMLHttpRequest;this.b.timeout=3e3;var i=this;this.b.ontimeout=function(){_j.e.a(_a.a.c,String.format("Bing proxy timed out trying to fetch image at URL: {0}",i.h));_at.t.a(-1,i.i,n)};var t=this;this.b.onreadystatechange=function(){if(t.b.readyState===4){var i=t.b.status;_j.e.a(_a.a.c,String.format("Bing proxy returned HTTP status code: {0}, status text: {1}, for image at URL: {2}",i,t.b.statusText,t.h));_at.t.a(i,t.i,n)}};this.b.open("GET",this.g,!0);this.b.send(null)},bp:function(n,t,i){var r=this.e[this.f];if(r){r.ImageUrl=n;r.PhotoPageUrl=t;r.ThumbnailUrl=i}},be:function(){this.n&&this.n(this.e,this.f,!1)},bd:function(n){if(this.g)if(this.i)this.t(!0);else{_a.c.a(this.c);this.c=null;_at.t.a(200,!1,!1)}if(this.l)if(this.s()){this.e[this.f]=null;this.j(!1)}else{this.e[this.f]=this.m;this.j(!0);var t=this.a.src;var r=this.a.getAttribute("data-downloadImage");var i=this.a.getAttribute("data-thumbnailImage");this.v();this.bp(t,r||t,i||t)}},E:function(n){if(this.g)if(this.i){_j.k.c(this.a,"error");this.t(!1)}else{this.c.k="ProxyFailure";_a.c.a(this.c);this.c=null;this.i=!0;this.a.setAttribute("src",this.h)}},s:function(){var n=this.a;return n.naturalWidth<50||n.naturalHeight<50},v:function(){this.a&&(this.a.style.maxWidth==="100%"||this.a.style.maxWidth==="99.9%")&&(this.z.style.maxWidth="99.9%")}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.bM=function(){};_at.bM.prototype={a:function(n,t){return String.format(_nbs.a.Iq,n)},b:function(n,t){throw Error.notImplemented();}};_at.bN=function(){};_at.bN.prototype={imageAttachmentNotLoaded:1,attachmentSize:2,attachmentDownloadingProgress:3,attachmentOverlay:4,attachmentWaitingDownloadText:5,attachmentNotDownloadedOverlay:6};_at.bN.registerEnum("_at.bN",!1);_at.bO=function(){};_at.bO.prototype={a:function(n,t){var i=n;var r=!0;try{var u=_j.t.d(_at.bN,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},b:function(n,t){throw Error.notImplemented();}};_at.e=function(){};_at.e.$$cctor=function(){_at.e._I()};_at.e.i=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='_at_5'></button> <div class='_at_2 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondary'> <span class='_at_3 ms-font-l ms-font-weight-semilight'></span> <span class='_at_3'></span> <span class='_at_3 _at_4'></span> </div> </div><div> <button type='button' class='_at_6'></button> </div>";_j.i.a().appendChild(n);return n};_at.e.h=function(n){return n.e};_at.e.n=function(n){return n.d};_at.e.m=function(n){return n.o};_at.e.g=function(n,t){n.K(t)};_at.e.f=function(n,t){n.T(t)};_at.e.l=function(n,t){n.l(t)};_at.e.k=function(n,t){n.m(t)};_at.e.j=function(n,t){n.Q(t)};_at.e.d=function(n,t){n.a(t)};_at.e.e=function(){_at.e.b||(_at.e.b=new _fc.k);return _at.e.b};_at.e._I=function(){var t="AttachmentOptionsIntroductionPeekView";new _j.d(t,function(){_at.e.a[t]===undefined&&(_at.e.a[t]=[[[-1,4,null,null,null,"ImageId",null,_at.e.l,0,null,null,null,_n.b.dh()],[-1,4,null,null,null,"HoveredImageId",null,_at.e.k,0,null,null,null,_n.b.di()],[-1,4,null,null,null,"AriaLabel",null,_at.e.j,0,null,null,null,_u.R.Bq],[-1,0,["ShowTitle"],[_at.e.h],null,"IsHidden",null,_at.e.g,1,_at.e.e(),null,!0],[-1,0,["CloseCommand"],[_at.e.n],null,"ClickCommand",null,_at.e.f,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.oe],[-1,0,["ShowTitle"],[_at.e.h],null,"IsHidden",null,_at.e.g,1,_at.e.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.VU]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.kg]]]);var n=_at.e.c.childNodes[0].cloneNode(!0);var u=new _fc.a(_j.a.a(n,[1,2]));var f=new _fc.a(_j.a.a(n,[1,1]));var i=new _fc.a(_j.a.a(n,[1,0]));var r=new _fc.b(n.children[0]);return new _j.a(n,[r,i,f,u])},"",_at.R,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_at.e.a);var n="InlineImageAttachment";new _j.d(n,function(){_at.e.a[n]===undefined&&(_at.e.a[n]=[[[-1,1,["PreviewCommand"],[_at.e.m],null,"ClickCommand",null,_at.e.f,1,null,null,null]]]);var i=_at.e.c.childNodes[1].cloneNode(!0);var t=new _fc.b(i.children[0]);return new _j.a(i,[t]).l({ImageContainerButton:t})},"",_j.c,_at.t,function(n){return new _at.t(n,_j.b.Instance.a(Array),_j.b.Instance.a(Number),_j.b.Instance.a(ImageElement),_j.b.Instance.a(Function),_j.b.Instance.a(Boolean))},!1,!1,!1,0,_at.e.a)};_at.W.registerClass("_at.W");_at.bP.registerClass("_at.bP",_h.ff);AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.iz,_j.cd);_at.s.registerClass("_at.s",null,IDownloadAuthenticatorFactory);_at.bx.registerClass("_at.bx",_h.ff,_a.fu);_at.z.registerClass("_at.z",null,IDownloadAuthenticator);_at.j.registerClass("_at.j",null,_at.I,IAttachmentPropertyChecker);_at.A.registerClass("_at.A",null,IFileReader);_at.q.c.registerClass("_at.q.c");_at.x.registerClass("_at.x",_h.ff,_a.fu);_at.bk.registerClass("_at.bk",_h.ff,_a.fu);_at.bl.registerClass("_at.bl",_h.ff,_a.fu);_at.bm.registerClass("_at.bm",_h.ff,_a.fu);_at.bn.registerClass("_at.bn",_h.ff,_a.fu);_at.bo.registerClass("_at.bo",_h.ff);_at.bp.registerClass("_at.bp",_h.ff);_at.bq.registerClass("_at.bq",_h.ff);_at.l.registerClass("_at.l",_h.cW.$$(_gg.gg,_gg.fT));_at.br.registerClass("_at.br",_at.l);_at.O.registerClass("_at.O",_h.ff,_a.fu);_at.bs.registerClass("_at.bs",_h.cW.$$(_gg.gr,_gg.gt));_at.bt.registerClass("_at.bt",_h.ff);_at.G.registerClass("_at.G",_h.cW.$$(_gg.rH,_gg.fT));_at.bu.registerClass("_at.bu",_h.ff);_at.k.registerClass("_at.k",_h.ff);_at.bS.registerClass("_at.bS",_h.ff);_at.bv.registerClass("_at.bv",_at.bS);_at.Z.registerClass("_at.Z",_at.bS);_at.H.registerClass("_at.H",_at.bS);_at.P.registerClass("_at.P",_h.ff);_at.ba.registerClass("_at.ba",_h.ff);_at.p.registerClass("_at.p");_at.C.registerClass("_at.C");_at.D.registerClass("_at.D");_at.w.registerClass("_at.w");_at.bF.registerClass("_at.bF",_a.bq);_at.R.registerClass("_at.R",_a.bs,_y.dT,_a.jk,_j.bq,Sys.IDisposable);_at.a.registerClass("_at.a",_a.bs,_at.bf,_y.dR,_j.bq,Sys.IDisposable);_at.L.registerClass("_at.L");_at.bU.registerClass("_at.bU",null,_at.bX);_at.S.registerClass("_at.S",_at.bU);_at.bH.registerClass("_at.bH",_at.bU);_at.T.registerClass("_at.T",_at.bU);_at.u.registerClass("_at.u",_at.bU);_at.U.registerClass("_at.U",_at.bU);_at.E.registerClass("_at.E",_at.bU);_at.v.registerClass("_at.v",_at.bU);_at.M.registerClass("_at.M",_at.bU);_at.bW.registerClass("_at.bW");_at.V.registerClass("_at.V",_at.bW);_at.F.registerClass("_at.F",_at.a);_at.N.registerClass("_at.N");_at.b.registerClass("_at.b",_at.a,_at.bY);_at.bK.registerClass("_at.bK");_at.bi.registerClass("_at.bi",_at.F);_at.bj.registerClass("_at.bj",null,IUriFileAttachmentViewModelFactory);_at.bD.registerClass("_at.bD",_at.bV);_at.bV.registerClass("_at.bV");_at.by.registerClass("_at.by",_at.bV);_at.bz.registerClass("_at.bz",_at.bV);_at.bC.registerClass("_at.bC",_at.bV);_at.bE.registerClass("_at.bE",_at.bV);_at.bc.registerClass("_at.bc",_at.bV);_at.bA.registerClass("_at.bA",_at.bV);_at.bB.registerClass("_at.bB",_at.bV);_at.bd.registerClass("_at.bd",_at.bV);_at.y.registerClass("_at.y",_b.bh);_at.Y.registerClass("_at.Y",_b.bh);_at.c.registerClass("_at.c",_b.A);_at.t.registerClass("_at.t",_j.c);_at.bO.registerClass("_at.bO",null,_j.bO);AttachmentsComponent.$$cctor();_at.i.b=_g.a.a().n()?_g.a.a().n().bD.DownloadUrlBase:null;_at.s.c=_a.a.c;_at.z.a=_a.a.c;_at.j.b=null;_at.K.a=_at.K.b();_at.q.b=null;_at.h.a={};_at.h.d=null;_at.f.b=null;_at.x.a={};_at.l.a=_a.a.c;_at.G.a=_a.a.c;_at.k.a=null;_at.k.b=0;_at.a.j="b7780972f918485c8cfc32b1ba7438eb";_at.a.h=_a.H.a();_at.a.d=_a.H.a();_at.a.a=_a.a.c;_at.a.c=new _j.q([".mp3"]);_at.a.g=new _j.q([".txt",".xml",".log"]);_at.a.f=new _j.q([".msg",".eml"]);_at.a.k=new _j.q([".ics",".ical",".icalendar",".vcs"]);_at.a.e=new _j.q([".pdf"]);_at.a.i=[8,1,4,9,5,6,11,10];_at.a.b=null;_at.S.a=[7,3];_at.T.a=[7,4,3];_at.u.a=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation","image/jpeg","image/gif","image/png","image/svg+xml","image/bmp","application/pdf"]);_at.u.b=new _j.q(["image/jpeg","image/gif","image/png","image/svg+xml","image/bmp","application/pdf"]);_at.u.d=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation","application/vnd.google-apps.drawing","application/vnd.google-apps.file","application/vnd.google-apps.folder","application/vnd.google-apps.form","application/vnd.google-apps.fusiontable","application/vnd.google-apps.map","application/vnd.google-apps.script","application/vnd.google-apps.sites"]);_at.u.c=[8,0,7,3];_at.U.a=new Array(0);_at.E.a=[8,0,2,4,7,3,5];_at.E.b=[0,2,7,3,5];_at.v.b=[8,0,2,12,4,7,3,10,5];_at.v.d=[8,0,2,4,7,3];_at.v.c=[0,2,7,3];_at.v.a=null;_at.M.a=[7,3];_at.n.b=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.g.j=[137,80,78,71,13,10,26,10];_at.g.h=[71,73,70,56,55,97];_at.g.i=[71,73,70,56,57,97];_at.g.g=[66,77];_at.r.a=_a.a.c;_at.r.b=!1;_at.d.a=_a.a.c;_at.b.a=_a.a.c;_at.b.d="application/octet-stream";_at.b.b="application/vnd.ms-excel";_at.b.e="application/msword";_at.b.c="application/vnd.ms-powerpoint";_at.b.f={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.b.b,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.b.e,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.b.e,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.b.c,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.b.c,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.b.c,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.b.c,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.b.c,".pwz":_at.b.c,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.b.b,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.b.b,".xlc":_at.b.b,".xld":_at.b.b,".xlk":_at.b.b,".xll":_at.b.b,".xlm":_at.b.b,".xls":_at.b.b,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.b.b,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.b.b,".xlw":_at.b.b,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};_at.y.a=_a.o.a().H&&!_a.o.a().M;_at.c.c=new _a.e("Attachment",_g.Attachment,_at.c);_at.c.e=new _a.e("ParentItemId",_g.f,_at.c);_at.c.g=new _a.e("IsEnabled",Boolean,_at.c);_at.c.d=new _a.e("FileSelectedCommand",_j.L,_at.c);_at.c.b=new _a.e("UploadAttachmentCommand",_j.L,_at.c);_at.c.f=new _a.e("UploadCompletedCommand",_j.L,_at.c);_at.c.a=_a.a.c;_at.t.b=new RegExp("https://www.bing.com/th\\?u=.+&pid=Outlook&hkey=.+","i");_at.e.c=_at.e.i();_at.e.b=null;_at.e.a={};_at.e.$$cctor();
window.scriptsLoaded['microsoft.owa.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
